%!TEX root = ../main.tex
% vim:nospell

\RequirePackage{shellesc} % unified shell-escape interface
\RequirePackage[debrief]{silence}
\RequirePackage[l2tabu, orthodox]{nag}
\providecommand{\pdfxopts}{a-3b,pdf17} % a-1a. a-1b
\immediate\write18{rm \jobname.xmpdata} % uncomment for Unix-based systems
\begin{filecontents*}{\jobname.xmpdata}
    \input{Preamble/metadata}
\end{filecontents*}
\documentclass[12pt,a4paper,oneside,openright]{book}
\PassOptionsToPackage{table}{xcolor}
\PassOptionsToPackage{luatex}{pdflscape}
\PassOptionsToPackage{pdfa}{hyperref}
% \usepackage[\pdfxopts]{pdfx}

\input{Preamble/standard_packages}

\usepackage[no-math]{fontspec} % after graphicx ; no-math option so that math-handling is left to unicode-math; silent to completely suppress all warnings (even in log file)
\usepackage[warnings-off={mathtools-colon}]{unicode-math}

\input{Preamble/font_selection.tex}

\usepackage[british]{babel} % with british, we get OUP hyphenation material for free
\usepackage[final,activate={true,nocompatibility},factor=1100,stretch=10,shrink=10,babel=true]{microtype} % if using option babel=true, babel must be loaded before microtype
\usepackage[british]{selnolig} % if using babel, this package should go after loading babel

% Loading order is important here https://tex.stackexchange.com/questions/435529/correct-loading-order-of-package-newfloat-along-with-hyperref-and-algorithmic-pa/435597#435597
\usepackage{float}

% \usepackage[draft=true,newfloat=true]{minted}
% \usepackage[minted]{tcolorbox}
\usepackage[newfloat=true]{minted}
\usepackage[minted,most]{tcolorbox}

\usepackage{csquotes} % The fvextra package is loaded by minted, so you should load minted before csquotes
\usepackage[modifier={by-nc-nd}]{doclicense} % depends on csquotes

\usepackage{chemformula} % uses tikz arrows

% \addbibresource{chapters/backmatter/thesis_refs.bib}
\ShellEscape{biber --tool chapters/backmatter/thesis_refs.bib} % deduplicate bibtex entries
\addbibresource{chapters/backmatter/thesis_refs_bibertool.bib}
% \setupbibentry{chapters/backmatter/thesis_refs.bib}

\input{Preamble/hyperref_related} % hyperref, glossaries etc.
\input{Preamble/customcommands}


% https://tex.stackexchange.com/questions/50830/do-i-have-to-care-about-bad-boxes/50850#50850
\tolerance=1414
\hbadness=1414
\emergencystretch=1.5em
\hfuzz=0.5pt
\vfuzz=\hfuzz
\raggedbottom
\hyphenpenalty=750
\frenchspacing
\binoppenalty=1000 % default 700
\relpenalty=800     % default 500
\interfootnotelinepenalty=10000
% \clubpenalty=10000
% \widowpenalty=10000

% \usepackage[draft,hyphenation,lastparline,nosingleletter,homeoarchy,rivers]{impnattypo}
\usepackage[hyphenation,lastparline,nosingleletter]{impnattypo}
\usepackage[defaultlines=2,all]{nowidow}

\makeglossaries % must be before starting to define any entries for the glossary. And, all glossary definitions (such as for symbols and any other custom glossaries) must come before this.
% no hyperlink on first use for entries with category=acronym
\glssetcategoryattribute{acronym}{nohyperfirst}{true} % https://tex.stackexchange.com/questions/434160/line-break-long-glossaries-entry-when-using-hyperref-and-latex-dvips-ps2pdf
\setabbreviationstyle[acronym]{long-short} % applicable only for glossaries-extra.sty
\input{chapters/frontmatter/acronyms}
