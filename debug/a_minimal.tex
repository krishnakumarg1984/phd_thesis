% vim:nospell
\documentclass{article}

\usepackage{subcaption}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage[margin=1cm]{geometry}
\usepackage{varwidth}

\newsavebox{\algboxA}
\newsavebox{\algboxB}

\begin{document}

\begin{figure}
    \centering
    \savebox{\algboxA}{%
        \begin{varwidth}[b]{0.65\linewidth}
            \begin{flushleft}
                \begin{algorithmic}[0]
                    \Procedure{Main}{}
                    \State configure interrupts
                    \State enable timers
                    \State $\vdots$
                    \While{\textproc{True}} \qquad \Comment{until shutdown}
                    \State background task \#1 \qquad  \Comment{safety checks}
                    \State background task \#2
                    \State $\vdots$
                    \If{Calibrate}
                    \Function{doCalibration}{$x$}
                    \State subroutine for calibration
                    \State $\vdots$
                    \EndFunction
                    \EndIf
                    \State $\vdots$
                    \State background task \#$n$ \qquad \Comment{serial comm.}
                    \EndWhile
                    \EndProcedure
                \end{algorithmic}
            \end{flushleft}
        \end{varwidth}%
    }%
    \savebox{\algboxB}{%
        \begin{varwidth}[b]{0.65\textwidth}
            \begin{flushright}
                \begin{algorithmic}[0]
                    \Function{ISR}{$ $}
                    \State read sensor data from ADC
                    \State $\vdots$
                    \State initialise model
                    \Function{computeControl}{$x$}
                    \State evalute modeleqns
                    \State $\vdots$
                    \EndFunction
                    \State $\vdots$
                    \State write control output to DAC
                    \EndFunction
                \end{algorithmic}
            \end{flushright}
        \end{varwidth}%
    }

    \fbox{%
        \subcaptionbox{background processes}{\usebox{\algboxA}}
        % \caption{background processes}
        \qquad
        \qquad
        \subcaptionbox{foreground processes}{%
            \raisebox{\dimexpr.5\ht\algboxA-.5\ht\algboxB}{%
                \usebox{\algboxB}%
            }%
        }%

        % \raisebox{\dimexpr.5\ht\algboxA-.5\ht\algboxB}{%
        %     \usebox{\algboxB}%
        % }%
    }%
    % \caption{RT software architecture of a microcontroller}
\end{figure}

\end{document}
