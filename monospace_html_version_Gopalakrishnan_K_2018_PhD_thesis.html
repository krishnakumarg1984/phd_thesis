<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Computational modelling of lithium ion batteries for electric vehicle applications: analysis, design and implementation</title>
<meta name="Subject" content="Lithium ion batteries ; Mathematical models ; Electric vehicles ; Plug-in electric vehicles ; Electric vehicle industry ; Electric vehicles–Batteries ; Battery management systems ; Battery charging stations (Electric vehicles) ; Battery industry ; electrochemistry ; Electric batteries ; Numerical calculations ; Numerical analysis ; Chemical processes–Mathematical models ; Simulation methods ; Computer simulation ; Computer modeling ; battery management systems "/>
<meta name="Author" content="Krishnakumar Gopalakrishnan"/>
<meta name="Creator" content="LuaTeX 1.07 and pdfx.sty with options a-3b,pdf17"/>
<meta name="Producer" content="LuaTeX 1.07 and pdfx.sty with options a-3b,pdf17"/>
<meta name="CreationDate" content=""/>
</head>
<body>
<pre>
Computational modelling of lithium ion
batteries for electric vehicle applications
Analysis, Design and Implementation

A thesis submitted for the degree of Doctor of Philosophy of Imperial College London by

Krishnakumar Gopalakrishnan
Department of Mechanical Engineering
Imperial College London

October 2018




Supervised by                                          Examined by
Dr Gregory J. Offer                                    Dr Dhammika Widanalage
Dr Monica Marinescu                                    Dr Daniele Dini


                                           1
2
Declaration of Originality
I declare that the material presented in this thesis is the result of my own research except for
specific portions wherein contributions from collaborators are acknowledged. Throughout
this thesis, references are made to other published works and these have been appropriately
cited. The material contained in this thesis has not been submitted, either in whole or in part,
for a degree at Imperial College London or any other university.



                                                      Signed:
                                                                Krishnakumar Gopalakrishnan
                                                                October 02, 2018
                                                                London, United Kingdom




Declaration of Copyright
                                  The copyright of this thesis rests with the author.
                                  Unless otherwise indicated, its contents are licensed
                                  under a Creative Commons Attribution-NonCommercial-
                                  NoDerivatives 4.0 International (CC BY-NC-ND 4.0) Licence.

Under this licence, you may copy and redistribute the material in any medium or format on
the condition that: you credit the author, do not use it for commercial purposes and do not
distribute modified versions of the work. When reusing or sharing this work, ensure you
make the licence terms clear to others by naming the licence and linking to the licence text.
Please seek permission from the copyright holder for uses of this work that are not included
in this licence or permitted under UK Copyright Law.




                                               3
                                                                                    Dedication
                                           To                my
                                   dear       wife,     Parvathy C.S.
                                 and my parents, Gopalakrishnan P.K.
                                 & Ananthalakshmi G. The sacrifices
                                 that you all made for my success
                                  is immeasurable and no amount
                                    of words shall convey my sheer
                                      gratitude. I am forever in
                                        your debt for your
                                              unconditional
                                                  love.
                                                    ♡




               Bhagavad-Gītā 2:47:
               कमयेवाधकारते मा फले षु कदाचन।
               मा कमफलहेतभूमा ते साेऽवकमण॥ २-४७
               Karmanye vadhikaraste Ma Phaleshu Kadachana
               Ma Karmaphalaheturbhurma Te Sangostvakarmani
               You are entitled to do your duty and action, but never to the results of your actions.
               Let not the fruits of action be your sole motive, nor let your attachment be to inaction.
                                         —Krishna to Arjuna




The image ‘Thaliyola.jpg’ (on which the Gita verse is overlaid by this thesis author) was sourced from Wikimedia Commons and is
                                                                                                           licensed CC-BY-SA 2.5




                                                      4
                                                Acknowledgements

Obtaining a PhD has long been a dream of mine. This dream could not have come to fruition
without the support of many of my well-wishers to whom I shall remain eternally grateful.
Here, I would like to acknowledge their invaluable support in aiding this achievement.

    I wish to incorporate Sahadharmiṇī (companion soul) and Bandhu-Mithradhikal (relatives
and friends) into the classical quartet of support pillars — Matah (mother), Pitah (father), Guru
(teacher), Deivam (God) — commonly attributed as reasons for one’s success in ancient Indian
scriptures such as the Vedas, Shastras, Charitras, Itihasas and Purāṇas. Whilst making this
personal amendment, I would like to de-emphasise any connotations of hierarchy amongst
these support pillars, since they all play equally important roles in one’s life.

    During these four years, the level of support accorded by my wife Parvathy Chittur
Subramanianprasad cannot be described in mere words. She voluntarily shouldered all
matters of responsibility in the family so that I could focus solely on my research. At
this prime of her youth, she has sacrificed so many material comforts and happily lived
a relatively austere life by humbly accepting the financial constraints that are part and parcel
of a student’s life. In the same vein, I owe a lot to my parents Shri Gopalakrishnan P. K.
and Smt. Ananthalakshmi G. It has been ten long years since I departed Indian shores in
pursuit of higher studies. During all those years, despite ill-health and missing my presence
at home, they have always urged me to carry on and complete my studies. Many a time, I
have experienced a hopeless sense of incompleteness due to my inability to fulfil the basic
duties of a son towards his parents, the least of which is spending quality time with them.
However, my parents have always brushed aside their physical and financial difficulties to
put my success above everything else.

    It is needless to explain the crucial role of academic supervisors in the life of a doctoral
candidate. I was extremely lucky to be bestowed with not just one, but two amazing
supervisors here at Imperial College London — Dr Gregory J. Offer and Dr Monica Marinescu.
I have immensely benefited from their supervision, both from technical and personal
perspectives. Even during moments of sheer despair, my supervisors steadfastly held faith
in my abilities. Their unflinching support contributed in no small measure for this success
of mine. I also wish to acknowledge Dr Davide M. Raimondo who served as my unofficial
supervisor and allocated months of his personal time for my research, often well outside
regular working hours. I also wish to express my gratitude to Dr Gregory L. Plett who has
always generously offered his technical expertise and guidance on all my research ideas.
I am thankful to Dr Teng Zhang who mentored me in my initial days here and without his
feedback, I could not have published my first journal article.

                                               5
                                                                  ACKNOWLEDGEMENTS


     Although my interaction with them has sadly been on the wane in recent years,
I am lucky to be a recipient of the blessings of my thatha (Shri Hariharan S) and paatti
(Smt. Parvathi Hariharan), my affectionate grandparents, who have lived a life of humil-
ity, adhering to time-honoured traditions, whilst seeming to have an endless reserve of
love to bestow. Although I regret not having had a deeper relationship with him, I am
immensely fortunate to have benedictions of the noble soul and towering figure, Acharyan
Shri C R Krishna Iyer, affectionately known as ‘thathanna’, who has recently attained the
lotus feet of Lord Guruvayoorappa. Though I have not yet attempted to imbibe the spiritual
hints bequeathed by him, I hope to be a worthy beneficiary of its legacy with passage of time.

    My father-in-law, Dr Subramaniaprasad C K or CKSP/Chithappa, as he is fondly known
in our family circles, has been a father-like figure to me. From procuring transcripts at my
alma-mater at the start of my PhD journey, all the way until providing regular feedbacks by
proofreading this thesis, he has been a strong driving force behind my success.

    Members of my extended family have long been staunch supporters of my educational
aspirations. I vividly recollect the day I offered namaskaarams to Kaimal Chithappa before
my first journey outside India prior to commencing Masters’ studies at Virginia Tech.
Shri Keshava Kaimal has been a strong motivator and was one of the earliest in my family to
instigate a passion for engineering in me. His erudite teachings, such as as the translation of
“Agnayeh, ithanna mamah (Oh Agni! This is not for me; this is for the society)” still ring in my
ears and I shall certainly strive to rise up to such lofty ideals.

    I am immensely thankful to my sister, Smt. Radhika Balaji for constantly cheering me up.
Not for a moment has her belief in me wavered, and I am relieved that I did not let her down.
I would like to express my gratitude to Smt. Usha Prasad whose calmness and compassion
were a solace during difficult personal times, and to Smt. Radha Ramaswamy, whose
enthusiasm has been a buoyant motivator. I wish to thank Balaji Anna, Shri Ramaswamy
Krishnan Chittur (Ramesh) and Dr Sandeep Sangameswaran, all of whom have been more
than what even brothers could be and have always lent their support throughout.

     Despite not having interacted much with her, the abilities of our beloved Manni Ammal
from Chittur remind me that one should not be carried away by their achievements. In India,
a female attending school in the pre-independence era, particularly in a rural Kerala village,
is virtually unheard of. Not only did Manni top her high-school grades, she can reel off
the Nobel-winning Gitanjali in fluent English, despite being hampered by the age-related
afflictions of a nonagenarian. On the same note, I bow before the vast knowledge and humility
of Shri Ramaswamy C. K. and Smt. Uma Sangameswaran which have endlessly inspired me.

   I would like to express my sincere gratitude to my uncles and aunts (Shri Kannan,
Smt. Subbalakshmi, Shri Jayakumar, Smt. Lalitha, Shri Nandakumar, Smt. Asha, Shri Kaimal,
                                            6
                                                                   ACKNOWLEDGEMENTS


Smt. Ranjini, Shri Dwarakanath, and Smt. Brinda) and to all my cousins who used to note
with pride that I was the first in the family to pursue higher studies outside India, and now the
first one to complete a doctoral degree. During difficult times in the PhD, I am glad to have
had the cheerful support of Smt. Remya and Smt. Shyama, whose light-hearted approaches
to many issues is certainly worth learning from. I am thankful to Lakshmi athai, Seetha athai
and Shankar athimbere for their constant support and encouragement. The next generation
in the immediate family — Arjith, Siddharth, Aditya and little Usha kutty — provided respite
from the monotonicity of doctoral studies through their carefree joy and innocence.

    On the technical front outside my specific research area, I would like to acknowledge the
scores of individuals who have contributed to open-source projects for free. It is due to their
efforts that much of the computational research work in the modern era is possible. I wish
to express my admiration of Dr Donald E. Knuth and Dr Leslie Lamport for giving us the
TEX typesetting system and the LATEX macro package respectively, that immensely helped in
document authoring. I am also thankful to Bill Joy and Bram Moolenaar for developing the
vi and vim text editors, whose sheer power eased my pain during coding and thesis writing
sessions. I am thankful to the senior contributors (David Carlisle, Ulrike Fischer, Nicola Talbot,
Jonathan Spratte to name just a few) of the TeX forum in the StackExchange family of portals,
for their personalised support and patient answers to my rather dull questions. I also wish
to tip my hat to Jorge Cham for his visceral portrayal of life in graduate school through
PhD comics, that has never failed to put a smile on my face.

    I would like to acknowledge members of my research group (Alexander Holland, Emma
Vendola, Ian Campbell, Ian Hunt, Mei-Chin Pang, Oisin Shaw, Wasim Sarwar, Yan Zhao,
Yu Merla to name a few) for their companionship during my studies here. Although few and
far between, the conversations in the coffee room with my group members as well as those
with other PhD students here at Imperial (James Tebbutt, Joel Henry, Manikandan Ganapathy,
Marco Da Costa Alves, Xianyan Zhou and many others), had always lent the shared comfort
of being fellow travellers on the same journey. I am deeply touched by the gesture of Mei-
Chin, who prayed for me in the hours leading up to the thesis submission to give me strength
and endurance. I am thankful to her for being a good friend with whom I could share technical
as well as personal challenges. I would like to thank Abhilash, Ambuj, Anand, Arjun, Ashok,
Bharath, Bibin, Divya, Elvira, Hari, Jagadees, Karthik, Krishnan, Lakshmi, Manu, Manoj, Nagu,
PK, Praveen, Ram, Remya, Sakthi, Satya, Silby, Sita, Sreevisakh, Varsha, Vinay, Vivek, and
Xavier for the camaraderie and time-tested friendship, the fond memories of which motivated
me to carry on the battle, even in the bleakest of times.

   Last, but not the least, I would like to thank God Almighty — the universal driving force
well beyond any specific forms of personification — for enabling me to complete this doctorate
degree. Tathastu! (so let it be).
                                               7
Abstract
The realisation of Physics-Based Models (PBMs) of lithium ion cells in the Battery Man-
agement Systems (BMSs) of electric vehicles is studied through a three-pronged strategy —
analysis, design and implementation. The survey of literature undertaken in the backdrop
of this broad landscape reveals a dearth of model-based designs for automotive-grade pouch
cells, which is therefore addressed in this work. Perusal of prior art in reduced-order battery
modelling provides key guidance on topics meriting further investigation viz. the Discrete-
Time Realisation Algorithm (DRA) scheme and the electrolyte-enhanced Single Particle
Model (SPM) which are therefore carefully analysed here from the perspective of their
embedded implementation. Owing to its familiarity and wide-spread popularity among
relevant stakeholders, the Pseudo Two-Dimensional (P2D) implementation of the Doyle-
Fuller-Newman (DFN) model is used as the PBM underpinning all research presented herein.

   A computational framework to optimise the number of electrochemical layers within
a pouch cell is developed. The chosen optimality criterion specifically addresses the two
most pertinent issues that currently hinder the mass-market adoption of electric vehicles —
range anxiety and fast charging. Driven by the need for a balanced capacity loading at both
electrodes, a deterministic criterion for computation of electrode thicknesses is formulated.
The search space of layer choices across all thermal scenarios is traversed with the least
operation count through a novel application of the binary search algorithm. Numerical
simulations of a lumped thermal model coupled with the P2D electrochemical model in
conjunction with judiciously chosen exit conditions help to inform the number of layers
needed to maximise the cell’s usable capacity whilst simultaneously satisfying the power
requirements of fast charging. The P2D model is reformulated to accord it with the innate
ability to accept power inputs. The model-led optimal layer design procedure thus developed
is plating-aware, facilitating the extension of pack lifetimes whilst helping to bypass expensive
empirical prototyping.

                                               8
   Owing to its simplicity, the SPM family of models is deemed to be the most promising
Reduced Order Model (ROM) candidate that can usher in the use of PBMs in electric vehicles.
An in-depth analysis of the SPM reveals an inherent mismatch between the accuracies of
its voltage and State of Charge (SOC) predictions, thereby rendering it unsuitable as the
plant model in state-estimation tasks. A comprehensive evaluation of the salient electrolyte-
enhanced SPMs from literature reveals that most solutions are either mathematically
intractable or overly simplistic. For the ionic concentration in the electrolyte, analysis of
the quadratic approximation model, which straddles the boundary between computational
complexity and mathematical tractability, reveals a poor temporal performance particularly
at the current collector interfaces. However, it is capable of delivering acceptable levels
of accuracy in computing the spatial profile of ionic concentration. Application of the
Multi-Gene Genetic Programming (MGGP) technique exposes that the causal factor for this
mediocre temporal performance is the equation deficiency of the underlying P2D model.

   From an implementation perspective, the discrete-time formulation of SPMs is presented
using the matrix exponential approach and its advantages over its continuous-time coun-
terparts enumerated. Despite its inherent shortcomings, it is deemed that operating within
the confines of the well-established foundations of the P2D dynamics represents a definitive
step forward in bringing into fruition the goal of incorporating PBMs into vehicular BMSs.
Therefore, the existing quadratic approximation model is retained for the electrolyte spatial
concentration, whilst advocating the novel application of a system identification method for
its temporal dynamics. After establishing linearity and time-invariance of the subsystems
under consideration, discrete-time transfer functions of the number of moles per unit area of
lithium ions in each electrode region is identified for the pertinent range of applied currents.
The identified transfer functions are then employed in a composite SPM which demonstrates
superior accuracy compared to the incumbent state of the art electrolyte-enhanced SPM,
thereby demonstrating a substantial accomplishment from an implementation viewpoint.
Although the advancements herein are reported for an isothermal implementation of the
models, future enhancement through thermally coupled model derivations is advocated.
Finally, the importance of parametrisation of the underlying PBM is acknowledged as a
crucial unsolved aspect which needs the collective effort of the battery research community.




                                               9
                                                       Project Outputs
Research Articles
 [1] Ian D. Campbell, Krishnakumar Gopalakrishnan, Monica Marinescu, Marcello
     Torchio, Gregory J. Offer and Davide M. Raimondo. ‘Optimising lithium-ion cell design
     for plug-in hybrid and battery electric vehicles’. Journal of Energy Storage (Accepted)
     (Jan. 2019). The highlighted authors are joint first authors with equal contributions.

 [2] Krishnakumar Gopalakrishnan, Teng Zhang and Gregory J. Offer. ‘A Fast, Memory-
     Efficient Discrete-Time Realization Algorithm for Reduced-Order Li-Ion Battery
     Models’. Journal of Electrochemical Energy Conversion and Storage 14.1 (Feb. 2017),
     p. 011001. issn: 2381-6872. doi: 10.1115/1.4035526.

 [3] Andrea Pozzi, Gabriele Ciaramella, Krishnakumar Gopalakrishnan, Stefan Volkwein
     and Davide M. Raimondo. ‘Optimal Design of Experiment for Parameter Estimation of
     a Single Particle Model for Lithium-Ion Batteries’. 57th IEEE Conference on Decision and
     Control (CDC). Ed. by Amir G. Aghdam. Miami Beach, FL: IEEE, 2018, WeB22.2. url:
     https://cdc2018.ieeecss.org/.

 [4] Krishnakumar Gopalakrishnan and Gregory J. Offer. ‘An Electrolyte Enhanced Com-
     posite Single Particle Model using System Identification Techniques’. IEEE Transactions
     on Sustainable Energy (manuscript in preparation) (2018).


Conference Presentations
 [1] Ian D. Campbell, Krishnakumar Gopalakrishnan, Monica Marinescu, Marcello Torchio
     and Davide M. Raimondo. ‘Optimising Lithium-ion Cell Design for Plug-in Hybrid and
     Battery Electric Vehicles’. UK Energy Storage Conference (UKES). Newcastle, UK, 2018.
     Presented by Ian D. Campbell.

 [2] Ian D. Campbell, Krishnakumar Gopalakrishnan, Monica Marinescu, Marcello Torchio,
     Gregory J. Offer and Davide M. Raimondo. ‘Optimised Cell Layer Configurations
     via Modelling: Common Module Design for Electric Vehicle Platforms’. Catapult
     Energy Storage Conference 2017. Coventry, UK: WMG/JLR-Catapult, 2017. Presented
     by Ian D. Campbell.

 [3] Krishnakumar Gopalakrishnan, Teng Zhang and Gregory J. Offer. ‘A Fast, Efficient
     Discrete-Time Realization Algorithm for Reduced-order Battery Models’. 13th Sympo-
     sium On Modeling & Experimental Validation Of Fuel Cells, Batteries & Electrolysers.
     Lausanne: Swiss Federal Energy Office, 2016. url: https://modval13.epfl.ch/.

 [4] Krishnakumar Gopalakrishnan, Teng Zhang and Gregory J. Offer. ‘A Fast, Efficient
     Discrete-Time Realization Algorithm for Reduced-Order Battery Models’. Meeting
     Abstracts of the Electrochemical Society (ECS). Vol. MA2016-03. 2. The Electrochemical
     Society, June 2016, pp. 844–844. url: http : / / ma . ecsdl . org / content / MA2016 -
     03/2/844.short.                         10
                                                                    PROJECT OUTPUTS


 [5] Wasim Sarwar, Gregory J. Offer, Krishnakumar Gopalakrishnan and Nick Green.
     ‘Combined Battery/Supercapacitor Hybridised Energy Storage Systems for Hybrid
     Electric Vehicles’. Meeting Abstracts of the Electrochemical Society (ECS). Vol. MA2016-
     03. 2. Chicago, IL: The Electrochemical Society, June 2016, pp. 443–443. url: http:
     //ma.ecsdl.org/content/MA2016-03/2/443.short. Presented by Wasim Sarwar.


Posters
 [1] Krishnakumar Gopalakrishnan, Ian D. Campbell, Monica Marinescu, Marcello Tprchio,
     Gregory J. Offer and Davide M. Raimondo. ‘Optimising lithium-ion cell design for plug-
     in hybrid and battery electric vehicles’. 15th Symposium on Modeling and Validation
     of Electrochemical Energy Devices, ModVal 2018. Ed. by Erik J. Berg, Felix N. Büchi,
     Jens Eller and Lorenz Gubler. Aarau, Switzerland: Electrochemistry Laboratory, Paul
     Scherrer Institut PSI, Apr. 2018, p. 160. doi: 10.3929/ETHZ-B-000240521. Created by
     Ian D. Campbell and presented by Monica Marinescu.

 [2] Ian D. Campbell, Krishnakumar Gopalakrishnan, Monica Marinescu, Marcello Torchio,
     Gregory J. Offer and Davide M. Raimondo. ‘Optimising Li-ion Cell Layers Rapid Cell De-
     sign For EV Fast Charging’. Kraftwerk Batterie Advanced Battery Power Batterietagung
     2018. Münster, Germany: Haus Der Technik E.V., 2018. url: http://2018.battery-
     power.eu/en/. Created and presented by Ian D. Campbell.

 [3] Ian D. Campbell, Krishnakumar Gopalakrishnan, Yatish Patel and Gregory J. Offer.
     Reducing Li-ion Degradation with Applied Compression. Solihull, UK, 2017. url: https:
     //futurepowertrains.co.uk/2017/. Created and presented by Ian D. Campbell.

 [4] Wasim Sarwar, Gregory J. Offer, Krishnakumar Gopalakrishnan and Nick Green.
     ‘Combined Battery/Supercapacitor Hybridised Energy Storage Systems for Hybrid
     Electric Vehicles’. 18th International Meeting on Lithium Batteries (IMLB). Ed. by Doron
     Aurbach. Chicago, IL: The Electrochemical Society (ECS), June 2016. url: https://
     ecs. confex . com / ecs / imlb2016 / webprogram / Paper78263 . html. Created and
     presented by Wasim Sarwar.


Computer Software
 [1] Battery Optimal Layer Design (BOLD) toolbox (in MATLAB). Co-created by this thesis
     author along with Ian D. Campbell and Davide M. Raimondo. All three authors con-
     tributed equally to this toolbox. DOI: https://doi.org/10.5281/zenodo.1016405.
     MIT license. Downloadable from Github.
        https://github.com/ImperialCollegeESE/BOLD_Toolbox.

 [2] Finite volume codes (in Python) for numerical simulation of Pseudo Two-Dimensional
     (P2D) lithium ion battery model. Co-created by this thesis author and Ian D. Campbell
     with equal contributions from each developer. Available upon request.

                                            11
                                                                           Contents


Title Page                                                                                      1

Declaration of Originality and Copyright                                                        3

Dedication                                                                                      4

Acknowledgements                                                                                5

Abstract                                                                                        8

Project outputs                                                                                10

List of Figures                                                                                18

List of Tables                                                                                 21

List of Algorithms                                                                             23

List of Program Code                                                                           23

List of Acronyms                                                                               24

List of Symbols                                                                                27

1   Introduction                                                                               34
    1.1   Working Principle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
    1.2   Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37


                                               12
                                                                                      CONTENTS


          1.2.1   Equivalent Circuit Models . . . . . . . . . . . . . . . . . . . . . . . . . 38
          1.2.2   Physics-Based Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39
    1.3   The Doyle-Fuller-Newman model . . . . . . . . . . . . . . . . . . . . . . . . . 40

2   Review of Literature                                                                          44
    2.1   Model Based Design for Batteries: Overview of Prior Art . . . . . . . . . . . . 44
          2.1.1   Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
          2.1.2   State of the art in cell-scale model-led design optimisations . . . . . . 47
    2.2   Reduced Order Models: A New Classification Scheme . . . . . . . . . . . . . . 50
          2.2.1   Frequency domain ROMs . . . . . . . . . . . . . . . . . . . . . . . . . . 53
          2.2.2   Quasi-hybrid time/frequency domain ROMs . . . . . . . . . . . . . . . 54
          2.2.3   Hybrid ROMs based on equivalent circuits . . . . . . . . . . . . . . . . 58
          2.2.4   Time-domain ROMs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
          2.2.5   Classification of ROMs — Interim summary . . . . . . . . . . . . . . . 65
    2.3   Review of Literature on the Single Particle Model Family . . . . . . . . . . . . 68
          2.3.1   Overview of literature on conventional SPMs . . . . . . . . . . . . . . 68
          2.3.2   State of the art in electrolyte enhanced SPMs . . . . . . . . . . . . . . 69
          2.3.3   Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

3   Model-based Design of Pouch Cells                                                             81
    3.1   Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
    3.2   Energy/Power Trade-off in Pouch Cells by Layer Selection . . . . . . . . . . . 82
          3.2.1   Preliminary assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . 83
          3.2.2   Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
          3.2.3   Quantitative demonstration of energy/power trade-off . . . . . . . . . 88
    3.3   Scope and Context within xEV Powertrain . . . . . . . . . . . . . . . . . . . . 91
          3.3.1   System-level — vehicular platforms . . . . . . . . . . . . . . . . . . . . 91
          3.3.2   Pack-level — strings, modules & cells . . . . . . . . . . . . . . . . . . . 93
          3.3.3   Cell-level — layers, cooling, electrochemical & thermal models . . . . 94
    3.4   Enhancements/Modifications to Standard DFN Model . . . . . . . . . . . . . . 97

                                                 13
                                                                                    CONTENTS


        3.4.1   Augmentations to parameter set . . . . . . . . . . . . . . . . . . . . . . 97
        3.4.2   Modification of standard DFN model to handle power inputs . . . . . 103
        3.4.3   Hybrid spectral-FV scheme . . . . . . . . . . . . . . . . . . . . . . . . . 107
  3.5   Computational Framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
        3.5.1   Introduction and guidelines for flow diagram traversal . . . . . . . . . 110
        3.5.2   Acceleration pathway . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
        3.5.3   Fast-charging pathway . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
        3.5.4   Search algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
        3.5.5   Upper and lower bounds on search space . . . . . . . . . . . . . . . . . 119
        3.5.6   Electrode thickness ratio for capacity balancing . . . . . . . . . . . . . 120
        3.5.7   Computation of electrode thicknesses per layer . . . . . . . . . . . . . 121
        3.5.8   Computation of layer-dependent cell mass . . . . . . . . . . . . . . . . 123
        3.5.9   Computation of layer-dependent cell specific heat . . . . . . . . . . . . 124
  3.6   Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
        3.6.1   Modelling Platform and Preconditioning . . . . . . . . . . . . . . . . . 125
        3.6.2   xEV configurations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
        3.6.3   Acceleration studies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
        3.6.4   Fast-charging studies . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130
  3.7   Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134

4 Computational Analysis and Numerical Reformulation of the DRA                                136
  4.1   Analysis of the Computational Bottlenecks of the DRA . . . . . . . . . . . . . 138
        4.1.1   Size of the Block-Hankel Matrix . . . . . . . . . . . . . . . . . . . . . . 140
        4.1.2   Classical DRA — Memory (RAM) Requirements . . . . . . . . . . . . . 141
        4.1.3   Classical DRA — CPU Operation Count . . . . . . . . . . . . . . . . . 142
        4.1.4   Summary Effect of Computational Bottlenecks . . . . . . . . . . . . . 143
  4.2   Improved DRA for Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . 144
        4.2.1   Candidate Schemes for Block-Hankel SVD . . . . . . . . . . . . . . . . 144
        4.2.2   SVD Operation on a Virtual Block-Hankel Matrix . . . . . . . . . . . . 145

                                               14
                                                                                      CONTENTS


    4.3   Golyandina-Usevich Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . 146
    4.4   Customisations for Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . 147
    4.5   Simulation Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . 148

5   Performance Evaluation of State of the Art in Single Particle Modelling                     154
    5.1   SPM Model Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
          5.1.1   Geometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
          5.1.2   Scope and Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . . . 156
          5.1.3   Governing Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
    5.2   Numerical Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169
          5.2.1   Continuous-time Implementation . . . . . . . . . . . . . . . . . . . . . 169
          5.2.2   Conceptual Overview of Real-Time Processing . . . . . . . . . . . . . 171
          5.2.3   Sample Delay Considerations . . . . . . . . . . . . . . . . . . . . . . . 174
          5.2.4   Discrete-Time SPM Formulation . . . . . . . . . . . . . . . . . . . . . . 175
    5.3   Desktop Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178
          5.3.1   Cell Parametrisation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
          5.3.2   Simulation Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185
          5.3.3   Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193
    5.4   Quadratic Approximation of Ionic Spatial Concentration . . . . . . . . . . . . 201
          5.4.1   Model derivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 201
          5.4.2   Numerical implementation, simulation results and analysis . . . . . . 207
    5.5   Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210

6 Implementing a New Electrolyte Model for Augmentation of the Basic SPM 211
    6.1   Performance Analysis: Quadratic Approximation Model . . . . . . . . . . . . . 212
          6.1.1   Symbolic regression using Multi-Gene Genetic Programming . . . . . 213
    6.2   A New Electrolyte Model through System Identification . . . . . . . . . . . . . 216
          6.2.1   Scope and motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
          6.2.2   Selection of Methodology — Background and Rationale . . . . . . . . 218
    6.3   Brief Introduction to System Identification . . . . . . . . . . . . . . . . . . . . 219

                                                 15
                                                                                  CONTENTS


6.4   Overview of Black Box System Identification . . . . . . . . . . . . . . . . . . . 220
      6.4.1    Non-parametric methods . . . . . . . . . . . . . . . . . . . . . . . . . . 220
      6.4.2    Parametric methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
      6.4.3    Investigation of suitable system identification methodology . . . . . . 221
6.5   Introduction to Electrolyte Time-Evolution Subsystems . . . . . . . . . . . . . 223
6.6   Design of Persistent Excitations . . . . . . . . . . . . . . . . . . . . . . . . . . . 223
      6.6.1    Training current profile . . . . . . . . . . . . . . . . . . . . . . . . . . . 224
      6.6.2    Validation current profile . . . . . . . . . . . . . . . . . . . . . . . . . . 225
6.7   Investigation of Linearity and Time Invariance . . . . . . . . . . . . . . . . . . 228
      6.7.1    Time-invariance of the electrolyte time-evolution subsystems . . . . . 228
      6.7.2    Linearity analysis of the electrolyte time-evolution subsystems . . . . 230
6.8   Transfer Function Identification Procedure . . . . . . . . . . . . . . . . . . . . 234
      6.8.1    The transfer operator and its model form . . . . . . . . . . . . . . . . . 234
      6.8.2    Estimation of transport delay . . . . . . . . . . . . . . . . . . . . . . . 236
      6.8.3    Choice of model structure . . . . . . . . . . . . . . . . . . . . . . . . . 236
      6.8.4    Starting guesses for coefficient orders . . . . . . . . . . . . . . . . . . . 236
      6.8.5    Refinement of coefficient orders using deterministic criteria . . . . . . 239
      6.8.6    Final transfer function coefficients — Nonlinear optimisation . . . . . 241
      6.8.7    Numerical implementation of identified transfer functions . . . . . . . 244
6.9   Performance Analysis of System Id Model: Ionic Concentration . . . . . . . . 246
      6.9.1    Constant current inputs . . . . . . . . . . . . . . . . . . . . . . . . . . . 246
      6.9.2    Dynamic current inputs . . . . . . . . . . . . . . . . . . . . . . . . . . . 251
6.10 Composite SPM Model with Electrolyte Dynamics . . . . . . . . . . . . . . . . 255
      6.10.1   Computation of electrolyte overpotential . . . . . . . . . . . . . . . . . 255
      6.10.2 Terminal voltage computation of composite SPM . . . . . . . . . . . . 260
      6.10.3 Validation of composite SPM: Terminal voltage accuracy . . . . . . . . 262
6.11 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 266




                                             16
                                                                                    CONTENTS


7   Conclusions                                                                               268
    7.1   Physics-Based Models as a Design Tool . . . . . . . . . . . . . . . . . . . . . . 269
          7.1.1   Conclusions from the model-based design study . . . . . . . . . . . . . 269
          7.1.2   Future work informed by the optimal layer design framework . . . . . 270
    7.2   Analysis of Salient Physics-based Reduced Order Models . . . . . . . . . . . . 271
          7.2.1   Conclusions from analysis of the DRA-based state-space ROM . . . . 272
          7.2.2   Future outlook for the DRA-based hybrid state-space ROM . . . . . . 272
          7.2.3   Conclusions from analysis of the SPM family of models . . . . . . . . 273
          7.2.4   Proposed analysis routes for the SPM modelling family . . . . . . . . . 275
    7.3   Implementation Aspects of Basic and Composite SPM . . . . . . . . . . . . . . 276
    7.4   Closing Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 278

References                                                                                     279

Appendix A Full Listing of Program Codes                                                      298
    A.1   MATLAB codes for continuous-time SPM . . . . . . . . . . . . . . . . . . . . . 299
    A.2 MATLAB codes for discrete-time SPM . . . . . . . . . . . . . . . . . . . . . . . 302

Appendix B Permissions Summary                                                                 307
    B.1   Summary of Copyright Permissions . . . . . . . . . . . . . . . . . . . . . . . . 308
    B.2   Copyright Permissions for reuse of Figure 3.4 . . . . . . . . . . . . . . . . . . . 311
    B.3   Copyright Permissions for reuse of Figure 3.8 . . . . . . . . . . . . . . . . . . . 313
    B.4   Copyright Permissions for reuse of text, figures and tables of Chapter 4 . . . . 315
    B.5   Copyright Permissions for reuse of Figure 5.1 . . . . . . . . . . . . . . . . . . . 318
    B.6   Copyright Permissions for reuse of Figure 5.3 . . . . . . . . . . . . . . . . . . . 322
    B.7   Copyright Permissions for reuse of Figure 5.4 . . . . . . . . . . . . . . . . . . . 323
    B.8   Copyright Permissions for reuse of Figure 5.13 . . . . . . . . . . . . . . . . . . 324

Appendix C Colophon                                                                           329




                                                17
                                                            List of Figures


1.1   Illustration of a lithium ion unit cell . . . . . . . . . . . . . . . . . . . . . . . . 36


2.1   Electrolyte conc. (time-snapshots) along cell thickness for 1C discharge . . . .       71


3.1   Qualitative comparison of the construction of one layer of a high-energy cell
      versus a high-power cell . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87

3.2   Voltage curves for a 60 A galvanostatic discharge from 100 % SOC until cut-off
      voltage for a few layer choices in a pouch cell of fixed exterior height . . . . 89

3.3   Vehicle-to-cell hierarchical overview of an electrified powertrain architecture        92

3.4   Illustration of a cell-centred Finite Volume (FV) discretisation mesh . . . . . . 105

3.5   Schematic illustraing Chebyshev discretisation . . . . . . . . . . . . . . . . . . 109

3.6   Flow diagram of layer optimisation methodology . . . . . . . . . . . . . . . . 112

3.7   Stacking of layers within a pouch cell showing overhang of negative electrode 120

3.8   Two possible topologies for arranging the layers within a pouch cell . . . . . 122

3.9   Optimal cell layer configurations for the BEV for a range of fast charging
      powers and thermal conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . 131

3.10 Optimal cell layer configurations for the PHEV for a range of fast charging
     powers and thermal conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . 131

3.11 Nominal capacity and charge passed versus layer count for constant current
     and constant power charging . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133


4.1   ROM workflow using the classical DRA scheme . . . . . . . . . . . . . . . . . 140

                                            18
                                                                        LIST OF FIGURES


4.2   Markov parameters of solid surface concentration at positive current collector 141

4.3   ROM workflow using the improved DRA scheme . . . . . . . . . . . . . . . . 148

4.4   Singular values computed by conventional and improved SVD methods . . . . 149

4.5   Memory usage of classical and improved DRA . . . . . . . . . . . . . . . . . . 150

4.6   Computation times for classical and improved DRA schemes . . . . . . . . . . 150

4.7   Comparison of singular values computed by conventional and improved SVD
      methods under a practical RAM limit of 10 GB . . . . . . . . . . . . . . . . . . 151

4.8   Solid surface concentrations at positive electrode/separator interface . . . . . 152


5.1   Schematic illustration depicting geometrical origins of the SPM . . . . . . . . 156

5.2   Overview of real-time software implementation of a typical BMS . . . . . . . 173

5.3   Timing diagram of a real-time software loop of a BMS . . . . . . . . . . . . . . 174

5.4   Timeline of BMS activities over multiple CPU cycles of a real-time controller 175

5.5   Surface plot of electrolyte conductivity . . . . . . . . . . . . . . . . . . . . . . 187

5.6   Electrolyte conductivity versus concentration at various cell temperatures . . 188

5.7   Voltage response of SPM and P2D models for capacity validation . . . . . . . 192

5.8   Voltage responses of P2D and SPM to constant current discharge . . . . . . . 194

5.9   SOC computed by P2D and SPM models for constant current discharge . . . . 195

5.10 Voltage and SOC computed by P2D and SPM for 1C constant current charge . 197

5.11 The UDDS drivecycle profile . . . . . . . . . . . . . . . . . . . . . . . . . . . . 198

5.12 Simulation results of P2D and SPM models to UDDS current profile . . . . . . 200

5.13 Co-ordinate systems for quadratic approximation of electrolyte concentration 202

5.14 Spatial distribution of electrolyte concentration for 1C discharge . . . . . . . . 208

5.15 Ionic concentrations at current collector interfaces over time for 1C discharge 209


6.1   Input current profile used as the training set for system identification . . . . . 225

                                           19
                                                                         LIST OF FIGURES


6.2   Input current profile used as the validation set for system identification . . . . 226

6.3   Demonstration of time-invariance of 𝑄e,n (𝑡) and 𝑄e,p (𝑡) subsystems . . . . . . 230

6.4   Illustration of linearity test for the 𝑄̃e,n and 𝑄̃e,p subsystems . . . . . . . . . . 233

6.5   Bode plots of the electrolyte time-evolution sub-systems . . . . . . . . . . . . 238

6.6   𝑄̃e,n (𝑡) outputs from P2D and identified transfer function for training profile . 244

6.7   𝑄̃e,p (𝑡) outputs from P2D and identified transfer function for training profile . 245

6.8   Spatial distribution of ionic concentration in electrolyte for a 1C discharge
      computed by the P2D, quadratic approximation & system identification models 247

6.9   Time evolution of ionic concentrations at current collectors computed by
      P2D, quadratic approximation & system identification models for 1C discharge 249

6.10 Transient phase of ionic concentration evolution at the two current collectors
     computed by P2D, quadratic & system identification models for 1C discharge 250

6.11 Time evolution of ionic concentrations at current collectors for P2D, quadratic
     approximation & system identification models with a UDDS input profile . . 253

6.12 Zoomed view of ionic concentration at both current collectors computed by
     the P2D, quadratic & system identification models for the UDDS profile . . . 254

6.13 Contribution to electrolyte overpotential from the gradient-induced polarisa-
     tion term and the bulk solution resistance term for a 1C discharge . . . . . . . 258

6.14 Electrolyte overpotential computed by the P2D and system identification
     models for a 1C discharge . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 259

6.15 Electrolyte overpotential computed by the P2D and system identification
     models for a UDDS load profile . . . . . . . . . . . . . . . . . . . . . . . . . . . 260

6.16 Comparison of terminal voltages of composite SPM, basic SPM and the P2D
     model for a 1C discharge . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 263

6.17 Time evolution of ionic concentration computed by the P2D and system
     identification models at both current collectors for a 2C discharge . . . . . . 265

6.18 Terminal voltage output of — a) the P2D model, b) the basic SPM, and c) the
     composite SPM for a UDDS input profile . . . . . . . . . . . . . . . . . . . . . 267


                                            20
                                                               List of Tables


1.1   Governing equations and boundary conditions of the DFN model . . . . . . . 41


2.1   Interim summary of salient literature on various ROMs categories            . . . . . . 65

2.2   Summary of salient literature on electrolyte enhanced SPMs . . . . . . . . . . 77


3.1   Theoretical capacity & usable energy of a Li-ion cell for a few layer choices
      under a 60 A galvanostatic discharge . . . . . . . . . . . . . . . . . . . . . . . 90

3.2   System-level simulation conditions & thermal parameters of an LCO cell . . . 126

3.3   Acceleration test parameters (common across xEV platforms) . . . . . . . . . 127

3.4   Acceleration test parameters (specific to each xEV) . . . . . . . . . . . . . . . . 128

3.5   xEV acceleration test results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129


4.1   Parameters for Reduced Order Model (ROM) Computation . . . . . . . . . . . 149

4.2   Salient Results — Classical vs. Improved DRA         . . . . . . . . . . . . . . . . . . 153


5.1   Solid phase diffusion approximation methods . . . . . . . . . . . . . . . . . . . 161

5.2   Simulation parameters of an LCO cell . . . . . . . . . . . . . . . . . . . . . . . 181

5.3   Simulation data for capacity characterisation of P2D and SPM models . . . . . 191

5.4   Error-metrics summary of basic SPM for constant current discharge . . . . . . 196


                                             21
                                                                          LIST OF TABLES


5.5   Error-metrics summary of basic SPM for UDDS current profile . . . . . . . . . 199

5.6   Electrolyte equations & boundary conditions of DFN model in separator . . . 203


6.1   Transient & QSS expressions for electrolyte concentration obtained by MGGP 215

6.2   A sample of system identification results for 𝑄̃e,n . . . . . . . . . . . . . . . . . 242

6.3   Error statistics for 1C galvanostatic discharge comparing the quadratic &
      system identification models . . . . . . . . . . . . . . . . . . . . . . . . . . . . 251

6.4   Error statistics for UDDS current for quadratic & system-id models . . . . . . 253

6.5   Error statistics for the basic, quadratic approximation and composite SPMs
      for 1C galvanostatic discharge . . . . . . . . . . . . . . . . . . . . . . . . . . . 262

6.6   Error statistics for the basic, quadratic approximation and composite SPMs
      for a UDDS load profile . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 266


B.1   Summary of permissions for reuse of third-party copyrighted material . . . . 308




                                            22
                                                 List of Algorithms

5.1   Continuous-time SPM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172
5.2   Discrete-time SPM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
5.3   Quadratic approximation model for spatio-temporal electrolyte concentration 207




                                         List of Program Code

A.1   MATLAB code for simulation of continuous time SPM . . . . . . . . . . . . . 299

A.2   MATLAB code for simulation of discrete time SPM . . . . . . . . . . . . . . . 302




                                            23
                                              List of Acronyms

ADC     Analog to Digital Converter
AER     All-Electric Range
AIC     Akaike’s Information Criterion
ARMAX   Auto Regressive with Moving Average and Exogenous Inputs
ARX     Auto Regressive with Exogenous Inputs

BEV     Battery Electric Vehicle
BMS     Battery Management System
BOLD    Battery Optimal Layer Design

CAS     Computer Algebra System
CCCV    Constant Current Constant Voltage
CP      Constant Power
CPU     Central Processing Unit

DAC     Digital to Analog Converter
DAE     Differential Algebraic Equation
DFN     Doyle-Fuller-Newman
DFT     Discrete Fourier Transform
DMC     Dimethyl Carbonate
DRA     Discrete-Time Realisation Algorithm

EC      Ethylene Carbonate
ECM     Equivalent Circuit Model
EIS     Electrochemical Impedance Spectroscopy
EMC     Ethyl Methyl Carbonate
ERA     Eigensystem Realisation Algorithm
ETFE    Empirical Transfer Function Estimate
EUDC    Extra-Urban Driving Cycle




                                       24
                                                         List of Acronyms



FDM     Finite Difference Method
FFT     Fast Fourier Transform
FRF     Frequency Response Function
FV      Finite Volume

GITT    Galvanostatic Intermittent Titration Technique
GPM     Galerkin Projection Method

HWFET   Highway Fuel Economy Test

ICE     Internal Combustion Engine
IMA     Integral Method Approximation
ISR     Interrupt Service Routine
IV      Instrumental Variable
IVP     Initial Value Problem

LCO     Lithium Cobalt Oxide
LFP     Lithium Iron Phosphate
LHS     Left-Hand Side
LTI     Linear Time-Invariant

MAE     Mean Absolute Error
MDL     Rissanen’s Minimum Description Length
MGGP    Multi-Gene Genetic Programming
MIMO    Multi Input Multi Output
MPM     Markov Parameter Matrix

NEDC    New European Driving Cycle

OCP     Open Circuit Potential
OCV     Open Circuit Voltage
ODE     Ordinary Differential Equation
OE      Output Error
OLS     Ordinary Least Squares

P2D     Pseudo Two-Dimensional
PBM     Physics-Based Model




                                         25
                                                          List of Acronyms

PDAE   Partial Differential Algebraic System
PDE    Partial Differential Equation
PHEV   Plug-in Hybrid Electric Vehicle
PMSM   Permanent Magnet Synchronous Motor
PP2D   Polynomial Profile P2D
PRBS   Pseudorandom Binary Signal
PWL    Piecewise Linear

QSS    Quasi-Steady State

RAM    Random Access Memory
RBS    Random Binary Signal
RGS    Random Gaussian Signal
RHS    Right-Hand Side
RLS    Recursive Least Squares
RMS    Root Mean Square
ROM    Reduced Order Model

SEI    Solid-Electrolyte Interphase
SIMO   Single Input Multiple Output
SISO   Single Input Single Output
SNR    Signal to Noise Ratio
SOAP   State of Available Power
SOC    State of Charge
SoV    Separation of Variables
SPDT   Single Pole Double Throw
SPM    Single Particle Model
SSA    Singular Spectrum Analysis
SVD    Singular Value Decomposition

UDDS   Urban Dynamometer Driving Schedule

VOP    Variation of Parameters

xEV    Battery Electric/Plug-in Hybrid Electric Vehicle

ZOH    Zero Order Hold




                                         26
                                                                    List of Symbols


List of Latin Symbols

𝑎man.           Acceleration rate specified by the vehicle manufacturer             −2
                                                                                [m s ]

𝑎std.           Acceleration rate specified by a governing vehicular standard              −2
                                                                                       [m s ]

𝑎𝑠              Specific interfacial surface area of the electrode       2 −3
                                                                       [m m ]
𝑎⃗              Time-varying coefficient vector for the quadratic spatial approximation model of
                ionic concentration in electrolyte

𝐴, 𝐴cell                                                                                           2
                Overall electrochemically active cross-sectional surface area of all cell layers [m ]

𝐴refcell        Overall electrochemically active surface area of the reference cell         2
                                                                                          [m ]

𝐴elec           Active cross-sectional surface area per layer i.e., for a unit cell      2
                                                                                       [m ]
𝐴∈      ℝ 𝑛×𝑛   System matrix corresponding to ‘𝑛’ states following standard state-space notation

𝐴tabs           Area of the cell tabs     2
                                        [m ]

𝐴v              Frontal area of the (hybrid) electric vehicle        2
                                                                   [m ]
brugg           Bruggeman coefficient (empirical) to account for the tortuosity of a medium
𝐵∈     ℝ 𝑛×𝑚    Input matrix corresponding to ‘𝑛’ states and ‘𝑚’ inputs following standard state-
                space notation
𝑐𝜆              Specific heat capacity of each component 𝜆 ∈ {neg, sep, pos, Al, Cu, pouch, LiPF6}
                                     −1 −1
                in a pouch cell [J kg K ]

𝑐avg            Lumped (average) specific heat capacity of a pouch cell              −1 −1
                                                                                [J kg K ]

𝑐e              Concentration of   Li+   ions in the electrolyte         −3
                                                                   [mol m ]

𝑐e,0            Initial concentration of   Li +   ions in the electrolyte         −3
                                                                            [mol m ]

𝑐s              Concentration of   Li0   in the solid phase i.e., electrode         −3
                                                                              [mol m ]

                                                        27
                                                                                        List of Symbols


𝑐s̄             Bulk concentration of      Li 0   in the electrode         −3
                                                                     [mol m ]

𝑐s,max          Saturation concentration of the electrode                  −3
                                                                     [mol m ]

𝑐s,surf , 𝑐s,e Concentration of     Li0   at the electrode surface           −3
                                                                       [mol m ]
 ∗
𝑐s                                         0
                Surface concentration of Li i.e., same as 𝑐s,surf , 𝑐s,e , but specifically for the negative
                electrode in the layer optimisation framework for fast charging [mol m ]           −3

𝐶∈      ℝ 𝑝×𝑛   Output matrix corresponding to ‘𝑝’ outputs and ‘𝑛’ states following standard state-
                space notation
𝐶d              Coefficient of drag for the vehicle body
𝐶r              Coefficient of rolling resistance for the vehicle body

𝐷               Intrinsic ionic diffusivity of the electrolyte         2 −1
                                                                     [m s ]

𝐷eff            Effective ionic diffusivity of the electrolyte          2 −1
                                                                      [m s ]

𝐷s              Intrinsic diffusivity of the electrode material          2 −1
                                                                       [m s ]

𝐷s,eff          Effective diffusivity of the solid phase         2 −1
                                                               [m s ]

𝐷∈      ℝ 𝑝×𝑚   Output matrix corresponding to ‘𝑝’ outputs and ‘𝑚’ inputs following standard
                state-space notation
𝑒[𝑘]            White noise sequence assumed in system identification

𝐸a,𝐷s           Activation energy for solid phase diffusivity                −1
                                                                       [J mol ]

𝐸a,𝑘r           Activation energy for solid phase reaction rate coefficient             −1
                                                                                  [J mol ]

𝐹               Faraday constant          −1
                                    [C mol ]
𝐹1              Continuous time emulation frequency for formulating the DRA [Hz]

𝑔               Acceleration due to gravity             −2
                                                    [m s ]
𝐺𝑞              Generic transfer operator used in system identification to denote system dynamics

ℎ               Convective heat transfer coefficient              −2 −1
                                                              [W m K ]
𝐻               Generic notation for a Block-Hankel matrix
𝐻pouch          Pouch height [m]

𝐻𝑞              Generic transfer operator in system identification for disturbance dynamics

𝑖               Current density experienced by each electrochemical layer (unit cell)              −2
                                                                                               [A m ]
𝐼               Load current applied at the terminals of the cell (at time-step 𝑘) [A]

                                                         28
                                                                            List of Symbols


𝑗        Molar flux density at particle surface         −2 −1
                                                  [mol m s ]

𝑘r       Intrinsic reaction rate coefficient at the electrode surface     2.5 0.5
                                                                        [m mol s ]−1


𝑘r,eff   Effective reaction rate coefficient at the electrode surface     2.5 0.5
                                                                        [m mol s ]−1


𝑙𝜆       Thickness of a specific region 𝜆 of a unit cell, 𝜆 ∈ {neg, sep, pos, Al, Cu} [m]
𝑙ce      Sum of thicknesses of the negative and positive electrodes in each layer [m]
𝑙ratio   Ratio of thickness of negative electrode to that of positive electrode
𝑙tot     Combined thickness of negative electrode, separator and positive electrode [m]
𝐿(⋅)     Scalar loss function used in non-linear optimisation step of system identification
𝐿pouch   Exterior length of pouch used to accommodate a typical automotive-grade
         electrochemical cell [m]
𝐿stack   Combined thickness of all unit cells within a pouch [m]
𝑚𝜆       Mass of each constituent component 𝜆 ∈ {neg, sep, pos, Al, Cu, pouch, LiPF6} for
         all electrochemical layers within a pouch cell [kg]
𝑚cell    Cell mass, computed as ∑ 𝑚𝜆 [kg]
𝑀cells   Total mass of all cells in a battery pack [kg]
𝑀c       Mass of the chassis of a (hybrid) electric vehicle [kg]
𝑀o       Mass of pack overhead (without cells) [kg]
𝑀p       Payload mass for vehicular acceleration test [kg]

𝑀v       Total mass of the vehicle [kg]
𝑛        Number of layers i.e., electrochemical unit-cells within the cell’s pouch
𝑛𝑎       Number of feedback coefficients used in system identification
𝑛𝑏       Number of feedforward coefficients used in system identification
𝑛cells   Overall number of cells in the battery pack
𝑛c,𝜆     Number of coefficients for a suitable spatial approximation polynomial model of
           +
         Li ions in electrolyte for each of the cell regions 𝜆 ∈ {neg, sep, pos}
𝑛feas    An intermediate layer choice during iterative search that achieves success in
         satisfying acceleration/fast charging power requirements

𝑛 (𝑖)    Layer choice presently being trialled in an iterative search for the optimal value
𝑛𝑘       Number of transport delay samples used in system identification

                                            29
                                                                             List of Symbols


𝑛max        Upper bound for the search space for the optimal layer search algorithm
𝑛min        Lower bound for the search space for the optimal layer search algorithm
 acc
𝑛opt        Optimal number of layers that satisfies power demanded during acceleration
            without violating termination criteria
 fastchg
𝑛opt        Optimal number of layers that satisfies fast charging requirements without
            violating termination criteria
𝑛refcell    Number of layers (unit cells) within the chosen reference cell
𝑁           Number of samples collected for each Markov parameter
𝑁a          Number of FV discretisation nodes in the through-thickness (axial) direction
𝑁𝑟          Number of Chebyshev collocation nodes in the radial direction

𝑝                                                                                        −2
            Generic notation for power density experienced by each layer (unit cell) [W m ]
𝑃 acc       Power density experienced by each electrochemical layer (unit cell) during
                                   −2
            acceleration phase [W m ]

𝑃 fastchg   Power density experienced by each electrochemical layer (unit cell) during fast
                          −2
            charging [W m ]
 acc
𝑝cell       Power demanded at the terminals of each cell during the acceleration phase of a
            (hybrid) electric vehicle [W]
 fastchg
𝑝cell       Power applied at the cell terminals while fast charging a (hybrid) electric
            vehicle [W]
 acc
𝑃batt       Power demanded at the terminals of the battery pack during acceleration phase
            of a (hybrid) electric vehicle [W]
 fastchg
𝑃batt       Power applied at the terminals while fast charging the battery pack of a (hybrid)
            electric vehicle [W]
𝑃𝑘          Power applied to a discrete-time equivalent circuit cell model (at time-step 𝑘) [W]
𝑃drag       Power required to overcome air resistance to a vehicle’s motion [W]

𝑃grade      Power required to negotiate a road gradient [W]

𝑃mass       Power required to accelerate a vehicle’s mass from standstill [W]
𝑃roll       Power required to overcome rolling resistance to a vehicle’s motion [W]
𝑃w          Power experienced at the wheels of a (hybrid) electric vehicle [W]
𝑞𝜆̄         Volume averaged concentration flux i.e., the average change of concentration with
                                                                   −2 −1
            respect to the radial position 𝑟, 𝜆 ∈ {neg, pos} [mol m s ]

                                              30
                                                                                  List of Symbols


𝑄e,𝜆        Moles of   Li+
                         ions in the electrolyte for each of the cell regions 𝜆 ∈ {neg, sep, pos}
                                                 −2
            per unit cross-sectional area [mol m ]

𝑄̃e,𝜆       Debiased (by removal of initial value) moles of       +
                                                                Li ions in the electrolyte for each
                                                                                   −2
            of the cell regions 𝜆 ∈ {neg, pos} per unit cross-sectional area [mol m ]
𝑄𝑛          Theoretical capacity of a pouch cell with 𝑛 layers [Ah]
𝑄neg        Theoretical capacity of the negative electrode of a pouch cell with 𝑛 layers [Ah]

𝑄pol        Thermal power dissipated due to internal heat of polarisation [W]

𝑄pos        Theoretical capacity of the posative electrode of a pouch cell with 𝑛 layers [Ah]

𝑟           Radial dimension i.e., the continuous co-ordinate along the particle radius where
            solid phase concentration is to be computed [m]
Δ𝑟          Spacing between discretisation nodes in the radial direction within each
            particle [m]
𝑟̃          Radial dimension in the Chebyshev domain 𝑟 ̃ ∈ [−1, 1] [m]

𝑅           Universal gas constant         −1 −1
                                     [J mol K ]
𝑅0 , 𝑅eq    Effective series resistance of an equivalent circuit cell model (at time-step 𝑘) [Ω]

ℝ           Real co-ordinate space
𝑅𝑝          Representative particle radius of the solid phase as used in the model [m]

𝑡           Time [s]
𝑡f,man.     Manufacturer-specified acceleration time (from standstill to 𝑣f,man. ) [s]

𝑡f,std.     Acceleration time (from standstill to 𝑣f,std. ) as specified by a governing standard [s]

𝑡max        Time limit for fast charging (as per level 3 fast charging specifications) [s]
 0
𝑡+          Transference number of     Li +   ions in the electrolyte with respect to the solvent
𝑇 , 𝑇cell   Lumped cell temperature (at time-step 𝑘) [K]
𝑇sink       Coolant temperature used in tab-cooling of the cell [K]
𝑇init       Cell temperature at the beginning of acceleration/fast charging [K]
𝑇max        Maximum allowed cell temperature [K]
𝑇pouch      Thickness of the pouch material [m]

𝑇s          Discrete-Time model sample rate [s]


                                                   31
                                                                                     List of Symbols


u∈     ℝ 𝑚×1   Input vector with ‘𝑚’ inputs following standard state-space notation
𝒰              Open circuit potential of the electrode [V]
𝑣b , 𝑣base     Base speed of a (hybrid) electric vehicle i.e., the speed at which the drivetrain
               motor switches from the torque-limited region to power-limited region [m s ] −1

𝑣f,man.        Manufacturer-specified final speed to be achieved at the end of acceleration
                         −1
               phase [m s ]
𝑣f,std.        Final speed to be achieved at the end of acceleration phase as specified by a
                                      −1
               governing standard [m s ]
𝑉 , 𝑉cell      Terminal voltage of the cell (at time-step 𝑘). Also denoted by 𝑣𝑘 [V]
𝑉max           Upper cut-off voltage of the cell [V]
𝑉min           Lower cut-off voltage of the cell [V]
𝑊pouch         Exterior width of pouch used to accommodate a typical automotive-grade electro-
               chemical cell [m]
𝑥              Axial dimension i.e., the continuous co-ordinate along the through-thickness
               direction of the cell [m]
Δ𝑥             Spacing between nodes in the axial (through-thickness) direction [m]

x∈     ℝ 𝑛×1   State vector with ‘𝑛’ states following standard state-space notation

ẋ ∈   ℝ n×1   Time derivative of the state vector x i.e.,   𝑑x   in a state-space formulation
                                                             𝑑𝑡

y∈     ℝ 𝑝×1   Output vector with ‘𝑝’ outputs following standard state-space notation
𝑧              State of Charge of the cell
𝑧 ∗            Target State of Charge for fast charging
𝑧max           Upper cut-off for the State of Charge of the cell
𝑧min           Lower cut-off for the State of Charge of the cell
ℤ              Set of integers
𝑍              Road gradient for acceleration tests of a (hybrid) electric vehicle is performed

List of Greek Symbols

𝛼              Charge transfer coefficient at the surface of an electrode
𝜀              Electrode porosity i.e., volume fraction of electrolyte phase within the electrode
𝜀fi            Filler/binder volume fraction

                                                  32
                                                                              List of Symbols


𝜀s         Solid phase volume fraction
𝜂          Electrode overpotential [V]
𝜂dt        Overall lumped efficiency of the drivetrain components (excluding battery pack)
           of a (hybrid) electric vehicle

𝜅          Intrinsic ionic conductivity of the electrolyte       −1
                                                             [S m ]

𝜅eff       Effective ionic conductivity of the electrolyte       −1
                                                             [S m ]

𝜔c         Corner frequency in a frequency response function             −1
                                                                   [rad s ]
Ω          Control volume in a standard finite-volume discretisation scheme
𝜙e         Electric potential in the electrolyte phase [V]
𝜙s         Electric potential of the electrode [V]
𝜌𝜆         Density of each constituent component 𝜆 ∈ {neg, sep, pos, Al, Cu, pouch, LiPF6} of
                         −3
           the cell [kg m ]

𝜌air       Air density at acceleration test conditions        −3
                                                         [kg m ]

𝜎          Intrinsic electronic conductivity of the electrode       −1
                                                                [S m ]

𝜎eff       Effective electronic conductivity of the electrode       −1
                                                                [S m ]
Σ          Matrix of singular values
𝜃          Surface stoichiometry of an electrode
𝜃0%        Surface stoichiometry of the given electrode that corresponds to 0 % State of
           Charge of the cell
𝜃100%      Surface stoichiometry of the given electrode that corresponds to 100 % State of
           Charge of the cell

Other Generic Nomenclature

neg        Denotes the negative electrode region. Alternatively, a subscripted ‘𝑛’ is also used.
sep        Denotes the separator region. Alternatively, a subscripted ‘𝑠’ is also used.
pos        Denotes the positive electrode region. Alternatively, a subscripted ‘𝑝’ is also used.
neg/sep    Denotes the negative electrode/separator interface
sep/pos    Denotes the positive electrode/separator interface
neg/Cucc Denotes the negative electrode/Copper current collector interface
pos/Alcc   Denotes the positive electrode/Aluminium current collector interface

                                              33
                                                                 Introduction
                                                                                   1
   1.1   Working Principle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

   1.2   Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

         1.2.1   Equivalent Circuit Models . . . . . . . . . . . . . . . . . . . . . . . . . 38

         1.2.2   Physics-Based Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

   1.3   The Doyle-Fuller-Newman model . . . . . . . . . . . . . . . . . . . . . . . . . 40




T
    ightening emissions regulations in various industrial sectors have led to a renewed
    interest in sustainable energy sources in recent years. In particular, the burgeoning
demand for clean energy has prompted the automotive and consumer electronics industries
to explore advanced methods of energy storage [1]. Li-ion batteries are seen as key enablers
in this quest due to the attractiveness of their high energy and power densities compared to
other competing non-conventional energy storage technologies [2]. However, with this surge
in energy storage demands comes stricter requirements for their longevity, performance,
and adhesion to safety requirements, particularly for adoption in mainstream transport
electrification [3]. In contrast to other incumbent technologies, lithium-ion batteries have


                                              34
                                                                          1.1 Working Principle


several advantages such as high energy density, long life-cycles, low internal resistance,
low self-discharge, long cycle life, fast charge and discharge cycles [4, 5]. This makes them
the preferred choice for storage and on-demand retrieval of energy in modern consumer
electronics and Battery Electric/Plug-in Hybrid Electric Vehicles (xEVs).


1.1      Working Principle
This section provides a brief overview of the essential chemistry principles that helps to
describe the working principle of a lithium ion battery and represents the author’s digested
summary of the introductory concepts presented in Plett [5].

      Figure 1.1 depicts the construction of one electrochemical layer of a lithium ion unit cell.
The positive electrode consists of porous particles of Lithium-Transition Metal Oxide (MO)
compounds. The negative electrode typically employs some variant of microporous graphite.
The porous nature of the electrodes provide pathways for lithium ion conduction through the
electrolyte. Due to the special construction of the electrode structure, there exist interstitial
sites which act as intercalation spots for lithium shuttling between the two electrodes. The
                                                                 +
electrolyte, which floods the cell, helps in the conduction of Li ions. The separator membrane
allows the passage of these ions between the two electrodes, but prevents internal short-circuit
by inhibiting electronic conduction through it. The current collectors facilitate passage of
electrons generated during the charge transfer at particle surface to the external circuit.

      At the fully charged condition, the majority of lithium in the system is stored within
the negative electrode microstructure. During discharge,         Li 0   atoms diffuse out of deep
interstitial sites towards the surface of the particles in the negative electrode. At the surface
(electrode-electrolyte interface), a charge-transfer process takes place according to Butler-
                                                               +
Volmer kinetics (see eq. (1.7)), leading to the formation of Li ions and electrons. The electrons
are passed to the external circuit through the Cu current collectors onto which the conductive
                                                                                +
matrix composed of the negative electrode material and binders is coated. The Li ions travel
through the electrolyte phase, crossing the separator membrane to the positive electrode
where they encounter an electron influx from the external circuit. A charge transfer reaction
takes place at the surface of the positive electrode particles, leading to the formation of neutral
Li0   atoms that diffuse into the positive electrode microstructure.


                                                35
                                                                                                                 1.1 Working Principle


                                Pos. Electrode                                                  Neg. Electrode




                                                                                                                                  Neg. Curr. Collector
Pos. Curr. Collector




                                                                   Separator
                       lAl                lpos                     lsep                                  lneg                  lCu




                                          …
                                                                                                                                 x
                                                                                                             …
                             Figure 1.1   Schematic depicting the basic construction of a lithium ion unit cell.


                       During the charging process, the reverse phenomena occur. Lithium is de-intercalated
   from the positive electrode and a similar charge-transfer happens at the surface, leading to the
                  +
   formation of Li ions which reach the negative electrode by passing through the separator. At
   the surface of the negative electrode particles, these ions absorb electrons from the external
   circuit, leading to the formation of neutral                                Li 0   that diffuses into interior vacant spaces in
   the layered graphite electrode. Equations (1.1) and (1.2) summarise the reactions during the
   charging and discharging process at the surfaces of both electrode materials.

                                                               Li𝑥C
                                                                                    discharge
                                                                                                C+   𝑥 Li+   +   𝑥e –             (1.1)
                                                                                      charge


                                          Li1–𝑥MO2 +   𝑥 Li+   +   𝑥e –             discharge
                                                                                                LiMO2                             (1.2)
                                                                                      charge




   where M represents a transition metal compound such as Ni1/3Co1/3Mn1/3 (NMC),
   Ni0.8Co0.15Al0.05 (NCA) amongst other choices [4]. Assuming no loss of cycleable lithium
   due to parasitic side reactions or through other mechanisms, the process is fully reversible.

                       The electrochemical potential at each electrode is dependent upon the extent of its
   lithiation. An empirical relationship of each electrode’s potential as a function of its
   stoichiometry can be obtained, and is dependent upon the specific design and material


                                                                               36
                                                                       1.2 Battery Modelling


properties of each active material under consideration. Finally, the Open Circuit Voltage
(OCV) of the cell is obtained by subtracting the negative electrode potential from its positive
electrode counterpart.


1.2    Battery Modelling
Through accurate model representations of the electrochemical-thermal behaviour of the cell,
advanced monitoring and control strategies can be deployed to tackle the current research
topics in Li-ion batteries such as increasing cycle-life, improving operational safety and
performance [5]. Over the past two decades, efforts have been made to construct models
to describe the physical, electrical, thermal, electrochemical and system-level performance
of Li-ion cells, leading to modelling strategies with various levels of sophistication. For the
interested reader, the article by Grazioli et al. [6] provides a broad introduction to the topic
of computational modelling of lithium ion batteries. Large in-roads into the depth of the
modelling art can be made by perusing comprehensive books on this topic such as those by
Plett [5], Hariharan [7], and Rahn and Wang [8].

   The need to address the operational challenges of lithium ion batteries in an embedded
environment such as on-board an electric vehicle has led to an increased impetus on the
development of advanced Battery Management Systems (BMSs) [9]. In vehicular applications,
the only measurable quantities of a lithium ion cell are its terminal voltage, current and
temperature. This implies that several internal states of the cell such as its State of Charge
(SOC), whose real-time computation is vital to the optimal performance of the cell, need to be
estimated from these available measurements. Therefore, the performance of a BMS for tasks
such as online state estimation is dependent upon the fidelity of the underlying cell model.
Sophisticated models of the cell enable these quantities to be estimated more accurately and
facilitate the implementation of advanced control algorithms. Therefore, it is imperative that
the cell model used is suitable for being embedded in a real-time BMS.

   Most battery models have the primary goal of accurately predicting the cell’s terminal
voltage at each time-step. This is so that the output from the predictor routine can be
compared to the measured voltage and the difference between them may be used in a suitable
corrector routine to improve future predictions. The combined information from the model
and measurement is then blended in a suitable way to estimate the cell’s SOC.

                                              37
                                                                       1.2 Battery Modelling


   More advanced models strive to provide insight into various other physico-chemical
quantities that could affect the cell’s health. The field of Li-ion battery modelling can
be classified into two broad categories — i) empirical/ad hoc Equivalent Circuit Models
(ECMs), and ii) detailed Physics-Based Models (PBMs) that are based upon first principles.
A comprehensive summary of various models that belong to each of the two categories is
discussed in Seaman et al. [10]. A characteristic aspect that contrasts them is the fact that
they are typically at loggerheads with each other in terms of their computational complexity.


1.2.1    Equivalent Circuit Models

ECMs employ circuit elements such as voltage sources, resistors and capacitors to model the
behaviour of batteries at their electrical terminals. The cell’s thermal subsystem may also
be modelled by an analogous electrical circuit. The parameters of the circuit are typically
functions of the cell’s current, SOC and temperature. These can be incorporated as a lookup
table by curve-fitting the model to experimental data. Using such equivalent circuit models,
two simple methods are available to compute the cell’s SOC — a) by using manufacturer-
supplied lookup table or graph of OCV versus SOC, and b) by numerically integrating the
charge passed in and out of the cell over time (commonly referred to as coulomb counting).
Both methods are computationally amenable for small-scale embedded applications such as
consumer electronics; however, neither one is robust enough to handle the stringent demands
in performance imposed by modern vehicular applications.

   Advanced state estimation algorithms such as nonlinear Kalman filters may still be able
to use ECMs as the plant model and obtain reasonable estimates of the cell’s SOC [11, 12].
However, the usefulness of ECMs is limited by the fact that their parameters are derived
essentially by a curve-fitting process using a standard set of training data. Since these models
are not based on any physical phenomena, their ability to predict the cell’s general behaviour
is extremely poor especially when subject to current profiles well outside their training realm.
Another important disadvantage of equivalent circuit models is that they do not allow insights
into the various internal states of the cell.

   ECMs of lithium ion batteries have been extensively studied and are widely applied.
However, the aforementioned difficulties render their reliability and accuracy questionable,
especially under highly demanding load profiles experienced by the battery packs in xEVs.

                                                38
                                                                       1.2 Battery Modelling


The boundaries of their performance have been well-quantified (see [5, 13]). Although
various estimation and control algorithms continue to be developed around them, the ECMs
themselves are no longer the subject of extensive research. Hence, this thesis does not discuss
them further.


1.2.2    Physics-Based Models

Physics-Based Models (PBMs) consist of governing equations that construct a realisation
of the behaviour of the cell based upon electrochemical principles such as equilibrium
thermodynamics, material diffusion and reaction kinetics. The fundamental advantage to this
modelling approach is that it is possible to compute the evolution of internal states of the cell
such as the concentration of lithium in the two electrodes during its operation with arbitrary
current profiles. Precise knowledge of such internal states e.g. the concentration of lithium
at the electrode surfaces, can help to design control strategies to prevent degradation due to
lithium plating. The difficulty with the physics-based modelling approach lies with obtaining
the values of all the physical, geometric, electrochemical, thermal and kinetic parameters of
the cell. Usually, these parameters are closely guarded trade secrets by cell manufacturers.

   In some cases, it may be possible to obtain a subset of these physical parameters by
dissecting cells in an inert environment followed by further characterisation using specialised
lab equipment. For instance, Ecker et al. [14] demonstrate the reverse-engineering of a 7.5 Ah
pouch cell by Kokam Ltd. in order to obtain its physical parameters. Nevertheless, this
is a tedious process and is feasible only with access to such sophisticated lab equipment.
Furthermore, the results from these experiments are susceptible to characterisation errors as
well as to cell-to-cell variations due to production spread. Therefore, some form of system
identification method needs to be employed for estimating the majority of the physical
parameters required for a PBM. Furthermore, it is a common practice to rely on published
data for the values of certain cell parameters that do not depend on physical construction,
especially for those that remain universally true for a particular Li-ion chemistry.

   The challenges involved in model parametrisation is a research exercise of its own merit
and is not addressed in this thesis. Once the model parameters are available, PBMs can be
used in aiding a deeper understanding of the working of the cell and in answering research
questions that could otherwise not be answered with simple ECMs. One area of focus of this

                                               39
                                                     1.3 The Doyle-Fuller-Newman model


thesis is to broach a less-probed area — exploring the possibility of using a PBM for the design
of pouch cells used in automotive applications which shall be presented in chapter 3.

    A major disadvantage of PBMs from an implementation point of view is that solving
for the model’s field variables is time-consuming. In particular, the more sophisticated
PBMs require the use of multi-physics Partial Differential Equation (PDE) solvers and hence
are not typically suitable for embedded applications. Nevertheless, for high performance
applications such as in automotive BMSs wherein state-of-health monitoring is crucial, there
is an overwhelming demand for obtaining insight into internal cell variables. For instance, the
real-time computation of surface concentration of     Li 0   in the solid particles enable the BMS
to regulate power flow into and out of the cell to proactively avoid plating and degradation
of the cell.

    In view of this consideration, model order reduction techniques are seen as key enablers
that facilitate in porting the first-principles based predictive powers of PBMs into a real-time
microcontroller. This thesis shall therefore have a strong focus on both the analysis and
implementation aspects of Reduced Order Models (ROMs).


1.3     The Doyle-Fuller-Newman model
Doyle, Fuller and Newman [15, 16] developed an isothermal physics-based porous electrode
model of the cell capable of describing its internal variables such as a) potential on the solid
particles 𝜙s , b) potential in the electrolyte solution 𝜙e , c) concentration of   Li 0   in the solid
particles 𝑐s , d) ionic concentration in the electrolyte solution 𝑐e , and e) molar flux density
of lithium at the solid-electrolyte boundary 𝑗. The most popular computational implement-
ation of the Doyle-Fuller-Newman (DFN) equations is the Pseudo Two-Dimensional (P2D)
model [5]. In the P2D implementation, all field variables of the DFN model are computed at
each spatial location along the axial thickness of the cell. However, the solid concentration
in spherical electrode particles is solved in a radial co-ordinate system that is perpendicular
to the axial direction of the cell’s thickness. The axial and radial dimensions are coupled at
each particle’s surface through the molar flux density describing the rate of pore-wall flux
that crosses from solid into electrolyte or vice-versa. The equations and boundary conditions
for the P2D implementation of the DFN model is shown in table 1.1.


                                               40
                                                                                                                                              1.3 The Doyle-Fuller-Newman model

    Table 1.1 Governing equations and boundary conditions of the Doyle-Fuller-Newman (DFN)
    model cast in its Pseudo Two-Dimensional (P2D) description. Apart from those equations whose
    sources are explicitly indicated with inline references, all equations of the DFN model presented
    herein are obtained from the lecture notes by Plett [17], suitably cast in their P2D formulation.
    To maintain comptability with computer codes from the simulation tool LIONSIMBA [18], the
    electrolyte potential at the positive electrode/current collector interface is set to zero (second
    boundary condition in eq. (1.5)) i.e., chosen as the ground reference. The notation of symbols has
    been suitably adapted from the cited sources and is detailed in List of Symbols (see page 27).

 Region                                                                                       Governing equations                                                   Boundary conditions
                                                                               𝜕𝑐s𝜆 𝐷s𝜆 𝜕 2 𝜕𝑐s𝜆                                                                     𝜕𝑐s𝜆 |            𝜕𝑐s𝜆 |   −𝑗𝜆
                                                                                   = 2    (𝑟     )                                                                        | = 0,            | =        (1.3)
                                                                                𝜕𝑡   𝑟 𝜕𝑟    𝜕𝑟                                                                       𝜕𝑟 |𝑟=0           𝜕𝑟 |𝑟=𝑅 𝐷s𝜆
                                                                                                                                                                                                 p𝜆



                                                                                𝜕𝑐e    𝜕        𝜕𝑐e                                                                   𝜕𝑐e |            𝜕𝑐e |
  All regions, 𝜇 ∈ {neg, sep, pos}
                                     Electrodes only, 𝜆 ∈ {neg, pos}




                                                                             𝜀𝜇     =                         0
                                                                                         (𝐷eff𝜇     ) + (1 − 𝑡+ )𝑎s𝜆 𝑗𝜆                                                   || = 0,          || = 0      (1.4)
                                                                                𝜕𝑡    𝜕𝑥        𝜕𝑥                                                                    𝜕𝑥 𝑥=0           𝜕𝑥 𝑥=𝑙tot

                                                                                        𝜕        𝜕𝜙e     𝜕        2𝑅𝑇 (𝑡) 0       𝜕 ln 𝑐e                             𝜕𝜙e |
                                                                           −𝑎s𝜆 𝐹 𝑗𝜆 =    (𝜅eff𝜇     )+    (𝜅eff𝜇        (𝑡+ − 1)         )                               | = 0,        𝜙e || = 0      (1.5)
                                                                                       𝜕𝑥        𝜕𝑥     𝜕𝑥          𝐹               𝜕𝑥                                𝜕𝑥 |𝑥=0              𝑥=𝑙tot


                                                                                         𝜕        𝜕𝜙s𝜆                                                               𝜕𝜙s𝜆 |          𝜕𝜙s𝜆 |    −𝐼
                                                                             𝑎s𝜆 𝐹 𝑗𝜆 =    (𝜎eff𝜆      )                                                                  | = 0,          | =          (1.6)
                                                                                        𝜕𝑥         𝜕𝑥                                                                 𝜕𝑥 |𝑥=𝑥neg/sep 𝜕𝑥 |𝑥=0 𝜎eff𝜆 𝐴
                                                                                                                                                                          𝑥=𝑥sep/pos       𝑥=𝑥tot


                                                                                                                                            0.5𝐹
                                                                                 𝑗𝜆 = 2𝑘r,eff𝜆 √𝑐e (𝑐s,max𝜆   − 𝑐s,surf𝜆 ) 𝑐s,surf𝜆 sinh (        𝜂𝜆 )                                                 (1.7)
                                                                                                                                           𝑅𝑇 (𝑡)

• 𝑐e ≔ 𝑐e (𝑥, 𝑡), 𝜙e ≔ 𝜙e (𝑥, 𝑡)                                                                        { 𝑥 ∈ [0, 𝑙tot ], (𝑥 = 0) ≙ neg/Cucc, (𝑥 = 𝑙tot ) ≙ pos/Alcc }

𝜆 ∈ {neg, pos}
• 𝑐s𝜆                                                         ≔ 𝑐s𝜆 (𝑟, 𝑡), 𝑐s,surf𝜆 ≔ 𝑐s𝜆 (𝑟 = 𝑅p , 𝑡)                       { 𝑟 ∈ [0, 𝑅p ], (𝑟 = 0) ≙ center, (𝑟 = 𝑅p ) ≙ surface }
                                                                                                                      𝜆                           𝜆                                          𝜆


• 𝜙s𝜆 ≔ 𝜙s𝜆 (𝑥𝜆 , 𝑡), 𝑗𝜆 ≔ 𝑗𝜆 (𝑥𝜆 , 𝑡)                                                                             { 𝑥𝜆 ⊂ 𝑥, 𝑥neg ∈ [0, 𝑙pos ], 𝑥pos ∈ [𝑙pos+neg , 𝑙tot ] }

• 𝜂𝜆                                                          ≔ 𝜂𝜆 (𝑥, 𝑡) = 𝜙s𝜆 (𝑥, 𝑡) − 𝜙e (𝑥, 𝑡) − 𝒰𝜆 (𝑐s,surf𝜆 )
                                                                                                     −𝐸a,𝐷                                             −𝐸a,𝑘
                                                                                                             s𝜆       1     1                                  r𝜆       1     1
                                                                                                                         −
                                                                                                                  ( 𝑇 (𝑡) 𝑇 )                                              −
                                                                                                                                                                    ( 𝑇 (𝑡) 𝑇 )
• 𝜎eff𝜆 = 𝜎𝜆 𝜀s𝜆 , 𝐷s,eff𝜆 = 𝐷s𝜆 𝑒                                                                      𝑅                  sink   , 𝑘r,eff𝜆 = 𝑘r𝜆 𝑒       𝑅                  sink   ⋯⋯(Torchio et al. [18])

𝜇 ∈ {neg, sep, pos}
                                                                           brugg𝜇
• 𝐷eff𝜇 =                                                                𝐷𝜀𝜇
                                                                                                                       54                             −3 𝑐 (𝑥,𝑡)
                                                                                         −4          −4.43− 𝑇 (𝑡)−229−5×10−3 𝑐               −0.22×10     e
•𝐷                                                                 ≔ 𝐷(𝑐e ,𝑇 ) =      10      × 10                                 e   (𝑥,𝑡)                        ⋯⋯⋯⋯⋯⋯⋯(Torchio et al. [18])
                                                                            brugg𝜇
• 𝜅eff𝜇 =                                                                 𝜅𝜀𝜇
•𝜅                                                                     ≔ 𝜅(𝑐e ,𝑇 ) = 10−4 ×𝑐e (𝑥,𝑡)(−10.5+0.668×10−3 𝑐e (𝑥,𝑡)+0.494×10−6 𝑐e2 (𝑥,𝑡)+(0.074−1.78×10−5 𝑐e (𝑥,𝑡)
                                                                                                                                                                             2
                                                                                      −8.86×10−10 𝑐e2 (𝑥,𝑡))𝑇 (𝑡)+(−6.96×10−5 +2.8×10−8 𝑐e (𝑥,𝑡))𝑇 2 (𝑡)) ⋯⋯⋯⋯(Torchio et al. [18])


                                                                                                                                   41
                                                     1.3 The Doyle-Fuller-Newman model


   In this thesis, this P2D implementation of the DFN model is considered as the reference
(and only) PBM. Although thermal dependence of parameters such as electrolyte conductivity
and diffusivity is shown in table 1.1, a sophisticated description of detailed thermal dynamics
i.e., a description of spatio-temporal evolution of cell’s temperature using a set of ordinary/-
partial differential equations is not considered in this work. Secondly, the SOC-dependence
of parameters is not incorporated, but the studies conducted here may be suitably extended
to include this dependence in the future.

   For those aspects of this thesis dealing with the analysis and implementation of various
ROMs and the improvements imparted herein to them, only an isothermal implementation
(at 298.15 K) of the P2D equations is considered. The performance of the various ROMs are
compared against this reference benchmark. In consideration of the relative sparsity of such
detailed analysis of ROMs in existing literature (see chapter 2), the author of this thesis
considers that such an analysis, albeit isothermal, is the need of the hour and is imperative
to gain a deeper understanding of the performance boundaries of various popular ROMs.

   Since temperature plays a crucial role in the operation of cells and battery packs in
xEVs, an isothermal model is unsuitable for design purposes. A model-based design that
does not consider thermal effects is likely to stray far from the operating regimen and
fail spectacularly. On the other hand, including a sophisticated thermally coupled model
is unlikely to yield significant gains. Firstly, running fully coupled electrochemical-thermal
model based simulations over the entire design space is computationally expensive. Secondly,
the design results of the model have to be verified using a reasonable number of experimental
prototypes. Taking into account these considerations it is deemed that, for the design aspect of
this thesis, a lumped thermal model suffices. This simplified thermal model is bidirectionally
coupled to the P2D equations (see table 1.1) of the electrochemical model and is used as the
PBM underpinning the model-based design discussed in chapter 3.

   The rest of the thesis is organised as follows. Chapter 2 presents an overview of pertinent
modelling art. The literature on model-based design shall be evaluated here and the present
shortcomings identified. The survey of literature also considers the advancements in the
field of reduced order modelling from their analysis and implementation perspectives. A
computational framework for optimising the number of layers within an automotive pouch
cell is presented in chapter 3. In chapter 4, the computational bottlenecks in a specific ROM

                                              42
                                                     1.3 The Doyle-Fuller-Newman model


method viz. the Discrete-Time Realisation Algorithm (DRA) is analysed in detail and an
improved alternative is proposed. In Chapter 5, the simplest time-domain PBM, the Single
Particle Model (SPM) is introduced and its performance is analysed. Salient advancements
made to the basic SPM in the literature are presented and their shortcomings analysed. A
discrete-time formulation focusing on the numerical implementation aspects is also presented.
In chapter 6, the causal factor for the lacklustre performance of a state of the art electrolyte-
enhanced SPM is unearthed. Additionally, chapter 6 proposes a new electrolyte model
which represents a novel application of the system identification technique. The superior
performance of this electrolyte-enhanced composite SPM is demonstrated. Finally, chapter 7
highlights the salient conclusions that can be drawn from the findings presented in this thesis
and paves the way for future research by identifying key unsolved tasks in physics-based
battery modelling for such automotive applications.




                                               43
                                               Review of Literature
                                                                                    2
   2.1     Model Based Design for Batteries: Overview of Prior Art . . . . . . . . . . . . 44

   2.2     Reduced Order Models: A New Classification Scheme . . . . . . . . . . . . . . 50

   2.3     Review of Literature on the Single Particle Model Family . . . . . . . . . . . . 68



T
      his chapter discusses the state of the art in the field of lithium ion battery modelling
      pertinent to the research sub-topics discussed in this thesis. The modelling art is therefore
presented in three parts, each providing a critical review of

   a) the body of literature discussing model-based design of lithium ion cells.
   b) prior works dealing with the analysis and implementation aspects of reduced order
        modelling of lithium ion cells, whose revelations lead to a focus on
   c) publications discussing the Single Particle Model (SPM) and its variants.

2.1      Model Based Design for Batteries: Overview of Prior Art

2.1.1     Introduction

In sharp contrast to the cornucopia of published literature dealing with reduced order
modelling of cells (see section 2.2), there is currently a relative paucity of prior art that
discusses model-based cell design. Albeit the relevant pool of knowledge is presently sparse,
this section nevertheless aims to critically evaluate it.

                                                44
                           2.1 Model Based Design for Batteries: Overview of Prior Art


   At the outset, it is important to clarify this thesis author’s general views on model-based
design. It is also important to state why this topic was chosen as an aspect of this thesis.
In the recent decades, industries pertaining to different walks of life, cutting across any
one discipline, have begun to establish a model-led product/process development culture.
For instance, a broad overview of industrial research policy by Thomke [19] towards the
turn of the last millennium provides quantifiable evidence that a simulation based design
approach in the automotive industry has had a positive impact in the crash-worthiness
of resulting vehicular designs. At a high level, the salient benefits of any model-based
design include — a) reducing the number of design iterations thereby speeding up the
time to a production-ready prototype, and b) facilitating improved understanding of the
variables influencing design that is gained by formalising empirical/ad hoc knowledge
through modelling. Furthermore, it is a well-known fact that computer time is cheaper than
human time. Therefore, with a simulation-oriented design approach, it is often cheaper to
explore Monte Carlo-like design scenarios using a computer model than iterating over a
series of rudimentary prototypes in the lab. Finally, once the results predicted by the model
have stabilised enough to satisfy the design specifications, prototypes closely matching the
final design objectives can be realised, thereby reducing the overall lead time to the market.

   The aforementioned views of the thesis author is echoed by Becker et al. [20] who present
a persuasive view that, since it shall be mandatory to have a deeper understanding of the
simulation tools in order to successfully employ a model-led design, this can trigger sweeping
changes percolating into the very core of the problem-solving culture in an organisation.
Although relatively at its infancy when it comes to cell design, model-based designs have
been applied at the battery pack-level in the past, and is therefore not a newcomer to the
battery industry in general. In the middle of the last decade, a clarion call for industry to adopt
simulation tools in battery engineering was issued by Spotnitz [21]. In the said article, the
author questioned the anachronistic industry trend of relying heavily on ‘making and testing’
rather than aiming to understand the fundamental governing equations and principles of a
battery and using this know-how for design. Spotnitz further argues that using Physics-Based
Models (PBMs) of batteries could provide reliable understanding of their behaviour and that,
as the understanding of the community steadily grows, it could bring about a significant
speed-up of battery development.



                                                45
                           2.1 Model Based Design for Batteries: Overview of Prior Art


   The nature and scope of ‘model-based design’ as intended by this thesis author needs to
be clarified. Since this thesis focuses exclusively on physics-based modelling, the term ‘model’
as used here pertains to Physics-Based Models (PBMs) and not to Equivalent Circuit Models
(ECMs) or any other type of battery models including other empirical/ad hoc models such as
surrogate models. Therefore, the survey of literature here does not include any prior efforts
on model-based design that lie outside of this scope.

   Among the published set of literature, there is evidence that computational modelling
has been successfully used to facilitate the development of novel energy storage materials.
The review article by Islam and Fisher [22] provides an overview of the use of computer
simulation to gain a deeper insight into the working of new types of cathode materials. Meng
and Arroyo-de Domp [23] also surveyed the topic of using computational tools for the design
and optimisation of energy storage materials. The computer models referred to in these
review articles are not volume-averaged models operating at the cell-level, but detailed ab-
initio models constructed using techniques such as Density Functional Theory (DFT). While
it is heartening to see such comprehensive studies of computational techniques being applied
to energy storage, there are two distinct reasons why the body of research reviewed in the
aforementioned articles do not align with the goals of this thesis. Firstly, in the works reviewed
in the aforementioned articles, computer simulation is used primarily to enhance researchers’
current understanding of these materials that can help to develop the next generation of
energy storage components. The computational methods presented therein are not directly
employed as design tools. Secondly, these articles use computational modelling to study
structural properties at the meso and nano scales. While these are of utmost importance
to researchers involved in synthesising prototypes of next generation of energy storage
materials, they are less relevant for production-ready cell-designs at scale. Since this thesis
has a strong focus on providing readily applicable solutions to industry for incumbent lithium
ion chemistries, it was decided not to pursue the methods discussed in the aforementioned
works for the design studies discussed herein.

   A holistic computational screening was performed by Sendek et al. [24] to study the
suitability of 12831 candidate materials for their suitability as solid state electrolytes in
electrochemical cells. These authors cite the same rationale of this thesis author i.e., rapid
prototyping, as the motivation behind their model-based design simulations. The study helped
to prune the initial candidate pool down to just 21 viable family structures. This effort serves
                                               46
                           2.1 Model Based Design for Batteries: Overview of Prior Art


as a concrete example in this literature survey wherein computer simulation is directly used
as a design tool for components of a lithium ion cell. The scope of the aforesaid work falls
into the realm of material synthesis and applied physics — topics outside the educational
background and expertise of this thesis author. Nevertheless, the success of this effort strongly
motivates the case for performing a computational study of similar scale, wherein instead
of screening out thousands of candidate materials, the framework presented in chapter 3
computationally screens out thousands of layer configurations within a pouch cell.

   Curiously, the use of volume-averaged models for design simulations of PBMs at the
cell-scale has not yet gained sufficient traction. This is despite the prevalence of the popular
Pseudo Two-Dimensional (P2D) implementation of the Doyle-Fuller-Newman (DFN) model
in areas such as degradation analysis and state-estimation. Ramadesigan et al. [25] postulate
that this slow uptake could be attributed to the computational challenges presented by the
complex reaction, diffusion and kinetics of lithium ion cells occurring over different length
and time scales. A few design efforts using electrochemical models at the cell scale have
nevertheless been reported in literature, which are examined next in section 2.1.2.


2.1.2    State of the art in cell-scale model-led design optimisations

The pioneering work by Newman [26] was the first of its kind to develop a scheme to
optimise cell design based on an electrochemical model. The two parameters optimised were
electrode thicknesses and porosities. The aforesaid study makes the assumption that electrode
kinetics are fast relative to diffusion, and furthermore ignores local concentration gradients.
A reaction-zone model, which considers that reactions occur in a narrowly confined area,
was used as the underlying model. The separator thickness was assumed to be fixed and the
specific energy of the cell was maximised. However, the aforesaid work does not impose any
constraints on the extent of specific power that can be drawn from the cell. Nevertheless, this
seminal effort provided the key guidance to other researchers that electrode thicknesses and
porosities can be considered as the critical design variables to be optimised for in a cell design.
Building upon the foundation laid by the aforementioned study, a few other model-led design
efforts have been published. However, in order to provide a focused review, only a subset of
the prior art that is deemed pertinent for the model-based design of pouch cells for automotive
applications is considered here.


                                                47
                           2.1 Model Based Design for Batteries: Overview of Prior Art


   Arora et al. [27] used an electrochemical model to inform design decisions on cell
parameters such as particle size, electrode thickness and mass ratio. Furthermore, the model
thus obtained was used to optimise the cell design against the risk of lithium plating. Cells are
susceptible to plating during fast charging and hence, this is a key aspect to consider in their
design for electric vehicles. This thesis author considers this contribution to be a vanguard
in model-based design for cells that is potentially applicable for vehicular applications.
Nevertheless, the aspect of stacking layers inside pouch cells and how this influences the
optimisation of the aforementioned design variables has not been studied.

   Xue et al. [28] presented a simulation based design study wherein a cell design was
optimised using a gradient-based algorithm. Specifically, the said work dealt with a numerical
framework for providing automated design outputs for maximising the cell’s energy density
whilst meeting specific power density requirements. This criterion appears to be highly
relevant in the context of cell design for electric vehicles and hence, was adopted as the basis
for the layer optimisation framework presented in chapter 3. In the aforementioned work,
various power levels were also tried. However, these power requirements were computed
indirectly rather than a direct reformulation of the P2D model to accept power density inputs.

   The design study by Xue et al. [29] represents a rare example of a model-led design attempt
performed in the backdrop of electrified transportation. In the said work, an electrochemical
cell model viz. the P2D model was successfully adapted to perform the design optimisation of
a Plug-in Hybrid Electric Vehicle (PHEV). Although the underlying model operates at the cell-
scale, this study considers a pack-level optimisation through a series-parallel combination of
cells. Furthermore, an advanced numerical algorithm in the form of a hybrid solver was used.
This solver adopted a unique scheme of employing a gradient-free optimiser in conjunction
with a gradient-based optimiser. Albeit a standout example in the context of vehicular
application, the aforesaid work falls slightly outside the scope of this thesis wherein the
design study is strictly confined to be at the cell level.

   The article by Xue et al. [29] does take into account pack-level constraints such as safety
limits as well as energy and power levels. Furthermore, these authors even accounted for
important details such as the presence of layers within each cell in their design optimisation
process. The system-level constraints considered in Xue et al. [29] were instrumental in
informing the choice of constraints in the design study presented in chapter 3. However, in

                                                48
                          2.1 Model Based Design for Batteries: Overview of Prior Art


the aforementioned article, the translation from pack-level into cell-level quantities does not
account for secondary effects i.e., the influence of layers on pack mass (a quantity that is
optimised in the said publication) is not studied. Simulations conducted as part of the work
reported in chapter 3 reveals that such effects are non-negligible.

   A critical issue in the approach by Xue et al. [29] is that the number of design variables
were excessively large which necessitated the use of complex numerical algorithms. The said
work assumes that cell design shall be an integral part of pack optimisation. However, in real-
world designs, cells are sourced from a specialised manufacturer. Furthermore, these cells are
designed independently to merely adhere to certain specifications [30]. Pack configuration
decisions such as the choice of number of series-parallel modules in the vehicular pack are
undertaken at a system level in conjunction with the rest of the drivetrain specifications by
vehicle manufacturers. This natural separation paradigm helps to decouple the cell design
from the pack design thereby drastically reducing the number of degrees of freedom and
simplifying the optimisation task. This is a key assumption in the design optimisation study
presented in chapter 3.

   A comprehensive multi-objective optimisation for optimal design of batteries was recently
proposed by Changhong Liu and Lin Liu [31]. This optimisation involved a multiphysics model
of the cell wherein a number of design variables such as electrode thicknesses, porosities
and particle sizes were considered. The optimisation objectives were to maximise the specific
power and specific energy during discharge as well as to minimise capacity loss. The model
was solved by using a genetic algorithm. While this contribution is certainly the first of its
kind to use a formal mathematical optimisation framework for cell design, in the opinion of
this thesis author, the complexity of the problem is excessively high — both mathematically
and computationally. For instance, with three design variables considered, it requires a careful
interpretation of the resulting pareto front to distinguish their relative importance. While
prima facie this is not an issue, the question of resolving the pareto front for cells with
different parameter sets needs to be addressed. The optimisation algorithm used is an exotic
genetic algorithm to be run on a parallel cluster. From a near-term industrial application
viewpoint, this scheme is less attractive since real-world constraints such as supply-chain
dictated raw-material sourcing typically restrict the number of degrees of freedom available
for optimisation. Nevertheless, this scheme is valuable from a long-term research perspective
and merits attention from researchers interested in model-based design.
                                              49
                               2.2 Reduced Order Models: A New Classification Scheme


   From the body of the relevant literature surveyed here, it is clear that the issue of optimally
stacking up layers within a pouch cell has not been dealt with in a systematic manner. Pouch
cells are the most common type of cells in automotive applications. Therefore, optimising
their design shall yield a beneficial improvement to the overall driving range and fast charging
capability of electric vehicles while simultaneously helping to increase the lifetime of their
battery packs. With these goals in mind, chapter 3 presents a mathematical framework for a
model-based optimal design of pouch cells.


2.2    Reduced Order Models: A New Classification Scheme
Battery modellers face the classic conundrum of conjuring PBMs that remain amenable for
control applications. The prior attempts made by the research community to tackle this
challenge is examined here. The term ‘control-oriented model’ can be considered synonymous
with the term Reduced Order Model (ROM). This is due to the fact that the complexity of
PBMs inherently necessitates the use of some order reduction strategy for their adoption in
control and real-time applications. In this thesis as well as in the relevant literature discussed
here, these two terms have been used interchangeably.

   Research into ROMs is motivated by the pressing need for a real-time model with accuracy
properties of full-order PBMs but possessing the computational simplicity of ECMs (see
sections 1.2.1–1.2.2 for an overview). A number of approaches to reduce the computational
complexity of PBMs have been explored in literature. Jokar et al. [32] provide a comprehensive
review of the various categories of reduced order PBMs for lithium ion batteries. However,
the aforesaid work does not aim to classify models based on time-vs-frequency domains.
Fan et al. [33] conducted a review of reduced order modelling methods, but only provide a
generic overview of deriving and implementing models in these dual domains without an
expository analysis of the implications of these modelling choices. Unlike Jokar et al. [32], the
review by Fan et al. did not aim to provide a classification of various reduced order models, but
instead emphasises on a broad survey of relevant methodologies and tools towards obtaining
them. Hence, neither of these works provide an insight into the rubrics and implications
of the choice of either of these domains to underpin the ROMs. Although in principle, the
transformation between them is often a straightforward mathematical exercise, availability
of models for final implementation in the time domain aids immediate uptake by industry for


                                               50
                              2.2 Reduced Order Models: A New Classification Scheme


adoption in online Battery Management Systems (BMSs). The treatment of ROMs from this
aspect is so germane to the central hypothesis of this thesis (a simple time domain model is
the key to large scale deployment of PBMs), that the author of this thesis feels compelled to
undertake a simpler classification exercise of the existing modelling art, within the context
of their suitability for online implementation.

   In this discussion, various modelling methodologies and their resultant models are viewed
as a single continuum. Consequently this thesis discusses them from such a unified perspect-
ive without microscopic separation of the final models from their progenitor mathematical
methods. Furthermore, there is also a need to highlight the salient works among the more
recent advances and extensions to the then prevailing models to obtain an updated view
of the modelling art that have gained traction since the publication of Jokar et al. [32] and
Fan et al. [33]. Hence, the specialised review of reduced order modelling literature covered in
this section intends to supplement, not supplant, the breadth of research covered between the
aforesaid works. In particular, care has been taken to minimise repetition of background art
already analysed in these aforementioned review articles, thereby striving to report the subset
of prior research that is pertinent to illustrate the new classification scheme introduced here.
The author does not aim to adhere to a chronological presentation of such background works.
Instead, salient ROM families are introduced in the context of discussion of their significance
within a particular mathematical modelling technique.

   In the views of this thesis author, physics-based control-oriented models can be classified
as belonging to one of the following categories

    • Frequency domain ROMs

    • Quasi-hybrid time/frequency domain ROMs

    • Hybrid ROMs based on equivalent circuits

    • Time-domain ROMs

   A common characteristic of all control-oriented models is that their ultimate goal is to
lower the computational burden of the pertinent physical quantities during operation of
the cell. However upon a closer study, a few contrasting aspects that set them apart become


                                              51
                              2.2 Reduced Order Models: A New Classification Scheme


apparent. Understanding the behavioural differences that stem from their lineage is the motive
behind distinguishing between those models that are derived directly in the time domain
versus those that are derived first in the frequency domain, but later converted to time domain.

   The classical modus operandi in frequency domain modelling is to transform the under-
lying physical equations into the Laplace space (the complex S plane) followed by a Padé
approximation to reduce the number of coefficients in the resulting transfer functions. This
category of models is briefly evaluated in section 2.2.1. At the other end of the spectrum
are the time-domain ROMs which typically adopt the strategy of either a) simplifying
the computational mesh used, b) capturing only the salient dynamics of the cell which
leads to a smaller parameter set, and/or c) a combination of the two. The state of the art
in these models is studied in section 2.2.4. An overlapping continuum of mathematical
techniques is encountered in the literature discussing the wide assortment of ROMs spanning
the intervening space between these extrema. The classification presented here reflects
their broad approach to model reduction. For instance, equivalent circuits have only a few
parameters and are an attractive option from an implementation perspective. In recent years,
there has been an up trend in published efforts employing mathematical methods to generate
physics-based equivalent circuits, the salient among which are discussed in section 2.2.3.
Finally, there exist Quasi-hybrid ROMs which do not necessarily seek to formulate equivalent
circuits, but rather strive to arrive at time domain reduced order state-space realisations by
proceeding through a series of mathematical transformations starting from the frequency
domain. In these models, order reduction is typically achieved through a reduction in the
number of states and not directly through a reduction in the number of parameters. These
methods typically employ both time-domain and frequency-domain aspects of control theory,
such as Markov parameters and the Ho-Kalman algorithm. An evaluation of the salient quasi-
hybrid ROMs from literature is presented in section 2.2.2.

   In principle, any modelling method that yields a time domain mathematical description of
physical phenomena that is lower in computational complexity by some arbitrary magnitude
than the original DFN model can be considered as a candidate for further investigation. In
the absence of a canonical or quantitative definition of what constitutes a ROM, the number
of candidate family of models to consider is overwhelmingly large. In practice, the constraint
imposed by the scope of this work i.e., suitability for real-time implementation, limits the


                                              52
                              2.2 Reduced Order Models: A New Classification Scheme


choice of candidate modelling families. For instance, models relying primarily on classical
finite difference [34], Galerkin’s approximation [35] or Galerkin’s projection [36, 37] methods
for transformation and order reduction of one or more field variables of the DFN model are
excluded from further study. This is done in view of the impracticability of implementing
such models in a resource-constrained environment such as an embedded BMS controller.


2.2.1   Frequency domain ROMs

Owing to the low entry-barrier for adoption in a real-time controller that typically logs
data samples at specific time intervals, this thesis prioritises those models that are cast in
a mathematical form directly suitable for final implementation in the time domain. This
choice implies the exclusion of those models that are derived and implemented entirely in
the frequency domain. For the sake of readers interested in frequency domain methods,
the discussion here briefly introduces salient literature employing the Padé approximation
method that serves as a backbone of a wide variety of frequency domain models. “A Padé
approximant is the ‘best’ approximation of a function by a rational function of given order
— under this technique, the approximant’s power series agrees with the power series of the
function it is approximating” [38].

   The transfer function oriented Padé approximation method for low order physics-based
battery modelling pioneered by Forman et al. [39] has gained widespread adoption in the
areas of cell design [40], charge-trajectory optimisation [41], controller design [42] and state
estimation [40, 43]. Although Prasad and Rahn [44] present an online identification of a subset
of ageing parameters using a Padé model and the Recursive Least Squares (RLS) algorithm,
specific implementation details such as the transformation of the Padé reduced impedance
to discrete-time difference equations were not provided. Padé models are typically limited to
offline applications owing to the aggressive trade-offs required in its approximation order so
as to maintain high accuracies. Those models truncated to very low Padé order exhibit poor
fidelity and perform no better than classical ECMs, although recent research attempts have
focused to mitigate this drawback [45, 46].




                                              53
                                2.2 Reduced Order Models: A New Classification Scheme


2.2.2    Quasi-hybrid time/frequency domain ROMs

Smith et al. [47] pioneered a semi-hybrid approach to reduced order modelling and obtained
closed form expressions for all electrochemical field variables in the frequency domain except
for those describing electrolyte concentration and potential (which were solved separately
using the classical finite difference discretisation method). To the author’s knowledge, this
is the earliest published instance wherein all the dynamics of the full order model were
completely retained in the frequency domain. This was facilitated through the use of
transcendental transfer functions that helped to avoid the accuracy degradation brought
about by truncation techniques such as Padé approximation. In the first stage of the model
derivation detailed in the said article, a composite impedance model for the frequency range
of interest from 0–10 Hz was obtained. This was then converted to a 12th order state space
model using the technique of residue grouping and truncation, thereby demonstrating the
first instance of the so-called hybrid modelling workflow. The ROM derived in Smith et al. [47]
was capable of predicting the cell’s terminal voltage within 1 % of the full-order DFN model.

   The modelling effort by Smith et al. [47] also has the unique distinction of being the first
of its kind to render a PBM suitable for implementation in the classical Linear Time-Invariant
(LTI) state-space formulation
                                              ẋ = 𝐴 x + 𝐵 u
                                                                                                     (2.1)
                                              y = 𝐶 x + 𝐷 u,


where x ∈    𝑛×1
            ℝ ,    𝐴∈    𝑛×𝑛
                        ℝ ,    𝐵∈   ℝ 𝑛×𝑚 ,   y∈    𝑝×1
                                                   ℝ ,    𝐶∈    𝑝×𝑛
                                                               ℝ ,    𝐷∈   ℝ 𝑝×𝑚   and u ∈   ℝ 𝑚×1



that is amenable for controller design and for further system-level simulation studies e.g. as
a component in the energy storage subsystem of a (hybrid) electric vehicle drivetrain.

   The requirement of a relatively large number of state variables (12 in this case) for
describing the system’s dynamics dilutes the effectiveness of state estimation algorithms.
In the classical isothermal implementation of this ROM, with the cell’s terminal voltage
being the only measured quantity, the observability of the model degrades significantly.
Although Smith et al. performed an observability analysis of the model in a noise-free context,
the presence of process noise (via unmodelled electrochemical phenomena and parameter


                                                    54
                               2.2 Reduced Order Models: A New Classification Scheme


uncertainties) coupled with corruption of measurement values through sensor noise in a
harsh electrical environment such as in a vehicle’s drivetrain, makes this model unattractive
for state estimation tasks in such embedded applications.

   Several attempts have been undertaken to improve and extend the ideas pioneered in
Smith et al. For instance, Lee et al. [48] addressed a critical missing aspect viz. the derivation
of transcendental transfer functions for both the electrolyte concentration and its potential.
These transfer functions were obtained by using a Sturm-Liouville approach by retaining
the first five modes of an eigenfunction expansion procedure which is detailed in [48, 49].
To the author’s best knowledge, this is the first published work wherein all electrochemical
field variables of the DFN model were considered for inclusion in a deterministic model order
reduction procedure whilst keeping the derivation entirely in the frequency domain.

   Obtaining closed form expressions for the electrochemical variables achieved in
Smith et al. (for all quantities other than electrolyte transfer functions) and Lee et al.
(all quantities including electrolyte transfer functions) also has an important computational
implication. With these capstone derivations serving to complete the model description in
the frequency domain, all electrochemical variables of the DFN model could now be solved
independently at any desired spatial location, in particular at certain crucial locations such
as the interface of each electrode with the respective current collector or separator. This
ground breaking idea sharply contrasted with the then prevalent state of the art in reduced
order modelling. For the simplification of the original Partial Differential Algebraic System
(PDAE) of equations in table 1.1, most order reduction approaches (excluding the SPM that
shall be discussed later) invariably required the solution of all electrochemical quantities at
multiple node locations along the thickness of the cell, thereby adding to the computational
burden. This was a significant deterrent to the adoption of such ROMs, particularly if the
intended purpose of the model is to simply predict the cell’s terminal voltage or serve as the
plant model in State of Charge (SOC) estimation applications.

   In the same publications [48, 49], Lee et al. also devised the Discrete-Time Realisation
Algorithm (DRA), a novel scheme to systematically transform all transcendental transfer
functions to the time domain so as to obtain an LTI state-space model given by eq. (2.1). The
DRA method retains the physical character of the original DFN equations until the very last



                                               55
                              2.2 Reduced Order Models: A New Classification Scheme


step wherein the matrices governing the system’s dynamics are generated. This yields a one-
dimensional discrete-time ROM of the cell that is entirely based upon fundamental physical
principles. The ROM thus obtained could then be used to compute the time-evolution of all
the internal electrochemical quantities of the DFN model. As an illustrative application of the
method, Lee et al. [48] performed a simulation study of a) the reaction flux density, b) surface
concentration of Li, c) ionic concentration of   Li +   in the electrolyte, d) potential in electrolyte,
and e) potential in solid in the anode and cathode at the respective domain boundaries and
demonstrated their high accuracies relative to a benchmark DFN model. In Lee et al. [48, 49],
the cell voltage was computed through linear combinations of these time-domain variables
with suitable non-linear corrections. Yet another advantage of this model order reduction
process is that the method does not involve any form of non-linear optimisation that is typical
of other order reduction schemes that attempt a top-down approach of simplifying the PBM
equations. In particular, the DRA scheme provides a deterministic method for selection of
the order of the simplified model, which is a pioneering contribution in the field of reduced
order modelling of Li-ion cells.

   The author of this thesis considers the formulation of the DRA to be a breakthrough
contribution that has helped in bringing physics-informed time domain models a step closer
to online implementation without having to resort to forming a lumped impedance and then
truncating it suitably. This seminal work is a first of its kind that is amenable to implementing
real-time controls for an entire cell without relying upon such empirical and ad hoc modelling
constructs. In a subsequent paper by the same lead author [50], this approach was then
extended to a wider range of operating conditions spanning various choices of initial SOCs,
temperature and C-rates. Although the final state space model thus obtained is simple to
implement, the classical DRA scheme suffers from significant computational bottlenecks in
forming the required block-Hankel matrices during the model-derivation phase.

   In both the original as well as the improved DRA, the eigenfunction modal expansion
of electrolyte concentration transfer function is computationally intensive. A slightly less
detrimental disadvantage with the series of transcendental transfer functions associated
with the electrolyte concentration was that their derivation entailed mathematically cum-
bersome symbolic manipulations that dictated the need of a capable Computer Algebra
System (CAS). Although from a standalone viewpoint this requirement does not seem to
be critical, the Ho-Kalman algorithm that forms a core component of the DRA scheme is
                                                 56
                              2.2 Reduced Order Models: A New Classification Scheme


steeped in numerical linear algebra routines. Furthermore, for facilitating state estimator and
controller designs, it is convenient to implement the resultant state-space model in a classical
numerical computation environment such as MATLAB. Taking these into consideration,
Rodriguez et al. [51] introduced a simplified computation of the electrolyte concentration
transfer function by applying the Variation of Parameters (VOP) scheme. With this final
improvement, the hybrid ROM implementation originally envisaged by Lee et al. can
be considered feature-complete with low computational requirements during both model
derivation and implementation phases.

   A key drawback of the transcendental transfer function approach is the requirement for
linearisation at a specific SOC. This implies that the entries in the matrices of the state space
model depends on the linearisation point. In all published works employing this approach,
these transfer functions were obtained by linearising the P2D equations of the DFN model
(see table 1.1), typically at an operating point of 50 % SOC. The linearisation requirement
renders the model usable only in a narrow range of SOCs. Furthermore, this adversely affects
the usability of the model for state estimation tasks, wherein the SOC is in fact an unknown
quantity and is to be estimated.

   In order to extend the model’s range of validity, Lee et al. [50] had used a simple model-
blending approach by interpolating between several linear models pre-computed at different
SOC and temperature combinations. To guarantee robustness during change-over, a naive
approach is to incorporate a large number of break-points in the look-up table. Since the
model is intended for online operation, this would entail significant requirements of both
operating memory and non-volatile storage. An alternative approach is to implement a fairly
coarse break-point table with a sophisticated changeover mechanism. However, this demands
careful tuning of the blending parameters and gain values, an in-depth treatment of which
has not been provided in Lee et al. [50]. Furthermore, employing these interpolated matrices—
whose entries are obtained from pre-computed matrices at various SOCs and temperature–for
state-estimation creates a subtle cyclic loop. The stability of this internal feedback loop thus
introduced has not been analysed in literature. This renders the idea of state-estimation using
such run-time interpolated models questionable.

   The author of this thesis hypothesises that any perceivable drawbacks such as non-
smooth changes in SOC estimates arising from using blended matrices could be potentially

                                               57
                               2.2 Reduced Order Models: A New Classification Scheme


mitigated by using smoothing filters and other ad hoc mathematical apparatus. However,
there exists no published work that discusses these engineering aspects or on how to actually
implement them in BMSs. Coupled with the absence of a theoretical analysis of loop stability,
these models are deemed as not being suitable for immediate adoption by industry, at least
until these aforementioned gaps have been addressed satisfactorily. The non-linear state
variable model presented by Guo et al. [52] aims to address this issue through a ROM in the
frequency domain by eliminating the linearisation phase from the workflow. However, the
online solution of its field variables entails a complex prediction-refinement procedure, loosely
defined as implicit and explicit solution methods, for each subsystem of the DFN model. The
formulation of the final model is not clearly illustrated and in the views of this author, is not
easily comprehensible. In the absence of actual source code, a numerical example or pseudo-
code of the model reduction workflow could have immensely helped with the reproducibility
of the results claimed in the aforesaid publication.

   In summary, the concept of quasi-hybrid ROMs is certainly promising, although more
work is required to address the present gaps, most prominently the need to linearise their
equations at certain operating points.


2.2.3    Hybrid ROMs based on equivalent circuits

Physics-inspired ECMs [53–57] are a class of hybrid models that have rapidly gained
prominence since the publication of Jokar et al. [32] and Fan et al. [33]. In this case, the
derivation of the relevant model equations is performed in the frequency domain. This
frequency domain representation is then converted to a form suitable for implementation as
an equivalent circuit. Prasad and Rahn [54] extended their Padé order reduced model, first
presented in [44], by converting their impedance model into standard equivalent circuits. A
key point to be highlighted is that these family of models do not necessarily strive to retain the
classical Randles structure [58] for their equivalent circuit representation. Instead, the values
of the electrical circuit components such as series resistance and equivalent capacitance are
obtained through various mechanisms such as Electrochemical Impedance Spectroscopy (EIS)
measurements under load. The biggest advantage of such models is that they serve as drop-in
replacements to traditional ECMs whilst still retaining their origins in physical principles
rather than on empirical curve-fitting.


                                               58
                              2.2 Reduced Order Models: A New Classification Scheme


    A common characteristic of all hybrid models is the lack of a physical meaning to
their model parameters. This severely limits the insights offered by such models into
electrochemical phenomena internal to the cell. The biggest attraction of using PBMs is
the possibility of predicting quantities such as the State of Available Power (SOAP) or
phenomena such as cell degradation through accurate computation of the solid phase surface
concentration and potentials. Furthermore, a model capable of implying a direct and causal
relationship between a group of physical parameters and internal overpotentials at various
spatial locations within the cell serves as a powerful tool for in-situ lifetime estimation of
batteries. Although the circuit components of physics-informed ECMs and the state-space
models discussed here trace their origins to the original parameters of the DFN model, the link
between the final model coefficients and their progenitor physical parameter sets is tenuous
at best.

    With the goal of translating physical parameters of a cell into circuit components,
Zhang et al. [55] presented a lumped ECM based on Padé approximation and model truncation.
However, the sensitivity of the final model values owing to perturbations in the original
physical parameters was not evaluated. Consequently, there is a lack of clarity in the relative
importance of physical parameters and their influence on circuit component values.

    Merla et al. [57] introduced an ECM that can be parametrised by attempting a systematic
decoupling of the kinetics and diffusion at both electrodes and the electrolyte. Although these
interacting phenomena can be complex to resolve over all length and time-scales, acceptable
trade-offs in accuracy was demonstrated to be achievable from a system-level simulation
perspective. A drawback of this approach is that key physical parameters such as solid and
electrolyte diffusion coefficients are attributed to the two electrodes through ad hoc, non-
verifiable assumptions. Furthermore, in the aforesaid article, notable discrepancies exist in
the values of parameters such as electrolyte conductivity (obtained through calculations from
EIS measurements) to that typically reported in literature.

    It must be acknowledged that presently there exists no modelling candidate that provides
all the desirable characteristics sought after in a ROM to unconditionally adopt it for final
implementation in the time domain. However, it is strongly desirable that the majority of
the final model values retain their physical meaning, yielding system engineers and cell
designers alike with a direct and causal relationship between groups of parameters and their

                                              59
                               2.2 Reduced Order Models: A New Classification Scheme


influence on the cell’s operational performance. Since one of the goals of this thesis is to
provide a readily usable ROM that is immediately deployable in an online implementation,
the author concludes that at present, the benefits offered by physics-inspired hybrid ECMs
do not decisively outweigh their drawbacks.


2.2.4    Time-domain ROMs

General strategies in time-domain reduced order battery modelling

The working rubric of all time domain ROMs typically consists of attempts to reformulate
the original P2D model equations towards the goal of simplifying them to as much extent as
possible. In contrast to the hybrid models, all tasks involved in both model derivation and
final implementation are carried out entirely within the time domain. While a subset of prior
research has focused only on simplifying certain aspects of the cell’s dynamics e.g. diffusion
in the two electrodes, other published works have aimed at providing a simplified description
of the time domain evolution of all physical quantities of the cell. An evaluation of the salient
literature based upon both these approaches is performed here.

   In this discussion, the modelling approaches that entail computations with medium or
large dense matrices [59–61] or those involving concepts such as fractional order derivat-
ives [62–66] shall not be discussed. In the views of this author, it appears that the academic
community has implicitly considered them to be so abstruse that there has not yet been
a comparative study pitting these families of models against the prevalent art. Comparing
with the typical published work in this field, it is not clear on how such models distinguish
themselves uniquely within the broader landscape of reduced order battery modelling.

   A few mathematical techniques for Partial Differential Equation (PDE) simplification in
the time domain, such as Hilbert space representation and singular perturbation, were applied
for cell modelling in Manzie et al. [67]. However, their presentation lacks expository visual
information such as plots of time domain evolution of the internal and terminal variables for
dynamic load profiles. Furthermore, the authors have not provided a tabulated set of physical
parameters of the cell being simulated which therefore impedes reproducibility of the results.
Consequently, these methods have not seen a healthy uptake either in academia or in industry.
The author of this thesis considers the aforesaid presentation to be of a cursory nature and
therefore shall not discuss it here.
                                               60
                              2.2 Reduced Order Models: A New Classification Scheme


   In the DFN model, the evolution of lithium in the solid phase is described by the classical
diffusion equation given by Fick’s first law [68]. In order to solve for this concentration
profile in full-order models, it is required to discretise every spherical particle (represented
by the placement of a node in the axial i.e., through-thickness direction) along its radial
direction (pseudo dimension). This additional discretisation along the pseudo dimension
dramatically increases the overall number of discretisation nodes and adversely affects
computational efficiency. The impact of such high node densities on the computational
requirements of the original P2D model coupled with the fact that diffusion in the solid
phase is typically the rate-limiting aspect of batteries have led researchers to adopt various
mitigation strategies to tackle this issue. In contrast to the pure frequency domain and the
semi-hybrid/hybrid approaches discussed thus far, these attempts typically strive to arrive at
a simpler computational mesh, whilst aiming to retain high fidelity. It should be noted that
high node densities are mainly required near the surface of the spherical particles for the
pseudo dimension. Similarly, it is desirable to have a clustering of nodes near the separator
and current collector interfaces along the axial dimension. Thus, a sizeable number of order
reduction strategies in the time domain seek to adopt non-uniform node spacing towards
lowering the aforesaid computational issues. The remainder of this section discusses several
popular families of time domain models and provides a summary evaluation of their relative
merits and weaknesses.

Overview of prior art in the formulation of time-domain ROMs

Computationally efficient pseudo-spectral schemes for numerical solution of PDEs can be
employed by placing discretisation nodes at orthogonal collocation points obtained by solving
for the zeros of certain class of polynomial basis functions [69–73]. The accuracy of such
schemes extend beyond the algebraic orders of that achievable with classical Finite Difference,
Finite Element or Finite Volume Schemes. Northrop et al. [74] pioneered their application
in battery modelling by employing Jacobi polynomials as the underlying basis functions.
A Lagrangian-like integral method to describe diffusion in the electrolyte and solid phase
was proposed by Rahn and Wang [8], which however works well only at low C-rates.
Suthar et al. [75] replaced the Jacobi polynomials originally proposed by Northrop et al. [74]
with Chebyshev polynomials to help extend the applicability of the resulting ROM to higher C-
rates. Bizeray et al. [76] provide a detailed treatment on the usage of Chebyshev discretisation


                                              61
                                2.2 Reduced Order Models: A New Classification Scheme


for the full P2D model on a global scale i.e., along both the axial and radial directions for all
equations of the DFN model.

    In pseudo-spectral methods, the reduced number of nodes as well as their clustered
placement at desirable spatial locations facilitated by these discretisation schemes lower the
computational burdens of simulating a physics-based cell model. In such schemes, the P2D
equations, their boundary conditions and corresponding field variables are mathematically
transformed to the Chebyshev space within which they are solved. The solved quantities are
then converted back to the physical space through a corresponding inverse transformation.
Although this bi-directional transformation is purely algebraic in nature, the requirement of
running a spatially resolved model coupled with the overheads of such variable transforma-
tions render these class of models unsuitable for online implementation. The contribution of
Lee et al. [48, 49] i.e., the ability to solve for any electrochemical variable at arbitrary spatial
locations by completely eliminating the need for spatial discretisation assumes particular
significance in this context.

    In all non-uniform discretisation schemes discussed here, the implications of using a non-
adaptive support mesh obtained by the placement of nodes whose locations are optimised
a priori must be considered carefully. For instance, in the prolonged operation of the cell with
a net unidirectional charge flow e.g. in an electric vehicle application, the reaction front drifts
from separator back towards the current collectors. This is due to the exhaustion of lithium at
the surface of particles near the separator interfaces. In this scenario, the solutions produced
by these models could be worse than simpler models with uniform mesh-density. Although
adaptive meshing strategies can be employed for desktop simulation with minimal effort, it
remains to be seen if this can be deployed successfully in a resource-constrained environment
such as an embedded BMS controller, and hence is a candidate for future research.

    The computational bottlenecks arising due to discretisation in the radial direction
have motivated researchers to explore mesh-free approaches to solve for the solid phase
concentration profile. Subramanian et al. [77] pioneered the concept of employing polynomial
approximations of the Fickian diffusion equation to solve for lithium concentrations in the
porous electrodes. In this approach, the solid-phase surface concentrations were expressed
as correction terms applied to their average concentrations (which was described using a
second degree polynomial). In a follow-on study [78], the same authors presented a solution

                                                62
                             2.2 Reduced Order Models: A New Classification Scheme


using higher order polynomials and performed a dimensionless analysis of their proposed
reformulation. The details of the 4th order polynomial approximation is presented in the
context of this thesis author’s comprehensive analysis of the SPM modelling art and is
discussed in section 5.1.3. In the 2nd and 4th order solutions, the polynomial equation for
surface concentration was accompanied by a corresponding Ordinary Differential Equation
(ODE) for describing the temporal evolution of average concentration, thereby leading to
a system of Differential Algebraic Equations (DAEs). Furthermore, Subramanian et al. [79]
convincingly demonstrated the application of polynomial approximation for the solid phase
diffusion equation in the numerical simulation of a complete DFN cell model.

   Using polynomial approximation for the solid phase concentration results in a drastic
reduction in the number of DAEs needed to solve the full model since now discretisation
needs to be performed only along the axial direction. The polynomial approximation solution
applied to solve for the surface concentration in the solid phase can hence be viewed as a
dimension reduction approach, as it removes the need to numerically solve the concentration
dependence in the radial direction. The textbook by Carslaw and Jaeger [80] provides
detailed derivations for obtaining the standard analytical solution to Fick’s law of diffusion
in the context of heat conduction in solids. Liu [81] derived this analytical solution for the
lithium intercalation process in the solid phase, taking into account the idiosyncrasies of
porous electrodes. However, this expression involves an infinite sum expansion of eigen
modes. Guo and White [82] formulated an expression for a truncated approximation of
this solution to arbitrary number of terms. Furthermore, they demonstrated the validity
of this approximation by comparing the analytical solution truncated to the first 5 terms
to that obtained from a classical finite element solution. However, this truncated analytical
solution involves exponential and trigonometric terms and is non-trivial to implement on
BMS chips, particularly in those that lack support for floating point computations. Moreover,
there has been no extensive study comparing the analytical solution to the polynomial
approach. Consequently, this approach has not yet gained widespread popularity in the
inherent elimination of the radial dimension that is so deeply ingrained as a core aspect of
the cell-level order reduction approaches discussed here.

   The computational speed-up facilitated by using polynomial approximations for the
solid phase diffusion has motivated other researchers to extend this approach to all other


                                             63
                              2.2 Reduced Order Models: A New Classification Scheme


electrochemical variables of the DFN model. Deng et al. [83] presented a polynomial-centric
evaluation of the full P2D model, whose notable contribution is in providing such an
approximation for the molar flux density along the thickness of the cell. To the best knowledge
of this thesis author, this is the first published work that provides a spatially dependent
simplified computation of the interfacial flux density. This represents a balanced choice
between the need to use the strongly non-linear Butler-Volmer kinetics eq. (1.7) or having
to resort to a lumped representation of average kinetic behaviour. Hence, this approach is
particularly suited to reduced order modelling of cells with medium electrode thicknesses
wherein the lumped representation of flux density is not generally applicable.

   One serious drawback in Deng et al. [83] is the use of a Finite Difference approximation
for computing the spatial gradients of the Open Circuit Potential (OCP) at three electrode
locations. This adversely affects computational performance and is not suitable for online
implementation. Unless a proven solution for such computational challenges is made available,
it is worthwhile to continue to explore other avenues to identify the most apropos first
candidate for adoption in real-time BMS environments.

   Farag et al. [84] proposed a Piecewise Linear (PWL) approximation of all governing
equations of the electrochemical model. Given that straight-line fits to complex phenomena
are inherently too simplistic, these authors acknowledged that a naive implementation of
their approach shall therefore result in a crude approximation of the cell’s dynamics. Hence,
an optimal knot-placement scheme was proposed and solved through a genetic algorithm
to compute the break-points of the PWL fit. Since this computationally intensive step
occurs offline, it does not adversely affect the real-time performance of the model. The final
ROM is implemented using standard state-space matrices. However, this model exhibits the
primary drawback seen in the hybrid modelling approaches i.e., a complete lack of physical
interpretation of its parameters. As with any other ROM involving SOC-based linearisation
points, the stability of the model to uncertainties in physical parameters is questionable.
A detailed sensitivity analysis of the knot placement scheme’s output to such parametric
variation is to be performed in order to establish confidence in the model’s robustness, before
such PWL approaches can gain widespread acceptance in online applications.




                                              64
                               2.2 Reduced Order Models: A New Classification Scheme


2.2.5    Classification of ROMs — Interim summary

Although the presentation of prior art on time-domain ROMs is not yet complete, it is helpful
to have a brief interlude to summarise the body of literature reviewed thus far. This exercise
shall help to inform the rationale behind the next directions to be undertaken. Table 2.1
provides a high level overview of the key contributions and limitations of the salient literature
on various categories of ROMs discussed in sections 2.2.1–2.2.4.


  Table 2.1 Overview of key contributions and limitations of the salient literature on various
  categories of ROMs discussed in sections 2.2.1–2.2.4.

                                                                             Limitations/
      Category                Source           Key Contributions
                                                                             Other Remarks

Frequency-domain      Forman et al. [39]       Pioneered Padé                Limited to offline
ROMs                                           approximation technique       applications due to
                                               for battery modelling         aggressive trade-offs
                                                                             in approximation
                                                                             order
                      Prasad and Rahn [44]     Online identification of a    Lack of
                                               few ageing parameters         implementation
                                               using RLS                     details hampers
                                                                             reproducibility
                      Yuan et al. [45, 46]     Proposed a high-fidelity      Being too recent,
                                               low order transfer function   unproven to rely as
                                               type ROM                      the foundation

Quasi-hybrid          Smith et al. [47]        Obtained transcendental       Needs a large number
ROMs                                           transfer functions of all     of states for
                                               field variables except        capturing system
                                               electrolyte concentration     dynamics, which
                                               and potential, followed by    impacts observability
                                               conversion to time domain
                                               state-space model

                                                                        Continued on next page




                                               65
                               2.2 Reduced Order Models: A New Classification Scheme


                          Table 2.1 — continued from previous page

Category                       Source         Key Contributions            Limitations

                      Lee et al. [48]         Sturm-Liouville approach     Computational
                                              to obtain transcendental     bottlenecks owing to
                                              transfer functions of the    large sized matrices;
                                              electrolyte, followed by a   needs linearisation at
                                              novel DRA scheme for         specific SOCs which
                                              state space implementation   raise questions on
                                                                           state estimation
                      Rodriguez et al. [51]   Simplified computation of    VOP scheme has not
                                              electrolyte transfer         seen traction in
                                              functions through a VOP      published literature;
                                              scheme                       Requires linearisation
                                                                           at multiple points
                      Guo et al. [52]         Eliminates linearisation     Final model
                                              from the workflow            formulation is not
                                              through a non-linear state   clearly illustrated;
                                              variable model               Lack of examples or
                                                                           pseudo-code hinder
                                                                           comprehension

Hybrid ROMs           Prasad and Rahn [54]    Pioneered this concept by    Does not provide a
based on                                      converting an impedance      direct relationship
equivalent circuits                           model into an equivalent     between physical
                                              circuit                      parameters and
                                                                           values of circuit
                                                                           components
                      Zhang et al. [55]       Lumped ECM based on          Lacks clarity in the
                                              Padé approximation and       relative importance
                                              model truncation             of physical
                                                                           parameters and their
                                                                           influence on circuit
                                                                           component values
                      Merla et al. [57]       Systematic decoupling of     Discrepancies in a
                                              kinetics & diffusion,        few parameter values
                                              followed by their mapping    compared to those
                                              to circuit components        reported in literature

                                                                       Continued on next page




                                              66
                            2.2 Reduced Order Models: A New Classification Scheme


                       Table 2.1 — continued from previous page

Category                   Source            Key Contributions              Limitations

Time-domain ROMs   Manzie et al. [67]        Direct simplification of       No expository visual
(excluding SPMs)                             PDEs by Hilbert space          information and
                                             representation and             absence of cell
                                             singular perturbation          parameter set
                   Northrop et al. [74]      Pioneered the use of           Applicable only at
                                             pseudo-spectral schemes        low C-rates
                                             in cell modelling using
                                             Jacobi polynomials
                   Suthar et al. [75]        Used Chebyshev                 Provides only a
                                             polynomials as basis           cursory mention of
                                             functions for numerical        the scheme; lacks
                                             robustness and hence, to       mathematical details
                                             facilitate higher C-rates      to aid battery
                                                                            modellers
                   Bizeray et al. [76]       Detailed treatment on the      Computational
                                             usage of Chebyshev             burden of
                                             discretisation for both the    discretisation in the
                                             axial & radial dimensions      axial direction is not
                                             of a lithium ion cell          justified for
                                                                            embedded BMS
                                                                            applications
                   Subramanian et al. [79]   Pioneered the use of           All other field
                                             polynomial approximation       variables were solved
                                             for solving diffusion in the   using a traditional
                                             solid phase                    finite difference
                                                                            method; not
                                                                            amenable to
                                                                            embedded
                                                                            implementation
                   Deng et al. [83]          Extended the use of            Finite Difference
                                             polynomials for the molar      approximation for
                                             flux density of the DFN        the spatial gradients
                                             model                          of OCP is an adverse
                                                                            side-effect not seen in
                                                                            other polynomial
                                                                            ROMs




                                             67
                          2.3 Review of Literature on the Single Particle Model Family


   It is evident that all physics-based ROMs presented thus far entail extensive paramet-
risation efforts to render them suitable for a practical application. The difficulties associated
with such parametrisation, coupled with inherent uncertainties in the obtained parameter
values act as a strong deterrent to stakeholders outside academia to adopt PBMs for online
implementation in a BMS. This motivates the need for even further simplified PBMs. One
such modelling candidate is the Single Particle Model (SPM), the prior research on which is
presented next in section 2.3.


2.3     Review of Literature on the Single Particle Model Family

2.3.1    Overview of literature on conventional SPMs

Haran et al. [85] proposed a highly simplified representation of porous electrodes for the
metal hydride cell chemistry. In the aforesaid article, each porous electrode was represented
as a single spherical particle. This concept was adopted for lithium ion batteries by Ning and
Popov [86] and has since become quite popular. Models employing this lumped representation
of electrodes are referred to as Single Particle Models (SPMs). These models have three
advantages. Firstly, SPMs involve only a subset of parameters of the original DFN model.
Furthermore, they are computationally cheap, especially when coupled with the polynomial
approximation for solving the solid diffusion equation for each electrode. Finally, all model
parameters in the SPM retain their physical character, aiding in a direct and intuitive
understanding of physical parameters on the cell’s operation.

   During the initial years following its inception, the formulation of the basic SPM was
discussed extensively within application-specific contexts such as SOC evaluation [87, 88],
parameter estimation [89], and life cycle/ageing predictions [90, 91]. There have also been
detailed stand-alone publications discussing various facets of the basic SPM, such as its
inherent assumptions and governing equations [92, 93]. The basic SPM suffers from poor
voltage accuracy which is discussed in the simulation results presented in section 5.3.3. Since
the turn of the decade, researchers have attempted to tackle this issue and a holistic discussion
of such efforts is presented next in section 2.3.2.




                                               68
                          2.3 Review of Literature on the Single Particle Model Family


2.3.2    State of the art in electrolyte enhanced SPMs

The lack of electrolyte dynamics in the conventional SPM results in poor voltage accuracy
even at moderate C-rates. This is illustrated in the author’s simulation results presented in
section 5.3.3. This poor performance in voltage prediction renders the model unsuitable for
observer design in SOC estimation applications . This is because the output voltage from the
model maps to a radically different SOC operating point. A number of candidate solutions
have been proposed in literature that strive to mitigate this drawback, the salient among
which are evaluated here.

   The earliest works which attempt to include electrolyte dynamics in the conventional
SPM were published only within the present decade. Schmidt et al. [94] proposed an infinite-
sum eigenfunction modal expansion paradigm to solve for the electrolyte concentration.
It was claimed that by accounting for contribution from only the first two terms, sufficient
accuracies may be achieved. Furthermore, a simple ODE was proposed for the rate of evolution
of the first temporal mode. The solved electrolyte concentration is then substituted into an
approximate analytical solution for the DFN model’s charge conservation PDE (see eq. (1.5))
to obtain the electrolyte potential. However, the presentation lacks depth in the explanation
which hinders reproducibility. For instance, the origin and explanation of the approximation
terms in the electrolyte potential solution is omitted. Derivations are performed from a
rigorous mathematical perspective without providing contextual reference to cell parameters
or electrochemical quantities. Introducing numerical examples would have been a redeeming
factor to help keeping the mathematical aspects tractable. This method has not seen further
uptake for SPM modelling.

   Guo et al. [95] presented an empirical approach to account for the solution-phase
dynamics. Using standard curve-fitting techniques, a non-linear resistance as a function
of current and temperature was introduced. Thus, the equation for cell terminal voltage
presented in eq. (5.29) is modified as

                            𝑉cell = 𝜂pos − 𝜂neg + 𝑈pos − 𝑈neg − 𝐼 𝑅eq                   (2.2)




                                               69
                                  2.3 Review of Literature on the Single Particle Model Family


where 𝑅eq is the equivalent resistance newly introduced. In the opinion of this thesis author,
this approach is too simplistic and does not generalise well. Even if giving up physics-
based model origins can be tolerated for one or two subsystems within the model, the
equivalent resistance is not just a minor correction term since it needs to account for a
large polarisation voltage of the order of tens of millivolts. Secondly, the current-dependence
introduced to account for the complex mass and charge transport within the electrolyte places
a disproportionately large weight on the accuracy of the curve-fitting process. Non-linear
fits as proposed in Guo et al. are inherently problematic as the optimisation routine may
simply converge to a local minimum. The specific form and nature e.g. the convexity of the
proposed hypothesis function is not discussed. It is also not guaranteed that the same fitting
function is applicable to a different cell with another set of parameters. Finally, the correction
term being resistive in nature is zeroth order i.e., cannot account for the frequency dependent
behaviour of the electrolyte’s dynamics. This approach is more suited for small-scale static
corrections that do not depend on the current e.g. to account for a few tens of microvolts due
to a constant contact resistance of the current collectors.

    Di Domenico et al. [96] were the first to present a step-by-step derivation of the
approximate analytical solution to the electrolyte overpotential. The potential drop in the
electrolyte is given by

                                                  𝐼   𝑙neg       𝑙sep     𝑙pos
                           𝜙e,pos − 𝜙e,neg    =−    (        +2         +         )                     (2.3)
                                                 2𝐴 𝜅eff,neg    𝜅eff,sep 𝜅eff,pos

and can be substituted into the subtraction operation involving eq. (5.26) and eq. (5.27) in
computing the overall overpotential of eq. (5.28) and hence the terminal voltage. The effective
conductivity of the electrolyte in a given region 𝑗 ∈ {pos, sep, neg} within the cell, is defined
                           brugg𝑗
as 𝜅eff𝑗 (𝑐𝑒 ) =   𝜅(𝑐𝑒 ) 𝜀𝑗      .   As discussed in section 5.3.2, the intrinsic, and hence the effective
electrolyte conductivity is a function of the concentration of                Li +   ions in the electrolyte.
Di Domenico and co-workers did not, however discuss the spatio-temporal calculation of
electrolyte concentration. It is likely that a constant electrolyte concentration at its initial
equilibrium value was used. As seen in fig. 2.1, significant spatial gradients in the electrolyte
are established even at low to moderate C-rates during the cell’s operation. Sustained
application of a unidirectional current even leads to starvation of ions in the electrolyte,
particularly near the current collectors. This phenomenon is visualised in fig. 2.1 wherein

                                                         70
                                         2.3 Review of Literature on the Single Particle Model Family


the electrolyte at the positive current collector is virtually depleted of ions at the end of
discharge. This ion-starvation process occurs earlier at higher C-rates and spreads throughout
the thickness of the electrode. Thus, the assumption of constant ionic concentration in
the electrolyte is not true. Neglecting mass transport due to diffusion implies that the
terms in eq. (2.3) constitute only a part of the expression for computing the electrolyte
overpotential. Furthermore, Di Domenico and colleagues do not present any results of
applying dynamic current profiles. Since the critical aspect of mass transport contribution to
electrolyte overpotential is omitted, this model cannot be viewed as a sufficient enhancement
to the basic SPM.
                             1750
                                                                                        3571 s
                                                                                        1785 s
                             1500
                                                                                        178 s
                             1250
                                                                                        60 s
             ce (mol m–3 )




                             1000


                             750                                                 20 s


                             500                                                 10 s
                                                                                 5s
                             250


                                 0
                                     0                 lpos        lpos + lsep                   ltot

                             +
  Figure 2.1 Li ion concentration in electrolyte along cell thickness at various time-snapshots
  during a 1C discharge simulation of the P2D model. A Quasi-Steady State (QSS) spatial profile with
  inflection point at each separator interface begins to form at ≈60 s after discharge begins. However,
  the ionic concentration in electrolyte exhibits a significantly different transient behaviour (zoomed
  inset) possessing another inflection point that disrupts the monotonic trend. Depletion of ionic
  concentration at positive current collector towards end of discharge is also seen (bottom left).


   Although not presented in the context of incorporating into the SPM, Guduru et al. [97]
derived an analytical solution of the spatio-temporal evolution of electrolyte concentration
using the Separation of Variables (SoV) method. The SoV method was first applied to
modelling of lithium ion cells by Subramanian et al. [98] to solve for solid phase concentration
profiles in spherical electrode particles. Although the ionic concentration in the electrolyte
computed by the analytical expression in Guduru et al. [97] seems like a feasible choice
for inclusion into the SPM, it is only applicable for galvanostatic boundary conditions

                                                              71
                          2.3 Review of Literature on the Single Particle Model Family


i.e., when the applied current is held constant over time. By natural extension, researchers
could hypothesise that this restriction may be removed by considering the input current as
piecewise constant over small sample intervals. Such a hypothesis could be reinforced by the
fact that standard drivecycles are specified as discrete samples and the discrete-time SPM
processes these input samples assuming Zero Order Hold (ZOH) behaviour. However, the
analytical solution presented by Guduru and co-workers assumes a Quasi-Steady State (QSS)
concentration profile. These authors consider a near-instantaneous establishment of this QSS
and suggest a parameter-independent analysis through use of dimensionless concentrations
and time-constants instead of absolute time.

   In the studies conducted by this thesis author, significantly different transient behaviour
is exhibited by the electrolyte concentration profile. In particular, the time taken to establish
the QSS profile is not negligible. This difference in behaviour could be attributed to the
different parameter set used. Figure 2.1 shows the spatial profile of ionic concentration at
various snapshots of time during a 1C constant current discharge. Starting at 100 % SOC,
the discharge lasts 3571 s. It is seen that it takes nearly 60 s to establish the approximately
parabolic shape assumed by the electrolyte concentration. After the initial transient has
elapsed, the underlying structure of the mathematical equations can be assumed to be static.
This is evidenced by the fact that at 1785 s i.e., after half of the discharge is completed, the
shape of the curve is nearly identical to the one towards end of discharge. These QSS curves
have their sole inflection points at their separator interfaces and remains monotonic within
their respective electrode regions. The difference in height for various times can be accounted
by the coefficients solved using the analytical modal solution proposed in Guduru et al..

   The axes in the inset of fig. 2.1 shows a zoomed-in view of the electrolyte concentration
during the transient phase, wherein the QSS has not yet been established. In particular, there
exist additional inflection points, one within the interior of each electrode, which render the
transient concentration profile mathematically incompatible with the monotonicity exhibited
by the QSS profile. Thus, in highly dynamic operating conditions with frequent reversals in
the direct of current, the QSS assumption for the galvanostatic analytical solution becomes
harder to uphold without introducing significant errors. Finally, the analytical solution profile
in Guduru et al. is not amenable to embedded implementation, since it consists of a set of
non-trivial trigonometric computations at each time-step.


                                               72
                             2.3 Review of Literature on the Single Particle Model Family


    Prada et al. [99] were the first to provide a simplified expression for potential drop in the
electrolyte by including the terms representing ionic concentration gradient within the cell
thickness. Thus, eq. (2.3) gets modified as

                                    0   2𝑅𝑇    𝑐e,pos/cc   𝐼   𝑙neg      𝑙sep     𝑙pos
          𝜙e,pos − 𝜙e,neg   = (1 − 𝑡+ )     ln           −   (       +2         +         )   (2.4)
                                         𝐹     𝑐e,neg/cc 2𝐴 𝜅eff,neg    𝜅eff,sep 𝜅eff,pos

Although the complete expression for electrolyte overpotential was provided, it was presen-
ted in a cursory manner i.e., without detailing the spatio-temporal computation of ionic
concentration values at the current collector interfaces. Nevertheless, it is important to note
this contribution as eq. (2.4) is widely relied upon by subsequent literature and shall be used
in section 6.10.1.

    The pioneering work by Rahimian et al. [100] provided approximate expressions for
both charge transport and mass transport properties of the electrolyte specifically with
the focus on improving the basic SPM. These authors discuss the usage of a polynomial
approximation for electrolyte concentration and potentials. In particular, a cubic polynomial
was chosen for approximating the electrolyte concentration within the porous electrodes. This
necessitates the need to solve for eight coefficients for uniquely describing the electrolyte
concentration profile within the electrode regions. However, in the standard DFN model, the
number of electrolyte-specific PDEs and their corresponding boundary conditions describing
charge and mass transport is insufficient to uniquely solve for all unknown coefficients of
this polynomial approximation. A detailed explanation of this equation deficiency shall be
discussed in section 6.1.1.

    To overcome the issue of equation deficiency, Rahimian et al. adopted a scheme wherein
one additional spatial location in the interior of each electrode was also needed. The
coefficients of the polynomial approximation were then obtained by iteratively solving
a large coupled system of algebraic equations, embedding within them the additional
equations evaluated at the interior points. A complicating issue that arises is regarding the
optimal positioning of these additional interior points. An online numerical optimisation was
performed to obtain the optimal placement of this interior node. In the opinion of this thesis
author, these optimisation results could be sensitive to the thickness of the electrodes among
other parameters. A discussion of the stability of the proposed routine and its robustness


                                                  73
                           2.3 Review of Literature on the Single Particle Model Family


to parameter variations shall help in lending confidence in the proposed method. Although
sufficient accuracy of the improved SPM was demonstrated for currents up to 5C, a notable
omission is the discussion of the model’s performance to dynamic input profiles. In conclusion,
the author of this thesis opines that, although this method serves as a proof of concept towards
implementing polynomial approximations for electrolyte dynamics, until the aforementioned
gaps are addressed with clarity, it is not convincing for uptake by relevant stakeholders.

    Kemper and Kum [101] presented an approach wherein the spatial gradients of the
electrolyte concentration are neglected. The time-evolution of average ionic concentration
in each of the three cell regions viz. positive electrode, separator and negative electrode are
described by a set of three ODEs. As established by the discussion thus far, the concentration
gradients along the axial thickness of the cell is significant, even at moderate C-rates. Lending
strength to doubts on the model’s wider applicability is the fact that results from constant
current inputs (which induce large concentration gradients in electrolyte) have not been
reported in this work. Thus, this approach is deemed as not satisfactory enough to warrant
further engagement.

    Luo et al. [102] derived a parabolic approximation of the electrolyte concentration
distribution along the thickness of the cell. The derivation is obtained for the case of steady-
state wherein the rate of change of concentration is zero. However, the author of this thesis
is sceptical about this since in the set of independent simulations conducted, there was no
situation other than prior to application of current that this exact steady-state condition is
satisfied. In the QSS profile concept discussion based on fig. 2.1, it is clear that only the spatial
profile reaches a shape that can be potentially described by a mathematically invariant family
of curves. The electrolyte concentration is still time-varying and therefore violates the static
time-evolution assumption. Although Luo et al. [102] do not explicitly acknowledge this, they
do provide an extension for general operating conditions by introducing two exponential
scaling functions 𝑓𝑛 (𝑡) and 𝑓𝑝 (𝑡) while retaining the assumption of parabolic spatial behaviour.
The computation of certain time-constants in these scaling functions are not elucidated nor
are the procedural steps for determination of the aforementioned scaling functions provided.

    In a subsequent paper by the same authors i.e., Luo et al. [103], the electrolyte concentra-
tion model together with a similarly-derived electrolyte potential model was incorporated
into the conventional SPM to arrive at what the authors term as extended SPM. In the

                                                 74
                          2.3 Review of Literature on the Single Particle Model Family


aforementioned work, the electrolyte potential is set to account for contribution from two
terms — a) ohmic drop due to bulk solution resistance, and b) polarisation potential due
to concentration gradients Although it seeks to correctly account for the two causes of
overpotential in the electrolyte, there is no detailed explanation on the computation of
quantities such as time-constants involved in the polarisation potential term.

   A modified version of the electrolyte model proposed in Luo et al. [102] was used in
Zou et al. [104] for observer design in an SOC estimation application. The modification
essentially consists of truncating the complex expression in Luo et al. [102], which originally
consisted of six coefficients 𝑝1 through 𝑝6 to just two, and elimination of the aforementioned
time-constants. However, to the disappointment of the author of this thesis, the claim that
truncation to 𝑛 = 2 terms is sufficient to describe the dynamics proved to be optimistic for
the parameter set considered. In the thesis author’s efforts to reproduce the aforesaid work,
an arbitrary scaling factor was needed to correct for the electrolyte potential drop and match
the P2D simulations. The requirement for such scaling factors whose physical origins are not
clearly identifiable lends to scepticism on the model’s robustness. Furthermore, it was found
that this value needed to be hand-tuned for each parameter-set. Until these gaps are addressed,
it is worth seeking other viable alternatives to model the cell’s electrolyte dynamics.

   After completing the simulations with the aforementioned scaling factors and continuing
in the quest for other alternatives, the author of this thesis made an observation that
other researchers have had to resort to similar techniques for describing the electrolyte
overpotential. For instance, Han et al. [105] use a similar scaling factor 𝑝 < 0 for the entire
expression of eq. (2.4) representing the electrolyte overpotential using the polynomial
approximation approach proposed by Rahimian et al. [100]. However, these unexplained
scaling factors lower the confidence regarding the model’s general applicability.

   Tanim et al. [106] accounted for electrolyte dynamics by deriving reduced order transfer
functions for ionic concentration distribution and electrolyte overpotential using the Integral
Method Approximation (IMA) technique. However, the coefficients of these transfer functions
are excessively long and comprised of chained algebraic operations expressed in a high-
entropy sum-of-products form in the appendix of the aforesaid article. For instance, ten
coefficients are needed to describe the concentration profile while six coefficients are required
for the electrolyte potential. The median length of each atomic sub-expression of these

                                               75
                           2.3 Review of Literature on the Single Particle Model Family


coefficients is sufficiently high to obfuscate their physical significance. A low-entropy form
for the coefficients of these transfer functions similar to that pioneered by Middlebrook [107]
and exemplified in the design-oriented analysis of electric circuits [108, 109] could have
been helpful to aid the readers’ understanding. The author of this thesis recognises that
mathematical complexity should not be the sole basis to evaluate the merits of such proposed
improvements. Although the presentation of these long coefficients have been judiciously
moved to the appendix, their derivations — essential to prove the model’s validity — is
curiously omitted. The unwieldiness of the mathematical expressions presented therein
increases the probabilities of introducing human errors during implementation.

    It is worth noting that Marcicki et al. [40] had independently proposed a similar approach
viz. deriving a transcendental transfer function from electrolyte concentration to applied
current, albeit for a cell of Lithium Iron Phosphate (LFP) chemistry. This transfer function
consisted of a series of hyperbolic trigonometric functions which were later truncated by
Padé approximation (see section 2.2.1 for a brief introduction to frequency domain ROMs).
However, upon the trial of this approach for the Lithium Cobalt Oxide (LCO) parameter set
(see table 5.2) by this thesis’ author, in order to obtain sufficient accuracy, the truncation order
had to be raised to at least seven, similar in complexity to that of Tanim et al. [110]. In both
Marcicki et al. [40] and Tanim et al. [110], the electrolyte-specific enhancements to the SPM
are in the frequency domain, placing further burden, particularly on industry stakeholders
to accurately interpret and transform the coefficients to a time-domain implementation for
deployment in an embedded BMS. Owing to this, as already stated in section 2.2.1, these
models fall outside the scope of this thesis.

    Fan et al. [36] proposed an Extended SPM that includes electrolyte dynamics using
the Galerkin Projection Method (GPM) which achieves an acceptable accuracy in terminal
voltage performance. Although these authors claim that the GPM is computationally cheaper
than other model order reduction techniques such as proper orthogonal decomposition and
balanced truncation, this claim has not been substantiated. The sole comparison of Central
Processing Unit (CPU) times presented in the said work only contrasts the GPM against the
classical Finite Difference Method (FDM). Although an impressive computational speed is
achieved, it is unclear whether the model equations, particularly those involving solutions
of non-linear integral expressions resulting from applying the Galerkin’s method can be


                                                76
                           2.3 Review of Literature on the Single Particle Model Family


solved in real-time for embedded implementation. It appears that the GPM is more suitable
for desktop simulations. In congruence with this thesis author’s scepticism, Fan et al. [36]
have not claimed the suitability of their work for online/embedded application in a BMS.
Therefore, in accordance with the stance taken in section 2.2, models employing such methods
are deemed to be not in alignment with the goals of this thesis.

    Moura et al. [111] proposed an improved SPM by simply augmenting the conventional
SPM with a simplified form of electrolyte-specific equations of the original DFN model. The
resulting model therefore has PDEs in it and therefore not easily amenable for embedded
implementation. Lotfi et al. [112] presented an algebraic approximation for the spatial distri-
bution of electrolyte concentration by modifying standard parabolic expressions with leading
exponential coefficients. There are two main issues with this approach. It is not explained
why that particular mathematical formulation was chosen. For instance, its superiority over
other feasible family of curves is not discussed. Secondly, the aforesaid coefficients are to be
determined through solution of equations obtained by applying continuity and flux boundary
conditions from the DFN model for electrolyte concentrations at the electrode-separator
interfaces. Since exponential-type expressions are assumed in the aforesaid mathematical
formulations, the resulting set of equations are non-linear, the solving of which in the context
of a resource-constrained environment is problematic. Table 2.2 provides a digested summary
of the salient electrolyte enhanced SPMs from literature.


              Table 2.2   Summary of salient literature on electrolyte enhanced SPMs

                                                                        Limitations/
         Source                Key Contributions
                                                                       Other Remarks

Schmidt et al. [94]       Electrolyte concentration       Excessive theoretical emphasis without
                          solved by an eigenfunction      regular contextual references to cell
                          expansion for spatial profile   modelling, which hinders reproducibility
                          and an ODE solution for
                          temporal dynamics
Guo et al. [95]           Non-linear resistance as a      Empirical approach which is difficult to
                          function of current and         generalise across parameter sets since
                          temperature to capture          large corrections of the order of a few mV
                          electrolyte overpotential       become essential; Non-linear optimisation
                                                          may converge to a local minimum

                                                                         Continued on next page

                                                 77
                           2.3 Review of Literature on the Single Particle Model Family


                          Table 2.2 — continued from previous page
                                                                          Limitations/
         Source                Key Contributions
                                                                         Other Remarks

Di Domenico et al. [96]   First to present an               Lacks discussion on spatio-temporal
                          approximate analytical            calculation of ionic concentration;
                          solution for electrolyte          presumably used constant initial value
                          overpotential                     which is problematic with sustained
                                                            unidirectional currents
Guduru et al. [96]        Pioneered an analytical           The derived analytical solution is
                          solution for the                  applicable only for galvanostatic
                          spatio-temporal evolution of      discharge; assumption of near
                          electrolyte concentration         instantaneous establishment of QSS
                          using the Separation of           hinders extensions using PWL
                          Variables (SoV) method            approximations while trigonometric
                                                            computations at each time-step impacts
                                                            embedded applicability
Prada et al. [99]         First to incorporate              The solution of spatio-temporal ionic
                          polarisation due to ionic         concentration is not detailed. However,
                          diffusion in the expression for   post-computation of this term, the
                          electrolyte overpotential         equation in Prada et al. [99] is widely
                                                            used for the electrolyte overpotential
                                                            contribution to cell terminal voltage
Rahimian et al. [100]     Cubic polynomials for spatial     Limited by the issue of equation
                          approximation of electrolyte      deficiency in the P2D model; proposed
                          concentration and                 workaround involves computations at
                          demonstrated satisfactory         additional interior points which is
                          accuracy for currents up to 5C    determined by an expensive placement
                                                            optimisation algorithm
Luo et al. [102, 103]     Derived a modified parabolic      Computation of time constants of the
                          approximation (with               exponential scaling functions is not
                          exponential scaling functions)    explained; improvements over a standard
                          for electrolyte spatial           quadratic approximation model is not
                          concentration profile             elucidated
Tanim et al. [106]        Derived transfer functions for    Coefficients of transfer functions are
                          ionic concentration               excessively long and mathematically
                          distribution and electrolyte      intractable; Is based upon many high
                          overpotential using Integral      entropy expressions whose analytical
                          Method Approximation              derivations are omitted




                                                     78
                           2.3 Review of Literature on the Single Particle Model Family


2.3.3    Conclusions

A survey of the recent literature dealing with the SPM family of models reveals a diminishing
rate of advancement in quantifiable improvements to the underlying plant model itself.
This nearly-static trend can be attributed to the general consensus within the research
community that these models may be too simplistic and not of suitable accuracy to warrant
further studies. Other than a small minority of papers that either propose core modelling
improvements to tackle their inaccuracies, or add new enhancements such as mechanical-
stress physics [113, 114], latest work in this family of models predominantly pertains to their
application in areas like state estimation [104, 111, 115–117], optimal charging [118, 119], cycling
performance [120], conversion to equivalent circuits [121], parametrisation [122–125], pack-
balancing studies [126] and observer design for joint state-parameter estimation [127]. The
SPM approach has also been extended to the case of composite electrodes, leading to a
state estimator design after basic observability analysis [128]. Owing to their simplicity, this
thesis author believes that SPMs hold the highest potential to bring physics-based models to
embedded BMSs. With this goal in view, this thesis seeks to resurrect interest in SPMs by
addressing the recent paucity in fundamental modelling improvements.

    Based upon the thesis author’s experiences in trying to replicate the results from the
literature presented in section 2.3.2, any questionable elements in such prior efforts can
be attributed to inaccuracies in estimating the spatio-temporal evolution of electrolyte
concentration. Upon obtaining a good estimate of the electrolyte concentration profile,
eq. (2.4) is deemed to be satisfactory for the electrolyte overpotential computation. Thus,
it can be concluded that the focus of research efforts must be on accurate determination of
the electrolyte concentration profile.

    Analysing the literature presented in section 2.3.2, it can be seen that the proposed
enhancements to computing the ionic concentration in electrolyte falls into one of the
following two categories

    • model description through physical principles followed by mathematical simplification

    • fitting of pre-assumed simplified mathematical structures to some physical phenomena




                                                79
                          2.3 Review of Literature on the Single Particle Model Family


   In the author’s view, it appears that using the former approach yields technically
correct, yet mathematically convoluted expressions for overpotentials that are fraught with
implementation difficulties. Although the latter approach looks promising in terms of ease of
implementation, their sub-optimal performance and lack of wider-applicability leaves much to
be desired. Among the latter class of models, owing to its simplicity, the quadratic (parabolic)
approximation method for electrolyte concentration is an attractive option. It is therefore
important to perform an in-depth analysis of this sub-class of models and understand their
source of potential weaknesses. Such an analysis has yet not been performed in literature
and is therefore presented in section 5.4.

   This concludes the author’s review of literature of the various reduced order modelling
strategies. Based on the wealth of information gleaned from this study, it was possible to
make an informed choice to pursue the SPM approach for further research. In particular, it
came to light that there has been no systematic analysis of the state of the art SPM-based
approach with a view to quantify their performance boundaries. This author’s contributions
to the time domain implementation-oriented reduced order modelling field include

    • performing a thorough analysis of the basic SPM and the quadratic approximation
      concentration model for inclusion of electrolyte dynamics into it
    • identifying the issues plaguing each of the aforementioned models
    • conducting a wide range of hypotheses-driven trials in an attempt to enhance the basic
      SPM (some of which did not yield the desired improvements)
    • Obtaining an electrolyte-enhanced composite SPM through system identification, and
    • arriving at a feasible approach capable of moulding the SPM framework into a readily
      implementable solution for electric vehicle applications

This research was performed through an iterative cycle of analysis, design and simulation-
based verification and shall be elucidated in a discourse spanning two chapters viz. chapter 5
and chapter 6.




                                              80
      Model-based Design Of Pouch Cells
                                        ∗
                                                                                            3
    3.1    Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 82

    3.2    Energy/Power Trade-off in Pouch Cells by Layer Selection . . . . . . . . . . . 82

    3.3    Scope and Context within xEV Powertrain . . . . . . . . . . . . . . . . . . . . 91

    3.4    Enhancements/Modifications to Standard DFN Model . . . . . . . . . . . . . . 97

    3.5    Computational Framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110

    3.6    Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124

    3.7    Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134


    ∗ Attribution  of content The groundwork for converting the existing computer code (LIONSIMBA v1.0x)
into a suitable form for layer optimisation was initiated by this thesis author, Krishnakumar Gopalakrishnan.
However, with the exception of the spectral scheme, for which Krishnakumar Gopalakrishnan was responsible,
and the zero-dimensional thermal model for which Ian D. Campbell (PhD student, Imperial College London) was
responsible, the advancements inherent to the enhanced computer software (LIONSIMBA v2.0) were made in
equal parts by Krishnakumar Gopalakrishnan and Ian D. Campbell. These advancements would not have been
possible without the contributions and support of Dr Davide M. Raimondo (Associate Professor, University
of Pavia) who served as an unofficial supervisor for the work reported in this chapter. The concept of layer
reconfiguration for energy and power trade-off, the layer optimisation framework, and the source code by which
it is implemented were co-developed in equal parts by Krishnakumar Gopalakrishnan and Ian D. Campbell.
Krishnakumar Gopalakrishnan was the major contributor to the development of the binary search while
Ian D. Campbell was the major contributor in the analysis of results. Parvathy Chittur Subramanianprasad
(MSc student, Queen Mary University of London) was instrumental in developing the analytical expression for
the maximum possible number of layers 𝑛max .


                                                     81
                                                                              3.1 Introduction


3.1     Introduction


T
      he issue of ‘range anxiety’ is a pervasive mental blockade for potential buyers of electric
      vehicles which in-turn hampers their widespread adoption. From a consumer viewpoint,
yet another practical issue is the fact that upon encountering a ‘low battery’ scenario on a
long distance journey, the charging times required for sufficiently replenishing the battery to
enable completion of the journey are prohibitively large, to the point of being non-competitive
against conventional fossil fuel powered vehicles.

   Unfortunately, the aforementioned scenarios are not unimaginable with the present
state of the art in lithium ion batteries. Hence, improving the All-Electric Range (AER) and
providing fast charging capabilities are two near-term goals of manufacturers of electric
vehicles. Increasing the AER necessitates a battery pack with higher energy content in it while
lowering the charging time demands a pack with higher power capability. The contrasting
nature of these goals can be traced all the way down to the cell level and is presented in
section 3.2. By trading off the number of layers in a pouch cell against the content of active
electrode material accommodated within it, bespoke cell designs addressing either the energy
demand or the power demand can be obtained. In the absence of accessible documentation
(as either industry white papers or academic literature) on the layer selection methodologies
employed in automotive pouch cell designs, this author postulates that manufacturers iterate
through an extensive empirical testing process of prototypes with a range of layer choices.
In the view of this thesis author, this procedure is not only time-consuming, but is also
likely to result in sub-optimal designs. This chapter envisages a model-based engineering
solution to more optimal cell designs by determining the appropriate number of layers needed
to maximise its usable energy while simultaneously satisfying certain power capability
constraints. The rest of the chapter provides a detailed treatment of topics such as the
proposed layer optimisation framework, its assumptions involved, and various modifications
to standard numerical code required to facilitate this design procedure.


3.2     Energy/Power Trade-off in Pouch Cells by Layer Selection
Varying the number of electrochemical layers stacked within a pouch cell has contrasting
effects on its energy storage and power handling capabilities. In this section, a high-level


                                               82
                         3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


intuitive explanation of this phenomenon is first offered, before delving into a detailed
presentation of this effect and its implications for a specific example cell in section 3.2.3.
Interwoven into the narrative is a set of simplifying assumptions which establishes the
broader context within which a computational framework for determining the optimum
number of layers for a specific target design shall be formalised (to be discussed in section 3.5).


3.2.1    Preliminary assumptions

To obtain a balanced loading of both electrodes and to avoid asymmetrical exhaustion of
lithium from one of the electrodes during operation, it is desirable to carefully calculate the
volume of electrochemical active materials to be accommodated within the cell. This concept
is well-known and is commonly discussed in standard textbooks in the field such as those by
Rahn and Wang [8] wherein example calculations are presented for non-porous electrodes.
The study by Ramadesigan et al. [25] also supports the statement that capacity matching of
anode and cathode materials is a standard practice in cell design.

   In the case of lithium ion cells with porous electrodes, the concept of electrode-balancing
involves an additional variable viz. the porosity of the active materials. The roles of porosity
and its corollaries i.e., the material volume fraction and filler/binder fraction are discussed in
section 5.3.1. In this work, a major assumption about material porosities (and hence active-
material/filler volume fraction) is that they are held constant. The rationale behind using this
simplified assumption is as follows.

   This author visualises the integration of cell-level design optimisation (through an optimal
layer selection procedure) into the overall drivetrain design by the cell manufacturer before
a custom design is delivered to vehicle/system integrators. Cell manufacturers, especially
small-scale manufacturers do not necessarily synthesise each electrochemical component,
but instead may opt to source certain raw-materials from an upstream supply-chain. From a
manufacturing viewpoint, the porosity of the electrode materials is governed by the extent of
calendaring of the electrode reel. Using pre-calendered electrode materials or sourcing large
volumes of electrode reels with a fixed extent of calendaring can help to keep costs low. Since
researchers in the field are typically not privy to the specifics of the industrial procurement
process, in the absence of further information, the assumption of constant porosities provides
a good starting point for this model-oriented design study.

                                                83
                         3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


    From a technical viewpoint, there exists another redeeming argument to support the
constant porosity assumption. Keeping material porosities constant enables to eliminate one
degree of freedom from the design optimisation study, thereby narrowing the dimensionality
of the search space. To the best of the author’s knowledge, there has not yet been any
published work tackling layer optimisation of pouch cells. Building an initial infrastructure in
terms of a computational framework that is based upon this constant porosity approximation
shall at least provide a solid foundation to build upon for such real-life use-cases. The author
foresees this study as a vanguard research into cell engineering and therefore places a high
value in obtaining ballpark estimates of an optimal layer count, albeit with constant porosities.
Ramadesigan et al. [25] present an opinion that the choice of porosities of electrode materials
is currently being done on a trial and error basis. Nevertheless, for real-world use, the
influence of varying the material porosities on the cell’s performance is to be quantified.
Hence, prior to adopting this model-based methodology for production yields at scale, a fully-
integrated design optimisation process with variable porosities has to be developed. Therefore,
in this work, the study is restricted to constant porosity values, whilst acknowledging variable
porosity designs as an important aspect for future studies.

    At the system level, the efficiency of the drivetrain is considered to be constant. The
drivetrain of an electric vehicle consists of a whole host of electrical and mechanical
components such as power electronics, electric motors, gearing, differential shaft and other
transmission systems. The efficiencies of each of these individual components has a cascading
effect on the overall drivetrain efficiency. The efficiency of each component is strongly
dependent upon the operating point. For instance, the efficiency of an electric motor is a
function of its torque-speed curve. In practice, it is rarely easy to decouple these efficiencies at
least during the initial design stage. The datasheet/technical specification of each component
in the platform is required to make a comprehensive multiphysics-based design optimisation
study. This is well beyond the scope of this work and requires access to various design
blueprints. Therefore, a constant lumped efficiency value for the drivetrain is adopted for this
work. However, the proposed optimisation methodology is a modular one which implies that
it can be suitably adapted e.g. to include a efficiency value dependent upon power delivered
at the wheels. However, the biggest redeeming aspect (observed after the completion of
the study) is that using a constant efficiency value did not influence the final layer choice



                                                84
                         3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


for the cell design. As seen in section 3.5.2, the drivetrain efficiency plays a role only
during acceleration studies. As per the results presented in section 3.6, the layers required
for satisfying even the basic fast-charging requirements far exceed the layers required for
handling the acceleration power demands. Therefore, this assumption is justified for keeping
the computations tractable.

   From a pack perspective, the primary assumption in the formulation of the proposed
optimisation methodology is that the pack configuration (series/parallel arrangement of
modules, number of cells per module and other system-level specifications) are held constant
throughout. The validity of this assumption is easily justified since a cell-level design may
be performed independently of the larger drivetrain design. In fact, the author postulates
that present design process for electrified transportation is a modular one i.e., empirical cell
designs are developed based on certain specifications laid out by vehicle manufacturers and
is not integrated into the drivetrain design. This modularity in the design approach enables
to keep such system-level parameters constant.

   A further assumption in this study is that the overall height of the pouch is held constant
at 10 mm. The rationale behind choosing this specific pouch height is discussed in section 3.4.1.
In the absence of this constraint, any arbitrary pouch size can be chosen, leading to an
infinite-dimensional optimisation problem wherein no unique optimality criterion exists. This
assumption is in-fact enforced by a current trend in the automotive industry viz. adoption of
common-module designs wherein the physical dimensions of the pack are chosen a priori and
modularising the pack helps in tailoring them suitably to cater to different market segments.
Extending this philosophy down to the cell level, it is easy to visualise the benefits of having
cells of identical exterior dimensions. For instance, having a common inventory helps a
vehicle manufacturer to keep costs in check for subsequent designs e.g. for derivative model
families of their product portfolio. This means that, for any layer choice to be tried, the
constituent components of the cell is to be arranged and contained within the same pouch (of
fixed exterior dimensions). This naturally leads to the assumption that the thickness of the
pouch material used shall remain constant throughout, which in-turn implies that the overall
height of the electrochemical stack within the pouch is constant. The detailed calculations of
the stack height is presented in section 3.4.1.




                                                  85
                          3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


    The current collectors and the separator in each electrochemical layer are assumed to have
uniform thickness irrespective of the number of layers used. Barring minor manufacturing
variability and tolerances, these values are merely factual data requiring no further justifica-
tion. For instance, a constant separator thickness was used in the design optimisation study
by Newman [26]. The final assumption from an electrochemical point of view, introduced
specifically for the first time in literature by this thesis author, is that the relative thicknesses
of each electrode is held constant to a fixed ratio. This warrants further explanation, but is ill-
suited for this introductory discussion. The details of this aspect are discussed in section 3.5.6.
Certain assumptions are to be made about the temperature distribution within the layers
owing to the choice of cooling arrangement. These aspects merit more than a cursory listing
in this introductory section and hence is discussed in section 3.3.3.


3.2.2    Motivation

This section provides a qualitative description of the effect of varying the number of layers
within a pouch cell and presents the motivation to embark upon this layer optimisation effort.

    Based upon the discussion in section 3.2.1, it is clear that by changing the choice of layer
counts accommodated within a pouch of fixed height, the thicknesses of the two electrodes
within each unit cell has to be suitably recomputed. Such use of different electrode thicknesses
imply that the electrochemical-thermal behaviour of a cell constructed with one particular
layer count shall be different from those employing any other layer count. With very few
layers, thicker electrodes can be used. This implies that a higher utilisation of the available
pouch volume can be used towards energy storage leading to higher theoretical capacity
for these cells. Based on the discussion thus far, using low layer counts to construct cells
may seem appealing for range extension of xEVs. However, prior to this, certain application-
specific aspects of designing cells for automotive packs must be duly considered.

    Thick electrodes resulting from using low layer counts present an increased impedance
for the diffusion of lithium ions through their microporous structure, which implies that
when operating under even moderate external loads, the cell may hit voltage cutoffs before
all the stored energy can be extracted. Thus, with ultra low layer designs, the power handling
capability of the cell suffers. The requirement of evenly distributing the external load power
over the available active surface area without inducing large overpotentials necessitates a

                                                 86
                          3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


certain minimum number of layers. With higher layer counts, the increased active surface area
translates to a reduced power density, which in-turn leads to a lower rate of heat generation.
Furthermore, with increased layer counts, the fraction of pouch volume occupied by current
collectors is proportionately higher. This leads to more conduction pathways to help channel
heat generated away from the cell’s interior which helps in faster cooling. With high layer
counts, this aspect of lower heat generation coupled with its faster removal leads to an overall
reduction in cell’s temperature, which helps to extend the pack’s lifetime owing to a reduced
degradation rate.

   In summary, for very low number of layers, there exists more active material, leading
to a high energy capacity. However, the reaction surface area is diminished proportionately
leading to lower power capability. Furthermore, owing to the presence of very thick electrodes,
the current density within the solid conductive matrix shall not be homogeneous [129],
nullifying some fundamental modelling assumptions of the standard Doyle-Fuller-Newman
(DFN) model. On the other hand, very high number of layers imply vanishingly thin electrodes
and correspondingly less active material accommodated within the cell, thereby resulting in
a lower energy capacity. Figure 3.1 shows a qualitative comparison of the construction of one
layer of an energy cell versus power cell which illustrates all the aspects discussed thus far.




  Figure 3.1 Schematic depicting a qualitative comparison of the construction of one layer of
  a high-energy cell versus a high-power cell. The illustration at top depicts one layer of a high-
  energy cell wherein thick electrodes are used. The bottom-left illustration depicts a single layer
  of a high-power cell wherein very thin electrode regions are used. Both cell diagrams are drawn
  to the same scale. The bottom right plot qualitatively indicates the relationship between C-rate
  and the nominal cell capacity. Illustration reproduced from von Srbik [130].
                                                 87
                              3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


    Therefore, there exists a research question on what constitutes the best layer choice
that straddles this trade-off with the least penalty to the power capability of the cell whilst
simultaneously having the maximum possible capacity. This saddle point determination needs
to be performed for a curated set of power input/output conditions to the cell. This niche
problem has not yet been tackled by researchers and therefore motivates the need to perform
a careful design study which is documented in this chapter.


3.2.3      Quantitative demonstration of energy/power trade-off

The discussion in section 3.2.2 has motivated the need for an in-depth exploration of the
energy to power trade-off expressed as a function of the number of layers. Before embarking
on constructing a framework to optimise the layer choice by formalising various constraints
that govern this optimality, this section aims to quantitatively demonstrate this relationship
by applying a fixed galvanostatic discharge to an example cell. Additionally, the crucial idea
of usable energy versus total stored energy is also introduced.

    A Lithium Cobalt Oxide (LCO) cell whose physical properties and simulation parameters
is drawn from the combined set of data from tables 3.2 and 5.2 is used as the example
cell. The only set of values that overlap between these two tables are — a) the cut-off
voltages, and b) the number of nodes used for numerical discretisation of the governing
Partial Differential Algebraic System (PDAE) equations. For these conflicting quantities, the
values in table 3.2 prevail for all simulation studies in this chapter. Furthermore, the individual
electrode thicknesses from table 5.2 are not directly used, but instead calculated for every
layer choice by keeping the ratio of their relative thicknesses constant. This aspect shall be
explained in section 3.5.6.

    Figure 3.2 illustrates the influence of the number of layers on the energy and power
capability of the example cell. Starting at 100 % State of Charge (SOC), a constant current
discharge of     60 A †   is applied to a DFN model of the cell until reaching the lower cut-off
voltage. For each discharge run, the model is reconfigured with a different layer choice. Five
distinct layer choices have been carefully chosen so as to provide a clear illustration of the
energy/power trade-off phenomenon.
    † The rationale behind choosing this specific magnitude of applied current is explained in the section dealing

with selection of a suitable reference capacity cell (also see section 3.4.1).


                                                         88
                                             3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


    As seen in fig. 3.2, during the initial phase of discharge, the terminal voltage of the
cell is the highest for the two highest layer choices i.e., 𝑛 = 90 and 𝑛 = 70. Consistent with
the explanation in section 3.2.2, these two layer choices have thin electrodes and hence
comparatively low resistances leading to only a small internal overpotential drop. However,
as expected, their total energy is lower than the cell with 𝑛 = 50 layers as evidenced by their
relative run-times until lower cut-off voltage. This is to be expected as the thin electrodes
of these high layer count cells cannot store a large volume of active material. Based on the
explanation from section 3.2.2, it is expected that this trend will continue i.e., the lower the
layer count, the higher the run-time until cut-off. If this were the case, prima facie it seems
that the layer optimisation task is trivial.

    Inspecting the discharge curves of lower layer choices brings into light the concept of
usable energy. Contrary to expectations, the discharge curves corresponding to very low layer
counts in fig. 3.2 terminate even earlier than 𝑛 = 50. This is owing to the fact that although
                                                                                                                   1

                                   4.2
                Cell voltage (V)




                                                  n=70
                                    4

                                   3.8

                                   3.6       n=10         n=30           n=90        n=50


                                         0       10     20      30     40    50
                                                Energy supplied over time (Ah)
  Figure     3.2 ‡
               Terminal voltage curves of a Li-ion cell (with parameters given in table 3.2) under
  a 60 A galvanostatic discharge beginning from 100 % SOC until lower cut-off voltage for a few
  layer choices 𝑛, in a pouch cell of fixed exterior height. The maximum usable energy is achieved
  for an intermediate choice of 𝑛 that corresponds to neither the highest nominal capacity layer
  configuration (𝑛 = 10) nor the highest electrode surface area configuration (𝑛 = 90).
    ‡ This  figure has been extensively adapted (by this thesis author, Krishnakumar Gopalakrishnan) from the
original figure created by Ian D. Campbell showing run times of cells with various layer counts instead of their
energy supplied. The copyright on the original figure prior to this adaptation is held by Ian D. Campbell, with
intellectual contributions from and the right to use asserted by Krishnakumar Gopalakrishnan.



                                                                 89
                              3.2 Energy/Power Trade-off in Pouch Cells by Layer Selection


the total stored energy in cells with low layer counts is much higher, only a fraction of it is
usable. This aspects introduces non-trivial dynamics (as discussed below) to an otherwise
linear optimisation task.

   For instance, when 𝑛 = 10, the terminal voltage of the cell collapses almost instantan-
eously, reaching cut-off voltage whilst its SOC remains as high as 96 %. At very low layer
counts, the thickness of each electrode is high. This presents a high resistance to the flow of
charges thereby leading to high overpotential drops within the cell. The usable energy under
this 60 A galvanostatic discharge for various layer choices is compared in table 3.1. It can be
seen that for very low layer counts, the usable energy that can be extracted is minuscule,
albeit their theoretical capacity 𝑄𝑛                              §
                                           are in-fact the highest . The usable energy in Wh reported
in table 3.1 is obtained by multiplying the integral of the area under each discharge curve by
the applied current (60 A) with the appropriate scaling of the time-base (i.e., conversion from
minutes to hours).
  Table 3.1 Theoretical capacity and usable energy of a Li-ion cell (with parameters given in
  table 3.2) for a few layer choices under a 60 A galvanostatic discharge.

                                    Theoretical       Usable        Remaining Resistance at
                   𝑛     C-rate
                                   Capacity (Ah)    Energy (Wh)      SOC (%) cutoff (mΩ)
                   90     1.24         48.25           166.46          9.84           0.97
                   70     1.11         53.99           184.80         10.26           1.35
                   50     1.00         59.73           195.47         13.51           3.44
                   30     0.92         65.47           101.20         58.95          10.24
                   10     0.84         71.21            10.15         96.22          11.18


   Table 3.1 also brings into view the fact that the C-rate of the cell becomes a variable
quantity even for a galvanostatic discharge, due to the dependence of its nominal capacity
on the number of layers 𝑛. This represents a departure from the norm in the modelling
community wherein the performance of cells are quantified as a function of the applied C-
rate e.g. in chapters 5 and 6 of this thesis. However, the preliminary investigation thus far has
quickly revealed that this normalised quantity does not hold much importance in any study
where the number of layers within a pouch cell is varied.

   Taking into account these factors, a reasonable choice of the number of layers in this
specific 60 A galvanostatic application for this example cell could be 𝑛 = 50. This represents
   § The   computation of theoretical capacity as a function of number of layers is discussed in section 3.6.4.


                                                       90
                                            3.3 Scope and Context within xEV Powertrain


a practical compromise between the surface area available for reaction and the total volume
of active material accommodated. Out of the finite layer configurations considered, this layer
choice offers the highest usable energy for the given discharge rate.

   In this sample study, only a handful of layer choices were considered, which represents
only a small possibility of the overall design space to be considered. Furthermore, thermal
considerations were not explored so far. For robust cell design, manufacturers shall need
a widely applicable model-led design tool that can tackle the various scenarios that can
occur in real-life operating conditions. A deterministic set of optimality criteria for the layer
selection is also to be formulated. The choice 𝑛 = 50, therefore does not represent the general
optimal layer choice even for this example cell. However, this sample study serves as an
illustrative demonstration of the trade-offs in energy versus power handling capability of
a cell for a specific set of conditions. Furthermore, it introduces the complicating aspect of
usable capacity into what would have otherwise been a trivial exercise, thereby setting the
tone for the development of a general layer optimisation framework for pouch cells.


3.3     Scope and Context within xEV Powertrain
It is important to provide the contextual setting for this layer optimisation work since it is
nestled deep within the broader horizon of electric drivetrain optimisation. Figure 3.3 provides
a graphical overview depicting the hierarchical architecture of a typical xEV powertrain, from
the system level down to a single electrochemical layer. The rest of this section describes
the scope of this layer optimisation work and its integration into this overall architecture.
A further set of assumptions that were deemed inopportune to be discussed in section 3.2.1,
is introduced at apropos junctures throughout this narrative. The overall architecture of an
xEV powertrain can be studied through a systematic, hierarchical evaluation at — a) the
system-level, b) the pack-level, and c) the cell-level.


3.3.1    System-level — vehicular platforms

The top row of fig. 3.3 represents the typical layout of a series-hybrid powertrain [30]. Partly
to supply the mechanical power and/or partly to charge the battery during propulsion, a
downsized Internal Combustion Engine (ICE) is employed. The ICE is coupled to the pack’s
DC bus through a generator and three-phase rectifier. While tackling the power handling

                                                91
                                                                       3.3 Scope and Context within xEV Powertrain


requirements, irrespective of whether a BEV or PHEV powertrain is being considered, the
cells in the pack are to be designed for the worst-case operating scenario i.e., without any
power support from the ICE. This implies that all discharge simulations of the PHEV are to
be conducted with the powertrain operating in all-electric mode resulting in a net charge-
depletion. The only distinction is that the magnitude of power to be handled by the pack in
this worst case scenario is vastly different between the BEV and PHEV cases. This allows for
some simplification as explained below and helps to narrow down the scope of the problem
to be tackled.

       Omitting the components to the left of the battery pack (represented as text boxes with
light grey border) shall render a powertrain corresponding to that of a BEV. The proposed
layer optimisation methodology is developed and presented in the context of this BEV
                  “hierarchical_powertrain_to_cell_layer” — 2019/1/24 — 20:54 — page 1 — #1
                                                                                                                                                                                         −→ vf
                                                                        fastchg
                                                                       Pbatt                                                                        ηdt

                                                                                      acc
                                                                                  −→ Pbatt
                                                          +                                                                                     PMSM
Fuel                     Electric            3-phase                   Battery                   3-phase
          ICE                                                                                                                                   Motor                 Gear Box                                  Pw
                        Generator            Rectifier                  Pack                     Inverter
                                                          −                                                                                      vb




                                                         Series String of 8 Identical Modules†

                        Module      Module        Module         Module       Module         Module                                Module           Module
                          1           2             3              4            5              6                                     7                8

                                                                                                      †
                                                                                                          BEV pack : 3 parallel strings
                                                                                                          PHEV pack : 1 parallel string




                                                                                                                                                     Unit Cell (Layer)
                                                                                                                                        Pos. Electrode                Neg. Electrode
                                                                                                                                                                                         Neg. Curr. Collector
                                                                                                           Pos. Curr. Collector




12 identical series-
                                                                                                                                                          Separator




connected batteries                                  Battery
                         …




per module

                                                                                                                                  lAl        lpos         lsep             lneg        lCu




                                                                                                                                             …
                                                                                                                                                                                        x
                                                                                                                                                                            …



  Figure        3.3 ¶
               Schematic depicting the vehicle-to-cell hierarchical overview of a typical electrified
  powertrain architecture. This represents the system-level context within which the proposed
  layer optimisation framework has been developed. Two xEV powertrains — a) a Battery Electric
  Vehicle (BEV), and b) a series Plug-in Hybrid Electric Vehicle (PHEV) are chosen as examples to
  demonstrate how the methodology facilitates common module designs for such battery packs.
       ¶ This
           figure was created by Krishnakumar Gopalakrishnan who asserts copyright, with intellectual
contributions from and the right to use asserted by Ian D. Campbell.


                                                                             92
                                              3.3 Scope and Context within xEV Powertrain


powertrain. However, being a modular framework, the optimisation methodology may be
readily extended to a PHEV powertrain.

    As shown in fig. 3.3, the BEV powertrain typically comprises of — a) a battery pack,
b) a three phase inverter, c) a Permanent Magnet Synchronous Motor (PMSM), d) a gearbox
for torque multiplication, and e) the rest of the powertrain (differential shaft and driven
wheels). Considering the worst-case scenarios, the power to be handled by the battery pack
                                                       fastchg
arises due to — i) fast charging from the mains       𝑃batt      (charge), or ii) acceleration from
standstill    acc
             𝑃batt   (discharge). The acceleration power is computed from the power required at
the wheels 𝑃w . The details of this calculation is presented in section 3.5.2. The sign convention
used in this chapter is that the charging power is positive (and consequently, the discharging
power is negative).


3.3.2    Pack-level — strings, modules & cells

Delving into the battery pack under consideration, this thesis considers a standard modular
layout wherein the PHEV pack has one string while the BEV pack has three parallel strings,
in congruence with a contemporary pack design [131]. Within each string, both vehicular
platforms employ 8 series-connected modules. Taking cognisance of the benefits of common
module design, identical pack modules are assumed across both xEV platforms which is then
extrapolated to impose a stronger condition of identical geometry for the constituent cells
(see section 3.2.1). The exterior dimensions of the pouch cells under consideration are listed
in table 3.2.

    Each module consists of 12 identical series-connected cells denoted by battery circuit
symbols (cyan-filled blocks in fig. 3.3). The PHEV pack is smaller and consists of only     1/3rd   of
the cells in the BEV pack. Assuming that the BEV pack consists of a 96S-3P cell assembly,
this implies that the PHEV pack shall conform to a 96S-1P layout. The DC bus voltage is
unaltered since both packs have same amount of series cells. The power flow is assumed to be
uniformly distributed across all the cells within the pack(s). At first, the power required at the
terminals of the pack is computed. From this, a first-order design ball-parking of the layers
of the cell is made through a single cell simulation. This process enables reduced simulation
run-time with the conditions of one cell assumed to be representative of all cells in the pack.



                                                 93
                                            3.3 Scope and Context within xEV Powertrain


    While the aforementioned assumption of identical cell conditions across the pack
seems infeasible at first glance, three careful considerations have been made to justify this
assumption. Firstly, power (and not current) is used as the stimulus to the cell. This implies
that, despite the parallel connection of cells (in groups of three cells within each module),
                                                  𝑃batt
each cell experiences the same power, 𝑝cell =     𝑛cells .   Even across parallel-connected strings,
the power handled by each cell shall be the same. This necessitates the modification of
the standard DFN model in order to accommodate power inputs which is discussed in
section 3.4.2. Such a modification assumes particular significance in the context of making
the model amenable to a charging scheme wherein the control algorithm in a modern grid
charger’s power electronics enable it to continuously operate close to its power-delivery
limits with suitable voltage feedback from the battery pack. Secondly, although the current in
all cells of a series string remain the same (by virtue of Kirchoff’s current law), their terminal
voltage levels could drift away from each other and becomes unbalanced over time [3]. This
naturally raises questions on the assumption of identical conditions for all cells. However,
this voltage unbalance is mitigated with the help of modern Battery Management Systems
(BMSs) that employ balancing techniques such as passive bleeder resistors or sophisticated
active dc/dc converters. Yet another adverse effect that poses a threat to the assumption
of identical conditions is the uneven distribution of cell temperatures. In automotive packs
employing natural convection, cells that are physically located innermost in the string tend
to get hotter than the outermost cells. Through good thermal management design e.g. forced
cooling through circulation of the coolant through conduits grooved into the pack, thermal
balance may be achieved. Therefore, it can be argued that, when operating in a well-designed
and controlled environment, cell-to-cell deviations are minimised. This justifies the global
representation of all cells in the pack through a single-cell simulation, although modifications
to the simulation model are deemed necessary to facilitate power inputs and is discussed in
section 3.4.2.


3.3.3    Cell-level — layers, cooling, electrochemical & thermal models

The illustration at the centre of the bottom row in fig. 3.3 shows a schematic representation of
a cell arranged within each module. In practice, the physical layout of cells within a module
is slightly more complex. For instance, a typical arrangement consists of groups of 3 parallel
cells. However, the illustration in fig. 3.3 suffices to explain the necessary details required for
the specific task at hand.
                                                94
                                           3.3 Scope and Context within xEV Powertrain


    Each cell in the pack consists of a number of identical layers 𝑛. The words ‘layer’ and
‘unit-cell’ are used interchangeably in this thesis to denote a single basic electrochemical unit
consisting of — i) a positive current-collector, ii) a positive electrode region, iii) a separator
material, iv) a negative electrode region, and v) a negative current-collector (see fig. 1.1).
Particular attention is called out in regard to the distribution of temperature within the
cell. In the schematic of fig. 3.3 the shading scheme is such that greener tints represent
the hotter regions of the cell while bluer tints represent colder regions. The temperature
distribution within the cell as indicated by this shading scheme is consistent with that
reported in literature [132–134]. Furthermore, heat exchange with the surroundings is also
graphically illustrated through cooling plates mounted at the tabs of the cell. This highlights
the specific type of cooling assumed viz. tab-cooling as opposed to conventional surface-
cooling historically employed for automotive applications. The assumption of tab-cooling
is an essential requirement for upholding the validity of the proposed layer optimisation
scheme, and therefore warrants further justification.

    An experimental study by Hunt et al. [135] compared tab cooling of cells against
conventional surface cooling. It was found that ≈8 % increase in the usable capacity of pristine
cells was achieved with tab cooling relative to that achieved with surface cooling. Secondly,
with surface cooling, the loss rate of usable capacity over thousand cycles was nearly thrice
of that with tab cooling. This implies that using tab cooling can potentially help to extend the
lifetime of the pack by three times. Thirdly, at higher discharge rates, surface cooling resulting
in a loss of usable capacity of 9.2 % compared to just 1.2 % for tab cooling. The simulations
discussed as part of the optimisation framework reported in section 3.5 are intended to
obtain robust cell designs capable of handling worst-case power inputs. In these scenarios,
tab cooling is more appropriate. Therefore, this author has no qualms about recommending
this specific cooling mechanism to be used in conjunction with the results reported (see
section 3.6) by applying the proposed layer optimisation scheme.

    Apart from its aforementioned beneficial effects on cell longevity and performance, with
the integral assumption of tab cooling, there exists an important side effect that affects the
very core of the numerics of the layer optimisation methodology. Carefully examining the
shading scheme used for the schematic in the centre-bottom of fig. 3.3, it is clear that at
any vertical co-ordinate in space within the cell, the shading across the entire cell width


                                               95
                                           3.3 Scope and Context within xEV Powertrain


remains uniform throughout. Furthermore, it has been reported in literature that the thermal
gradients established within a unit cell are relatively small and may be safely ignored [136].
These imply that each layer along a one-dimensional cross-section of the cell is at the same
temperature. Based on the inferences from Hunt et al. [135], with tab cooling, only small
thermal gradients are induced in the planar direction. In this unique scenario, the thermal
effects within the cell are not large enough to warrant a detailed numerical discretisation. On
the other hand, ignoring the temperature distribution of the cell shall not lead to robust cell
designs, especially given that design simulations typically involve high magnitudes of power.

   In situations akin to aforementioned circumstances, a lumped thermal model of the cell
has been recommended by Pals and Newman [129]. This represents a good trade-off between
accuracy and simplicity and hence, is deemed to be appropriate for this design application.
A suitable value for the convective heat transfer coefficient ℎ (see table 3.2), comparable
to the typical magnitudes in forced air convection, is used to represent the heat transfer
from the cell to the environment. The heat exchange area is the combined surface area
of the two cooling tabs that are situated at either end of the cell. The temperature of the
coolant (a thermal ‘sink’ in thermodynamic terminology) is denoted by 𝑇sink . In this work, this
ambient temperature is held constant during the course of a simulation run, but is allowed to
change to different constant values between set of simulations as per relevant vehicle testing
standards. The details of this aspect is discussed in section 3.5. The material properties of the
constituent components of each layer coupled with the total number of layers are used to
determine the lumped mass and specific heat capacity of the pouch cell. These computations
are discussed in sections 3.5.8 and 3.5.9 respectively. The assumption of tab cooling thus
leads to this qualitative description of the lumped thermal model to be used for the design
simulations. Further quantification by way of relevant model equations and the computation
of the constituent parameters of the thermal model is embedded as an integral aspect of the
layer optimisation framework and shall be presented in section 3.5.9.

   As a final observation, all layers within the cell are electrically in parallel which implies
that their terminal voltages are identical. The current (or power) at the cell terminals is shared
equally among each layer. The aforementioned considerations have important ramifications
on the cell modelling and helps to drastically simplify it. Specifically, these considerations
imply that the electrochemical performance of any one layer is identical to every other


                                               96
                              3.4 Enhancements/Modifications to Standard DFN Model


layer. Therefore, in conjunction with a lumped thermal model, a standard Pseudo Two-
Dimensional (P2D) discretisation of the DFN model suffices to capture the electrochemical
behaviour of the entire cell. The bottom-right illustration of fig. 3.3 presents a one-dimensional
discretisation of the cell layer across its thickness. The spheres along the axial direction
represent computational nodes wherein the solid-phase diffusion equation is to be solved
(see section 1.3 for a brief overview). It is this standard DFN model, suitably amended to
accept power inputs, that will be the backbone of the electrochemical aspects of the design
simulation. The electrochemical model shall be strongly coupled in a bidirectional sense to the
lumped thermal model i.e., the temperature of the cell shall influence various cell parameters
(see table 3.2) while the overpotentials and currents in the cell shall play a role in the rate of
heat generation and cell temperature simultaneously.

    Thus, through a systematic set of simplifying assumptions that are justifiable in a real-
world design, the system-level requirements at the pack-level can be suitably scaled down to
power-density inputs at the layer level. Having established the contextual setting and scope
of this work within the broader landscape of drivetrain optimisation, it is now possible to
proceed to the set of numerical enhancements required to be incorporated into the DFN
model to handle the specific requirements of this layer optimisation task.


3.4     Enhancements/Modifications to Standard DFN Model

3.4.1    Augmentations to parameter set

Cell capacity and electrochemically active surface area

The Pseudo Two-Dimensional (P2D) implementation of the standard Doyle-Fuller-Newman
(DFN) model lacks certain parameters that are vital to the layer optimisation process. The
cell’s nominal capacity is a fundamental quantity that gets altered as the number of layers is
varied. However, it may be surprising to discover that this parameter is absent in the research
literature discussing the P2D model. The rationale behind this glaring omission becomes clear
upon closer examination of the model equations presented in table 1.1. These equations do
not operate on a cell level, but instead are formulated on a normalised basis. To clarify, only
one layer of the cell is being modelled wherein the stimulus driving the model is the applied
current density per unit area rather than the total external current. The model to be used in

                                               97
                              3.4 Enhancements/Modifications to Standard DFN Model


the layer optimisation task therefore faces a unique predicament — the need to adhere to
the present modelling paradigm for compatibility with the status quo whilst being flexible
enough to incorporate the cell’s capacity as a function of number of layers.

   To tackle the aforementioned quandary, it is key to realise that the core parameter that
varies with the number of layers in a pouch cell is the electrochemically active cross-sectional
surface area 𝐴cell . Curiously, published literature on physics-based cell modelling do not place
rigorous emphasis on this key parameter. More often, much to this author’s chagrin, this
parameter is simply listed in a standard table of parameters and is typically sourced from a
historic parameter-set without further explanation.

   For a pouch cell, the overall electrochemically active surface area can be defined as

                                        𝐴cell = 𝑛 × 𝐴elec                                   (3.1)

where 𝑛 is the number of layers and 𝐴elec is the active surface area per layer.

Surface area per layer

A literature search reveals that akin to the cell’s capacity, there is no information of cross-
sectional geometry in articles dealing with the P2D implementation of the DFN model. To
determine the surface area per layer, relying on certain assumptions and the recent literature,
a novel methodology is proposed involving a sequence of steps. The process involves the
selection of a real-world cell, and determining its surface area per layer. To the best knowledge
of the author, this reverse parametrisation process (explained next), mapping from a real-
world cell to a new P2D parameter, is a unique idea.

1) Selection of a suitable reference capacity cell

    This is a crucial first-step towards obtaining a complete parameter set — particularly to
determine the surface area per layer.

    The focus of this chapter is to provide a ready-to-use solution to industry that improves
upon the present empirical designs through optimal layer configuration of pouch cells. There
is a clear motivation to further increase cell capacities so as to maximise the All-Electric
Range (AER), as laid out in the beginning of this chapter (see section 3.1).


                                               98
                                    3.4 Enhancements/Modifications to Standard DFN Model


     With this guiding principle, as a starting point towards choosing a reference capacity
cell, a survey was performed to identify the production BEV with the highest driving range.
As of 2018, the Chevrolet Bolt BEV bears this distinction with a range of 383 km as rated by
the United States Environmental Protection Agency (EPA). The specifications of its battery
pack is listed in Liu et al. [131]. The battery pack of this BEV consists of 288 cells arranged
in a 96S-3P configuration, in agreement with the configuration discussed in the drivetrain
hierarchy of section 3.3.2.

     The Chevrolet Bolt BEV pack has an energy capacity of 60.0 kWh with a nominal pack
voltage of 350 V [131]. However, for this specific task, the Ah capacity is required. This can
be obtained as

                                                 Pack Energy (Wh)
   Ah capacity of reference cell =                                                                           (3.2)
                                   Nominal pack voltage (V) × No. of cells in parallel
                                    60000
                                 =                                                                           (3.3)
                                   350 × 3
                                 = 57.14 Ah                                                                  (3.4)

   • DC bus voltage and revised cell capacity
       Even without a dc/dc boost converter, robust design of the powertrain during brown-
  outs should allow for continued operation even with a slightly diminished DC bus voltage
  ≈4–5 % lower than nominal [30]. Considering a maximum permissible dip of 4 % in the bus
  voltage i.e., 336 V, the cell’s capacity may be refined as

                                                  Pack Energy (Wh)
     Ah capacity of reference cell =                                                                         (3.5)
                                     Lowest pack voltage (V) × No. of cells in parallel
                                      60000
                                   =                                                                         (3.6)
                                     336 × 3
                                   = 59.52 Ah                                                                (3.7)


       The reference cell’s Ah capacity is therefore rounded to                      ‖
                                                                                60 Ah .   The 1C-rate of this
  reference cell is therefore 60 A.



    ‖ Inthe interest of maintaining consistency, this computed capacity is retained for the cell used in chapters 5
and 6 of this thesis. This also explains the use of 60 A for the simulations used for demonstrating energy/power
trade-off of section 3.2.3 since this current level corresponds to the 1C-rate of this reference cell.


                                                        99
                                 3.4 Enhancements/Modifications to Standard DFN Model


      • Lower cutoff voltage for cells
         In this layer optimisation work, following the assumptions of section 3.2.1, the overall
     pack configuration remains unchanged i.e., independent of number of layers within the
     pouch. This implies that the undervoltage threshold for DC bus voltage throughout this
  work shall remain fixed at 336 V. Therefore, with 96 series connected cells in a string, the
     lower cut-off voltage for an individual cell is 3.5 V. This value is reported in table 3.2 and
     is used as a termination condition for all simulations as explained in section 3.5.

2) Computation of electrochemically overall active surface area for reference cell

       For the cell properties in tables 3.2 and 5.2, the majority of parameters are sourced
from Subramanian et al. [137] and Northrop et al. [74]. In Northrop et al. [74], the current
density that corresponds to a 1C-rate discharge of a cell with this parameter set is reported to
          −2
be ≈30 A m . With the help of carefully designed numerical simulations (very slow discharge
with a trickle current from fully charged state until charge depletion), this value is refined
to            −2
     29.23 A m ,   so as to match the residual stoichiometries in both electrodes to that quoted
in Northrop et al. [74].

       The task of determining the electrochemically active overall surface area of the reference
cell is now straightforward, and is obtained as

                                                           1C-rate for the reference cell (A)
      Overall surface area of reference cell, 𝐴refcell   =                           −2          (3.8)
                                                                1C-rate density (A m )
                                                             60
                                                         =                                       (3.9)
                                                           29.23
                                                         = 2.053 m 2                            (3.10)

This value is listed in table 5.2 for use in chapters 5–6, but is not used directly in this layer
optimisation work. This is because, as the number of layers change, the overall surface area
changes as per eq. (3.1). However, determining this value is an important initial step in the
determination of the surface area per layer.

3) Setting the pouch height for the reference cell

       Although the official press release [138] from the manufacturer of the Bolt BEV does
contain data on the cross-sectional geometry of the cell, it does not report the cell’s height.
Hence, this information needs to be assumed by extrapolation from an alternate source
wherein the conditions are similar and so that value may be applied for the reference cell.
                                            100
                              3.4 Enhancements/Modifications to Standard DFN Model


    The review article by Gröger et al. [139] discusses the state of the art in energy densities
of electrode materials used in various lithium ion chemistries. At the time of its publication,
                                            −2
the areal capacity of cells were ≈2.0 mAh cm . Gröger and colleagues recommended an areal
capacity target of   4.0 mAh cm −2   for future automotive applications. The said publication
also considers the aspect of stacking layers into pouches of certain geometries. In particular,
table IV of Gröger et al. [139] considers a pouch of 10 mm height, for which the aforementioned
areal capacities were calculated.

    In the case of the reference cell under consideration, the areal capacity is

                                                 60 000 mAh                −2
              Areal capacity of reference cell =           2 = 2.92 mAh cm                 (3.11)
                                                 20 527 cm

which is close to the desired value in automotive applications as per the recommendations in
Gröger et al.. Considering that the reference cell is based on the high energy density Chevrolet
Bolt BEV cell, a pouch height of 10 mm is justifiable for this task and is reported in table 3.2.
This numerical value is comparable to that of commercially available cells for automotive
applications. For instance, a 56.3 Ah cell with a pouch height of 7.91 mm is manufactured by
the Automotive Energy Supply Corporation [140] while a 63 Ah pouch cell with a pouch
height of 11.0 mm is available from Kokam Inc. [141]. Therefore, it is reasonable to use a value
of 10.0 mm for this 60 Ah reference cell. As per the assumptions discussed in section 3.2.1,
this value is held constant throughout the layer optimisation process.

4) Computation of stack thickness of reference cell

    The pouch material itself has a finite thickness (a value of 160 mm is used here; see table
note 𝑔 for this entry in table 3.2) and hence after accounting for this, the stack thickness
available for placement of unit cells is smaller than the pouch thickness.

                Stack thickness, 𝐿stack = Pouch height − 2 × pouch thickness               (3.12)
                                          = 𝐻pouch − 2𝑇pouch                               (3.13)
                                          =                       −3
                                              10.0 − 2 × (160 × 10 )                       (3.14)
                                    𝐿stack = 9.68 mm                                       (3.15)

The computed value of stack thickness is held constant for all layer choices trialled in the
entire layer optimisation process.

                                                  101
                                3.4 Enhancements/Modifications to Standard DFN Model


5) Determination of number of layers within reference cell

    The next step is to determine the number of layers within the reference pouch cell 𝑛refcell .
The thickness of a complete electrochemical sandwich multiplied by the number of layers
yields the total stack height

                          𝑛refcell (𝑙Al + 𝑙pos + 𝑙sep + 𝑙neg + 𝑙Cu ) = 𝐿stack                    (3.16)


    The product of number of layers and the thickness of an electrochemical sandwich cannot
exceed the overall stack height. This implies that the equality in eq. (3.16) is to be changed
to an inequality, with the upper bound of the expression on the Left-Hand Side (LHS) of
eq. (3.16) set to the stack height.

              𝑛refcell (𝑙Al + 𝑙pos + 𝑙sep + 𝑙neg + 𝑙Cu ) ≤ 𝐿stack                                (3.17)
                                                                            𝐿stack
                                                   𝑛refcell   ≤                                  (3.18)
                                                                𝑙Al + 𝑙pos + 𝑙sep + 𝑙neg + 𝑙Cu

    Since fractional layers do not have any physical meaning, the number of layers that
can be accommodated within any pouch must be an integer quantity. Therefore, 𝑛refcell is
computed as the ‘floor’ of the quantity in the Right-Hand Side (RHS) of eq. (3.18)

                                       ⎢               𝐿stack                ⎥
                           𝑛refcell   =⎢                                     ⎥                   (3.19)
                                       ⎣ 𝑙 Al + 𝑙 pos + 𝑙 sep + 𝑙 neg + 𝑙 Cu ⎦
                                       ⎢                   9.68                  ⎥
                                      =⎢                                      −3 ⎥               (3.20)
                                       ⎣ (15  +  72  + 25   + 88  + 10) ×  10    ⎦
                           𝑛refcell = 46                                                         (3.21)

The reference cell is thus determined to consist of 46 layers.

6) Computation of surface area per layer

    Substituting the values of 𝑛refcell and 𝐴refcell into eq. (3.1), the electrochemically active
surface area per layer is obtained as

                                                   𝐴refcell
                                         𝐴elec   =                                               (3.22)
                                                   𝑛refcell



                                                     102
                                3.4 Enhancements/Modifications to Standard DFN Model

                                                               6
                                                     2.053 × 10 m2
                                        𝐴elec =                                              (3.23)
                                                         46
                                                 = 44 630.43 mm 2                            (3.24)
                                                 =             −3
                                                     44.63 × 10 m 2                          (3.25)


    The surface area per layer thus computed is listed in table 3.2 and is held constant across
all layer choices tried during the layer optimisation process. This assumption is immediately
justifiable from a physical viewpoint, since the process of assembling layers is performed
along the axial thickness direction (aligned with pouch height) and is independent of the
planar (cross-sectional) direction.


3.4.2    Modification of standard DFN model to handle power inputs

As discussed in section 3.3.2, assuming identical cell conditions during operation necessitates
that the external stimulus to each cell is an applied power value. The cell’s terminal voltage
and current can be viewed as its natural response to this power input. To simulate this
condition and achieve a model-based optimal layer design, the standard DFN model, which
conventionally handles current stimuli, has to be suitably modified to accept power inputs.

   Plett [13] suggests a methodology for applying power inputs to equivalent circuit models
for simulation at a fixed sample rate. This involves converting the input power 𝑃𝑘 to a
current 𝐼𝑘 using an equivalent series resistance 𝑅0 . The value of 𝑅0 is updated at each time
index 𝑘 as per eq. (3.26).
                                                      2
                                                𝑣𝑘 − 𝑣𝑘      − 4𝑅0 𝑃𝑘
                                         𝐼𝑘 =       √                                        (3.26)
                                                        2𝑅0
where 𝑣𝑘 is the cell’s terminal voltage at time index 𝑘, evolved from the applied current up
to and including the (𝑘   − 1) th   time step.

   There are two disadvantages in using Plett’s simplified approach for the proposed layer
optimisation study. Firstly, this necessitates the quantification of a lumped electrical resistance
for a Physics-Based Model (PBM). Such an idea is at loggerheads with the fundamental
philosophy of PBMs which strive to represent a detailed picture of underlying phenomena, as
opposed to the system-level terminal behavioural characterisation facilitated by Equivalent



                                                       103
                                3.4 Enhancements/Modifications to Standard DFN Model


Circuit Models (ECMs). Translating power to current in this manner also necessitates a two-
pass conversion between the physical and electrical domains — a process likely to significantly
degrade modelling fidelity. Since the results from application of the model shall inform the
number of layers to be used in a real-world cell design, such loss of fidelity is unacceptable.
Secondly, the constraint of using fixed interval updates implies that a high-speed adaptive
time-stepping solver cannot be used for handling this power input condition. This shall slow
down the simulation speed considerably since the search space of layer combinations to be
considered is fairly large. Furthermore, the simulations have to be repeated over multiple
combinations of initial and ambient temperatures which shall significantly slow down the
model-based design simulations and offset its advantages over a conventional prototype-
based design.

   Dees et al. [142] identified the requirement of having a P2D model that can run on applied
power. However, in the aforementioned work, the relevant equations for reformulation of
solid-phase boundary conditions are not presented. An independent derivation of reformulat-
ing the P2D model to facilitate an innate power input capability is therefore provided. Since
the equations are derived for a single layer, the power density 𝑝, obtained by dividing the
applied power by the overall active cross-sectional area 𝐴cell , is used as the driving input.

                                           𝑝cell   𝑝cell
                                        𝑝=       =                                           (3.27)
                                           𝐴cell 𝑛𝐴elec


   In the P2D model, charge conservation in solid phase is given by eq. (1.6), which is revisited
below. Eqs. (3.28)–(3.29) represent the corresponding boundary conditions. In these equations,
the current density 𝑖 represents the applied input, 𝜎eff the effective electronic conductivity
and 𝑎s the specific interfacial surface area of an electrode respectively, 𝑗 the molar flux density
of lithium at the electrode surface and 𝜙s the solid phase potential.

                       𝜕         𝜕𝜙s (𝑥, 𝑡)
                           (𝜎eff            ) = 𝑎s 𝐹 𝑗(𝑥, 𝑡)                   (eq. (1.6) revisited)
                      𝜕𝑥            𝜕𝑥
                           𝜕𝜙s (𝑥, 𝑡) |
                      𝜎eff            |𝑥      = −𝑖                                           (3.28)
                              𝜕𝑥 | pos/Alcc
                                      𝑥neg/Cucc
                             𝜕𝜙s (𝑥, 𝑡) |
                      𝜎eff              |𝑥   =0                                              (3.29)
                                𝜕𝑥 | pos/sep
                                      𝑥neg/sep



                                                  104
                                3.4 Enhancements/Modifications to Standard DFN Model


   Equation (3.30) replaces the boundary condition in eq. (3.28) to use the applied power
density 𝑝 to drive the model.


                                     𝜕𝜙s (𝑥, 𝑡) |                       𝜕𝜙s (𝑥, 𝑡) |
                  𝜎effneg (𝜙s (𝑥, 𝑡)           ) | − 𝜎effpos (𝜙s (𝑥, 𝑡)           )| = 𝑝          (3.30)
                                        𝜕𝑥       |                         𝜕𝑥      |
                                                 𝑥=𝑥neg/Cucc                       𝑥=𝑥pos/Alcc


   Eqs. (3.31)–(3.32) represent constraints pertaining to physical laws and are to be satisfied.

                                               𝑣𝑖 − 𝑝 = 0                                         (3.31)
                                                    𝑣>0                                           (3.32)

Equation (3.31) conveys the condition that the product of the terminal voltage and com-
puted current density shall equal the externally applied power density, whereas eq. (3.32)
implies that the cell’s terminal voltage shall always remain positive during operation.
Eqs. (3.30)–(3.32) are then discretised for numerical implementation as follows.

   Figure 3.4 describes a schematic overview of a one-dimensional cell-centred Finite Volume
(FV) discretisation scheme. Here, evenly spaced nodes are considered to form the support
mesh along the through-thickness dimension of a layer. Vertical lines denote the edges
of control volumes whereas the filled circles depict computational nodes where the axial-
direction variables from table 1.1 are solved.




  Figure 3.4 Simplified illustration of a standard cell-centred FV discretisation scheme. Illustra-
  tion reproduced from Torchio et al. [18].


   Equation (3.33) represents the weak form of eq. (1.6) applied on the FV mesh for each
control volume, wherein subscripts 𝑘 and 𝑘 ±        1   denote the 𝑘th   FV node and its associated left
                                                    2



                                                   105
                                         3.4 Enhancements/Modifications to Standard DFN Model


and right edges respectively.

                                                                𝑥𝑘+ 1
                                                 𝜕𝜙s (𝑥, 𝑡) |       2
                                          𝜎eff              |           = 𝑎s 𝐹 𝑗𝑘 (𝑡)Δ𝑥                            (3.33)
                                                    𝜕𝑥 |
                                                                𝑥𝑘− 1
                                                                    2




   At this juncture, a simplifying approximation for the solid-phase potentials can be
considered. In the standard FV scheme, the solution values at the faces (edges of control
volumes) is obtained by interpolating from the two nearest FV node values. At either extrema
of this one-dimensional computational domain, a linear extrapolation of the values from the
first and last nodes can be performed. This increases the accuracy of computations, thereby
providing good estimates of solid potentials at the two current collector interfaces. However,
with the increased fidelity comes the penalty of a mathematically complex set of boundary
conditions. When using high node densities in the negative and positive electrode regions
(see table 3.2), for the two outermost control volumes, the values of                            Δ𝑥   become small. With
                                                                                                  2
a reasonably small mesh interval, the potentials at the cell centres can be considered to be
nearly equal to that at their corresponding current collector interfaces. This assumption helps
to keep the resulting mathematical expressions tractable.

   Applying eq. (3.33) to the first control volume                       (0 th   node) in the positive electrode and to
the last control volume        (n th    node) in the negative electrode,

                                     −𝜎effpos 𝜙s0         𝜎effpos 𝜙s1
                                                      +                 + 𝑖 = 𝑎spos 𝐹 𝑗0 Δ𝑥pos                     (3.34)
                                       Δ𝑥pos              Δ𝑥pos
                                   −𝜎effneg 𝜙s𝑛       𝜎effneg 𝜙s𝑛−1
                                                  +                     − 𝑖 = 𝑎sneg 𝐹 𝑗𝑛 Δ𝑥neg                     (3.35)
                                       Δ𝑥neg              Δ𝑥neg


   Multiplying eq. (3.34) by 𝜙s0 and eq. (3.35) by 𝜙s𝑛 and subtracting,

            2
  −𝜎effpos 𝜙s0                2
                     𝜎effneg 𝜙s𝑛       𝜎effpos 𝜙s0 𝜙s1        𝜎effneg 𝜙s𝑛 𝜙s𝑛−1
                 −                 +                      +
     Δ𝑥pos            Δ𝑥neg               Δ𝑥pos                   Δ𝑥neg
                                                              + 𝑝 − 𝑎spos 𝐹 𝑗0 𝑥pos 𝜙s0 − 𝑎sneg 𝐹 𝑗𝑛 𝑥neg 𝜙s𝑛 = 0 (3.36)




                                                                 106
                              3.4 Enhancements/Modifications to Standard DFN Model


   Two solutions exist for the quadratic equation in eq. (3.36). However, the solid phase
potential, being a physical quantity of the cell, has a unique solution. Therefore, in order
to achieve numerical convergence, an additional positivity constraint, the FV-discretised
equivalent of eq. (3.32), is imposed.

                                         𝜙s 0 − 𝜙 s 𝑛 > 0                                  (3.37)

Finally, since the input to the model is the applied power density 𝑝, in addition to the cell’s
terminal voltage, the current density within each layer 𝑖 at each time-step needs to be solved.
This is facilitated by employing the discretised form of eq. (3.31). Furthermore, since this
equation is mathematically simple, the aforementioned assumption of using node values at
current collector interfaces is no longer required. Applying a linear extrapolation scheme at
the outermost control volumes, the algebraic residual equation is obtained as

                                                 𝑝
                          0=𝑖−                                                             (3.38)
                               1.5𝜙s0 − 0.5𝜙s1 + 0.5𝜙s𝑛−1 − 1.5𝜙s𝑛−1

The computer code used (LIONSIMBA v2.0, to be discussed in section 3.6.1) employs the
Differential Algebraic Equation (DAE) solver IDA [143] to handle such algebraic constraints.

   Eqs. (3.36)–(3.38) therefore represents the discretised form of the reformulated boundary
condition and associated algebraic constraints for the solid phase potential Partial Differential
Equation (PDE) that can be applied to either electrode to facilitate the use of an input power
density to the P2D model.


3.4.3    Hybrid spectral-FV scheme

Fast and accurate estimation of the solid phase lithium concentration, particularly its value
at the surface of electrode particles is an inherent requirement of the layer optimisation
procedure presented in section 3.5. The high power densities to be handled, particularly
at low layer counts necessitate this requirement. It has been acknowledged that solid-
phase concentration calculations employing polynomial approximations lack fidelity at high
charge/discharge rates [92]. Hence, a conventional full-order solution based on Fick’s law of
diffusion is required for this layer optimisation task.



                                              107
                                 3.4 Enhancements/Modifications to Standard DFN Model


   With full-order solid phase diffusion dynamics, applying the FV scheme (that has been
employed in LIONSIMBA v1.0x (see section 3.6.1 for a discussion of this modelling platform)
to discretise all through-thickness PDEs of the P2D model) results in a very large system
of equations. This is due to the requirement of using a high radial node density per
spherical particle for improved accuracy. Consequently, the computational cost is high and
simulation run-time becomes prohibitive when exploring the search space of all possible
layer configurations. Moreover, with a cell-centered FV discretisation, it is non-trivial to
directly apply the ionic flux boundary condition at the particle surface, since this involves
extrapolation from at least two other nodes within the particle. While such extrapolations
are acceptable in the axial dimension — particularly with high node densities providing
small values of   Δ𝑥   — they are undesirable in the radial dimension. This is because the cell’s
                   2
Open Circuit Potential (OCP) and terminal voltage strongly depends on the concentration
at the particle surface. Spectral methods offer a combination of high accuracy and speed
while permitting the use of a lower number of radial discretisation nodes. To implement a
spectral scheme on a non-periodic domain, a Chebyshev discretisation [70] may be applied.
Bizeray et al. [76] discretised all of the P2D model equations using this approach. However,
this entails a bi-directional mapping of all field variables between the physical and Chebyshev
domains, incurring computational overhead.

   For the proposed layer optimisation simulations, a hybrid formulation of the P2D model
is proposed wherein a standard FV scheme in the axial dimension and a spectral scheme in
the radial domain are used. Exploiting this natural separation of the axial and radial domains
enables to — i) retain the ability to easily couple the molar flux density at the particle surface
through reformulation of the boundary conditions of the solid diffusion PDE, and ii) solve for
solid-phase lithium concentration in the Chebyshev domain and locally transform to physical
domain, without requiring system-wide Chebyshev reformulations. Although the proposed
implementation does not globally employ a spectral scheme, the combined beneficial effects
of radial-domain spectral scheme and automatic differentiation of system equations using
CasADi [144] facilitate rapid simulations, enabling the completion of the layer optimisation
in a short duration. Eqs. (3.39)–(3.42) detail the steps leading up to the reformulated solid
phase diffusion and its associated boundary conditions in the Chebyshev domain.




                                                108
                                3.4 Enhancements/Modifications to Standard DFN Model


   Figure 3.5 depicts the schematic of a standard Chebyshev discretisation. For solving the
solid-phase diffusion equation, 𝑁r Chebyshev collocation nodes defined on a 1D mesh in
the radial direction is employed. The nodal co-ordinates are the roots of the Chebyshev
polynomials of the first kind and are given by eq. (3.39) (see Trefethen [70]).

                                     𝑖𝜋
                          𝑟 ̃ = cos ( ) ,      𝑖 = 0, 1, … 𝑁r   𝑟 ̃ ∈ [−1, 1]                  (3.39)
                                     𝑁r




  Figure 3.5 Schematic of the discretisation process depicting the generation of Chebyshev
  collocation nodes. A unit semicircle in the upper quadrants of a standard Cartesian plane is
  uniformly divided, whose projections on the horizontal co-ordinate axis through the origin yields
  the location of the Chebyshev nodes. Illustration reproduced from Johnson [145].

   Assuming constant diffusivity, expanding the derivative in the standard form of the
Fickian spherical diffusion equation (see eq. (1.3)) for each particle, we obtain eq. (3.40),
presented along with its Neumann boundary conditions, eqs. (3.40a) and (3.40b). 𝑗 is the
molar flux density         −2 −1
                     (mol m s )     and 𝑅p is the particle radius (m).

                                𝜕𝑐s           2 𝜕𝑐     2
                                                      𝜕 𝑐
                                          eff      s     s
                                       = 𝐷s (        + 2)        𝑟 ∈ [0, 𝑅p ]                  (3.40)
                                𝜕𝑡            𝑟 𝜕𝑟    𝜕𝑟
                               𝜕𝑐s |
                                   || = 0                                                    (3.40a)
                               𝜕𝑟 𝑟=0
                         eff   𝜕𝑐s |
                        𝐷s          || = −𝑗                                                  (3.40b)
                               𝜕𝑟 𝑟=𝑅p




                                                109
                                                                       3.5 Computational Framework


   Mapping 𝑟 ∈ [0, 𝑅p ] ↦ 𝑟 ̃ ∈ [−1, 1],

                                                  𝑅p
                                               𝑟=    (𝑟 ̃ + 1)                               (3.41)
                                                   2


   Applying eq. (3.41) to eqs. (3.40)–(3.40b) whilst retaining 𝑐s in the physical space yields
eqs. (3.42)–(3.42b).

                                        𝜕𝑐s         eff
                                                   𝐷s           2 𝜕𝑐s     2
                                                                         𝜕 𝑐   s
                                                =4   2    (              + 2)                (3.42)
                                        𝜕𝑡         𝑅p       𝑟 ̃ + 1 𝜕𝑟 ̃  𝜕𝑟 ̃
                                       𝜕𝑐s |
                                            || = 0                                          (3.42a)
                                       𝜕𝑟 ̃ 𝑟=−1̃
                                 eff
                                𝐷s     𝜕𝑐s |
                            2                || = −𝑗                                        (3.42b)
                                𝑅p     𝜕𝑟 ̃ 𝑟=1   ̃


   During the iterative solution process, the spatial gradients of solid phase lithium concen-
tration in eq. (3.42) in this case are not computed through an explicit differentiation procedure
as usual, but instead evaluated by pre-multiplying the concentration values at the collocation
nodes by a Chebyshev differentiation matrix. This particular aspect is responsible for the
inherent reduction of simulation run-time achieved by introducing a spectral method. In the
updated version of LIONSIMBA v2.0 (created specifically for this layer optimisation work;
see section 3.6.1 for a brief overview of the modelling platform), differentiation matrices
of suitable dimensions as well as the Chebyshev collocation nodes are generated using the
MATLAB function cheb.m distributed along with the book by Trefethen [70].


3.5     Computational Framework

3.5.1    Introduction and guidelines for flow diagram traversal

The methodology adopted by the proposed layer optimisation framework can be explained
by using the flow diagram in fig. 3.6. The power handled by the cell during normal operation
(evaluated by considering various drivecycles) is much lower than that experienced during
acceleration (discharge) and fast-charging (charge) scenarios. Section 3.6 provides a brief
summary of the peak and median powers across all standard drivecycles. Therefore, from a
design perspective, it is sufficient to consider the power requirements for these two extreme

                                                       110
                                                             3.5 Computational Framework


cases. Hence, the schematic in fig. 3.6 can be studied by broadly dividing the flow diagram
into two parts — i) an acceleration pathway (primarily consisting of blocks shaded in grey),
and ii) a fast-charging pathway (predominantly composed of blocks shaded in cyan).

    As indicated by the legend in fig. 3.6, blocks with a light grey border represent input data/-
parameters for computations. Blocks with a standard black border represent computations
common to both acceleration and fast charging pathways. The design output is given by the
double-bordered block at the bottom centre of fig. 3.6. Other types of blocks and arrows are
appropriately listed in the legend key. To aid the understanding of the layer optimisation
framework, the reader is encouraged to correlate the narrative in this section with the blocks
and arrows in the schematic. The acceleration and fast charging pathways are not amenable
for standalone comprehension and are to be parsed in conjunction with the flow of control
through the infrastructure blocks as if the entire flow diagram is a single cohesive unit. These
‘control’ blocks, common to both pathways in fig. 3.6, govern how these two pathways are to
be traversed with the presently trialled layer choice and quantify the suitable reformulations
needed whenever a new layer choice is to be used. The computational aspects covered by
these blocks are described in sections 3.5.4–3.5.9.


3.5.2    Acceleration pathway

The computations for acceleration-based layer optimisation begins at the anchor block
labelled ‘Start Acc. Calcs.’.

Determination of acceleration rate, final speed and acceleration time

The first step is to determine the rate of acceleration to be used for computing the power
requirements for accelerating an xEV from standstill. For various other regulatory reasons,
vehicular standards for electrified transport are codified by various standardisation bodies
(e.g. the SAE J1772 standard [146]). The standards published by these regulatory agencies
typically specify a minimum required acceleration rate for the vehicle under consideration
to be certified as an electric vehicle. Additionally, vehicle manufacturers often provide their
own specifications, which typically exceed these minimum standards. However, for certain
classes of electric vehicles such as golf carts, the manufacturer-specified standards might fall
below that of a roadworthy electric vehicle. This thesis advocates a conservative design by
choosing the higher of the two values.
                                               111
                                                                                                                                                                                                                                                        “Konstanz_master_flow_diagram_thesismod’’ — 2019/1/16 — 2:32 — page 1 — #1
                                                                                                                                                                                                                                Key                                                                                                     Cell
                                                                                                                                                                                                                                                                                                                                     Parameters                                                                                 fastchg             fastchg
                                                                                                                                                                                                               Input Data/Parameters                                                                                                                                                                                        P                                                  Sim. params
                                                                                                                                                                                                                                                                                                                                                                                                         Start Fast-            batt               Pcell
                                                                                                                                                                                                                                                                           Start Acc. Calcs.                                                                                                                                                1
                                                                                                                                                                                                                                                                                                                                                                                                                                          n
                                                                                                                                                                                                                                                                                                                                                                                                                                           cells                              for fast charge
                                                                                                                                                                                                                                                                                                                                                                                                       Charge Calcs.
                                                                                                                                                                                                               Standard Computations




                                                         ∗∗ This
                                                                                                                                                                                                                                                                                                  Bool sel. sw. cntrl: toggle SPDT to bottom pole if astd. > aman.                                                                                                         pfastchg
                                                                                                                                                                                                               Fast Charge Computations                                    astd. >aman. ?                                                                                                                                                                         ÷
                                                                                                                                                                                                               Acceleration Computations                                                                                                                                                                                                               Acell




                                                                                                                                                               Figure 3.6
                                                                                                                                                                                                                                                                                                                                             vbase




                                                                                                                                                                         ∗∗
                                                                                                                                                                                                               Calcs. producing updated sim.
                                                                                                                                                                                                               params. for given layer                                               tfman.                                                                                                          vfman.                                                                   Thermally Coupled
                                                                                                                                                                                                                                                                                                                               tf          Compute          vf                                                                                                                 P2D Simulation
                                                                                                                                                                                                               Subset of cell params. that in-                                                                                               Pmass                                                                                                                              (fast charge)
                                                                                                                                                                                                               fluence layer calculations                                            tfstd.                                                                                                          vfstd.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  results(t ≤ tmax )
                                                                                                                                                                                                               Design Output
                                                                                                                                                                                                               (optimal layer choice)                                                                                                  ρair , Cd , Av




                                                                                                              for Li-ion pouch cells.
                                                                                                                                                                                                                                                         Cell Parameters
                                                                                                                                                                                                               Start of Acc/Fast Chg Pathways
                                                                                                                                                                                                                                                                                                                                           Compute                                                                                                                     no
                                                                                                                                                                                                                                 Composite Signal                                                                                                                                                                                                                                 T (t) < Tmax ?
                                                                                                                                                                                                                                                                                                                                             Pdrag
                                                                                                                                                                                                                             Layer Iteration n(i)                                                                                                                                                   Mc
                                                                                                                                                                                                                            Updated sim param.
                                                                                                                                                                                                                                                                                                                                                Cr                                                  Mp
                                                                                                                                                                                                                Sim. params.                            acc
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             yes
                                                                                                                                                                                                                                                       Pcell                                   acc
                                                                                                                                                                                                               for acceleration                                                        1
                                                                                                                                                                                                                                                                                              Pbatt      1      Pw                         Compute                           Mv
                                                                                                                                                                                                                                        tf                                           ncells                              Σ                                                          Σ
                                                                                                                                                                                                                                                                                                        ηdt                                    Proll
                                                                                                                                                                                                                                                ÷          Acell
                                                                                                                                                                                                                                                                                                                                                                                                    Mo
                                                                                                                                                                                                                                                                                                                                           Z           g                                                                                                               no
                                                                                                                                                                                                               Thermally Coupled                                                                                                                                                                                                                                                  V (t) < Vmax ?
                                                                                                                                                                                                                                             pacc                                                                                                                                           Mcells
                                                                                                                                                                                                                P2D Simulation
                                                                                                                                                                                                                                                                                                                                           Compute
                                                                                                                                                                                                                  (discharge)                                                                                                                                                                       ncells
                                                                                                                                                                                                                                                                                                                                            Pgrade

                                                                                                                                                                                                                           results(tf )




112
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             yes
                                                                                                                                                                                                                                                                                                                                                                                                                                   Compute cavg
                                                                                                                                                                                                                                                                                                                                                                                            mcell
                                                                                                                                                                                                                                                                                                                                                                                                     Σ                                     cAl , cpos , cneg , cCu
                                                                                                                                                                                                                                        no                                                                                                                                                                                                 csep , cpouch , cLiPF6          no
                                                                                                                                                                                                                  T (tf ) < Tmax ?                                                                                                                                                                                                                                                    c∗s < cs,sat
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     advance simulation further in time




      contributions from and the right to use asserted by Ian D. Campbell.
                                                                                                                                                                                                                                                                                                                                                           Aelec                                  Compute:
                                                                                                                                                                                                                                                                                                                ×
                                                                                                                                                                                                                                                                                                                                                                                                  mAl , mpos , mneg , mCu                       Lpouch , Wpouch
                                                                                                                                                                                                                                                                                                                                                                                                  msep , mpouch , mLiPF6
                                                                                                                                                                                                                           yes                                                                                                                                                                                                                                                               yes
                                                                                                                                                                                                                                                                             nmin = 1


                                                                                                                                                                                                                                                                                                                                     (i)
                                                                                                                                                                                                                                                                                                                                                                                            lAl                                 εs,pos
                                                                                                                                                                                                                                        no    Bisect Customised Binary                                        Search     use new n                     Compute:                                                                                                       no                             yes
                                                                                                                                                                                                                  V (tf ) > Vmin ?                                                                                                                                                          lsep                                εs,neg                                                t < tmax ?
                                                                                                                                                                                                                                             Upwards Search Algorithm                                       Converged?    no                            lneg , lpos
                                                                                                                                                                                                                                                                                                                                                                                            lCu
                                                                                                                                                                                                                                                                                                                                                                                                              ρAl , ρpos
                                                                                                                                                                                                                                                                                                                                                                                                              ρneg , ρsep
                                                                                                                                                                                                                                                                                                                                                                                   Lstack                    ρCu , ρpouch
                                                                                                                                                                                                                                                                                                                 yes                                                                                           ρLiPF6
                                                                                                                                                                                                                           yes




                                                                                                                                                                                                                                                                            Bisect
                                                                                                                                                                                                                                                                                                                                                                                   Compute nmax                                 Compute lratio




                                                                                                                                                                                                                                                           Downwards
                                                                                                                                                                                                                                      yes                     Store                                                                                                                                                                                                    yes
                                                                                                                                                                                                                   z(tf ) > zmin ?                                                                                                                                                                                                                                                    z(t) ≥ z ∗ ?
                                                                                                                                                                                                                                                       nfeas = n(i)


                                                                                                                                                                                                                                                                                                                                                               fastchg
                                                                                                                                                                                                                                                        acc    (k)    (k)                                                                  nopt = max(nacc
                                                                                                                                                                                                                                                                                                                                                       opt , n opt     ),                               fastchg (k)   (k)
                                                                                                                                                                                                                                                       nopt (Tinit , Tsink )                      = nfeas                                                        ∀ Tinit , Tsink
                                                                                                                                                                                                                                                                                                                                                                                                       nopt (Tinit , Tsink )                 = nfeas




                                                                                                                           Flow diagram depicting an overview of the proposed layer optimisation methodology
                                                                                                                                                                                                                           no                                                                                                                                                                                                                                                          no




                 figure was created by Krishnakumar Gopalakrishnan who asserts copyright, with intellectual
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          3.5 Computational Framework
                                                                3.5 Computational Framework


    The acceleration rate is calculated by dividing a pre-determined final speed 𝑣f by the
time 𝑡f taken to attain that speed from standstill. The manufacturer-specified acceleration
rate 𝑎man. is compared against the minimum acceleration rate specified by the governing
vehicular standards 𝑎std. . The two Single Pole Double Throw (SPDT) switches assign the final
speed 𝑣f and acceleration time 𝑡f using the corresponding values from the appropriate source
depending on which of the two acceleration rates is higher.

Computation of acceleration power at the wheels

The next step is to calculate the acceleration power required at the driving wheels 𝑃w . Using
the governing equations from basic vehicle dynamics (See Maksimovic [30]), the power at
the wheels of an xEV is given by eq. (3.43).

                                 𝑃w = 𝑃mass + 𝑃drag + 𝑃roll + 𝑃grade                        (3.43)
                                         1 𝑀v (𝑛) 2       2
                              𝑃mass    =           (𝑣b + 𝑣f )                             (3.43a)
                                         2 𝑡f
                                         1             3
                              𝑃drag    = (𝜌air 𝐶d 𝐴v 𝑣f )                                 (3.43b)
                                         2
                               𝑃roll   = 𝐶r 𝑀v (𝑛) 𝑔𝑣f                                     (3.43c)
                             𝑃grade = 𝑀v (𝑛) 𝑍 𝑔𝑣f                                        (3.43d)


    The individual components contributing to the summation for wheel-power computation
presented in eq. (3.43) is briefly explained. 𝑃mass represents the power required to accelerate
the vehicle’s mass. 𝑃drag and 𝑃roll denote the powers required to overcome air resistance and
rolling resistance respectively. Finally, 𝑃grade represents the power required to negotiate a road
gradient. Except for 𝑀v (𝑛) which is described next, all terms in the RHS of eqs. (3.43a)–(3.43d)
are constants. The nomenclature for each of these terms is explained in tables 3.3 and 3.4
along with their numerical values used in simulation.

Computation of layer-dependent vehicle mass

Changing the layer count used within a cell changes its mass. This in-turn affects the mass of
the pack, which further influences the overall vehicle mass. Hence, for precise computation
of 𝑃mass in eq. (3.43a), the vehicle’s mass is computed as a function of number of layers within
each cell.

                                                 113
                                                                   3.5 Computational Framework


    In the schematic of fig. 3.6, this layer-dependent calculation of mass of all cells in the
pack 𝑀cells is shown by the product of the signal labelled 𝑚cell and the triangular gain block
representing the overall number of cells in the pack 𝑛cells .

                                              𝑀cells = 𝑛 × 𝑚cell                                (3.44)


    The mass of the vehicle is given by the sum of chassis mass 𝑀c , vehicle payload 𝑀p , pack
overhead 𝑀o and the layer-dependent mass of all cells in the pack 𝑀cells as computed in
eq. (3.44). The computation of mass of a single cell 𝑚cell is detailed in section 3.5.8.

Computation of acceleration power density per layer

Since the P2D equations of the DFN model are based upon a normalised unit area and is
applicable only to each electrochemical layer, the goal is to compute the power density
experienced by each layer. This is arrived at by a sequence of simple scaling steps.

                                                       acc
    Firstly, the power demanded at the pack terminals 𝑃batt        is computed by dividing the power
at the wheels by the efficiency of the drivetrain. As explained in section 3.2.1, the drivetrain
consists of a number of components, the efficiencies of which depend on the operating point
(such as the speed and torque of the electric motor, current drawn by the power electronics
etc.). Following the assumptions detailed in section 3.2.1, a single lumped efficiency 𝜂dt can
be used for the powertrain. The power demand on the pack is then divided by the number
of cells in the pack 𝑛cells to obtain the power demand at the input of the cell’s terminals        acc
                                                                                                  𝑝cell .
For each layer choice 𝑛, the overall electrochemically active surface area is computed using
by using eq. (3.1), wherein the surface area per layer 𝐴elec listed in table 3.2 is held constant
throughout. Finally, the acceleration power density per layer          𝑝 acc   is computed by dividing
 acc
𝑝cell   by the overall surface area 𝐴cell .

Thermally-coupled P2D simulation and exit conditions

For the presently trialled layer choice 𝑛, a thermally-coupled P2D simulation is performed
                                                             acc
for a duration of 𝑡f seconds with the applied power density 𝑝cell       corresponding to the present
layer choice as input to the model. When the simulation terminates, the cell’s condition is
compared against the following three criteria:


                                                     114
                                                              3.5 Computational Framework


   1. the maximum possible values of cell temperature 𝑇max ,

   2. the minimum allowed terminal voltage 𝑉min , and

   3. the lowest allowed cell SOC 𝑧min .

This helps to determine whether the cell constructed from the present layer choice is able
to successfully satisfy the acceleration power demands. These comparison operations are
represented by decision blocks placed in the leftmost region of the schematic in fig. 3.6.

    If any one of the three aforementioned exit checks fail, the present layer configuration is
deemed to be not feasible and the entire workflow is repeated by trialling a new layer choice.
A sophisticated search algorithm, to be described in section 3.5.4, is employed to minimise the
                                                             acc
number of iterations needed until a successful layer choice 𝑛opt   is obtained. The above process
is repeated for different combinations of initial and ambient temperatures (𝑇init , 𝑇sink ). The
largest successful layer value from all temperature combinations is deemed as the canonical
optimal design choice when considering acceleration demands. This concludes the narrative
describing the acceleration-specific pathway.


3.5.3    Fast-charging pathway

The workflow describing the optimal layer calculation for the fast charging scenario begins
with the anchor block labelled ‘Start Fast-Charge Calcs.’ in fig. 3.6. The charging algorithm
used in this framework is based upon the model-based strategy proposed by Choe et al. [147],
wherein the surface concentration is never allowed to exceed its saturation value. Adopting
this charging scheme leads to a robust cell design that is resilient to lithium plating. A major
departure from the scheme in Choe et al. [147] is the fact that the constant current phase used
therein is replaced by a constant power phase. This is so that the assumption of identical
conditions across all cells in the pack holds true (see section 3.2.1 for details). Furthermore, the
pulsing phase used to top-up the cell’s SOC in Choe et al. [147] is omitted. This is because, the
level 3 fast charging specifications typically require charging to a target SOC that is typically
well below 100 % (see table 3.2).

                                                                  fastchg
    At first, the charging power applied at the pack’s terminals 𝑃batt      is scaled down by the
overall number of cells in the pack. This results in the charging power experienced by each


                                                115
                                                                   3.5 Computational Framework

                    fastchg
cell in the pack   𝑃cell .    Following the strategy used in section 3.5.2, the power at the cell’s
terminals is scaled down by the electrochemically active overall surface area 𝐴cell . This yields
the power density     𝑝 fastchg   experienced by each layer in the cell and is now amenable to be
applied to the normalised P2D equations of the DFN model (that has been suitably modified
to handle power inputs).

Thermally-coupled fast-charging simulations and exit conditions

After computing the power density per layer, the thermally-coupled P2D model is then
invoked. While the simulation runs, the cell’s state is continually evaluated against various
termination criteria.

   1. the maximum possible values of cell temperature 𝑇max ,

   2. the maximum allowed terminal voltage 𝑉max , and

   3. the surface concentration         ∗
                                       𝑐s   not to exceed the saturation concentration 𝑐s,sat

   If any of these three criteria are violated, the simulation immediately stops and the
trialled layer choice is deemed to not satisfy the fast charging power requirements. The
search algorithm then updates the layer choice suitably and the entire workflow is repeated.

   If the simulation for any layer choice passes the aforementioned termination criteria,
the SOC achieved by the cell is compared against the fast-charging target               ∗
                                                                                       𝑧.   If 𝑧(𝑡) >    ∗
                                                                                                        𝑧,
then the present layer choice represents the minimum (and therefore optimum) value for
                                                                                             fastchg
this specific fast charging application. The successful layer choice is labelled            𝑛opt .      If
the surface concentration has not yet reached the saturation limit, then the charge time is
compared against the upper bound for fast charging specifications 𝑡max . If this preset duration
has not been reached, then the simulation is allowed to advance further in time, with the
aforementioned termination criteria being continuously tested at each subsequent time-step.

   The above process is repeated for different combinations of initial and ambient temper-
atures (𝑇init , 𝑇sink ). The largest successful layer value from all temperature combinations is
deemed as the canonical optimal design choice when considering the fast charging power
demands. This concludes the narrative describing the fast charging pathway.



                                                     116
                                                              3.5 Computational Framework


   Finally, the maximum of the layer choices across all temperature combinations from the
acceleration and fast charging scenarios is deemed as the globally optimal number of layers to
be used for this model-led cell design. The maximum value is chosen because, if any smaller
layer count is used to construct the cell, that design shall fail to satisfy its power requirements
without violating at least one termination criterion. Hence, the worst case runs across all
desired thermal scenario under which the cell is intended to operate shall inform the final
design choice.


3.5.4    Search algorithm

A customised binary search algorithm is designed for the layer optimisation framework. Bin-
ary search is a computationally efficient search algorithm requiring a worst-case operational
count of 𝒪(log 𝑘) where 𝑘 is the overall number of layer candidates to be searched [148].
However, this algorithm is applicable only when the array to be searched is already sorted in
either ascending or descending order. By recognising the relationship between the magnitude
of power density applied versus the factors that deem a layer suitable or unsuitable for the
application, a customised set of ‘exit conditions’ that meet the aforementioned sorted-array
requirement can be enforced. This specific mapping is a unique idea and is claimed as a
contribution by this thesis author to the art.

   This search strategy is equally applicable (with small modifications to exit conditions as
explained next) for both acceleration and fast charging pathways.

Binary search for acceleration pathway

If all the termination criteria are successfully met, the exit condition is set to a value of 1. If
any of these conditions fail, then the exit condition is assigned a value of 0. Thus, the search
vector in this bespoke strategy consists of only two Boolean possibilities. For ultra-low layer
counts, the applied power densities are extremely high. Therefore, one of the exit conditions
is likely to fail. For very high layer counts, the power densities are very low, implying that
acceleration runs shall always be successful. When considering layer counts from the lowest
to the highest, there exists a critical transition point viz. the first layer count for which the
exit vector toggles from 0 to 1. Through a systematic bisection of the layer search space, the
search algorithm speedily converges to the optimal layer value.

                                                 117
                                                               3.5 Computational Framework


Binary search for fast-charging pathway

If all the fast-charging termination criteria are successfully met, the exit condition is set to a
value of 1. For violating any of the following three failure conditions (see section 3.5.3) viz.
exceeding a) upper cutoff temperature, or b) upper cutoff voltage, or c) the maximum allowed
charging despite encountering surface saturation, the exit condition is assigned the value of 0.
The search array is bisected by using this failed layer choice as the new lower bound. If no
termination criterion is violated, then the presently trialled layer choice is deemed a success
and the exit condition is set to 1. The search space is narrowed down by using the current
layer choice as the new upper bound.

   However, there exists possible scenarios of needing to assign a third exit condition for the
fast charging case. If the aforementioned termination criteria are not violated, but the charging
process fails to meet the target SOC specification for very high values (close to 𝑛max ) of the
presently trialled layer choice, this implies operation in a capacity-limited region (see fig. 3.11
and section 3.6 for a brief explanation of this case). The exit condition corresponding to this
failure mode is assigned a value of 2. Thus, the search vector in this bespoke strategy consists
of three distinct numbered exit conditions. Despite being a failure, from the perspective of
narrowing down the search space, this third exit condition is treated in the same way as the
second exit condition i.e., the trialled layer choice is deemed to be too high, which implies a
downward bisection for the next search iteration.

   Akin to the acceleration pathway, the optimal layer choice for fast charging is deemed
to be at the critical transition point wherein the exit condition toggles from 0 to 1 and
hence, minimal customisation is needed in the computer code to handle these two cases.
The handling of exit condition 2 is shown in the lower rightmost portion of fig. 3.6. Despite
being a failure, from the search algorithms point of view this is treated as a success, with
the only difference being the assignment of the exit condition value purely for logging and
debugging purposes.

Alternative search algorithm — linear search

A simpler alternative to using the binary search algorithm is the standard linear search
algorithm. This is a simple search strategy which involves sequentially iterating from 𝑛min
to 𝑛max until arriving at the lowest value       acc
                                                𝑛opt   that satisfies all the termination criteria.

                                               118
                                                                   3.5 Computational Framework


However, a naive use of the linear search algorithm is computationally expensive with a
worst case operation count of 𝒪(𝑛). Therefore, this thesis author recommends the use of the
bespoke binary search algorithm. The choice of minimum and maximum values for the layer
search space is discussed in section 3.5.5.


3.5.5    Upper and lower bounds on search space

It is helpful to determine the highest possible number of layers that can be physically
accommodated in a stack of height 𝐿stack . For instance, this value may be used as the upper
bound to the binary search algorithm (which compulsorily requires such an upper bound)
described in section 3.5.4. This can be obtained by defining a simple integer optimisation
task as shown in eq. (3.45). The objective function here is to maximise the value of the layer
count 𝑛 subject to the physical constraint that the thicknesses of both electrodes always
remains positive.

                    max 𝑛
                    𝑛∈ℕ
                                     𝐿stack − 𝐿Al (𝑛) − 𝐿Cu (𝑛) − 𝑛𝑙sep
                     s.t.   𝑙pos = (                                     )>0              (3.45)
                                                  𝑛(1 + 𝑙ratio )
                                     𝑙ratio (𝐿stack − 𝐿Al (𝑛) − 𝐿Cu (𝑛) − 𝑛𝑙sep )
                            𝑙neg = (                                              )>0
                                                     𝑛(1 + 𝑙ratio )


   Equation (3.46) represents the analytical closed-form solution to the integer optimisation
problem of eq. (3.45).

                                   ⎢ 2 (𝐿stack − 𝑙Cu ) ⎥ ⎢ 2𝐿stack − 𝑙Al − 𝑙Cu ⎥
                    𝑛max    = max (⎢                      ⎥, ⎢                      ⎥)    (3.46)
                                   ⎣ 𝑙 Al + 𝑙 Cu + 2𝑙 sep ⎦⎣   𝑙 Al + 𝑙 Cu + 2𝑙 sep ⎦


   The first argument to the max function in eq. (3.46) represents the maximum number
of physically feasible odd layers while the second argument represents the maximum such
value when considering odd layers. Therefore, the greater of these two values is chosen as
the maximum permissible layer choice 𝑛max and is used as an input to the search algorithm.

   In the absence of published information on how the minimum layers within a pouch cell
is currently set, there is presently no unique way to determine 𝑛min . Therefore, for this layer
optimisation study, the value of 𝑛min used by the search algorithm is currently set to one —

                                                    119
                                                                       3.5 Computational Framework


the minimum physically feasible number of layers. Design engineers from industry may opt
to tweak this to a higher value based on insights gained from present empirical designs.


3.5.6    Electrode thickness ratio for capacity balancing

A key idea of the layer optimisation scheme is that, for computing the physical lengths of
electrodes as a function of number of layers, the ratios of their thicknesses 𝑙ratio , is held
constant. This coefficient is germane to the concept of capacity balancing of electrodes with
a view to equalise their loading. The idea of matching the capacity of anode and cathode
materials is widely accepted as a standard principle in cell design [25]. The computation of
this 𝑙ratio parameter is discussed here.

   Equating the active material volume of both electrodes,

                              𝐴elec,pos 𝑙pos 𝜀s,pos = 𝐴elec,neg 𝑙neg 𝜀s,neg                     (3.47)


   While stacking the layers within a pouch cell, for the negative electrode layers, there
exists an extra overhang of (< 2 mm) with respect to the positive electrode layers. Figure 3.7
shows a CT scan depicting the two-dimensional longitudinal-sections with a close-up view
of this overhang region. This is a design feature to prevent plating of lithium at the edges.




  Figure 3.7 CT scan showing the two-dimensional longitudinal-sections from the edge of the
  pouch cell with a close-up view of the graphite overhang region. For the negative electrode layers,
  there is an extra overhang of (< 2 mm) with respect to the positive electrode layers. This design
  feature helps to avoid plating of lithium at the edges. Image reproduced from Bond et al. [149].

   Neglecting overhangs of the negative electrode (typically < 2 mm), both electrodes have
the same cross-sectional area 𝐴elec . Therefore, eq. (3.47) reduces to

                                  𝐴
                                  elec
                                      𝑙pos 𝜀s,pos   =   𝐴
                                                           elec
                                                               𝑙neg 𝜀s,neg                    (3.48)
                                        𝑙pos 𝜀s,pos = 𝑙neg 𝜀s,neg                               (3.49)

                                                  120
                                                                3.5 Computational Framework


   Owing to the reasons outlined in section 3.2.1, the volume fractions of the electrode
materials are assumed to be constant, which implies that their ratio is also a constant. The
electrode thickness ratio 𝑙ratio is therefore obtained as

                         𝑙neg
              𝑙ratio   =                      (by definition)                            (3.50)
                         𝑙pos
                         𝜀s,pos
                       =                      (rearranging eq. (3.49))                   (3.51)
                         𝜀s,neg
                         1 − 𝜀pos − 𝜀fi,pos
                       =                      (by definition, see eq. (5.60))            (3.52)
                         1 − 𝜀neg − 𝜀fi,neg
                         1 − 0.385 − 0.025
                       =                      (substituting values from table 5.2)       (3.53)
                         1 − 0.485 − 0.033
              𝑙ratio   = 1.22                                                            (3.54)



3.5.7    Computation of electrode thicknesses per layer

In this section, a deterministic way to compute the thickness of electrode materials is
present. In the views of this thesis author, this represents a departure from the norm wherein
electrode thicknesses are designed on a trial and error basis [25]. Following the assumptions
listed in section 3.2.1, the exterior dimensions of the pouch are held constant. Furthermore,
as explained in section 3.4.1, the thickness of the electrochemical stack within the pouch
cell 𝐿stack , is also considered to be constant. Therefore, when the number of layers forming
the stack is varied, this implies that the only quantities that may be allowed to change are
the thicknesses of the two electrodes within each layer i.e., higher the layer count, lower the
electrode thicknesses and vice-versa. In this section, this relationship between the number of
layers 𝑛 and the electrode thicknesses 𝑙𝑗 (𝑗 ∈ neg, pos) is quantified with the help of the key
𝑙ratio parameter obtained in section 3.5.6.

   Figure 2 of Northrop et al. [74] (suitably adapted and reproduced in fig. 3.8) considers two
possible configurations of stacking up layers within a pouch cell. In the first topology shown
in fig. 3.8a, the outermost current collectors are of copper. In the alternative configuration
shown in fig. 3.8b, a copper current collector occupies one end of the stack while an aluminium
current collector occupies its other end. The formulae derived here is equally applicable to
both these cases. Although the use of aluminium current collectors at both extrema of the
stack is not studied, the approach presented here may be easily extended to this case.

                                               121
                                                                   3.5 Computational Framework




                                  (a) Topology 1                                     (b) Topology 2

  Figure 3.8 Two possible topologies for arranging the layers within a pouch cell. The first
  possibility entails using an even number of layers as shown in the example illustration with
  four layers in the left sub-figure. Here, both extrema of the stack are occupied by copper current
  collectors. The second possible arrangement consists of using an odd number of layers and is
  depicted in the sample illustration with three layers in the right sub-figure. This represents a
  heterogeneous topology wherein the outermost current collectors of the stack consist of copper
  at one end and aluminium at its other end. Illustration adapted from Northrop et al. [74].


   The stack height may be obtained by the sum of thicknesses of the constituent regions.

              𝐿stack = ∑ 𝐿𝑗 (𝑛) + 𝐿Al (𝑛) + 𝐿Cu (𝑛)           ∀ 𝑛 ∈ ℕ, 𝑗 ∈ {pos, sep, neg}       (3.55)
                        𝑗
where
              𝐿𝑗 (𝑛) = 𝑛𝑙𝑗                                                                      (3.55a)
                          𝑛 𝑙 ,           if 𝑛 is even
                        ( 2 ) Al
             𝐿Al (𝑛) = {                                                                        (3.55b)
                         𝑛+1 𝑙 ,          if 𝑛 is odd
                        ( 2 ) Al
                         𝑛+2 𝑙 ,          if 𝑛 is even
                        ( 2 ) Cu
            𝐿Cu (𝑛) = {                                                                         (3.55c)
                        𝑛+1 𝑙 , if 𝑛 is odd
                       ( 2 ) Cu


   The combined thickness of the two electrode regions in each layer 𝑙ce can be then obtained
by rearranging eq. (3.55)

                                    𝐿stack − ⌈0.5(𝑛 + 1)⌉𝑙Cu − ⌈0.5𝑛⌉𝑙Al
                            𝑙ce   =                                      − 𝑙sep                  (3.56)
                                                     𝑛


                                                        122
                                                                3.5 Computational Framework


   The individual electrode thicknesses can then be obtained from eq. (3.56) by suitably
substituting in 𝑙ratio and performing simple algebraic manipulations.

                                                       𝑙ce
                                          𝑙pos   =                                          (3.57)
                                                   𝑙ratio + 1
                                          𝑙neg = 𝑙ce − 𝑙pos                                 (3.58)


   The two electrode thicknesses thus obtained using Eqs. (3.57)–(3.58) are used as com-
putational domain lengths in the P2D simulations. Therefore, these thicknesses have to be
recomputed each time the trialled number of layers 𝑛 is updated by the search algorithm.


3.5.8    Computation of layer-dependent cell mass

The mass of the cell varies as a function of number of layers. This is because, the thicknesses
of the two electrodes within each layer changes each time a different layer choice is used.
Following the discussion in section 3.5.6, for computing masses of the constituent components
of a cell, the anode overhang is neglected. Therefore, the common cross-sectional area 𝐴elec is
used for all calculations. For a given layer choice 𝑛, the cell mass is computed as per eq. (3.59).



               𝑚cell = ∑ 𝑚𝑗 + 𝑚Al + 𝑚Cu + 𝑚LiPF6 + 𝑚pouch , 𝑗 ∈ {pos, sep, neg}             (3.59)
                         𝑗

                  𝑚𝑗 = 𝐴elec 𝐿𝑗 𝜀𝑗 𝜌𝑗                                                      (3.59a)
                𝑚Al = 𝐴elec 𝐿Al 𝜌Al                                                        (3.59b)
                𝑚Cu = 𝐴elec 𝐿Cu 𝜌Cu                                                        (3.59c)

              𝑚LiPF6 = 𝐴elec (∑ 𝐿𝑗 (1 − 𝜀fi𝑗 − 𝜀𝑗 ))𝜌LiPF6                                 (3.59d)
                                 𝑗

             𝑚pouch = 2𝐻pouch 𝐿pouch 𝑊pouch 𝜌pouch                                         (3.59e)


   Owing to lack of information on their thickness, the mass of the cell’s tabs has been
omitted in eq. (3.59). However, upon availability of the relevant data, this may be easily
incorporated through an equation analogous to eq. (3.59e).



                                                  123
                                                                             3.6 Results and Discussion


3.5.9      Computation of layer-dependent cell specific heat

A lumped thermal model of the cell given by eq. (3.60) is used to model the thermal dynamics
of the cell. This thermal model is coupled with the electrochemical model equations of the
P2D model for the simulations used to determine the optimal layer configurations. The cell’s
temperature 𝑇cell (𝑡) is also obtained from this lumped thermal model.

                               𝑑𝑇cell
                  𝑚cell 𝑐avg          = −ℎ𝐴tabs (𝑇cell (𝑡) − 𝑇sink ) + 𝑄pol                         (3.60)
                                𝑑𝑡
                                𝑄pol = 𝐴cell ⋅ |𝑖 | ⋅ |𝑈 − 𝑉 |                                    (3.60a)
                                                   |               |
                                   𝑈 = 𝑈pos (𝜃pos )| − 𝑈neg (𝜃neg )|                              (3.60b)
                                                   |𝑥=𝑥            |𝑥=𝑥
                                                               pos/Alcc   neg/Cucc

                                   𝑉 = 𝜙s ||         − 𝜙s ||                                       (3.60c)
                                               𝑥=𝑥pos/Alcc 𝑥=𝑥neg/Cucc



    The average specific heat of the cell 𝑐avg used in eq. (3.60) is a function of the number of
layers and is given by eq. (3.61).

          1
𝑐avg   =      [∑ 𝑐𝑗 𝑚𝑗 + 𝑐Al 𝑚Al + 𝑐Cu 𝑚Cu + 𝑐LiPF6 𝑚LiPF6 + 𝑐pouch 𝑚pouch ],          𝑗 ∈ {pos, sep, neg}
         𝑚cell 𝑗
                                                                                                    (3.61)

    The first three terms in eq. (3.61) are evaluated as a function of the number of layers 𝑛 by
substituting the appropriate layer-dependent mass values computed in eqs. (3.59a)–(3.59c).
The latter two terms i.e., the specific heats of the electrolyte material and the pouch are held
constant since their corresponding mass values do not vary with the number of layers used.

    This concludes the overall narrative describing the layer optimisation framework. The
results obtained by applying this methodology to a specific numerical example is presented
in section 3.6.


3.6      Results and Discussion
At the outset, it is worth mentioning that the focus of this chapter is on the layer optimisation
methodology itself. The results as such do not stand alone outside of the modelling universe
with all its inherent assumptions discussed thus far. Presently, the value added by this work

                                                          124
                                                                         3.6 Results and Discussion


is its ready adaptability to industry through its modular design. A numerical implementation
in the form of a toolbox     ††   is also provided which is immediately available for download
and use by relevant stakeholders. This author recommends that until the tool matures,
cell manufacturers substitute their own parameters and adjust other numerical coefficients
suitably so that the toolbox supplements, rather than supplants present empirical layer
designs. Hence, the results presented in this section must be interpreted in the backdrop
of the context within which the methodology was developed implying that the reader must
consciously strive to interpret all numerical values in relative terms of magnitude. To aid this
thought process, this author chooses to deliberately limit the discussion around the absolute
magnitude of numbers presented here.


3.6.1      Modelling Platform and Preconditioning

The complete parameter set used for simulation is presented in table 3.2. All cells are assumed
to be in their equilibrium state prior to beginning of simulations. The thermally-coupled, P2D
electrochemical model used for simulating each layer choice is implemented in MATLAB [159]
using a heavily-modified version of the LIONSIMBA toolbox [18]. The work reported in this
chapter helped to advance the toolbox from v1.0x to v2.0. The updated computer codes to
which this author heavily contributed, is available from the project’s official                     ‡‡
                                                                                          repository .

    The rationale behind choosing this specific software to implement layer optimisation is
as follows. The LIONSIMBA v1.0x toolbox has already been validated against the results of
the DUALFOIL [160] codes (which can be considered as the present benchmark standard).
The toolbox is implemented in the MATLAB programming language. Since this chapter has
a strong industry focus, the omnipresence of MATLAB in industry, its mature code-base and
familiarity was a strong motivator in the adoption of this toolbox. The simulation speeds
using LIONSIMBA have been shown to be comparable to the FORTRAN implementation of
DUALFOIL, primarily owing to the sophisticated computation of the analytical Jacobian of
the system through automatic differentiation [18]. In addition to fundamental enhancements
to the modelling platform presented in section 3.4, numerous bug fixes and other minor
   †† As an accompaniment to this chapter, an open-source software toolbox, (co-created with Ian D. Campbell
and Davide M. Raimondo) for optimal layer selection in pouch cells viz. Battery Optimal Layer Design (BOLD)
is made available for download from GitHub.
    https://github.com/ImperialCollegeESE/BOLD_Toolbox
   ‡‡ LIONSIMBA v2:      https://github.com/lionsimbatoolbox/LIONSIMBA


                                                    125
                                                                                      3.6 Results and Discussion

    Table 3.2 Cell parameters and system conditions for a simulating an LCO cell with the DFN
    electrochemical model and a lumped thermal model. These parameters, when augmented with
    the values of the kinetic, geometric and transport properties of the cell (from table 5.2) represents
    the complete information required for all simulations in this layer optimisation framework.
                                                   System Conditions
Parameter                                                            Parameter
Lower cutoff cell voltage, 𝑉min (V)                   a 3.50         Target cell SOC for fast charge, (%)𝑧 ∗              c 80.00

Upper cutoff cell voltage, 𝑉max (V)                   b 4.22                                             ∘
                                                                     Cell upper temperature limit, 𝑇max ( C)              d55.00


                                                Geometric Parameters
Parameter
Surface area of pos. & neg. electrode overlap within a layer, 𝐴elec                  2
                                                                                   (m )                            b 44.63 × 10−3

Exterior pouch length, 𝐿pouch (m)                                                                              e 332.74 × 10−3

Exterior pouch width, 𝑊pouch (m)                                                                                   e 99.06 × 10−3

Exterior pouch height, 𝐻pouch (m)                                                                                  f 10.00 × 10−3

Pouch material thickness, 𝑇pouch (m)                                                                           g 160.00 × 10−6

Stack thickness, 𝐿stack (m)                                                                                         r 9.68 × 10−3


                                                  Thermal Parameters
Parameter                                   Al. CC      Pos            Sep         Neg      Cu. CC       LiPF6            Pouch
Sp. heat capacity, 𝑐𝑗  (J kg −1    −1
                                  K )        h 903    h 1269.2        h 1978.2   h 1437.4        h 385   h 2055.1         i 1464.8
                  −3
Density, 𝜌𝑗 (kg m )                          j 2700   k 2291.6        b 1100.0   j 2660.0       l 8960   j 1290.0        m 1150.0

Activ. energy, diff. 𝐸act,s (J mol−1 )        —       p 5000            —        p 5000          —             —           —
                           𝑗
Activ. energy, rxn. 𝐸act,k             −1
                                 (J mol )     —       p 5000            —        p 5000          —             —           —
                             𝑗

                                     Other Geometric/Cell-Level Parameters
Parameter
Thickness of pos. current collector, 𝑙Al (m)                                                                          f 15 × 10−6

Thickness of neg. current collector, 𝑙Cu (m)                                                                          p 10 × 10−6
                        2
Total tab area, 𝐴tabs (m )                                                                                          b 5.94 × 10−3

Lumped heat transfer coefficient, ℎ (W m K )−2   −1                                                                         b 150
                                               −3
Initial electrolyte concentration, 𝑐e,0 (mol m )                                                                           q 1000
                                                         −3
Saturation Concentration for fast-charging, 𝑐s,sat (mol m )                                                              s 30555


                                                  Spatial Discretisation
Parameter                                                        Pos                        Sep                             Neg
Nodes, through-thickness (axial), 𝑁a𝑗                            40                         40                                 40
Nodes, within spherical particle (radial), 𝑁r𝑗                   15                         —                                  15
a Calculated in section ‘Lower cutoff voltage for cells’ (also see section 3.4.1)           b
                                                                                         Assumed               c
                                                                                                       Ref. [146]
d Ref. [150]    e Converted from imperial units reported in Ref. [138]        f Table IV of Ref. [139]
g Sum of values in table 1 of Ref. [151]     h Ref. [152]    i From constituent values (see [151]) using Ref. [153]
j Ref. [154]   k Ref. [155]   l Ref. [156, 157]     m Ref. [158]   p Ref. [74]    q Ref. [137]
r See section ‘Computation of stack thickness of reference cell’       s Ref. [137]



                                                               126
                                                                    3.6 Results and Discussion


enhancements to the original LIONSIMBA code-base have been provided by this thesis author.
Interested readers may peruse these from the README.md file from the project’s repository.


3.6.2    xEV configurations

             Table 3.3      Acceleration test parameters (common across xEV platforms)

             Parameter
             Coefficient of drag for xEV body, 𝐶d                               a 0.31

             Frontal area of xEV, 𝐴v (m )2                                      b 2.40
             Acc. time dictated by standards, 𝑡f,std (s)                        c 6.00

             Acc. time specified by manufacturer, 𝑡f,man (s)                    d6.50
                                                         −1
             Speed, end of acc. (standards), 𝑣f,std (m s )                      e 8.94

             Speed, end of acc. (manufacturer), 𝑣f,man (m s )−1                f 26.82
             Base speed of xEV, 𝑣b (m s )−1                                    e 13.41
                                                            −3
             Air density at acc. test conditions, 𝜌air (kg m )                   f 1.20
             Drivetrain efficiency, 𝜂dt                                         g0.75
             Payload, 𝑀p (kg)                                                 c 150.60

             Rolling resistance coefficient of road surface, 𝐶r                 f 0.01
             Road gradient, 𝑍                                                   g0.00

             a Ref. [161]      b Calculated from typical BEV dimensions in [162]
             c Ref. [163]      d Ref. [164]   e Ref. [131] f Ref. [165] g Assumed


   Tables 3.3 and 3.4 show the xEV parameters used in simulations. To obtain an estimate
of the worst case design condition for which layer optimisation needs to be performed, the
60 Ah reference cell with 46 layers is used as the benchmark. The power demands on a battery
pack comprised of the reference cell during normal operation are found to be significantly
lower than that experienced during the two extreme cases of discharging and charging viz.
acceleration and fast charging respectively. This conclusion was arrived at after analysing
the power demands of four different drivecycles — a) Urban Dynamometer Driving Schedule
(UDDS), b) New European Driving Cycle (NEDC), c) Extra-Urban Driving Cycle (EUDC), and
d) Highway Fuel Economy Test (HWFET). 50.83 kW is the highest peak discharge power
while 14.20 kW is the highest median discharge power encountered across all the drivecycles
considered. Even with the assumption that 100 % of braking energy can be recovered, the
highest peak and median charging powers are only 43.13 kW and 26.03 kW respectively across
all these drivecycles.


                                                 127
                                                                  3.6 Results and Discussion


   The discharging and charging powers experienced by the pack with the same reference
cell during acceleration and fast charge are significantly higher than those experienced with
any standard drivecycle. Considering the acceleration parameters in table 3.3 for the BEV
pack, 181.45 kW is the power requirement for acceleration of a fixed vehicle mass on a flat
road surface. Four distinct fast-charging power levels viz. 50 kW, 80 kW, 110 kW and 130 kW
are considered in this study. This is in adherence to the minimum and maximum values of
level 3 rating as suggested by Yilmaz and Krein [166]. Furthermore, near-term fast charging
goals laid out in literature [167, 168] and the peak power capability of charging infrastructure
further justify these choices. The above power comparison study helps to inform the two
worst case conditions for layer optimisation.

                 Table 3.4   Acceleration test parameters (specific to each xEV)

             Parameter                                          BEV          PHEV
             Mass of xEV chassis, 𝑀c (kg)                     a 1340.0      b 1438.0
             Mass of pack overhead (w/o cells), 𝑀o (kg)        a 196.4         c 65.5

             Upper cutoff SOC of cell, 𝑧max (%)                 d95.0          d90.0

             Lower cutoff SOC of cell, 𝑧min (%)                   d5.0         e 30.0

             a Calculated based on [169]      b Calculated based on [169, 170]
             c Calculated (see sections 3.5.2 & 3.5.8)   d Assumed    e Ref. [165]


   For the acceleration tests, the initial cell SOC has been set to 40 %. This is in conformity
with the test criterion (50 ± 10) % of the SAE J1666 standard [146]. By choosing the worst
case starting SOC i.e., 40 %, a conservative design can be achieved. The chassis mass of the
vehicle as well as the mass of two passengers at 75.3 kg each [146] is considered for both
xEV platforms. The pack mass is computed as a function of number of layers as described
in section 3.5. Vehicle manufacturers General Motors Inc. provide the mass value of the
GM Ecotec series of engines [170] that can be used for the PHEV case which consists of a
range-extending ICE. The mass of the Bolt BEV pack reported in [169] minus the computed
mass of the overall cells used in the pack gives the overhead mass of the BEV pack. The
PHEV pack’s overhead mass is determined by suitably scaling the mass by the proportion of
reduction in the number of cells used.

   For the BEV platform, a fast-charging scheme operated on a Constant Power (CP) mode
with an initial SOC of 20 % is employed. In the case of the PHEV, an initial SOC of 30 %


                                              128
                                                                   3.6 Results and Discussion


(10 % higher than that for BEV) is used. This facilitates a smaller SOC window by taking
into account the higher number of charge-discharge cycles which are typical with PHEV
designs [30]. Both xEV platforms are fast charged to a target SOC of 80 % in CP mode. This
SOC value corresponds to the end-of-charge target in level 3 charging standards [171].


3.6.3    Acceleration studies

For both vehicle platforms under study, the acceleration at a worst-case rate of     4.13 m s −2   is
assumed for simulation. This corresponds to the manufacturer’s acceleration specifications
for the BEV listed in table 3.3. The acceleration rate corresponding to the SAE J1772 standards
is lower than this rate. Therefore, to obtain a robust cell design, the higher of the two
acceleration rates needs to be considered.

   Table 3.5 gives the simulation results based on the binary search strategy for various
combinations of (𝑇init , 𝑇sink ) for both the BEV and PHEV platforms. The overall simulation
time for this acceleration study was 24 min.
                            Table 3.5 xEV acceleration test results

                                                      acc
                                                     𝑛opt    acc
                                                            𝑛opt
                                  (𝑇init , 𝑇sink )
                                      (degC)         BEV    PHEV

                                       (38,5)          21   55
                                      (38,49)          21   57
                                      (25,25)          23   63
                                       (15,5)          27   69

   The following discussion is applicable for both vehicular platforms. The specific com-
binations of temperatures for traversing the thermal design space are chosen following
the SAE J1772 guidelines. High power densities result from using very low numbers of
layers. For instance, with 𝑛 = 1, the power density is                   −2
                                                              −14.92 kW m .   This leads to large
overpotentials causing the cell’s terminal voltage to drop lower than 𝑉min , thereby unable to
satisfy acceleration power requirements. As 𝑛 increases, the overall electrochemically active
surface area available to absorb the externally power increases. This, in-turn leads to lower
power densities and proportionally lower overpotentials.

   At higher initial temperatures, owing to the reduction in overpotentials, a larger voltage
overhead is available to accommodate the internal polarisation drop. This, in-turn, implies

                                                 129
                                                                     3.6 Results and Discussion


that smaller layer counts suffice to satisfy acceleration power demands for higher values of
𝑇init . For all temperature combinations, the largest deviation from 𝑇init experienced by the
BEV cell is a          ∘
                   0.48 C   increase. This is because the acceleration event, wherein the highest
magnitude of discharge powers get applied, are of a short duration. Consequently, it can
be concluded that a single isolated acceleration event does not heat the BEV battery pack,
and therefore the cell temperature remains close to that of the initial value. The PHEV cell
experiences higher power levels and although its temperature increases much higher than the
corresponding BEV cell, the maximum temperature during acceleration remains well below
the upper cutoff limit for all thermal scenarios considered. Finally, even for the worst case
simulation run, the cell’s SOC is depleted only by a maximum of 0.32 % for the BEV cell and
by a slightly higher value for the PHEV cell.

      The foregoing discussion reveals that the lower cut-off voltage strongly influences the
optimal layer value for acceleration tests. Based upon the simulation results of table 3.5, for
satisfying acceleration power requirements, 𝑛 = 27 and 𝑛 = 69 represent the optimal layer
choices for the BEV and PHEV platforms respectively for the assumed xEV configurations.


3.6.4       Fast-charging studies

Figures 3.9 and 3.10 shows the results produced by the layer optimisation framework for the
BEV and PHEV platforms respectively when considering fast charging requirements. Each
                                                             fastchg
heat map in these figures show the optimal number of layers 𝑛opt            for various combinations
of initial and ambient temperatures for four different charging powers. In each case, the values
      fastchg                                                                         ∘
of   𝑛opt       correspond to the temperature combination (𝑇init , 𝑇sink ) =   (15, 5) C   as shown in
fig. 3.9. This represents the least number of layers required to fast charge the pack under CP
conditions until the target SOC is reached. The charging scheme additionally considers the
constraint that the cell temperature must stay within 𝑇max =          ∘
                                                                    55 C.   Furthermore, its voltage
must remain less than or equal to 𝑉max = 4.22 V. Finally, the charging algorithm is plating-
aware i.e., the charging stops as soon as the concentration at the particle surface reaches the
maximum possible concentration limit of                    −3
                                               30 555 mol m ,   thereby preventing lithium plating
at the surface of negative electrode particles.

      Thus, using the model-based design strategy presented in this chapter, an effective cell
design is achieved which helps to maximise energy density and BEV range, without forgoing

                                                  130
                                                                           3.6 Results and Discussion




                      Figure   3.9§§   Optimal cell layer configurations for the BEV




                    Figure   3.10‡‡    Optimal cell layer configurations for the PHEV
   ‡‡ These figures were created by Ian D. Campbell who asserts copyright, with intellectual contributions from
and the right to use asserted by Krishnakumar Gopalakrishnan.
                                                     131
                                                                           3.6 Results and Discussion

                                                                                    fastchg
fast charging power targets. From figures 3.9 and 3.10, it is seen that            𝑛opt       increases with
increase in the charging power. This is because, as the charging power increases, the minimum
number of layers required to maintain the cell voltage below the maximum permissible value
also increases. This requires higher interfacial surface area to accommodate the increased
power demand. Furthermore, rapid surface saturation occurs due to steep concentration
profiles in the negative electrode particles when the charging power is high which causes
plating. With higher layers, the resulting electrodes are thinner, thereby allowing faster
diffusion of lithium in the solid particles and avoiding steep concentration gradients in them.
This suggests that the number of layers must be large enough to prevent plating.

    The computation of the cell’s nominal capacity as a function of the number of layers
merits explanation. The overall capacity of each of the two individual electrodes is obtained
as follows (suitably adapted from Plett [172] to account for the concept of layers)

                        𝑄neg = 𝑛𝐴elec 𝐹 𝑙neg 𝜀s,neg 𝑐s,maxneg |𝜃100 %neg − 𝜃0 %neg |                  (3.62)

                        𝑄pos = 𝑛𝐴elec 𝐹 𝑙pos 𝜀s,pos 𝑐s,maxpos |𝜃100 %pos − 𝜃0 %pos |                  (3.63)

The cell’s nominal capacity is the lower of the electrode capacities i.e., 𝑄𝑛 = min(𝑄neg , 𝑄pos ).
Considering non-constant parts (barring 𝑛) of eqs. (3.62)–(3.63) and applying eq. (3.49), it is
clear that the quantities to be compared are the two product terms 𝑐s,maxneg |𝜃100 %neg − 𝜃0 %neg |
and 𝑐s,maxpos |𝜃100 %pos − 𝜃0 %pos |. Substituting the numerical values from table 5.2, it is seen that
the negative electrode is the limiting electrode for cell i.e., 𝑄𝑛 = 𝑄neg .

    Figure 3.11 shows the nominal capacity of cells and charge passed versus the number of
layers during fast charging. In these plots, the nominal capacity 𝑄n of the cell versus the layer
count 𝑛 is represented by the linear downward-sloping line.

    For any layer choice, 𝑄n therefore represents the upper bound on the charge that can be
passed during charging. For both constant current and constant power charging, the loci of
actual charge passed 𝑞 lie much below this theoretical nominal capacity. For very low layer
counts, as the number of layers decreases, the power density drops rapidly which implies that
the rate of heating is low. This allows for more charge to be passed. However, at ultra-low
layer counts, the overpotential due to the cell’s internal resistance is quite high. Therefore,
hitting the upper bound on the terminal voltage is the reason for the failure of these layer

                                                    132
                                                                                                                                                        3.6 Results and Discussion


    choices. This is indicated by the narrow 𝑉max -limited region in fig. 3.11. For an intermediate
    range of layer choices, the rate of power-density drop with layer count begins to flatten,
    thereby leading to a plating-limited region. For these layer choices, the surface concentration
    starts to exceed the saturation value before any thermal or voltage limits are reached. Finally,
    further increasing the layer count beyond an intermediate optimal value leads to a linear
    drop in the cell’s charge accepting capability. During fast charging with the chosen power
    levels, although these layer choices do not reach the thermal, voltage or concentration limits,
    they are unable to attain the target SOC of 80 %. This is simply due to the lower nominal
    capacity of the these cells. There is no benefit in choosing layers in this region. Figure 3.11
    provides clues on the degree of optimisation that can be achieved by careful design choices.
    For instance, by using electrode materials capable of operating at higher plating voltage or
   with higher saturation concentration, the optimisation point can be appropriately adjusted.
                                                   “fig_capacity_quadrants’’ — 2018/5/4 — 20:14 — page 1 — #1
                                        BEV Constant Current Charging                                                                      BEV Constant Power Charging
Nom. capacity & charge (Ah)




                                                                                              Nom. capacity & charge (Ah)




                                                                      Qn                                                                                                                        Qn
                              60                                      q at   20   A                                         60                                                                  q at    50   kW
                                                                      q at   50   A                                                  Vmax -limited                                              q at    80   kW
                              40                                      q at   80   A                                         40                                                                  q at   110   kW
                                                                                                                                              d
                                                                                                                                            ite




                                                                      q at   90   A                                                                                     Cap                     q at   135   kW
                                                                                                                                          m




                                                                                                                                                                           acit
                                                                                                                                       -li




                                                                                                                                                                               y-li
                                                                                                                                                                                      mit
                                                                                                                                       ing




                              20                                                                                            20                                                           ed
                                                                                                                                     at
                                                                                                                                 Pl




                                                                                                                                                      Increasing utilisation
                               0                                                                                            0
                                   1       50       100      150      200         250                                            1                   50              100      150      200                    250
                                                  Number of layers, n                                                                                              Number of layers, n
                                       PHEV Constant Current Charging                                                                  PHEV Constant Power Charging
Nom. capacity & charge (Ah)




                                                                                              Nom. capacity & charge (Ah)




                                                                      Qn                                                                                                                        Qn
                              60                                      q at   20   A                                         60                                                                  q at    50   kW
                                                                      q at   50   A                                                  Vmax -limited                                              q at    80   kW
                              40                                      q at   80   A                                         40                                                                  q at   110   kW
                                                                      q at   90   A                                                                                                             q at   135   kW
                                                                                                                                                            te d              Cap
                              20                                                                                            20                          m i                         acit
                                                                                                                                                  - l i                                 y-lim
                                                                                                                                             i n g                                            ited
                                                                                                                                        a  t
                                                                                                                                      Pl
                                                                                                                                                      Increasing utilisation
                               0                                                                                            0
                                   1       50       100      150      200         250                                            1                   50              100      150      200                    250
                                                  Number of layers, n                                                                                              Number of layers, n

                         Figure         3.11 §§
                                        The right column shows nominal cell capacity and charge passed during CP
                         charging. Rate capability and cell utilisation are positively correlated with 𝑛. With increasing
                         power levels, the optimal layer configuration shifts to higher values of 𝑛. Similar behaviour is
                                                                                                          ∘
                         observed for galvanostatic charging (left column). Plotted for 𝑇init = 𝑇sink = 25 C.
                              §§ This
               figure was created by Ian D. Campbell who asserts copyright, with intellectual contributions from
    and the right to use asserted by Krishnakumar Gopalakrishnan.



                                                                                        133
                                                                                    3.7 Conclusions


    From the results discussed thus far, it is evident that it is the thermal environment that
governs the overall globally optimal layer configuration to to be used for cell design in
both acceleration and fast charging studies and across both vehicular platforms. For all
                                        fastchg
charging powers simulated,             𝑛opt       is the highest for the coldest temperature combina-
tion (𝑇init , 𝑇sink ) =          ∘
                          (15, 5) C.   This is due to the slow rate of electrochemical reaction and
diffusion at cold temperatures. The thinner electrodes from using higher layer count enable
fast charging without saturating the surface of the electrode particles. For the fast charging
scenarios considered here, the optimal number of layers to use is 89 for the BEV cell and
153 for the PHEV cell. The globally optimal layer choice to be used for cell design is therefore
the higher of the two values corresponding to acceleration and fast charging cases. Therefore,
this model-based design framework recommends choosing 89 layers for the cells to be used
in the BEV platform and 153 layers for those to be used in the PHEV platform.


3.7     Conclusions
A methodology to design the number of layers within pouch cells so as to maximise
their energy density whilst simultaneously being capable of high charge-acceptance rate
at the plating boundary has been developed. The proposed methodology may be employed
by designers of xEV powertrains to mitigate the inefficiencies that plague the iterative
experimental designs for each powertrain in a vehicle manufacturer’s product portfolio. The
methodology discussed in this chapter also paves the way to incorporate common module
designs for packs through layer optimisation. By suitably changing the number of layers
within a cell, while keeping the exterior module geometry unchanged, shall lead to cost
reduction and lower the time for derivative product designs.

    A mathematical procedure to adapt the standard galvanostatic-driven P2D model to
accept direct power inputs has been elucidated. This reformulation is based on a quadratic
boundary condition for the discretised solid-phase charge conservation equation, coupled
with a positivity constraint on the cell’s terminal voltage and an algebraic residual equation.
A key numerical aspect of the PBMs used in this work is the incorporation of a hybrid
pseudo-spectral/Finite Volume scheme, wherein the solid phase diffusion equation is solved
in the Chebyshev domain while a finite volume discretisation is employed for rest of the
axial-direction PDEs. This hybrid combination helps to achieve fast simulation runs without
sacrificing model fidelity.
                                                       134
                                                                           3.7 Conclusions


   The methodology proposed here for pouch cells may be considered for application to
cells of other form factors with suitable modifications. While considering the cylindrical
form factor, instead of a discrete set of layers, the electrode sheets are wound into one
continuous jelly roll and placed inside a cylindrical can. A suitable mathematical curve such
as the logarithmic spiral could be employed wherein the number of turns could be used
as a proxy for the layer count. The optimisation problem is also simplified to a certain
extent since the cylindrical can’s dimensions have already been standardised across the
automotive battery industry. However, certain additional challenges could arise in directly
translating the assumptions of the cooling methodology employed. For instance, a three
dimensional discretisation of the thermal grid is not uncommon for cylindrical form factors,
which requires careful considerations for bidirectionally coupling to the electrochemical
model. Any differences in power densities at the interior of the core versus the extremities
of the electrode spirals need to be accounted for.

   This concludes the design-oriented aspects of the thesis. Next, chapter 4 deals with the
aspects of analysing the computational bottlenecks present in one of the notable Reduced
Order Models (ROMs) and proposes a mitigation strategy for them.




                                             135
Computational Analysis and Numerical
                                                                                                  4
                                  Reformulation of the DRA
                                                           ∗

    4.1     Analysis of the Computational Bottlenecks of the DRA . . . . . . . . . . . . . 138

    4.2     Improved DRA for Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . 144

    4.3     Golyandina-Usevich Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . 146

    4.4     Customisations for Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . 147

    4.5     Simulation Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . 148




     ∗ This chapter is based on the journal publication — Krishnakumar Gopalakrishnan, Teng Zhang and Gregory

J. Offer. “A Fast, Memory-Efficient Discrete-Time Realization Algorithm for Reduced-Order Li-Ion Battery Models”.
Journal of Electrochemical Energy Conversion and Storage 14.1 (Feb. 2017), p. 011001. issn: 2381-6872. All intellectual
ideas in the aforementioned article are original contributions of this thesis author. All text, tables, figures and
captions therein were contributed solely by this thesis author. Copyright clearance for non-commercial verbatim
reproduction of the content (such as in this thesis) has been secured through the publication agreement with
the copyright holder ASME (see appendix B). The contents in this chapter may be, in full or in part, included
verbatim from the said publication. This author wishes to express his thankfulness to Teng Zhang, co-author of
this article, for checking my calculations and providing valuable feedback that helped to refine the manuscript
for that journal publication.


                                                         136
T
    his chapter presents an analysis and critical evaluation of a computational bottleneck
    present in a popular physics-based Reduced Order Model (ROM) framework of lithium-
ion batteries and proposes an alternative numerical reformulation to mitigate it. From the
literature review presented in chapter 2, it may be recalled that transcendental transfer
functions of the cell’s electrochemical field variables (except for ionic concentration and
potential in the electrolyte) was obtained by Smith et al. [47] through linearisation of the
underlying Pseudo Two-Dimensional (P2D) model equations. Lee et al. [48, 49] extended the
aforementioned approach so as to obtain these missing electrolyte-specific transfer functions
through a multi-modal EigenFunction expansion employing a Sturm-Liouville approach [174].

   In order to arrive at a Linear Time-Invariant (LTI) state-space representation of the system
(see eq. (2.1)) for embedded implementation, Lee et al. devised the Discrete-Time Realisation
Algorithm (DRA), a numerical procedure to systematically transform all transcendental
transfer functions to the time domain. A special property of the DRA is that it retains the
physical nature of the original Doyle-Fuller-Newman (DFN) equations until the very last
step wherein the matrices governing the system’s dynamics are generated. This yields a one-
dimensional discrete-time ROM of the cell that is entirely based upon fundamental physical
principles. The ROM thus obtained could then be used to compute the time-evolution of all the
internal electrochemical quantities of the DFN model. Prima facie it appears that this model
could be directly implemented for embedded vehicular applications, for example, as the plant
model for state estimation tasks. However, a comprehensive analysis of the procedure reveals
a critical issue that must be first tackled before implementation aspects can be considered.

   The unresolved issue in Lee et al. is the excessively high computational requirements
associated with the DRA, which becomes a crippling bottleneck since the procedure needs
to be repeated for multiple States of Charge (SOCs) and temperatures. This computational
bottleneck arises from forming a large Block-Hankel matrix in memory upon which a
Singular Value Decomposition (SVD) is performed. Under certain conditions as discussed in
section 4.1.1, owing to the large size of the Block-Hankel matrix, the DRA computation is
rendered intractable. This issue has been acknowledged by the original authors themselves
in [5, 49]. In this chapter, this computational bottleneck is analysed and an improved




                                             137
                                4.1 Analysis of the Computational Bottlenecks of the DRA

                  †
scheme is proposed . Section 4.1 discusses an analytical evaluation of the massive computing
requirements of the original DRA method. Redundancies and inefficiencies in this step are
enumerated and the high computational costs are deemed as unnecessary. In section 4.2,
a fast computational approach is presented which significantly reduces both the memory
and computational time of the ROM workflow. Section 4.5 summarises the results obtained
from applying the new workflow presented in section 4.2, by comparing and contrasting the
much smaller computational requirements of the new method with the original DRA scheme.
The improved modelling accuracy achieved by this proposed method when deployed under
resource-constrained computing environments, is also highlighted.


4.1        Analysis of the Computational Bottlenecks of the DRA
The ROM proposed by Lee et al. aims for the simplified representation of the Pseudo Two-
Dimensional (P2D) volume-averaged P2D implementation of the continuum model proposed
by Doyle, Fuller and Newman [15, 16].

    The block diagram in fig. 4.1 depicts this thesis author’s summary presentation of the
overall modelling workflow in Lee et al.. Firstly, the governing Partial Differential Algebraic
System (PDAE) equations of the DFN model (see table 1.1) are linearised about an operating
point of SOC and temperature. Then, closed-form Laplace domain transcendental transfer
functions of all the internal physical quantities (𝜙𝑠 , 𝜙𝑒 , 𝑐𝑠 , 𝑐𝑒 , 𝑗) at different cell locations, are
derived using applied current as the input. A detailed treatment of this analytical derivation
is presented in Lee et al. [48]. The authors proposed a novel Discrete-Time Realisation
Algorithm (DRA) scheme [175] in order to transform these transcendental transfer functions
to standard state-space representation. Sublevel-1 of fig. 4.1 shows a breakout view of the
DRA procedure and illustrates the steps involved in this computation. At the heart of this
numerical method is the classical subspace identification approach known as Ho-Kalman
algorithm [176], whose computation steps are shown via the exploded view in sublevel-2
of fig. 4.1. Then, the Markov parameters (unit-pulse response) of this Single Input Multiple
    † In the views of this thesis author, it is difficult to succinctly summarise the mathematical derivations
involved in the long sequence of modelling steps of the DRA i.e., obtaining transcendental transfer functions
followed by the Ho-Kalman algorithm for state-space realisation. Extraction of salient equations from published
works do not have the ability to convey the essence of the method in a standalone manner, and risks the
introduction of a slew of new notation and symbols. Therefore, this chapter needs to be viewed as a continuum
to the basic DRA presentation, a detailed presentation of which is available in the textbook by Plett [5].


                                                     138
                               4.1 Analysis of the Computational Bottlenecks of the DRA


Output (SIMO) linear system of battery transfer functions are                       ‡
                                                                            computed .     They form the
entries of a Block-Hankel matrix [177], wherein each block element is a column vector of the
set of Markov parameters at a given time-step as shown in eq. (4.1).


                                          ⎡ 𝑔 1 𝑔2 …  𝑔 𝑛 ⎤
                                          ⎢𝑔 𝑔             ⎥
                                              2  3
                                       𝐻 =⎢                ⎥                                            (4.1)
                                          ⎢⋮       ⋱   ⋮ ⎥
                                          ⎢                ⎥
                                          ⎣𝑔 𝑛     … 𝑔2𝑛−1 ⎦

where 𝑔𝑘 represents the Markov parameter of the system at time-index 𝑘. Each entry 𝑔𝑘
is a column vector for SIMO systems. For the lithium ion battery application proposed by
Lee et al. [48],the Markov parameters of the system correspond to transcendental transfer
functions of each of the following quantities to the applied current

    1. Solid phase potential

   2. Electrolyte potential

   3. Solid phase concentration

   4. Electrolyte concentration

   5. Molar flux density

   6. Overpotential

    7. solid-electrolyte potential difference

at four different spatial locations — the two current collectors and the two separator interfaces.

    A key computation in the Ho-Kalman algorithm is the Singular Value Decomposition
(SVD) of this Block-Hankel matrix. A wide separation in the magnitude drop between
successive singular values serves as a guide for the modeller in choosing a suitable reduced
order to represent the entire dynamics of the system. The analyses of this thesis author,
presented in section 4.1.2 and section 4.1.3 reveal major inefficiencies in both the Block-
Hankel formation and the SVD computation steps which hinder the entire reduced-order
modelling workflow.

    ‡A ubiquitous concept in linear systems and control theory, Markov parameters represent the discrete-time
unit pulse response of a linear system.


                                                    139
                                                        4.1 Analysis of the Computational Bottlenecks of the DRA


                                                         Laplace                  Integrator Pole            Discrete-Time                           Augment Integrator
   PDE Model            linearize around   Linearized                Transfer                                                        State-Space                          Reduced Order
                                                                                                         Realization Algorithm
(Doyle-Fuller-Newman)    given SOC, T      PDE Model    Transform   Functions   Removal (if present)                                  Matrices          and Residues      Model (ROM)
                                                                                                       ,         (DRA)




                                                                                                            Discrete-Time Unit
                                    Continuous-Time                    Continuous-Time                                                         Ho-Kalman
                                                                                                             Pulse Response
                                    Impulse Response                    Step Response                                                         , Algorithm
                                                                                                              (Markov Parameters)




                                                                         Block-Hankel                         Singular Value        U, Σ, V    Extended Observability &
                                                                        ,Matrix in RAM                    ,Decomposition (SVD)                  Controllability Matrices



                                                                                                              Max. System Order



   Figure 4.1 Reduced Order Model (ROM) workflow using classical Discrete-Time Realisation
   Algorithm (DRA). The shaded blocks represent computational bottlenecks.


4.1.1           Size of the Block-Hankel Matrix

Large Block-Hankel matrices can occur in DRA computation due to the following reasons.

      1. For a given duration of Markov-parameter recording, if a high sample-rate ROM
           is desired, the emulation frequency in the DRA scheme has to be proportionately
           increased to accurately compute the continuous-time step and pulse responses in fig. 4.1.
           This implies that the total number of time-samples 𝑁 for each Markov parameter will
           have to be scaled linearly to capture the desired duration of the unit-pulse response.
           However, the size of the Block-Hankel matrix has a quadratic dependence on the
           Markov parameter length.

     2. The recorded sample size 𝑁 could also become large if the Markov parameters of just
           one of the transfer functions decay very slowly. In Li-ion batteries, diffusion within
           the solid particle is typically the slowest process. For the cell modelled in Lee et al.,
           the unit-pulse response of surface concentration of Li adjacent to the positive current
           collector requires approximately 16000 samples before reducing to an appreciably low
           value, as shown in fig. 4.2.

     3. For a battery modelling problem consisting of multiple transfer functions, the number
           of entries in the Block-Hankel matrix also scales linearly with the number of transfer
           functions. Thus, if more cell variables (e.g. concentrations and potentials at other spatial


                                                                                             140
                                                4.1 Analysis of the Computational Bottlenecks of the DRA


        locations within the cell) are to be studied, then the size of the transfer function vector
        and that of the Block-Hankel matrix increases correspondingly.

                                     0.02

                                     0.00
              c̃se (0, t)[mol/m ]
                               3




                                    −0.02

                                    −0.04
                  pos




                                    −0.06
                ∗




                                    −0.08

                                    −0.10
                                            0         4000              8000         12000   16000
                                                                   Time [sec]

  Figure 4.2 Time evolution of Markov parameters of pole-removed transfer function corres-
  ponding to surface concentration of Li in the solid particle adjacent to positive current collector.

   Considering the combined influence of these effects, if 𝑥 transfer functions are to be
modelled and 𝑁 time-samples of each Markov parameter are to be captured, the corresponding
size of the Block-Hankel matrix 𝐻 is

                                                     Size(𝐻 ) ∼       2
                                                                  𝒪(𝑥𝑁 )   entries                           (4.2)


   This has a significant computational impact as shown in section 4.1.2 and section 4.1.3.


4.1.2     Classical DRA — Memory (RAM) Requirements

Lee et al. [48] modelled 28 transfer functions representing various electrochemical variables at
the current collector and separator interfaces. Each Markov parameter is a 28 element column
vector. 16000 time-samples were obtained at a sample-rate of 1 Hz, allowing sufficient time
for the Markov parameters of the slowest dynamics i.e., solid surface concentration to settle
to an acceptably low magnitude. The Block-Hankel matrix thus formed has 8000 blocks, each
block consisting of 28 elements i.e., has 8000×28 = 224000 rows and 8000 columns. Hence, the
overall number of elements in the Block-Hankel matrix is 224000 × 8000 =                               9
                                                                                              1.79 × 10 .   Using
double-precision arithmetic, its storage requirement can be estimated to be ≈27 GB.

                                                                  141
                               4.1 Analysis of the Computational Bottlenecks of the DRA


     Computing the SVD results in the formation of three more large matrices in memory
— i) matrix of output singular vectors 𝑈, ii) matrix of input singular vectors 𝑉, and iii) the
diagonal singular-value matrix Σ. With 8000 Hankel-blocks, approximately 81 GB of Random
Access Memory (RAM) is required for holding these three output matrices generated by a
full SVD. However, the intermediate operational memory usage during the SVD computation
is often much higher than the combined size of all the matrices. As these large matrices must
be repeatedly handled for each operating point of SOC and temperature, the high memory
demand of the classical DRA remains a persistent issue.


4.1.3    Classical DRA — CPU Operation Count

The most widely used numerical algorithm for computing the full SVD of a generic dense
matrix 𝐴 ∈   ℝ 𝑚×𝑛 ,𝑚    ≥ 𝑛 is the two-stage Golub-Kahan-Reinsch method [178]. In the first stage,
𝐴∈   ℝ 𝑚×𝑛   is reduced to an upper bidiagonal form. In the second stage, SVD of this upper
bidiagonal matrix 𝐵 ∈      ℝ 𝑚×𝑛   is computed using an iterative procedure such as the Demmel-
Kahan method [178]. If stage I of the SVD computation employs ℝ-Bidiagonalisation [178],
then the overall process is referred to as ℝ-SVD. This is the fastest known full SVD
computation method that may be applied to this battery modelling problem. The dgesvd
algorithm, originally implemented in LAPACK [179], employs this method. This has been
ported to many numerical computation packages such as MATLAB, GNU Octave and Scilab.
Several numerical libraries such as NAG and Intel MKL also use the dgesvd codes due to
its acclaimed stability, robustness and versatility. The MATLAB implementation ‘svd’ is also
based upon dgesvd and hence this can be considered as the de-facto baseline SVD code.

     The operation count for computing the singular values and vectors of a generic dense
matrix 𝐴 ∈    ℝ 𝑚×𝑛 ,𝑚   ≥ 𝑛 using the ℝ-SVD method is       2
                                                           4𝑚 𝑛 + 22𝑛 3   [178]. Markov parameters
of 𝑥 transfer functions and 𝑁 time-samples yields a Block-Hankel matrix with 𝑚 = 𝑥𝑁 rows
and 𝑛 = 𝑁 columns. Hence,

                             CPU Operation Count               2
                                                       = 4 (𝑥𝑁) 𝑁   + 22𝑁 3

                                                       =     3        2
                                                           2𝑁 (11 + 2𝑥 )                      (4.3)

                                                                    3
Thus the Central Processing Unit (CPU) operation count scales as 𝒪(𝑁 ) with the number of
                                2
Markov time-samples 𝑁 and as 𝒪(𝑥 ) with the number of transfer functions 𝑥 being modelled.

                                                 142
                            4.1 Analysis of the Computational Bottlenecks of the DRA


The ROM computed in Lee et al. uses 28 transfer functions wherein the Markov parameters
are collected for 16 000 s with a sampling interval of 1 s. Thus, the CPU operation count for
                                                    3
performing this computation is approximately 𝒪(16000 )      ≈   4 × 10 12   floating point operations.


4.1.4     Summary Effect of Computational Bottlenecks

The computational bottleneck in a classical DRA implementation arises due to the require-
ment of capturing a large number of Markov parameters, which in turn leads to growth in
Block-Hankel size. In the case of battery modelling, this can arise in the following real-life
scenarios:

   1. Electrochemical variables at additional locations of interest within the cell (e.g. middle
        of electrode or separator domain) might need to be modelled. This increases the number
        of transfer functions and hence the number of Markov parameters.

   2. High frequency load cycles necessitate higher sample-rates to obtain a high fidelity
        model. This leads to a correspondingly higher number of Markov parameters.

   3. In cells with large particle sizes and small diffusion coefficients, a large set of Markov
        parameters is needed to capture the full system dynamics.

Lack of specialised computing infrastructure necessitates early truncation of the Markov
parameters in the ROM workflow. The resulting errors in the singular value computation
lead to significant modelling errors in the physical variables of the cell. Thus, in practice, the
computational bottlenecks of classical DRA manifest as modelling errors when implemented
in a resource-constrained computing environment. Furthermore, this tedious computation
has to be repeated for multiple SOCs and temperatures.

   The foregoing analysis clearly demonstrates that the high memory and CPU demands in
a classical DRA implementation severely hamper the scope and applicability of the reduced
order modelling process. This implies that the modelling workflow is not accessible to
research groups without specialised computing infrastructure and its universal appeal is
rendered questionable. The shaded blocks in fig. 4.1 depict the hierarchical propagation of
the classical DRA’s computational bottleneck throughout the ROM workflow.



                                               143
                                                 4.2 Improved DRA for Battery Modelling


4.2      Improved DRA for Battery Modelling
Collecting a large Markov parameter set is inevitable due to the fundamental physics of
the cell dynamics as established in section 4.1.4. Hence, in order to circumvent the high
computational demands of the classical DRA, the second step in the process i.e., forming the
Block-Hankel matrix, is critically examined with the following scientific rationale.

   1. The unit-pulse responses of most battery transfer functions (other than those of rate-
        limiting steps such as solid diffusion) decay relatively quickly. Hence it is inefficient
        to record the Markov parameters of the full system for the entire duration needed to
        capture the slowest dynamics.

   2. The Block-Hankel matrix is essentially redundant information since its entries are
        simply the Markov parameters arranged in a repeating special structure. Thus, it is
        wasteful to construct this huge matrix. If the SVD operation can be performed on a
        virtual Hankel matrix, the memory requirements can be drastically reduced.

   3. The matrix of singular values Σ is diagonal and hence, sparse. It is redundant to hold
        all the non-diagonal entries (zeros) in memory.

   4. It is not necessary to perform a full SVD operation in order to achieve order reduction.
        When an upper bound on desired system order can be decided a priori, it is sufficient
        to compute a truncated SVD yielding the first few dominant triplets of 𝑈 , Σ and 𝑉.

Thus, forming the large Block-Hankel matrix and computing its SVD is identified as an
avoidable bottleneck in the classical DRA method. This can be tackled since forming the
Block-Hankel matrix is an idiosyncrasy of the algorithm used and does not arise from any
fundamental physical limits. Facilitated by an efficient SVD implementation, this thesis author
proposes an improved DRA that serves as a drop-in replacement in the ROM workflow.


4.2.1     Candidate Schemes for Block-Hankel SVD

Generic SVD routines such as dgesvd do not take advantage of the anti-diagonal structural
symmetry of Block-Hankel matrices. Since it is sufficient to obtain the first few leading
eigentriplets for order reduction, iterative algorithms such as the Jacobi and Lanczos schemes

                                               144
                                               4.2 Improved DRA for Battery Modelling


(see [178]) emerge as attractive candidates for computing these dominant singular values
and vectors. In order to ensure accessibility to the large community of battery researchers
and to encourage widespread adoption of the fast reduced order modelling framework, the
author of this thesis considered only freely available open-source numerical libraries that
exist in the public domain, especially those with permissive licensing terms. Otherwise the
gains achieved by an efficient SVD computation for implementing DRA on non-specialised
computing hardware would be offset by commercial licensing terms, usage restrictions and
monetary considerations associated with using proprietary codes. Among these open-source
candidate algorithms, the Jacobi scheme [178] is available through the xGESVD routine in
the LAPACK suite [179]. FORTRAN 77 codes for the implicitly restarted Arnoldi and Lanczos
schemes (see nu-TrLan [180]) are available as part of the ARPACK [181] library.

   The practical drawback of most SVD implementations, both open-source and proprietary,
is that they require the entire matrix as input argument. Since operating upon the Block-
Hankel matrix requires constructing it in the first place, the memory bottlenecks discussed
in section 4.1.2 are not ameliorated. An example is the svds routine — an economy size SVD
implementation in MATLAB. Albeit this is a commercial implementation of the Arnoldi codes,
any potential benefits of using an iterative scheme is nullified by the memory penalty. Owing
to reasons enumerated in section 4.2, the chosen SVD algorithm needs to be able to handle
the computation without actually forming the huge block-Hankel matrix in memory.


4.2.2    SVD Operation on a Virtual Block-Hankel Matrix

The pioneering work by Larsen, PROPACK [182], based on his earlier work [183] implements
a numerically stable Lanczos SVD computation designed specifically for large and sparse
matrices. In addition to the ability to operate on the matrix as a whole, the PROPACK
codes possess a unique flexibility of accepting input arguments in a functional form. A key
highlight of the Lanczos SVD scheme is that it does not strictly require the matrix itself, but
only the product of the matrix and its transpose with an arbitrary vector. This feature has
been effectively exploited in the PROPACK suite. Therefore, these multiplication routines
can be supplied as input arguments instead of forming the large Block-Hankel matrices in
memory. Furthermore, this package includes sophisticated schemes such as Gram-Schmidt
partial re-orthogonalisation [184] to compensate for numerical round-off errors in the basic


                                             145
                                                        4.3 Golyandina-Usevich Algorithm


Lanczos bidiagonalisation and ensures orthogonality of the input and output singular vectors.
The PROPACK suite is available as both Fortran 77 and MATLAB codes distributed under a
permissive BSD license. Version 1.1 of the MATLAB implementation of the PROPACK suite
was used by this thesis author.

   For the ROM workflow, in order to use PROPACK’s unique feature viz. its flexibility to
accept functional form inputs, the key is to use an algorithm that effectively exploits the affine
structure of the Block-Hankel matrix without actually forming it in memory. Recent research
in a specialised time-series technique known as Singular Spectrum Analysis (SSA) [185] has
yielded efficient methods for achieving this goal. Korobeynikov [186] proposed an algorithm
that employs the Fast Fourier Transform (FFT) for implementing this matrix-vector product
by embedding the Markov parameters into the column vectors of a circulant matrix. This
is suitable for applications wherein the Hankel matrix is composed of scalar entries such
as that formed by the Markov parameters of a Single Input Single Output (SISO) transfer
function. Golyandina, Usevich and colleagues [187, 188] extended this approach to a generic
2D-case for performing SSA on images. With this modification, this algorithm is rendered
capable of handling the structure of Multi-level Block-Hankel matrices formed from the
Markov parameters of a generic Multi Input Multi Output (MIMO) system. While the modified
scheme does not construct the Block-Hankel matrix in memory, the operational rubrics of the
Golyandina-Usevich algorithm in conjunction with PROPACK is such that they iteratively
operate on a virtual Hankel matrix of equivalent size. The Golyandina-Usevich algorithm is
briefly summarised in section 4.3.


4.3    Golyandina-Usevich Algorithm
The Golyandina-Usevich algorithm is used for computing the product of a Block-Hankel
matrix with an arbitrary vector. The steps involved in this scheme are enumerated in
Algorithm 3 of Golyandina et al. [188]. These steps are reproduced here in the context of
the improved DRA for reduced order battery modelling.

   1. Compute a 2-D FFT of Markov parameter matrix.

   2. Form an augmented vector by zero-padding the arbitrary vector input from Lanczos
      iteration.

                                               146
                                              4.4 Customisations for Battery Modelling


   3. Perform a column-wise reshaping of this augmented vector to obtain a new matrix
      with the same dimensions of the Markov parameter matrix.

   4. Compute the element-wise product of this newly created matrix with the 2-D FFT of
      Markov parameter matrix.

   5. Reshape the resulting matrix back to a column vector.

   6. Extract the first 𝐿 elements from this vector, wherein 𝐿 = 𝐾 𝑥. 𝐾 represents the desired
      block-Hankel size and 𝑥 represents the number of transfer functions being modelled.

   At the end of Step 6, the product of the Hankel matrix and arbitrary vector is obtained.
This is reused as an input for the Lanczos scheme which generates a new arbitrary vector
in the subsequent iteration. Thus, the steps 1–6 are run in a loop within the main Lanczos
scheme. These same steps can also be used for computing the product of the transpose of
the Hankel matrix and the arbitrary vector. The only change is to account for the different
dimensions of the arbitrary vector input from the Lanczos scheme in step 2. As a practical
implementation, software code representing steps 1–6 is written in a plain-text file and used
as functional-form inputs by the PROPACK scheme which implements the Lanczos iteration.


4.4    Customisations for Battery Modelling
Specific considerations are required for incorporating the Golyandina-Usevich algorithm in
the ROM workflow for Li-ion batteries. The classical DRA architecture is set up to handle
SIMO systems, wherein all transfer functions are derived by considering only a single input
viz. the applied battery current. Thus the Markov parameters form a 2D matrix wherein each
row corresponds to individual battery transfer functions with columns representing unit-
pulse response samples for each transfer function. The 2D moving-window illustrated in [188]
for Block-Hankel matrix formulation has to be suitably reshaped to account for this structure.
Step 3 of the algorithm deals with 2-D FFT computation of the Markov Parameter Matrix
(MPM). In this thesis author’s implementation, this is pre-computed since it remains invariant
between iterations of the Hankel-vector product computation loop. This pre-allocation and
a priori computation contributes to overall code efficiency.




                                             147
                                                                                                        4.5 Simulation Results and Discussion

                                                         Laplace                  Integrator Pole           Discrete-Time                                Augment Integrator
   PDE Model            linearize around   Linearized                Transfer                                                             State-Space                         Reduced Order
                                                                                                        Realization Algorithm
(Doyle-Fuller-Newman)    given SOC, T      PDE Model    Transform   Functions   Removal (if present)                                       Matrices         and Residues      Model (ROM)
                                                                                                                (DRA)




                                                                                                       Discrete-Time Unit
                                        Continuous-Time              Continuous-Time                                                     Ho-Kalman
                                                                                                        Pulse Response
                                        Impulse Response              Step Response                                                      Algorithm
                                                                                                        (Markov Parameters)




                                                                       Golyandina -          Hv
                                                             X̂                                           PROPACK             U, Σ, V   Extended Observability &
                                            2-D FFT                      Usevich
                                                                                                        (Lanczos SVD)                    Controllability Matrices
                                                                        Algorithm           H′
                                                                                              v



                                                                                                         Max. System Order




   Figure 4.3 Reduced Order Model (ROM) workflow using improved Discrete-Time Realisation
   Algorithm (DRA).


       Figure 4.3 shows the ROM workflow with the improved DRA wherein all computational
bottlenecks highlighted by shaded blocks in fig. 4.1 have been eliminated. The strategy is to
first employ the (suitably modified) Golyandina-Usevich algorithm for describing the matrix-
vector multiplication routines. These two functions are then used as inputs to the PROPACK
codes. Eigentriplets up to the desired upper bound on system order is then computed using
a Lanczos SVD iteration. Figure 4.4 presents a comparison of singular values computed by
both the traditional and new methodologies. It is evident that the two sets of singular values
are identical. This proves that the new scheme can indeed serve as a drop-in replacement for
the classical DRA.


4.5            Simulation Results and Discussion
This section provides a quantitative demonstration of the reduced computational demand
of the improved DRA scheme by comparing it with the classical DRA implementation. The
physical parameters of the cell are the same as those published in Fuller et al. [16]. Table 4.1
lists the parameters used in the ROM workflow (same as those employed by Lee et al. [48]).

       Figure 4.5 shows a comparison of the memory usage of classical and improved DRA
methods. It is evident that the SVD step in classical DRA consumes an overwhelming majority
of the total memory demand, requiring ≈100 GB for a Hankel block size of 8000. This can be a
limiting factor in modelling slow cell dynamics without access to a large memory workstation.
The improved DRA method eliminates this bottleneck and the memory usage of SVD step is

                                                                                            148
                                                                    4.5 Simulation Results and Discussion

                                 3
                           10
                                                                                      Classical SVD
                                                                                      Improved SVD
                                 2
                           10
               Magnitude



                                 1
                           10

                                 0
                           10


                           10   −1




                           10   −2
                                     1    2      3    4         5      6    7     8       9       10
                                                          Singular Values

  Figure 4.4 Comparison of singular values computed by the conventional and improved SVD
  methods. Using the new scheme results in identical singular values

                                     Table 4.1   Parameters for ROM Computation

                                Initial Cell SOC                                  60 %
                                Hankel Block Size                                 8000
                                Discrete-Time Model Sample-Rate, 𝑇𝑠               1s
                                Number of Electrolyte EigenModes                  5
                                Continuous-Time Emulation Frequency, 𝐹1           128 Hz
                                Desired Number of Singular Values                 10


negligible. Overall memory usage of the improved DRA is dominated by Markov parameter
computation. Considering 10 GB of usable RAM, this means that 60000 Markov parameters
(Hankel Block-size of 30000) can be captured.

    Figure 4.6 shows a comparison of CPU times for computing the ROM at a single SOC
and temperature for both the classical and the improved DRA                            §
                                                                                methods .     Owing to the high
operation count for the SVD computation (see eq. (4.3)), the classical DRA requires ≈40 min
for a Hankel block size of 8000. Clearly, the overall CPU time for the classical DRA is almost
exclusively spent for computing the SVD. The improved DRA method reduces the overall

    §All computations reported in this chapter were performed on a dedicated high-RAM pool drawn from the
compute cluster hosted at the Department of Mathematics at Imperial College London. The author of this thesis
wishes to express his thankfulness to the relevant authorities for providing access to this facility. The resources
borrowed were one core of a 4-core Intel® Xeon® E5-2637 v3 processor clocked at 3.50 GHz with 500 GB RAM.


                                                          149
                                                                      4.5 Simulation Results and Discussion


                                                                                    Classical SVD Step
                               100
                                                                                    Overall (Classical DRA)
                                                                                    Improved SVD Step
                                80
             RAM Usage (GB)

                                                                                    Overall (Improved DRA)

                                60

                                40
                                                                       Practical RAM Limit
                                20

                                 0
                                     0        5000     10000         15000      20000         25000
                                                        Number of Hankel Blocks

  Figure 4.5 Memory usage of classical and improved DRA. Overall, RAM usage as well as the
  memory used only for SVD computation is illustrated.


computational time by two orders of magnitude, taking ≈40 s for the same block-size. In this
case, the CPU time is evenly split between the SVD and Markov parameter computations.

                               100

                                                                                      Overall (Classical DRA)
                                                                                      Classical SVD Step
                                10
             CPU Time [mins]




                                                                                      Overall (Improved DRA)
                                                                                      Improved SVD Step

                                 1


                                0.1


                               0.01
                                      0      2000    4000   6000       8000     10000 12000 14000
                                                        Number of Hankel Blocks

            Figure 4.6                    Computation times for classical and improved DRA schemes


   From fig. 4.5, it is evident that if classical DRA is employed, a standard laptop with a
nominal 10 GB RAM limit (dedicated for ROM workflow) cannot capture the full cell dynamics
and hence is restricted to 2500 Hankel blocks. This necessitates early truncation of Markov
parameters at 5000 s. From fig. 4.2, the truncation residue at 5000 s for the unit-pulse response

                                                               150
                                                     4.5 Simulation Results and Discussion

                                                                             −3
of solid surface concentration at positive current collector is −0.0087 mol m . The truncation
errors in the MPM directly translate to errors in computed singular values, adversely affecting
accuracy of simulated cell variables. It must be noted that the accuracy of simulation results
reported here does not bear a causal relationship to the particular DRA scheme employed. In
principle, when an upper bound on computational usage has not been enforced, the numerical
operations of both the existing and proposed DRA schemes lead to similar error magnitudes
for the modelled quantities. Instead, the accuracy comparison illustrated here primarily serves
to demonstrate the practical usefulness of the improved DRA scheme when implemented in
a commonplace computing environment.

   Figure 4.7 shows a comparison of singular values obtained by the classical and improved
SVD methods computed by imposing a RAM limit of 10 GB. Owing to early truncation of the
MPM, the dominant singular values computed by the conventional method differ significantly
from those computed by the improved SVD operating on untruncated data. With the same
memory constraints, the improved DRA can handle up to 30000 Hankel blocks, allowing for
capture of 60 000 s of Markov parameter data.

                                                                    Classical DRA - 2110 Blocks
                          2
                    10                                              Improved DRA - 30000 Blocks




                          1
                    10
            Value




                          0
                    10



                    10   −1



                              1   2   3   4      5      6       7          8         9       10
                                              Singular Values

  Figure 4.7 Comparison of singular values computed by conventional and improved SVD
  methods under a practical RAM limit of 10 GB


   For comparative analysis of modelling accuracy under this memory constraint, a time-
domain simulation of the ROMs obtained by classical and improved DRA methods is
performed. The input current profile corresponding to a Urban Dynamometer Driving


                                              151
                                                                                   4.5 Simulation Results and Discussion


Schedule (UDDS) drive cycle reported in Lee et al. [48] is used. Figure 4.8 depicts the time-
evolution of the solid surface concentration at the positive electrode/separator boundary.
For comparing the accuracy of the two ROMs, a COMSOL Multiphysics [189] simulation
of the full-order pseudo-2D porous-electrode PDAE model is used as the reference. The
ROM employing classical DRA diverges over time, and after 1500 s results in an error
of              −3
      1120 mol m .                                 The ROM incorporating the new DRA workflow accurately tracks the
COMSOL simulation trend-line.
                cs,e (L ne g + Lsep , t)[mol/m ]




                                                   12000
                3




                                                   11000



                                                   10000                           COMSOL (Full Order Pseudo-2D)
                                                                                   Classical DRA ROM - 2500 Hankel Blocks
                                                                                   Improved DRA ROM - 30000 Hankel Blocks
                                                   9000
                                                           0   200   400     600        800     1000       1200      1400
                                                                                Time [sec]

     Figure 4.8 Time-domain simulation depicting solid surface concentrations at the boundary of
     positive electrode and separator. The simulation results from the P2D model implemented in
     COMSOL is used as the reference benchmark. The two ROMs were derived under a RAM limit
     of 10 GB. The performance of the improved DRA is significantly better than the classical DRA
     owing to the fact that its derivation could accommodate a larger number of Hankel blocks without
     exceeding the specified memory limit.


      Table 4.2 provides a summary of the key simulation results. At a single operating point
of SOC and temperature, for a Hankel block size of 8000, the ROM workflow incorporating
the improved DRA is ≈100 times faster than that employing the classical DRA. Using the
machine with specifications listed in the                                          §
                                                                           footnote ,   for 100 operating points (combinations
of 10 SOC and temperature values), computing the ROM requires only 6 hours using the
improved DRA, whereas the classical DRA consumes 666 hours (27 days). Furthermore, for
the same block-size, the improved DRA is demonstrated to be superior in terms of memory
efficiency, drastically reducing the memory requirement from 112 GB down to 2 GB. Finally,
the improved DRA demonstrates superior modelling accuracy when implemented even in
moderately equipped computing environments such as laptops.

                                                                             152
                                                           4.5 Simulation Results and Discussion

                   Table 4.2   Salient Results — Classical vs. Improved DRA

                     ROM                                  Classical   Improved
                                    Entity
                   Condition                                DRA         DRA
                                  Memory              111.80 GB       2.14 GB
                                   (overall)
                                  Memory              97.93 GB        0.03 GB
                   8000           (SVD step)
                   Hankel        CPU Time             39.78 min       0.63 min
                                   (overall)
                   Blocks
                                 CPU Time             39.30 min       0.14 min
                                  (SVD step)

                   10 GB         Block Size           2500            30000
                   Memory        Max. error           1120 mol m −3   13 mol m −3
                   Limit        in 𝑐𝑠,𝑒pos (1, 𝑡)


   This chapter concludes with the view that, although the bottlenecks in Lee et al. [48]
revealed by this in-depth analysis have been effectively tackled in this chapter, owing to the
circular dependency between the linearisation point and model parameters, the underlying
model itself is not robust enough for immediate implementation. Furthermore, the model
derivation is convoluted with the derivation being performed in the frequency domain and
implementation in the time-domain. This thesis author is of the opinion that a simple, yet
accurate model derived and implemented entirely in time-domain is the need of the hour for
encouraging the automotive industry to adapt physics-based battery models onto on-board
Battery Management Systems (BMSs) of electric vehicles. In the quest to fulfil this need, an
analysis of the simplest time-domain Physics-Based Model (PBM) viz. the Single Particle
Model (SPM) is presented next in chapter 5.




                                                    153
 Performance Evaluation of State of the
                                                                                    5
                   Art in Single Particle Modelling

   5.1   SPM Model Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155

   5.2   Numerical Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169

   5.3   Desktop Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 178

   5.4   Quadratic Approximation of Ionic Spatial Concentration . . . . . . . . . . . . 201

   5.5   Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210




T
    aking into account the relative strengths and weaknesses of all the physics-based
    reduced order modelling families in the literature considered (see chapter 2), the
overarching simplicity of the Single Particle Model (SPM) coupled with its immediate
potential to bring the power of physics-based predictions to an embedded environment is a
strong motivation to pursue an in-depth exploration of its horizons. This chapter discusses
the performance of multiple SPM variants, ranging from basic to sophisticated. The governing
equations of the conventional SPM are first introduced and its baseline performance is
evaluated. Next, an in-depth analysis of the basic SPM’s drawbacks is performed. Various

                                               154
                                                                 5.1 SPM Model Development


published attempts to mitigate their current challenges towards implementability is presented
and their inadequacies discussed. Owing to its simplicity and latent potential, a popular
modelling strategy from the existing art that aims to enhance the performance of the basic
SPM through incorporation of electrolyte dynamics, is chosen for further analysis. The
chapter concludes with the author’s critical comments on its relative merits that come to view
through comparison against a benchmark model, whilst simultaneously identifying its critical
weakness whose mitigation forms the focal point of the research discussed in chapter 6.


5.1     SPM Model Development
In order to establish a context for the author’s work to be discussed in chapter 6, it is
imperative to provide a holistic presentation of the basic SPM modelling art. The conventional
SPM is the simplest of all time domain Physics-Based Models (PBMs). The rest of this section
provides this author’s digested summary of its modelling rubrics based upon the keen insights
gained from perusing the vanguard literature in this topic [87, 92, 96] as well as their relevant
derivative works.


5.1.1    Geometry

A description of the working principle of the cell was presented in section 1.1 and is
not repeated here. The SPM aims to capture the electrochemical phenomena along the
thickness 𝑙𝑗 , 𝑗 ∈ {neg, pos} of each porous electrode by a representative spherical particle.
Thus the two distinct solid phase porous regions of the cell i.e., the negative and positive
electrode regions, are idealised as two spheres of radii 𝑅neg and 𝑅pos respectively.

    Figure 5.1 shows the geometrical origins of the basic SPM. In this arrangement, the spatial
dimension along the axial thickness of each electrode degenerates to a single point which is
represented by a sphere. Hence, the concentration of lithium within each electrode 𝑐s𝑗 , 𝑗 ∈
{neg, pos} is only a function of the radial position 𝑟𝑗 , 𝑗 ∈ {neg, pos} and the time 𝑡. The surface
area of each representative sphere is scaled appropriately, such that they are equivalent to
the active area 𝐴elec of the corresponding porous electrodes. Thus the SPM accounts for the
reduced volume-fraction arising due to the microporous structure of the solid phase and hence,
the storage capacity of the representative particles match that of the corresponding electrodes.
The overarching assumption of the SPM modelling philosophy is that the electrochemical

                                                155
                                                                  5.1 SPM Model Development


performance of these representative electrodes are sufficient to model the voltage behaviour
of the cell at its terminals. The SPM thus employs the coarsest possible spatial discretisation
of the cell’s thickness with the goal of minimising computational burden.




                               pn                                      pp



  Figure 5.1 Schematic illustration depicting the geometrical origins of the basic SPM. The model
  is obtained through a degenerate spatial discretisation of one electrochemical layer of a pouch
  cell. The active material of each porous electrode is represented by one representative spherical
  particle, thus entirely eliminating the spatial dimension along the axial direction. Illustration
  adapted from Moura et al. [43].



5.1.2    Scope and Assumptions

Having described the geometrical representation of the model, it is imperative to establish
its aims and scope. This section discusses the subset of physical phenomena that can be
captured by the basic SPM and enumerates the inherent assumptions in model derivation.
The validity of these assumptions and their effects on model accuracy shall be examined in
the results presented in section 5.3.3. As a broad outline of its scope, the model attributes the
cell polarisation to two dominant physics viz. reaction kinetics and solid phase transport
phenomena i.e., diffusion dynamics.

                                                156
                                                                5.1 SPM Model Development


   The SPM assumes that charge transfer happens throughout the surface of each represent-
ative spherical particle where intercalation occurs. The electronic conductivity of the solid
phase is assumed to be high enough to ignore the spatial distribution of charge i.e., the local
volumetric current density is assumed to be uniform along the thickness of each porous
electrode. This assumption is motivated from early calculations by Newman and Tobias [190]
in their stand-alone analysis of current distributions in porous electrodes, wherein a volume-
averaged molar flux was deemed sufficient throughout the thickness of the electrode. This
uniform current density assumption implies that all of the particles in the electrode active
material are in parallel. Solid phase diffusion dynamics within each electrode are therefore
solved by assuming this averaged electrochemical reaction rate. In the simulation study by
Smith and Wang [34], it is reported that soon after the beginning of discharge, solid phase
concentration and ionic flux become nearly independent of spatial position, and that lithium
diffusion in solid particles may be driven by an averaged molar flux at the surface.

   Based on the discussion thus far, it is clear that the SPM does not attempt to model all
physical processes within the cell. In particular, the model assumes instantaneous charge
transport from one electrode to the other through the solution phase. This implies that
electrolytic diffusion is sufficiently fast (relative to diffusion in the solid phase). Thus, mass
transport phenomena in the electrolyte have been neglected in the basic SPM.

   During the operation of the cell, the SPM assumes that the electrolyte concentration 𝑐e
remains constant at its equilibrium initial value 𝑐e,0 throughout the cell thickness. Neglecting
local concentration gradients in the solution phase, together with ignoring its mass transport
phenomena, implies that the current in the electrolyte does not vary over space and time.
Hence, in the conventional SPM there is no contribution of the solution phase to internal
overpotentials i.e., electrolyte dynamics have no influence on the cell’s terminal voltage. The
SPM also ignores any variations in material porosities in each electrode. Furthermore, all
solid phase diffusivities and kinetic parameters are held constant. Finally, all thermal effects
are assumed to be negligible and no degradation effects are attempted to be modelled in the
basic SPM formulation.

   These simplifying assumptions are made so as to facilitate the ease of implementing a
PBM, without incurring the heavy computational cost that typically accompanies it. The
impact of these assumptions on the accuracy of the model shall be examined in section 5.3.3

                                               157
                                                                           5.1 SPM Model Development


and later sections presents prior research that strives to straddle the fine balance between
model sophistication and computational complexity.


5.1.3      Governing Equations

As discussed in section 5.1.2, the SPM captures the cell’s dynamics arising due to diffusion and
kinetics at the two representative spherical electrodes. It also accounts for the contribution
of their equilibrium thermodynamics to the cell’s Open Circuit Potential (OCP).

Solid Phase Diffusion

Conservation of   Li 0   in the electrodes can be obtained by assuming that the movement of
neutral atoms within the solid phase is primarily due to diffusion within particles. This
diffusion phenomena is induced due to a concentration gradient that exists between the
surface and interior/core of the solid phase particles. Based on the geometrical assumptions
of the SPM as discussed in section 5.1.1 i.e., owing to the lack of spatial discretisation in
the axial direction 𝑥, the concentrations of            Li 0   in the two electrodes 𝑐s𝑗 (𝑥, 𝑟, 𝑡), reduce to
a function of the radial co-ordinate 𝑟 and time 𝑡, and is denoted by 𝑐s𝑗 (𝑟, 𝑡), 𝑗 ∈ {neg, pos}.
To keep the notation tractable, this explicit spatio-temporal radial dependence is omitted,
further simplifying the representation to 𝑐s𝑗 . We start with the derivation of the solid-phase
diffusion equation eq. (1.3) in table 1.1, and then proceed to the simplifications of its boundary
conditions facilitated by the SPM assumptions.

   Diffusion in the solid phase can be modelled by applying classical Fickian dynamics [68]
given by
                              𝜕𝑐s𝑗
                                     = ∇⋅ (𝐷s𝑗 ∇𝑐s𝑗 )            𝑗 ∈ {neg, pos}                         (5.1)
                               𝜕𝑡
The divergence of a vector field F(𝑟, 𝜃, 𝜙) can be expressed in spherical co-ordinates as

                                         2
                              1      𝜕 (𝑟 𝐹   𝑟)        1 𝜕 (sin 𝜃 𝐹𝜃 )      1 𝜕𝐹𝜙
                         ∇⋅F= 2                    +                    +                               (5.2)
                             𝑟         𝜕𝑟            𝑟 sin 𝜃   𝜕𝜃         𝑟 sin 𝜃 𝜕𝜙

where 𝑟 denotes the radius, 𝜃 the polar angle, and 𝜙 the azimuthal angle. 𝐹𝑟 , 𝐹𝜃 and 𝐹𝜙 denote
the corresponding components of the vector field F.

   The co-ordinate origin at each electrode is aligned with the centre of its representative
spherical particle. Due to symmetry in the polar and azimuthal axes, the divergence becomes

                                                        158
                                                                       5.1 SPM Model Development


a function of only the radial position. Equation (5.2) therefore reduces to

                                                         2
                                                     𝜕 (𝑟 𝐹
                                             1                𝑟)
                                        ∇⋅F= 2                                                  (5.3)
                                            𝑟            𝜕𝑟

Applying the Right-Hand Side (RHS) of the divergence operator of eq. (5.3) in eq. (5.1) yields

                                     𝜕𝑐s𝑗 1 𝜕 2
                                        = 2   (𝑟 𝐷s𝑗 ∇𝑐s𝑗 )                                     (5.4)
                                     𝜕𝑡  𝑟 𝜕𝑟

As per the assumption of uniform diffusivity in the solid phase, eq. (5.4) becomes

                                     𝜕𝑐s𝑗 𝐷s𝑗 𝜕
                                         = 2      2
                                                (𝑟 ∇𝑐s𝑗 )                                        (5.5)
                                      𝜕𝑡   𝑟 𝜕𝑟

Applying the gradient operator of eq. (5.5) along the radial direction 𝑟,

                                     𝜕𝑐s𝑗 𝐷s𝑗 𝜕      𝜕𝑐s𝑗
                                         = 2    (𝑟 2      ).                                    (5.6)
                                      𝜕𝑡   𝑟 𝜕𝑟       𝜕𝑟

Equation (5.6) represents a mass-balance equation describing solid phase diffusion in each
electrode and is identical to the governing equation eq. (1.3) from table 1.1. The potential at
each electrode depends on the solid phase surface concentration 𝑐s,surf𝑗                   0
                                                                               i.e., the Li concentra-
tion 𝑐s𝑗 (𝑟, 𝑡) evaluated at 𝑟 = 𝑅p , 𝑗 ∈ {neg, pos} where 𝑅p represents the equivalent radius of
                                 𝑗                                 𝑗
each representative spherical particle.

   Due to spherical symmetry, flux at the centre of the particle is considered to be zero.

                                                𝜕𝑐s𝑗 |
                                                     |=0                                         (5.7)
                                                 𝜕𝑟 |𝑟=0

Diffusion in the solid phase is driven by concentration gradients induced due to intercalation
flux density at the particle surface i.e., the surface of each particle experiences a pore-wall
flux density driven by reaction kinetics. Based on the SPM geometry discussed in section 5.1.1,
the spatial dependence of this molar flux density 𝑗n𝑗 (𝑥, 𝑡) is eliminated and it can therefore be
represented as 𝑗n𝑗 (𝑡), 𝑗 ∈ {neg, pos}. For the sake of brevity, its explicit temporal dependence
is also omitted resulting in a simplified notation 𝑗n𝑗 . Hence, at the particle surface
                                                𝜕𝑐s𝑗 |
                                            𝐷s𝑗      | = −𝑗n𝑗                                   (5.8)
                                                 𝜕𝑟 |𝑟=𝑅
                                                         p𝑗

                                                  159
                                                                           5.1 SPM Model Development


The sign convention chosen here is such that pore-wall flux leaving the particle surface is
considered to be negative.

    Charge conservation in solid phase is applied to evaluate the RHS in eq. (5.8), a detailed
derivation of which is presented in Domenico et al. [96]. In summary, by assuming a uniform
charge density throughout the thickness of each electrode (see section 5.1.2), we get

                                              𝐼 (𝑡)
                                𝑗n𝑗 (𝑡) = ±                      𝑗 ∈ (neg, pos)                 (5.9)
                                            𝐴 𝑙𝑗 𝑎s𝑗 𝐹

Substituting eq. (5.9) in eq. (5.8)

                                𝜕𝑐s𝑗 |       𝐼
                            𝐷s𝑗      |=∓                         𝑗 ∈ (neg, pos)                (5.10)
                                 𝜕𝑟 |𝑟=𝑅 𝐴 𝑙𝑗 𝑎s𝑗 𝐹
                                           p𝑗



wherein the load current 𝐼 (𝑡) > 0 for discharge, whose explicit time-dependence has been
omitted in eq. (5.10) for being consistent notation with the Left-Hand Side (LHS). The positive
and negative signs apply to the negative and positive electrode respectively as indicated
by the ordered pair 𝑗 ∈ (neg, pos). It should be noted that the term involving the Faraday
constant in the RHS of eq. (5.9) is 𝑛𝐹, where 𝑛 is the number of electrons transferred during
the reaction. However, since this thesis only discusses lithium-ion chemistries where 𝑛 = 1,
this is implicitly conveyed and shall be omitted for all potential occurrences.

    The cell’s State of Charge (SOC) can be obtained from the bulk concentration of lithium
in either the negative or positive electrode. By convention, the negative electrode is used.

                                                        𝑅p
                                            3            neg    2
                               𝑧(𝑡) =               ∫          𝑟 𝑐𝑠neg (𝑟, 𝑡) 𝑑𝑟                (5.11)
                                        𝑐s,maxneg   0



    Given an initial cell SOC 𝑧(0) = 𝑧0                                                0
                                           at rest, the equilibrium concentration of Li in the two
individual electrodes can be computed as

                           𝑐s𝑗 (𝑟, 0) = 𝑐s,max𝑗 [𝑧0 (𝜃100%𝑗 − 𝜃0%𝑗 ) + 𝜃0%𝑗 ]                  (5.12)

where 𝜃100%𝑗 and 𝜃0%𝑗 are the electrode stoichiometries at 100 % SOC and 0 % SOC respectively.



                                                    160
                                                                5.1 SPM Model Development


   Equation (5.6), its corresponding boundary conditions (5.7) and (5.10) along with initial
condition (5.12), provide the complete description of time-domain evolution of lithium in
the conventional SPM for a given applied current profile 𝐼 (𝑡). Considerations for efficient
numerical simulation of this system is presented next.

Further Reduction in Dimensionality

A naive approach to numerically solving the solid phase diffusion equation is to discretise each
of the two representative particles in the radial direction 𝑟. Given the elaborate simplifications
made to remove spatial resolution from the axial direction, the efficacy of using a radial
discretisation is rendered questionable, particularly within the scope of embedding the model
in an online simulation and state-estimation environment. Since diffusion in each spherical
particle is modelled by the well-known Fickian dynamics [68], several attempts have been
made to obtain an approximate analytical solution for the solid phase concentration in both
electrodes. In a dimensionless analysis study, Zhang and White [191] provide a comparative
evaluation of the various approximation methods for solid phase diffusion, a summary of
which is presented in table 5.1.

             Table 5.1   Summary of approximation methods for solid phase diffusion

              Approximation Method              Introduced by
              Duhamel’s superposition           Doyle, Fuller & Newman [15, 16]
              Diffusion length                  Wang et al. [192]
              Corrected Diffusion length        Wang and Srinivasan [193]
              Polynomial approximation          Subramanian et al. [78, 98]
              Pseudo steady-state               Liu [81]


   In the aforementioned study, the computational burden i.e., storage requirements and
Central Processing Unit (CPU) times of Duhamel’s superposition method was found to
be excessively high to warrant further interest in it. The original diffusion length method
proposed by Wang et al. is valid only after the diffusion layer builds up to its steady state,
and hence leads to significant errors in transient conditions. Although Wang and Srinivasan
introduced an empirical correction factor to the diffusion length to extend its validity to short-
time scale operations, this affected the convergence of the method for steady state conditions.
The pseudo steady state solution proposed by Liu uses a finite integral transform technique
to eliminate the radial dependence of solid phase concentration. However, this method uses

                                               161
                                                                            5.1 SPM Model Development


computations involving infinite summations, exponential and trigonometric quantities, which
in this thesis author’s view, makes it less attractive for online implementations.

    The literature on polynomial methods by Subramanian et al. [78] provide detailed
derivations of the 2nd and 4th order polynomial approximations. The 2nd order solution
was found to have poor performance for transient behaviour, similar to that of the original
diffusion length method. However, higher order polynomial approximations were found to
provide acceptable levels of performance for both transient and steady state conditions and
shall therefore be examined further.

    The polynomial approximation method describes the dynamic evolution of the volume
averaged concentration
                                                 1
                                     𝑐s,avg (𝑡) = ∫ 𝑐s𝑗 (𝑟, 𝑡) 𝑑Ω                               (5.13)
                                           𝑗     Ω
                                                            Ω
as a function of the applied load current 𝐼 (𝑡). Here, Ω represents the volume of the spherical
particle. For notational brevity, 𝑐s,avg (𝑡) is shortened to 𝑐s𝑗 whilst also dropping its explicit
                                               𝑗
time dependence.

    The 4th order polynomial approximation assumes that the solid phase concentra-
tion 𝑐s𝑗 (𝑟, 𝑡) is a quartic function of the radial co-ordinate 𝑟.

                                                                    2                 4
                                                      𝑟          𝑟
                           𝑐s𝑗 (𝑟, 𝑡) = 𝑎(𝑡) + 𝑏(𝑡) ( ) + 𝑑(𝑡) ( )                              (5.14)
                                                     𝑅p         𝑅p
                                                                𝑗                 𝑗




    The detailed derivation of the coefficients 𝑎(𝑡), 𝑏(𝑡) and 𝑐(𝑡) is provided in Sub-
ramanian et al. [78]. Eqs. (5.15)–(5.17) summarise the governing equations obtained by
applying the 4th order polynomial approximation of eq. (5.14) to the system of equations
given by eqs. (5.6), (5.7) and (5.10).
                                                       𝑑           𝑗n 𝑗
                                                          𝑐 s𝑗 + 3      =0                      (5.15)
                                                       𝑑𝑡          𝑅p
                                                                        𝑗

                                    𝑑         𝐷s𝑗     45 𝑗n𝑗
                                       𝑞𝑗 + 30 2 𝑞𝑗 +        = 0                                (5.16)
                                    𝑑𝑡        𝑅p       2 𝑅p2
                                                        𝑗               𝑗
                                    𝐷s𝑗
                               35            (𝑐s,surf𝑗 − 𝑐s𝑗 ) − 8𝐷s𝑗 𝑞𝑗 = −𝑗n𝑗                 (5.17)
                                    𝑅p
                                         𝑗


                                                        162
                                                                     5.1 SPM Model Development


where 𝑞𝑗 (𝑡) represents the volume averaged concentration flux, that defines the average
change of concentration with respect to the radial position 𝑟.

    As per eq. (5.9), the interfacial flux density is proportional to the applied current. Hence
eq. (5.15) implies a simple linear relationship between the applied current and the rate of
evolution of average   Li 0   concentration within each spherical particle. This further implies
that the SOC of the cell has a linear rate-dependence on the externally applied current.
Furthermore, due to the elimination of radial discretisation, the computation of SOC, given
by eq. (5.11), reduces to the task of first computing the ratio of bulk (average) concentration
to surface concentration and then adjusting it to account for the useable stoichiometry limits
for the relevant electrode. Thus, the cell’s SOC can be computed as

                                              𝑐s,neg
                                             𝑐s,maxneg    − 𝜃0%neg
                                        𝑧=                                                  (5.18)
                                             𝜃100%neg − 𝜃0%neg

where 𝑐s,neg is obtained by solving eq. (5.15) for the negative electrode.

    In the views of this author, this 4th order polynomial approximation proposed by
Subramanian et al. [78] strikes an acceptable balance between the three modelling pivots
— i) computational complexity, ii) mathematical tractability, and iii) numerical accuracy and
has therefore been adopted for all SPM simulations presented in this work.

    At the end of this dimension-reduction step, spatial dependence is completely eliminated,
yielding a zero-order (in space) physical model whose dynamics are described by the
Differential Algebraic Equation (DAE) system of eqs. (5.15)–(5.17).

Equilibrium Thermodynamics

The equilibrium potential of a porous electrode is a thermodynamic property that depends on
the extent of lithiation in the outermost interstitial sites near the Solid-Electrolyte Interphase
(SEI) layer. This surface stoichiometry 𝜃𝑗 for an electrode is obtained by computing the
surface concentration (using eq. (5.17)) and dividing by the maximum lithiation capacity of
that electrode.
                                                    𝑐s,surf𝑗
                                             𝜃𝑗 =                                           (5.19)
                                                    𝑐s,max𝑗


                                                    163
                                                                             5.1 SPM Model Development


   Although based upon the theoretical foundation laid out by the Nernst equation, owing
to a multitude of complex phase transitions, the potential of porous electrodes (with respect
to metallic lithium) is usually given as empirical functions of its surface stoichiometry [4, 8].

                                           𝑈𝑗 (𝑡) = 𝒰𝑗 (𝜃𝑗 (𝑡))                                  (5.20)

where the empirical relationships 𝒰𝑗 are typically high order polynomials or rational func-
tions that are fitted to relaxation data from Galvanostatic Intermittent Titration Technique
(GITT) experiments on half-cells [14, 194].

   In the SPM, the cell’s OCP is obtained by subtracting the negative electrode equilibrium
potential 𝑈neg from its positive electrode counterpart 𝑈pos , as shown in eq. (5.21).

                                           𝑈ocp = 𝑈pos − 𝑈neg                                    (5.21)

Even though the concept of OCP is defined only in equilibrium conditions when no current
flows, the individual electrode potentials themselves form a significant component of the
cell’s terminal voltage 𝑉 (𝑡).

Reaction Kinetics

In the SPM, the reaction kinetics in each spherical electrode is modelled using the Butler-
Volmer expression (see eq. (1.7)).

                                              (1 − 𝛼) 𝐹 𝜂𝑗           −𝛼𝐹 𝜂𝑗
                          𝑗n 𝑗   = 𝑗0𝑗 [exp (              ) − exp (        )]                   (5.22)
                                                  𝑅𝑇                  𝑅𝑇
where
                                                                         1−𝛼
                          𝑗0 𝑗 =        1−𝛼 𝛼
                                   𝑘r𝑗 𝑐e 𝑐s,surf    (𝑐s,max𝑗 − 𝑐s,surf𝑗 )                       (5.23)
                                                 𝑗




   The equilibrium rate of forward and backward reactions at both electrodes is assumed to
be equal. With charge transfer coefficient 𝛼 = 0.5, eq. (5.22) simplifies to

                                                                                𝐹 𝜂𝑗
                       𝑗n𝑗 = 2𝑘r𝑗 𝑐e 𝑐s,surf𝑗 (𝑐s,max𝑗      − 𝑐s,surf𝑗 ) sinh (      )           (5.24)
                                 √                                              2𝑅𝑇




                                                      164
                                                                      5.1 SPM Model Development


    The expression for overpotential 𝜂𝑗 for the basic SPM can be obtained by rearranging
eq. (5.24), substituting for 𝑗n𝑗 from by eq. (5.9) whilst using the initial electrolyte concentration
𝑐e,0 and is given by


                         2𝑅𝑇        ⎛                       ±𝐼 (𝑡)                        ⎞
                                 −1
                𝜂𝑗 (𝑡) =     sinh ⎜                                                       ⎟    (5.25)
                          𝐹         ⎜                                                     ⎟
                                      2𝐴 𝑙𝑗 𝑎s𝑗 𝐹 𝑘r𝑗 𝑐e,0 𝑐s,surf𝑗 (𝑐s,max𝑗 − 𝑐s,surf𝑗 )
                                    ⎝                √                                    ⎠


Cell Terminal Voltage

The terminal voltage of the cell under applied load is obtained by subtracting the potential
of the negative electrode from its positive counterpart.

    Starting from the definition of the overpotential of each electrode

                                                          ⌃0
                                   𝜂pos =            𝜙e,pos
                                            𝜙s,pos −   
                                                              − 𝑈pos                          (5.26)
                                                            0
                                   𝜂neg =            𝜙e,neg
                                            𝜙s,neg −   ⌃
                                                          
                                                              − 𝑈neg                           (5.27)

Within each electrode domain, the contribution of electrolyte potential is neglected (see
sections 5.1.1 and 5.1.2 for a brief discussion on the exclusion of electrolyte dynamics).

    Subtracting eq. (5.27) from eq. (5.26),

                             𝜂pos − 𝜂neg = 𝜙 s,pos
                                           ⏟⏟⏟⏟⏟   − 𝜙 s,neg −𝑈 pos + 𝑈 neg                    (5.28)
                                                   𝑉cell
whose rearrangement yields
                                     𝑉cell = 𝜂pos − 𝜂neg + 𝑈pos − 𝑈neg                        (5.29)

In the basic SPM, eq. (5.29) is used to compute the cell’s terminal voltage under load. Although
their explicit time-dependence notation is omitted in the notation here, it is worth reminding
that all quantities in eq. (5.29) are indeed continuous functions of time.

State Space Representation

For control oriented applications, it is imperative to have a classical state space representation
that collates all intermediate equations and definitions presented thus far into a single system

                                                   165
                                                                                   5.1 SPM Model Development


of equations that describes the evolution of solid concentration and terminal voltage over
time, expressed as a response to the external current input 𝐼 (𝑡). However, the non-linearities
in the equation for terminal voltage i.e., eq. (5.29) imply that it is not possible to represent
the SPM in the form of a classical Linear Time-Invariant (LTI) system of eq. (2.1). Instead,
the SPM can be summarised by a system of linear state equations together with the single
non-linear output equation.

    Rearranging eqs. (5.16) and (5.17), the state equation is obtained as

                           𝐷s,pos                                                             45            1
     ⎛ 𝑞pos ⎞ ⎛−30         𝑅p2
                              0       0 0 ⎞ ⎛ 𝑞pos ⎞                 𝐴 𝑙pos 𝑎s,pos 𝐹  ⎞      ⎛ 2 𝑅2
                                                                                                  p
     ⎜        ⎟ ⎜     pos
                                          ⎟⎜         ⎟ ⎜         pos
                                                                                      ⎟
                              𝐷s,neg                       45          −1
     ⎜𝑞 ⎟ ⎜         0     −30   2     0 0 ⎟⎜𝑞 ⎟ ⎜ 2 2                                 ⎟
  𝑑 ⎜ neg ⎟ ⎜                 𝑅p
                                  neg     ⎟ ⎜
                                                neg
                                                     ⎟   ⎜
                                                              𝑅p 𝐴 𝑙neg 𝑎s,neg 𝐹
                                                                neg                   ⎟ 𝐼 (𝑡)
                =                                      +
  𝑑𝑡 ⎜        ⎟   ⎜                       ⎟ ⎜        ⎟   ⎜                3           ⎟
       𝑐s,pos       0         0       0 0     𝑐s,pos          𝑅p 𝐴 𝑙pos 𝑎s,pos 𝐹
     ⎜        ⎟ ⎜                         ⎟⎜         ⎟ ⎜         pos                  ⎟
     ⎜𝑐       ⎟ ⎜   0         0       0 0 ⎟ ⎜ 𝑐s,neg ⎟   ⎜             −3             ⎟
        s,neg                                                 𝑅      𝐴 𝑙     𝑎      𝐹
     ⎝        ⎠ ⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
                  ⎝                       ⎠⎝         ⎠ ⏟⏟⎝ ⏟⏟⏟⏟pneg      neg  s,neg
                                                                              ⏟⏟⏟     ⎠
                                              𝐴                                                         𝐵
                                                                                                                          (5.30)
which corresponds to the classical LTI form

                                                    ẋ = 𝐴 x + 𝐵 u                                                        (5.31)

where x = [ 𝑞pos 𝑞neg 𝑐s,pos 𝑐s,neg            𝑇
                                              ] ,   𝑥∈    4×1
                                                         ℝ is the state vector. The scalar system input u                     ∈
ℝ is the applied current 𝐼 (𝑡). The system matrix 𝐴 ∈                   ℝ 4×4    and input matrix 𝐵 ∈           ℝ 4×1   are also
shown in eq. (5.30).

    For state estimation and controller design purposes, it is important to keep the number
of elements in the state vector as small as possible by eliminating redundant variables. For
instance, Di Dominico et al. [96] noted that with output voltage as the only measured quantity,
the observability of the four-state model of eq. (5.30) is adversely affected. To tackle this issue,
a state-reduction approach was proposed by Di Domenico et al. [96], which hinges upon the
principle of material balance.

    The total number of moles of lithium in the system is given by

           𝜀s,pos 𝑙pos 𝐴       𝑅p                                𝜀s,neg 𝑙neg 𝐴        𝑅p
                                pos      2                                             neg      2
   𝑛Li =     4     3       ∫          4𝜋𝑟 𝑐s,pos (𝑟, 𝑡) 𝑑𝑟   +     4     3        ∫          4𝜋𝑟 𝑐s,neg (𝑟, 𝑡) 𝑑𝑟         (5.32)
             3   𝜋𝑅p        0                                      3   𝜋𝑅p         0
                     pos                                                   neg


                                                           166
                                                                               5.1 SPM Model Development


Upon considering only the bulk concentration as per the dimensionality reduction procedure
outlined in section 5.1.3, eq. (5.32) reduces to

                𝜀s,pos 𝑙pos 𝐴              𝑅p                  𝜀s,neg 𝑙neg 𝐴              𝑅p
                                            pos      2                                     neg      2
        𝑛Li =     4     3
                                𝑐s,pos ∫          4𝜋𝑟 𝑑𝑟   +     4     3
                                                                               𝑐s,neg ∫          4𝜋𝑟 𝑑𝑟     (5.33)
                  3   𝜋𝑅p              0                         3   𝜋𝑅p              0
                          pos                                            neg

            = 𝜀s,pos 𝑙pos 𝐴 𝑐s,pos + 𝜀s,neg 𝑙neg 𝐴 𝑐s,neg                                                  (5.34)

Assuming no loss of cycleable lithium or other degradation mechanisms, the total number of
                                                                𝑑𝑛Li
moles of lithium in the system is conserved i.e.,                𝑑𝑡    = 0. Substituting this into eq. (5.33),

                                     𝑑                        𝑑
                                0=      𝜀s,pos 𝑙pos 𝐴 𝑐s,pos + 𝜀s,neg 𝑙neg 𝐴 𝑐s,neg                         (5.35)
                                     𝑑𝑡                       𝑑𝑡
                        𝑑            𝑑
                           𝑐s,pos = − 𝑐s,neg                                                                (5.36)
                        𝑑𝑡           𝑑𝑡


   As per eq. (5.36), the time evolution of the bulk concentration of one electrode can be
obtained as a function of the other. Furthermore, Di Domenico et al. [96] show that the
diffusion dynamics of the bulk concentrations can be algebraically related through their
stoichiometric factors as

                                  𝑐s,neg (𝑡) − 𝜃0%neg 𝑐s,maxneg
      𝑐s,pos (𝑡) = 𝑐s,maxpos [                                          (𝜃100%pos − 𝜃0%pos ) + 𝜃0%pos ]     (5.37)
                                 (𝜃100%neg − 𝜃0%neg ) 𝑐s,maxneg


   Hence, it is possible to eliminate the bulk concentration of any one of the electrodes from
the state-equation to arrive at a three-state description of the model dynamics. In extant
lithium-ion chemistries, owing to its proclivity for lithium deposition during charging, the
negative electrode is considered to be the limiting electrode (See Arora et al. [27]). Hence it
is retained in the state vector, thereby leading to the final form of the state dynamics of the




                                                       167
                                                                                5.1 SPM Model Development


conventional SPM as

                           𝐷s,pos                                            45             1
       ⎛ 𝑞pos ⎞ ⎛−30       𝑅p2
                               0      0 ⎞ ⎛ 𝑞pos ⎞                          ⎛ 2 𝑅2
                                                                 𝐴 𝑙pos 𝑎s,pos 𝐹  ⎞
                                                                                 p
       ⎜        ⎟ ⎜    pos
                                        ⎟⎜         ⎟ ⎜       pos
                                                                                  ⎟
    𝑑 ⎜         ⎟ ⎜            𝐷s,neg
                                        ⎟ ⎜        ⎟   45          −1
         𝑞neg =      0     −30 𝑅 2    0              ⎜
                                            𝑞neg + 2 𝑅 2 𝐴 𝑙 𝑎 𝐹 ⎟ 𝐼 (𝑡)                                (5.38)
    𝑑𝑡 ⎜        ⎟ ⎜              pneg
                                        ⎟⎜         ⎟ ⎜     pneg      neg s,neg
                                                                                  ⎟
       ⎜𝑐       ⎟ ⎜  0         0      0 ⎟ ⎜ 𝑐s,neg ⎟ ⎜             −3             ⎟
          s,neg                                           𝑅      𝐴 𝑙     𝑎      𝐹
       ⎝        ⎠ ⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟⏟
                  ⎝                     ⎠⎝           ⎝ ⏟⏟⏟⏟
                                                   ⎠ ⏟⏟    pneg      neg  s,neg
                                                                          ⏟⏟⏟     ⎠
                                     𝐴                                                 𝐵


   The measured variable 𝑦 ∈ ℝ is the cell’s terminal voltage 𝑉 (𝑡) and is expressed as a
non-linear scalar function of the state vector and the load current.

                                             𝑦 = ℎ (x(𝑡), 𝑢(𝑡))                                         (5.39)

The output equation given by eq. (5.39) includes a non-zero direct feedthrough dependency
of the voltage on the input current, thereby modelling the resistive component of the cell’s
impedance. The full expression for output voltage is given by expanding eq. (5.29) as


              2𝑅𝑇        ⎛                                −𝐼 (𝑡)                                  ⎞
                      −1
  𝑉cell (𝑡) =     sinh ⎜                                                                          ⎟
               𝐹         ⎜                                                                        ⎟
                           2𝐴𝑙pos 𝑎s,pos 𝐹 𝑘rpos 𝑐e,0 𝑐s,surfpos (𝑡) (𝑐s,maxpos − 𝑐s,surfpos (𝑡))
                         ⎝                      √                                                 ⎠

            2𝑅𝑇        ⎛                                  𝐼 (𝑡)                                  ⎞
                    −1
          −     sinh ⎜                                                                           ⎟
             𝐹         ⎜                                                                         ⎟
                         2𝐴 𝑙neg 𝑎s,neg 𝐹 𝑘rneg 𝑐e,0 𝑐s,surfneg (𝑡) (𝑐s,maxneg − 𝑐s,surfneg (𝑡))
                       ⎝                       √                                                 ⎠
                                                         + 𝒰pos (𝑐s,surfpos (𝑡)) − 𝒰neg (𝑐s,surfneg (𝑡)) (5.40)

wherein the solid phase surface concentration at each electrode 𝑐s,surf𝑗 is obtained from its
corresponding bulk concentration 𝑐s,avg by rearranging eq. (5.17) and is given by
                                                  𝑗


                                            8𝑅p                           𝑅p
                                                  pos                          pos
                    𝑐s,surfpos = 𝑐s,pos +               𝑞pos +                              𝐼 (𝑡)        (5.41)
                                             35                  35𝐷s,pos 𝐴 𝑙pos 𝑎s,pos 𝐹
                                            8𝑅p                           𝑅p
                                                  neg                          neg
                    𝑐s,surfneg = 𝑐s,neg +               𝑞neg −                               𝐼 (𝑡)      (5.42)
                                             35                  35𝐷s,neg 𝐴 𝑙neg 𝑎s,neg 𝐹

where 𝐼 (𝑡) > 0 for discharge.


                                                          168
                                                                      5.2 Numerical Implementation


    Given the initial SOC of the cell 𝑧(0), the initial bulk concentration of the negative
electrode at equilibrium 𝑐s,neg (0) is obtained by eq. (5.12). The initial value of the mean radial
concentration flux in both electrodes is zero i.e., 𝑞𝑗 (0) = 0. Therefore, the initial state vector
is [ 0 0 𝑐s,neg        𝑇
                  (0) ] . Thus, the system of equations given by eqs. (5.37)–(5.42) form a complete
state-space representation of the conventional SPM. This state-space model can be simulated
as a standalone Initial Value Problem (IVP) or embedded as the plant model in control-oriented
applications such as for dynamic state estimation.


5.2     Numerical Implementation
The equations presented in section 5.1 are well-known, self-sufficient and fully descriptive so
as to implement the basic SPM. Although discrete-time numerical implementation of circuit-
oriented cell models has been considered [11, 195–197], there has been no such treatment of
this critical aspect in the SPM modelling literature. Since this thesis has a strong focus towards
enabling the use of PBMs in an embedded environment, at least the numerical aspects of
implementing these equations need to be discussed. The finer details and practical engineering
considerations of real-time programming, in particular the integration of the cell model into
the pack, interaction with upstream components and other such aspects of a typical vehicular
drivetrain controller, are beyond the scope of this academic work. Nevertheless, the discussion
here aims to lower the barrier to real-time implementation and is a unique contribution in
the implementation context of cell models.


5.2.1       Continuous-time Implementation

Analytical solution

Although not explicitly given in SPM literature, using LTI system theory, the analytical
solution for continuous-time state equation (eq. (2.1)) with current                input∗   is given by

                                                            𝑡
                               x(𝑡) =   𝑒 𝐴(𝑡−𝑡0 ) x(𝑡0 ) + ∫ 𝑒 𝐴(𝑡−𝜏 ) 𝐵u(𝜏 ) 𝑑𝜏                          (5.43)
                                                             𝑡0


    ∗ The
        analytical closed form solution cannot be obtained for constant voltage operation. This is because the
boundary flux is implicitly determined by the non-linear Butler-Volmer equation eq. (1.7) and needs to be solved
numerically with some variant of a Newton-type iteration scheme.


                                                      169
                                                                       5.2 Numerical Implementation


With a standard IVP, 𝑡0 = 0
                                                     𝑡
                           x(𝑡) =      𝐴𝑡
                                      𝑒 x(0) +           𝑒 𝐴(𝑡−𝜏 ) 𝐵u(𝜏 ) 𝑑𝜏                  (5.44)
                                                   ∫
                                                    0 ⏟⏟⏟⏟⏟⏟⏟
                                                   ⏟⏟
                                                    convolution integral



   The matrix exponential     𝑒 𝐴𝑡   is known as the state-transition matrix and is defined as

                                       𝑒 𝐴𝑡   ≜    −1
                                                  ℒ {(𝑠𝐼          −1
                                                              − 𝐴) }                          (5.45)

although several methods exist for its efficient numeric computation [198].

   The analytical solution given by eq. (5.44) can be applied to obtain the matrix-vector state
equation eq. (5.38) of the SPM. Once the state variables are obtained at a given time-step, after
evaluating the surface concentrations as per eq. (5.41) and eq. (5.42), they may be substituted
into the output equation of eq. (5.40) to obtain the cell’s terminal voltage for that time-step.

Numerical considerations for continuous time implementation

The procedure described thus far has a practical limitation. The input current 𝐼 (𝑡) to the cell
has been defined as a continuous quantity. Although for the purpose of characterising the
cell’s behaviour, it is possible to use pre-determined continuous-functions as load profiles
(e.g. sinusoidal waveforms for virtual Electrochemical Impedance Spectroscopy (EIS) testing),
it is desirable to evaluate the model’s response to typical real-life conditions. In a vehicular
application, only samples of cell current measured by sensors at discrete-time intervals are
reported to the Battery Management System (BMS). A Zero Order Hold (ZOH) operation is
used at the model’s input i.e., the level of current is assumed to be held constant between two
successive measurements.

   It is tedious to hand-compute the convolution integral of eq. (5.44). However, state of
the art adaptive-time solvers employing numerical schemes such as Dormand-Prince, Runge-
Kutta, Collocation and Backward Differentiation Formula are available to efficiently handle
such Ordinary Differential Equations (ODEs). Since lithium concentrations vary smoothly
over time without abrupt discontinuities, a standard non-stiff solver of moderate order shall
suffice. An example line of code using MATLAB’s ode45 solver for this time integration is
[~,x_new] =      ode45(@(t,x) stateEqn(x,Ik,spm_params), t_span, x_old);

                                                    170
                                                          5.2 Numerical Implementation


   Since the direction of applied current is susceptible to sudden reversals, (e.g. due to
acceleration and braking events in a vehicular application), the solver needs to be stopped
and re-started every sample period. Algorithm 5.1 shows the sequence of operations for a
desktop simulation of the continuous time SPM on a digital computer. The source code listing
of an example implementation in MATLAB is provided in listing A.1.

   In the author’s view, the continuous time SPM algorithm has limited practical use.
Computing the convolution integral or deploying ODE solver codes onto a microcontroller is
challenging and introduces substantial computational burden. Although the continuous time
model can be used for desktop simulation, more sophisticated PBMs are already available for
this task. Therefore, for online deployment in state estimation and control tasks, a discrete-
time version of the model suitable for real-time implementation is needed.


5.2.2   Conceptual Overview of Real-Time Processing

The equations in section 5.1.3 are derived in continuous time form. In particular, the state
equation given by eq. (5.38) describes the continuous time dynamic evolution of quantities
such as the bulk concentration and rate of mean radial flux. However, a typical embedded
controller such as that used in a vehicular BMS operates in discrete-time [3]. This implies
that samples of voltage, current and temperature measurements are obtained at a periodic
time interval 𝑇𝑠 . The updating of solution variables are performed between two successive
data acquisition events from the sensors.

   Execution of control-oriented reduced-order PBMs such as the SPM and their associated
computations are modular sub-tasks of a vehicular BMS. A single BMS often provides a
whole host of other auxiliary functionality such as cell balancing, protection, diagnostics
and data-logging [13]. Although thermal management tasks are typically delegated to
dedicated controllers, the BMS software routines often handle data exchanged between
various subsystems on the vehicular communication bus. While some of these tasks such as
book-keeping and diagnostics can be performed at a low execution-rate, others such as cell
measurements and model-related computations need to be performed with high priority.

   Figure 5.2 shows an example of a plausible implementation of a BMS software in an em-
bedded microcontroller. The vast array of functionality performed by the BMS can be grouped


                                             171
                                                                                         5.2 Numerical Implementation

Algorithm 5.1          Continuous-time SPM
Require: Load profile                                                                                    ▷ e.g. a csv file of 𝑡 vs. C-rate
Require: SPM parameter set                                                                             ▷ e.g. stored in a struct params
User data: 𝑧[1], 𝑡f,user , 𝑡f,condition , cell capacity 𝐼1C , sample rate 𝑇𝑠                                     ▷ 𝑡f,condition ∈ {max, min}
Ensure: 𝑧[1], 𝑉cell [1] within limits                                                                    ▷ index [𝑘 = 1] ≙ time (𝑡 = 0)
 1: procedure SimulateSPM
                     max(𝑡f,user , 𝑡f,profile ), if 𝑡f,condition == max;
 2:    𝑡f,desired = {                                                                                   ▷ may terminate early due to
                     min(𝑡f,user , 𝑡f,profile ), otherwise.                                               cut-off violations
        Note: Flexible end time. Extrapolate last C-rate from profile until 𝑡f,desired if necessary.
                     𝑡f,desired
  3:     𝑁max ←     ⌈ 𝑇𝑠 ⌉        +1                                                          ▷ max iterations assuming no cut-offs
  4:     Allocate storage of size       ℝ 𝑁max ×1   for each simulation variable
  5:     Compute 𝑐s,neg [1] as per eq. (5.12)
  6:     𝐼 [1] ← 𝐼1C × C-rate[1],         x[1] ← [ 0 0 𝑐s,neg      [1] ] 𝑇                                    ▷ C-rate[1] from profile
  7:     𝑉cell [1] ← ComputeCellVoltage(x[1], 𝐼 [1], params)                                                ▷ from direct feedthrough
  8:     for 𝑘 ← 2 ∶ 𝑁max do
  9:         𝐼 [𝑘] ← interpolate from profile using ZOH
 10:         Solve continuous-time equation eq. (5.38)                                                       ▷ solver IC set to 𝑥[𝑘 − 1]
 11:         x[𝑘] ← last time-entry vector of soln. matrix                       ▷ from an adaptive solver e.g. MATLAB’s ode45
 12:         Compute 𝑧[𝑘] as per eq. (5.18)
 13:         𝑉cell ← ComputeCellVoltage(x[𝑘], 𝐼 [𝑘], param)
 14:         if 𝑧[𝑘] or 𝑉cell [𝑘] exceeded cut-off limits then
 15:            𝑘 ←𝑘−1                                                                                  ▷ data from last step is invalid
 16:            break;
 17:         end if
18:   end for
19: end procedure
20: subroutine ComputeCellVoltage(x, I, params)
 21:     Compute 𝑐s,surfneg as per eq. (5.42)                                ▷ consider saturating i.e., 𝑐s,minneg ≤ 𝑐s,surfneg ≤ 𝑐s,maxneg

22:      Compute 𝑐s,pos as per eq. (5.37)
23:      Compute 𝑐s,surfpos as per eq. (5.41)

24:    Compute 𝑉cell as per eq. (5.40)
25: return 𝑉cell                                                                        ▷ resume suspended line in SimulateSPM


and managed as two separate processes — i) a background thread, and ii) a foreground thread.
The background thread runs continuously within the main loop sequentially processing
instructions. Figure 5.2a shows an example illustration of typical background tasks that a
BMS handles. All high-priority tasks are triggered by an interrupt and the supervisory control

                                                                    172
                                                                      5.2 Numerical Implementation


        (a) background process (low priority)                     (b) foreground processes (high priority)

 Initialise: SOC & other global variables
 Ensure: voltage, current & temperature limits                    begin Interrupt Service Routine ()
    procedure Main()
                                                                     read new sensor data from ADC
       configure interrupts
                                                                     function ComputeSPM(𝑖𝑘−1 , params)
       enable timers
                                                                        evaluate spm model equations
       ⋮
                                                                        ⋮
       while True do        ▷ until “key off” or shutdown
                                                                        compute model output voltage
          background task #1 ▷ diagnostics/protection
                                                                        function SOCEstimator(𝑣model ,𝑣meas )
          background task #2 ▷ canbus communication
                                                                           state estimation subroutine
          ⋮
                                                                           ⋮
          if needs_balancing == 1 then
                                                                        end function
              function PackBalance(𝑛cells ,SOC𝑖 ,𝑣𝑖 )
                                                                        function ICEControl()
                subroutine for pack balancing
                                                                           ⋮
                ⋮
                                                                           write control outputs to DACs
              end function
                                                                        end function
          end if
                                                                     end function
          ⋮                                                       return ▷ resume suspended line in Main()
          background task #𝑛 ▷ supervisory reporting
       end while
    end procedure

  Figure 5.2 Overview of the real-time software implementation of a typical BMS. Through an
  interrupt-driven architecture for time-critical tasks as state estimation and control, the same
  processor can be efficiently utilised by employing its idle CPU cycles for background tasks such
  as diagnostics, fault logging and book-keeping.


loop suspends the presently executing background task for later resumption. As shown in
fig. 5.2b, a typical example of such an interrupt driven process is the evaluation of the SPM
model equations and computation of control outputs and is discussed next.

    Figure 5.3 depicts an exploded view of the timing aspects of the Interrupt Service
Routine that was briefly presented in fig. 5.2b. Upon the expiry of an on-chip timer calibrated
against a baseline precision-clock, hardware interrupts are raised by one or more Analog to
Digital Converters (ADCs) associated with voltage/current sensors mounted on cells. The ISR
disables the interrupt and reads the samples of data from the ADCs into software. At the end of
this process, the ISR rearms the interrupts and simultaneously sends and acknowledgement to
the appropriate sensor which reloads its timer. The SPM model equations are then evaluated
in software and the resulting computational variables such as voltage and concentrations
are employed in other pertinent tasks such as state estimator subroutines. If the BMS also


                                                            173
                                                                       5.2 Numerical Implementation




  Figure 5.3 Timing diagram of a real-time software loop of a BMS. The sequence of events
  within one sample period 𝑇𝑠 in relation to the base clock of the controller is shown. Particular
  emphasis is placed on depicting the handling of Interrupt Service Routine (ISR) requests pertinent
  to cell models. Other background tasks performed by the CPU are de-emphasised. Moreover, the
  integration of the BMS software loop within the larger scope of a master vehicular controller is
  not shown. Illustration adapted from Southward [199].


performs control tasks e.g. regulating the coolant’s flow rate or Internal Combustion Engine
(ICE) state-toggling such as in the hysteresis control of a series hybrid drivetrain, these control
outputs are written to the relevant Digital to Analog Converters (DACs).


5.2.3       Sample Delay Considerations

Figure 5.4 shows a vertically compressed view of all CPU activities across a larger time
horizon. The CPU’s load factor is the ratio of time spent in foreground requests to its idling
time. While a high load factor is beneficial in terms of efficient usage of resources, it adversely
affects the power efficiency of the chip.

    For Li-ion cell modelling, a sampling interval of 𝑇𝑠 = 1s is commonly used, thus aiming
                                          †
to capture the cell dynamics below 500 mHz . The CPU’s clock used is of several MHz, a vast
majority of which is spent in background tasks or in sleep mode. Furthermore, a low-latency
ISR code is employed in the tasks of reading the ADC value, evaluating the model equations
and writing any control outputs to the DAC. Using a simplified PBM such as the SPM helps
in achieving a low-latency throughput for the ISR.
   † In   the ideal case, according to the Nyquist sampling theorem. In practice, the frequency range is smaller.


                                                       174
                                                                        5.2 Numerical Implementation




  Figure 5.4 A compressed timeline of CPU execution cycles showing details of activities within
  each sample interval. The execution sequence is shown over a larger horizon so as to illustrate
  the proportion of ‘activity time’ relative to the ‘idle time’. The vast majority of the CPU cycle is
  spent in idling or background tasks. The servicing of the ISR occupies a relatively small fraction
  of each CPU cycle. Diagram reproduced from Plett [200].


   The overall implication of such a scheme is that any delays owing to the sample and
hold process at the model input and outputs can be neglected. In conventional sampled-data
systems, control delays may be analysed by considering a multiplicative factor of               𝑒 −𝑠𝜆   in the
Laplace domain transfer function of the system. Delay parameters of 𝜆 = 0.5𝑇𝑠 or 𝜆 = 1𝑇𝑠
are commonly employed as conservative estimates. However, owing to the small CPU load
factors, in this thesis this delay term is omitted for discrete-time formulation of the SPM.


5.2.4    Discrete-Time SPM Formulation

Due to the sampling and ZOH operations at the ADC input to the system, the input to
the SPM is transformed from a simple continuous time signal to discrete-time sequences
i.e., 𝑢(𝑡) ↦ 𝑢[𝑘] and 𝑦(𝑡) ↦ 𝑦[𝑘], where 𝑘 = 0, 1, … , ∞ is the sample index corresponding to
the continuous time instant 𝑡𝑘 = 𝑘𝑇𝑠 . The continuous time plant model represented by the
ODE system of eq. (5.38) is therefore replaced by a discrete-time process and modelled by a
difference equation which is to be determined.

   Consider the general continuous-time solution given by eq. (5.43). Let 𝑡0 = 𝑘𝑇𝑠 and
𝑡 = (𝑘 + 1)𝑇𝑠 , where 𝑘 = 0, 1, … , ∞. Therefore,

                                   𝑥(𝑡0 ) = 𝑥(𝑘𝑇𝑠 )            ≡ 𝑥[𝑘]                                   (5.46)
                                    𝑥(𝑡) = 𝑥((𝑘 + 1)𝑇𝑠 ) ≡ 𝑥[𝑘 + 1]                                     (5.47)

Substituting these relationships into eq. (5.43) yields
                                                    (𝑘+1)𝑇𝑠
                      x[𝑘 + 1] =    𝐴𝑇
                                   𝑒 𝑠 x[𝑘] +                 𝑒 𝐴((𝑘+1)𝑇 𝑠 −𝜏 ) 𝐵u(𝜏 ) 𝑑𝜏   .           (5.48)
                                                ∫
                                                𝑘𝑇𝑠
                                                     175
                                                                                5.2 Numerical Implementation


With the ZOH scheme discussed here, 𝑢(𝜏 ) remains constant from 𝑘𝑇𝑠 to (𝑘 + 1)𝑇𝑠 , and is
equal to 𝑢(𝑘𝑇𝑠 ) i.e., 𝑢[𝑘]. Consider a change-of-variable definition for the dummy variable of
integration 𝜏 as 𝜂 = (𝑘 + 1)𝑇𝑠 − 𝜏. Thus, 𝜏 = (𝑘 + 1)𝑇𝑠 − 𝜂. Hence, 𝑑𝜏 = −𝑑𝜂. Substituting these
into eq. (5.48),

                                                                  0
                            x[𝑘 + 1] =     𝐴𝑇
                                          𝑒 𝑠 x[𝑘] + [                 𝐴𝜂
                                                                      𝑒 𝐵] 𝑢[𝑘] −𝑑𝜂                    (5.49)
                                                              ∫
                                                              𝑇𝑠
Reversing the order of integration leads to
                                                              𝑇𝑠
                            x[𝑘 + 1] =     𝐴𝑇
                                          𝑒 𝑠 x[𝑘] + [                 𝐴𝜂
                                                                      𝑒 𝐵 𝑑𝜂] 𝑢[𝑘]                     (5.50)
                                                              ∫
                                                              0


    Equation (5.50) represents a discrete-time state-space representation of the dynamics of
the system whose generic representation is given by the difference equation

                                    x[𝑘 + 1] = 𝐴𝑑 𝑥[𝑘] + 𝐵𝑑 𝑢[𝑘]                                       (5.51)

              𝐴𝑇               𝑇𝑠 𝐴𝜂
where 𝐴𝑑 =   𝑒 𝑠   and 𝐵𝑑 =   ∫0 𝑒 𝐵 𝑑𝜂.      If the continuous-time system matrix 𝐴 is invertible,
a closed form expression for 𝐵𝑑 is obtained as

                     𝐵𝑑 =    −1
                            𝐴 (𝐴𝑑   − 𝐼𝑛 )𝐵                                     (if   𝐴−1   exists)    (5.52)

For the continuous time system matrix 𝐴 of the SPM, its determinant is zero.

                                             𝐷s,pos
                                      |   −30 2
                                             𝑅p
                                                          0           0|
                                      |         pos                     |
                                      |       0
                                                         𝐷s,neg
                                                      −30 2           0 | = 0                          (5.53)
                                      |                  𝑅p
                                                            neg
                                                                        |
                                      |       0           0           0 |

and hence is not invertible. This necessitates an explicit evaluation of the integral in eq. (5.50)
for computation of the discrete-time input matrix 𝐵𝑑 .

    Since the only non-zero entries of the matrix lie along its main diagonal i.e., its modes are
decoupled, the matrix exponential reduces to a diagonal matrix whose elements are simply the
scalar exponentials of the original entries. The discrete-time input matrix 𝐵𝑑 can be obtained




                                                       176
                                                                                   5.2 Numerical Implementation


by evaluating eq. (5.55).

                                                                                     𝐷s,pos
                                𝐷s,pos                                            −30 2 𝑇𝑠
                      ⎛⎡ −30                       0              0⎤ ⎞ ⎡             𝑅p                                   ⎤
                                𝑅p2                                           𝑒        pos                   0           0⎥
                       ⎢
                      ⎜⎢
                                     pos
                                                   𝐷s,neg          ⎥ ⎟ ⎢                                   𝐷s,neg
   𝐴𝑑 =    𝐴𝑇
          𝑒 𝑠   = exp ⎜      0               −30   𝑅p2
                                                                  0⎥ 𝑇𝑠 ⎟ = ⎢                           −30 2 𝑇𝑠
                                                                                                           𝑅p
                                                                                                                          ⎥   (5.54)
                       ⎢                               neg         ⎥        ⎢        0              𝑒        neg         0⎥
                      ⎜⎢                                           ⎥ ⎟ ⎢                                                  ⎥
                      ⎝⎣     0                     0              0⎦ ⎠               0                       0           1⎦
                                                                            ⎣
                                               𝐷s,pos
                                            −30 2 𝜂                                  45                  1
                                𝑇𝑠   ⎛⎡        𝑅p                              ⎤    ⎡ 2 𝑅p2         𝐴 𝑙pos 𝑎s,pos 𝐹 ⎤⎞
          𝑇𝑠                          ⎢ 𝑒        pos                 0        0⎥ ⎢            pos
                                                                                                            ⎥⎟
                                     ⎜                               𝐷s,neg        45           −1
   𝐵𝑑 = ∫
          0
                𝐴𝜂
               𝑒 𝐵 𝑑𝜂   =
                            ∫         ⎢
                                     ⎜⎢
                                     ⎜⎢
                                               0              𝑒
                                                                  −30 2 𝜂
                                                                     𝑅p
                                                                       neg
                                                                               ⎥⋅⎢ 2
                                                                              0⎥ ⎢
                                                                               ⎥ ⎢
                                                                                         𝑅p 𝐴 𝑙neg 𝑎s,neg 𝐹 ⎟ 𝑑𝜂
                                                                                          2
                                                                                            neg
                                                                                                −3
                                                                                                            ⎥
                                                                                                            ⎥
                                                                                                            ⎥⎟
                                                                                                                              (5.55)

                            0                                                            𝑅p 𝐴 𝑙neg 𝑎s,neg 𝐹 ⎦
                                     ⎝⎣        0                     0        1⎦ ⎣          neg               ⎠
                                                                      𝐷s,pos
                                                ⎡            1−exp(−30 2 )𝑇𝑠
                                                                      𝑅p             ⎤
                                                ⎢ 3                     pos          ⎥
                                                ⎢   4         𝐷s,pos 𝐴 𝑙pos 𝑎s,pos 𝐹 ⎥
                                                ⎢                                    ⎥
                                           𝐵𝑑 = ⎢                         𝐷s,neg
                                                             1−exp(−30 2 )𝑇𝑠         ⎥                                        (5.56)
                                                ⎢ 3                       𝑅p
                                                                             neg     ⎥
                                                  −
                                                ⎢ 4           𝐷s,neg 𝐴 𝑙neg 𝑎s,neg 𝐹 ⎥
                                                ⎢                                    ⎥
                                                ⎢                    −3𝑇𝑠            ⎥
                                                ⎣             𝑅p 𝐴 𝑙neg 𝑎s,neg 𝐹 ⎦
                                                                neg




   The discrete-time matrix-vector system presented in eq. (5.54) and eq. (5.56) have not
been presented in existing literature, but is vital to understanding the implementation of the
SPM in digital controllers. Although, simpler alternatives such as Forward Euler methods are
available to approximate the time-derivative of the state vector, they suffer from problems
such as a growth in the rate of local truncation error per time-step [201], necessitating the
use of very high sample rates, which increases the burden on the embedded controller. The
matrix exponential approach is superior in terms of accuracy and stability across a wide range
of sample rates.

   For a pre-determined sample-rate, the matrix exponential and hence the 𝐴𝑑 and 𝐵𝑑
matrices can be computed offline on a desktop and stored into the non-volatile memory of the
embedded controller to be loaded onto RAM during operation. The vectorised implementation
of the state dynamics presented here is highly efficient and directly amenable for use in
classical state-vector algorithms. For the cell’s terminal voltage computation, the basic
structure and form of the output equation given by eq. (5.39) remains intact, except that the


                                                                  177
                                                                        5.3 Desktop Simulation


continuous time variables (x(𝑡), 𝑢(𝑡)) need to be replaced by their discrete-time counterparts
in the corresponding equation set i.e., eqs. (5.40)–(5.42). The discrete-time output function ℎ𝑑
is evaluated after updating the state vector (through eq. (5.51)).

                                 𝑦[𝑘 + 1] = ℎ𝑑 (x[𝑘 + 1], 𝑢[𝑘 + 1])                            (5.57)


    The complete sequence of steps for implementing the discrete-time variant of the SPM is
given in algorithm 5.2. In particular, it can be seen that the discrete-time system and input
matrices, 𝐴𝑑 and 𝐵𝑑 can be easily pre-computed from the parameter set using the matrix
exponential approach. In MATLAB, this can be achieved by passing the arguments of the
matrix exponential to the ‘expm’ command. The vectorised implementation of the discrete-
time state equation given in line 11 of algorithm 5.2 is a set of efficient linear algebra operations
consisting of simple matrix-vector product and vector-addition routines.

    This thesis strives for an inclusive approach by taking into account that some battery
researchers whose focus is on fundamental aspects of lithium ion cells e.g. those specialising
in electrochemistry, might not be familiar with the nuances of the matrix exponential
and discrete-time matrix computations (in line 7 of algorithm 5.2). Therefore, a snippet of
MATLAB code clarifying the computation of the discrete-time system and input matrices, 𝐴𝑑
and 𝐵𝑑 is given in code snippet 5.1. A full code listing of an example discrete-time SPM
implementation in MATLAB is provided in listing A.2.

    Thus, a discrete-time model of the basic SPM is now available for implementation in
an embedded BMS. Further analysis of discrete-time issues such as aliasing, quantisation
noise, signal pre-conditioning and discrete Fourier analysis lies in the specialised engineering
domain of signal processing and falls outside the scope of the thesis. The results of the basic
SPM are presented next in section 5.3.


5.3     Desktop Simulation
In this section, the performance of the basic SPM is discussed through desktop simulation
and by comparison against a standard Doyle-Fuller-Newman (DFN) benchmark model
incorporating the full Pseudo Two-Dimensional (P2D) dynamics.


                                                178
                                                                                                       5.3 Desktop Simulation




Algorithm 5.2          Discrete-time SPM
Require: Load profile                                                                                    ▷ e.g. a csv file of 𝑡 vs. C-rate
Require: SPM parameter set                                                                             ▷ e.g. stored in a struct params
User data: 𝑧[1], 𝑡f,user , 𝑡f,condition , cell capacity 𝐼1C , sample rate 𝑇𝑠                                     ▷ 𝑡f,condition ∈ {max, min}
Ensure: 𝑧[1], 𝑉cell [1] within limits                                                                    ▷ index [𝑘 = 1] ≙ time (𝑡 = 0)
 1: procedure SimulateSPM
                     max(𝑡f,user , 𝑡f,profile ), if 𝑡f,condition == max;
 2:    𝑡f,desired = {                                                                                   ▷ may terminate early due to
                     min(𝑡f,user , 𝑡f,profile ), otherwise.                                               cut-off violations
        Note: Flexible end time. Extrapolate last C-rate from profile until 𝑡f,desired if necessary.
                     𝑡f,desired
  3:     𝑁max ←     ⌈ 𝑇𝑠 ⌉        +1                                                          ▷ max iterations assuming no cut-offs
  4:     Allocate storage of size       ℝ 𝑁max ×1   for each simulation variable
  5:     Compute 𝑐s,neg [1] as per eq. (5.12)
  6:     𝐼 [1] ← 𝐼1C × C-rate[1],         x[1] ← [ 0 0 𝑐s,neg [1] ]𝑇                                          ▷ C-rate[1] from profile
  7:     Compute 𝐴𝑑 and 𝐵𝑑                                                                             ▷ as per eq. (5.54) and eq. (5.56)
  8:     𝑉cell [1] ← ComputeCellVoltage(x[1], 𝐼 [1], params)                                                ▷ from direct feedthrough
  9:     for 𝑘 ← 2 ∶ 𝑁max do
 10:         𝐼 [𝑘] ← interpolate from profile using ZOH
 11:         𝑥[𝑘] ← 𝐴𝑑 𝑥[𝑘 − 1] + 𝐵𝑑 𝑢[𝑘 − 1]                                                                                  ▷ eq. (5.51)
 12:         Compute 𝑧[𝑘] as per eq. (5.18)
 13:         𝑉cell ← ComputeCellVoltage(x[𝑘], 𝐼 [𝑘], param)
 14:         if 𝑧[𝑘] or 𝑉cell [𝑘] exceeded cut-off limits then
 15:            𝑘 ←𝑘−1                                                                                  ▷ data from last step is invalid
 16:            break;
 17:         end if
18:   end for
19: end procedure
20: subroutine ComputeCellVoltage(x,I,params)                                 ▷ uses discrete-time variants of eqs i.e., at index 𝑘
 21:     Compute 𝑐s,surfneg as per eq. (5.42)                              ▷ consider saturating i.e., 𝑐s,minneg ≤ 𝑐s,surfneg ≤ 𝑐s,maxneg

22:      Compute 𝑐s,pos as per eq. (5.37)
23:      Compute 𝑐s,surfpos as per eq. (5.41)

24:    Compute 𝑉cell as per eq. (5.40)
25: return 𝑉cell                                                                        ▷ resume suspended line in SimulateSPM




                                                                    179
                                                                                  5.3 Desktop Simulation


% Returns 𝐴𝑑 and 𝐵𝑑 matrices
A_cts = [-30*Ds_pos/(R_pos^2),                    0, 0; ...
                            0, -30*Ds_neg/(R_neg^2), 0; ...
                            0,                    0, 0];
% 𝐴𝑑 = 𝑒 𝑠 (see eq. (5.54))
        𝐴𝑇
A_disc = expm(A_cts*Ts); % expm command computes the matrix exponential

B_cts = [ (45/2)/(R_pos^2*a_pos*L_pos*F*A); ...
         (-45/2)/(R_neg^2*a_neg*L_neg*F*A); ...
             (-3/(R_neg*a_neg*L_neg*F*A))];
         𝑇𝑠 𝐴𝜂
% 𝐵𝑑 =          (see eqs. (5.55)–(5.56))
        ∫0 𝑒 𝐵 𝑑𝜂
B_disc = nan(size(B_cts));
B_disc(1) = B_cts(1)*(exp(A_cts(1,1)*Ts)-1)/A_cts(1,1);
B_disc(2) = B_cts(2)*(exp(A_cts(2,2)*Ts)-1)/A_cts(2,2);
B_disc(3) = B_cts(3)*Ts;

        Code snippet 5.1         Computation of discrete-time matrices 𝐴𝑑 and 𝐵𝑑 in MATLAB


                                             ‡
5.3.1    Cell Parametrisation

Table 5.2 lists the simulation parameters of an Lithium Cobalt Oxide (LCO) cell whose
positive and negative electrodes are LiCoO2 and LiC6 respectively. The electrolyte in this
system consists of LiPF6 salt in a solution of Ethylene Carbonate (EC)/Dimethyl Carbonate
(DMC)/Ethyl Methyl Carbonate (EMC) in a 1:1:1 ratio. The standard set of DFN parameters
have been extensively described and documented in literature. The detailed characterisation
of the physical properties of lithium-ion cells falls outside the scope of this thesis. Here,
the vast majority of electrochemical parameters viz. the geometric, thermodynamic, kinetic
and transport properties of the cell have been sourced from Subramanian et al. [137]. The
significance of each of the parameters in the context of the modelling assumptions discussed
in section 5.1.2 is examined.

   The simulation parameters that are applicable exclusively to the P2D model are shown as
highlighted text in table 5.2. It can be seen that only a subset of the isothermal DFN model’s
parameters are required for the SPM. In particular, there is no requirement to estimate any
of the electrolyte-related parameters in each electrode region. Furthermore, the properties

   ‡ Some   contents in this section overlap with section 3.4.1 and represents a joint effort with Ian D. Campbell.


                                                       180
                                                                                                                     5.3 Desktop Simulation

    Table 5.2 Parameters for isothermal simulation of the P2D and SPM implementations of an
    LCO cell (with LiCoO2–LiC6 electrode pair and LiPF6 electrolyte). Highlighted entries represent
    parameters exclusive to P2D model. 𝑗 ∈ {pos, sep, neg}.
                    System Conditions                                                                      Other Constants
Lower cutoff cell voltage, 𝑉min (V)                               a 2.50             Faraday constant, 𝐹                 −1
                                                                                                                     (C m )                             96487
Upper cutoff cell voltage, 𝑉max (V)                               b 4.30                                             −1 −1
                                                                                     Universal gas constant, 𝑅 (J mol K )                                8.314
                                                          Cell-level Parameters
Cell temperature, 𝑇cell (K)                                                                                                                            c 298.15
                                    −3
Init. electrolyte conc., 𝑐e,0 (mol m )                                                                                                                  c 1000

Overall active surface area, 𝐴 (m ) 2                                                                                                                   i 2.053


                      Thermodynamic, Kinetic, Geometric and Transport Parameters
Parameter                                                                       Pos                                   Sep                                 Neg
Bruggeman coefficient, brugg𝑗                                                 c4                                      c4                                    c4
                                       2 −1
Intrinsic electrolyte diffusivity, 𝐷 (m s )                                   d 3.22 × 10−10                     d 3.22 × 10−10               d 3.22 × 10−10
                                          −1
Intrinsic electrolyte conductivity, 𝜅 (S m )                                              see table note e & section 5.3.2
  +                          0                                                c 0.363                   c 0.363                  c 0.363
Li transference number, 𝑡+
                                           −1
Intrinsic electronic conductivity, 𝜎𝑗 (S m )                                  c 100.00                     —                   c 100.00
Thickness, 𝑙𝑗 (m)                                                             c 72 × 10−6            c 25 × 10−6           f 88 × 10−6

Electrolyte volume fraction, 𝜀𝑗                                               c 0.385                   c 0.724                  c 0.485

Filler vol. fraction, 𝜀fi𝑗                                                    c 0.025                      —                     c 0.033
Particle radius, 𝑅p (m)                                                       c 2 × 10−6                   —                 c 2 × 10 −6
                           𝑗
Specific interfacial surface area, 𝑎s𝑗                (m2    −3
                                                            m )               g 885 × 103                              —                       g 723.6 × 103
                              2 −1
Electrode diffusivity, 𝐷s𝑗 (m s )                                             c 1 × 10−14                              —                        c 3.9 × 10−14

Stoichiometry, 0% SOC, 𝜃min𝑗                                                  h 0.9917                                 —                              h 0.0143

Stoichiometry, 100% SOC, 𝜃max𝑗                                                c 0.4955                                 —                               c 0.8551

Max concentration, 𝑐s,max (mol m )  −3                                        c 51 554                                 —                              c 30 555
                                      𝑗
Reaction rate coefficient, 𝑘r𝑗             (m2.5      −0.5
                                                   mol s ) −1                 c 2.33 × 10−11                           —                      c 5.03 × 10−11

Open circuit potential, 𝑈𝑗 (V)                                                k see    table note                      —                 m see      table note
                                                          Spatial Discretisation
Parameter                                                                       Pos                                   Sep                                 Neg
Nodes, through-thickness (axial), 𝑁a𝑗                                           15                                    15                                    15
Nodes, within spherical particle (radial), 𝑁r𝑗                                  10                                    —                                     10
a Ref. [74]    b Set to ≈100 mV above the cell’s OCP at 100 % cell SOC               c Ref. [137]      d Computed at 𝑇
                                                                                                                       cell = 298.15 K using coefficients
from table II in Ref. [202]
e Computed at 𝑇        = 298.15 K using coefficients from table   III in Ref.   [202] at 𝑐     = 1000 mol m −3
                  cell                                                                     e,0
f Set up for capacity balance of electrodes such that 𝑙      =  1.22   × 𝑙     here (see  section  3.5.6)   g Computed as per eq. (5.61)
                                                         neg               pos
h Obtained as residual stoichiometries after a C/500 simulated discharge from 100 % cell SOC to 2.7 V
i Chosen so that current density for the electrochemical layer is 29.23 A m−2 for 60 A applied current (see section 3.4.1)

                  −4.656+88.669𝜃   2 −401.119𝜃 4 +342.909𝜃 6 −462.471𝜃 8 +433.434𝜃 10
k 𝒰(𝜃 ) =                          pos           pos           pos              pos            pos
                                                                                                                                                 (5.58)
         pos                        2            4           6               8
                         −1+18.933𝜃pos −79.532𝜃pos +37.311𝜃pos −73.083𝜃pos +95.96𝜃pos    10

m                                                   0.5        0.0172       0.0019               (0.9−15𝜃neg )               (0.4465𝜃neg −0.4108)
    𝒰(𝜃neg ) = 0.7222 + 0.1387𝜃neg +          0.029𝜃neg    −    𝜃neg    +      1.5
                                                                             𝜃neg    + 0.2808𝑒                   − 0.7984𝑒                               (5.59)


                                                                             181
                                                                       5.3 Desktop Simulation


of the separator material which are necessary in the DFN model are also not considered in
the SPM computations. A brief enumeration of the additional P2D-specific parameters in the
context of parametrisation requirements is provided here.

a. brugg𝒋 (×3)   The empirical Bruggeman coefficient helps to define the effective values of
                 conductivity and diffusivity of the electrolyte. Although an identical value (4)
                 is used in table 5.2, in principle all three regions can have different values of
                 brugg and need to be parametrised separately.

b. 𝑫 (×1)        The intrinsic electrolyte diffusivity of a typical electrolyte consisting of
                 LiPF6 salt in an organic solvent was experimentally characterised and
                 provided as a table of polynomial coefficients by Valøen and Reimers [202].
                 Evaluating this polynomial at a cell temperature of 298.15 K results in an
                 intrinsic diffusivity of            −10 2
                                            3.22 × 10 m s .−1   Since this is a material property
                 independent of the region within the cell, it needs to be parametrised only
                 once.

c. 𝜿 (×1)        Like the diffusivity, the intrinsic electrolyte conductivity is also a material
                 property and its value is independent of the region within the cell. Unlike
                 the diffusivity, the electrolyte conductivity is a strong function of its ionic
                 concentration. Thus, the polynomial proposed by Valøen and Reimers [202]
                 needs to be evaluated at 𝑇cell = 298.15 K and has to be updated during the
                 simulation as salt concentration within the electrolyte changes over time. A
                 discussion on the choice of initial concentration is provided in section 5.3.2.

d. 𝒕 (×1)
   𝟎                                                                                      +
                 The cationic transference number measures the relative mobility of the Li ion
   +

                 in the organic solvent and is independent of the region within the cell. Hence,
                 this intrinsic property is to be parametrised only once (per solvent).

e. 𝝈𝒋 (×2)       The intrinsic conductivity of the solid phase depends on the material used
                 in the porous electrodes. Although a simplified assumption of equal conduct-
                 ivity is used for the two electrodes, in practice, this property needs to be
                 characterised for each of the two electrodes.




                                                182
                                                                             5.3 Desktop Simulation


   Neglecting Arrhenius-type temperature dependence of physical properties and their
corresponding activation energies, the basic SPM facilitates the ability to afford physics-
based modelling capabilities with eight fewer parameters than the equivalent isothermal P2D
model. With the naive assumption of equal parametrisation effort per physical property,
this implies a 20 % reduction in parametrisation requirements for the basic SPM when
compared to its DFN counterpart. However, considering the fact that parametrising the
electrolyte’s transport properties requires apparatus and infrastructure typically available
only in specialised chemical/materials science labs, the reduction in parametrisation overhead
for system-level engineering stakeholders is more pronounced.

   Prima facie, it may seem that electrolyte porosities and filler volume fractions do not
influence the SPM model. However, they do have an indirect bearing on arriving at a critical
parameter viz. the solid phase volume fraction 𝜀s𝑗 . This parameter is required to compute the
specific interfacial surface area of the electrodes 𝑎s𝑗 i.e., the effective electrode area exposed
to reaction and is an important entity in the SPM model equations presented in section 5.1.3.
The solid phase volume fractions are also required in simulating the P2D model owing to
the need for computing the effective electronic conductivities of the electrodes (see eq. (1.6)).
They are calculated as
                                        𝜀s𝑗 = 1 − 𝜀𝑗 − 𝜀fi𝑗                                       (5.60)

where 𝜀𝑗 and 𝜀fi𝑗 are the electrolyte and filler volume-fraction within the respective electrode
regions. Using the values from table 5.2 results in 𝜀s,pos = 0.590 and 𝜀s,neg = 0.482 for the
positive and negative electrodes respectively. The specific interfacial surface areas are then
calculated as
                                                    2
                                                 4𝜋𝑅p
                                                      𝑗
                                                                    3𝜀s𝑗
                                     𝑎s𝑗 = 𝜀s𝑗   4              =                                  (5.61)
                                                 3   𝜋𝑅p3           𝑅p
                                                            𝑗            𝑗



   As discussed in the assumptions made during model derivation (see section 5.1.2) and
consistent with the assumed model geometry, the parameters not covered by the SPM
pertain to those describing electrolyte dynamics and distribution of electronic charge along
the axial thickness direction of the cell. Properties such as the intrinsic diffusivities and
conductivities of the electrolyte as well as the transference number of            Li +   in the organic
solvent are thus completely redundant for SPM simulation. The assumption of uniform
charge density along the through-thickness length of each electrode implies that the intrinsic

                                                 183
                                                                             5.3 Desktop Simulation


electronic conductivities of the two electrodes do not play any role in the model dynamics.
The porosities and Bruggeman coefficients in table 5.2 serve as modifying factors of the
intrinsic conductivities and diffusivities (see table 1.1) leading to an effective value within
each region of the electrochemical layer. Thus, their relevance is also rendered void for the
basic SPM simulation. The thickness of the separator material only plays a role in electrolyte
behaviour. By the model geometry presented in section 5.1.1, this parameter also falls outside
the scope of the basic SPM.

   The thicknesses of the electrodes are optimised for equal loading i.e., to achieve a balance
in their individual capacities to store Li atoms. The thickness of the positive electrode is
chosen as the value from Subramanian et al. [137]. The thickness of the negative electrode
region is then computed with the goal of equalising the volume of active material in each
electrode for every electrochemical layer in a pouch cell.

                              𝐴elecpos 𝜀s,pos 𝑙pos = 𝐴elecneg 𝜀s,neg 𝑙neg                      (5.62)


   In a lithium-ion pouch cell, the electrodes are designed such that the layers can be overlaid
on top of one another and finally encapsulated in a pouch. Geometrical considerations then
imply that the cross-sectional area (or face area) of the two electrodes must be the same.
However, due to the consideration of avoiding plating at the edges due to microscopic
malformations, the design is done such as to have a small overhang of the negative electrode
layer (< 2 mm) with respect to the positive electrode layer [149] (see fig. 3.7). Nevertheless,
the active surface area is just the common overlap area between the two electrodes, and hence
𝐴elec is equal to the cross-sectional area of the positive electrode.
                                 𝑙neg       𝜀pos
   Thus, eq. (5.62) reduces to   𝑙pos   =   𝜀neg   = 1.22, yielding 𝑙neg = 72 µm.

   At first, it may be surprising to note that the values of the particle radius 𝑅p used in
                                                                                           𝑗
both the P2D and SPM remain identical. However, it is important to note that the P2D
equations of the DFN model are cast in a normalised form i.e., already set up to account
for the overall capacity of the cell under consideration implicitly through usage of a current
density (per unit area) for its simulation. Furthermore, this explains why increasing the
number of discretisation nodes does not increase the modelled capacity, but instead merely
serves to improve the simulation accuracy owing to the enhanced spatial resolution.

                                                      184
                                                                              5.3 Desktop Simulation


   The overall active surface area 𝐴 = 𝑛𝐴elec is the combined cross-sectional area of all layers
(𝑛 is the number of electrochemical (pos, sep, neg) triplets) stacked into the pouch cell. In
both the P2D and SPM models, this parameter serves to scale the external load current down
to the current density experienced by each electrochemical layer. A value of               ≈30 A m −2   was
reported in the results section of Subramanian et al. [137]. When considering a 60 Ah pouch
cell with 10 mm exterior thickness and using the parameters reported in [137], this results in
a cross-sectional area of    2.053 m 2   (see section 3.4.1). Considering the equalisation of capacity
loading, with the newly chosen thickness value of the negative electrode, the 1C-rate capacity
of the cell has been revised to              −2
                                    29.23 A m .

   On simulating the P2D model with a trickle bleeding type discharge corresponding
to a current of C/500 and logging the data every 1 ms, after reaching                     §
                                                                                     2.7 V ,   the remnant
concentrations in the two electrodes were noted. The corresponding residual stoichiometry
values are reported in table 5.2.

   Since only isothermal cell behaviour is considered, table 5.2 omits the activation energies
for the various diffusivities and conductivities of materials (see section 5.3.2 for further
thermal considerations). For this reason, table 5.2 does not include other material properties
such as specific heats, and thermal conductivities. No properties of the current collectors
appear in the isothermal model equations for both the P2D and SPM models and hence are
omitted. All other electrochemical properties, viz. stoichiometries at 100 % SOC, maximum
concentrations, diffusivities, reaction rate coefficients and OCP of the two electrodes remain
invariant between the P2D and SPM models.


5.3.2    Simulation Setup

For reproducibility of results, it is important to discuss the system-level parameters influen-
cing simulation setup.

   The lower cut-off voltage of the cell is chosen to be 2.5 V. This is deliberately kept
lower than the voltage corresponding to the cell’s 0 % i.e., 2.7 V. If set above 2.7 V even at
infinitesimally small discharge currents, the cell would cut-off before achieving complete
discharge. Choosing a value lower than 2.7 V means that the cell gets a chance to recover

   § From   manufacturer datasheets for LCO chemistries, this value is considered to correspond to 0 % SOC.


                                                     185
                                                                       5.3 Desktop Simulation


its terminal voltage, despite spikes in highly dynamic load currents that might bring the
voltage below this threshold momentarily. If a low-enough value is not chosen, a system-
level shutdown shall be initiated despite possessing the ability to continue to operate after
recovery of terminal voltage. In this case, choosing a cut-off voltage of 2.5 V does not damage
the cell since checks are in place to monitor the SOC and trigger cut-off in the event of charge
depletion (see algorithms 5.1 and 5.2). Northrop et al. [74] use this value, although no specific
explanation is given for this choice.

   The upper cut-off voltage of the cell is chosen at 4.3 V i.e., ≈100 mV higher than the
equilibrium OCP at 100 % SOC. There are several reasons for this smaller margin at the upper
end of the voltage spectrum.

safety               li-ion cells are less tolerant to overcharging and can pose fire hazards.

degradation          overcharging li-ion cells can lead to plating and accelerate other degrad-
                     ation mechanisms.

low C-rates          charging C-rates are typically lower than discharge C-rates.

CCCV charging        For on-board chargers, taper charging (such as in a Constant Current
                     Constant Voltage (CCCV) profile) is activated, which ensures that char-
                     ging current drops off rapidly, leading to a lower overvoltage towards
                     the upper SOC range.

low probabilities The only charging event when an electrified vehicle is in motion is during
                     regenerative braking. The vehicular BMS manages the operating window
                     such that the starting SOC is much lower than the overvoltage that could
                     be caused due to braking. Furthermore, during operation, net discharge
                     events occur more frequently than regenerative braking events.

   For both the P2D model and the SPM model, the cell temperature is kept constant at its
                   ∘
initial value of 25 C (298.15 K). This might imply to the reader that the operation of the lithium
ion cell is assumed to be isothermal. While this is not true in general, for the C-rates considered
here (<5C), typical in a Battery Electric Vehicle (BEV) application particularly for the short-
duration transient loads studied, it is certainly a valid zeroth order coarse approximation
of the cell’s thermal condition. Detailed modelling of thermal dynamics is not within the

                                               186
                                                                                                    5.3 Desktop Simulation


scope of this thesis, as the primary goal is to obtain a PBM incorporating electrochemical
principles amenable for embedded application. Hence, the thermal dependence of parameters
through an Arrhenius-type relationship is also not considered. Future work could include
performing thermally coupled simulations i.e., incorporating thermally dependent parameters
and simplified heat generation expressions e.g. a lumped thermal model could be employed
for both the SPM and P2D and their performances may be compared.

       To understand the parametrisation of initial concentration, the expression for electrolyte
conductivity needs to be examined. As discussed in section 5.3.1, the intrinsic conductivity of
a specific type of electrolyte is a material property that depends on the local concentration
of    Li +   ions and temperature. In the characterisation of the electrolyte by Valøen and
Reimers [202], the best fit expression for electrolyte conductivity was obtained as

                                 −4                                  −3                              −6                    2
     𝜅𝑗 (𝑐e , 𝑇 , 𝑥, 𝑡) =      10 𝑐     e   (𝑥, 𝑡)(−10.5 + 0.668 × 10 𝑐       e   (𝑥, 𝑡) + 0.494 × 10 𝑐         e (𝑥, 𝑡)
                                                        −5                          −10                  2
                                    + (0.074 − 1.78 × 10 )𝑐   e   (𝑥, 𝑡) − 8.86 × 10 𝑐        e (𝑥, 𝑡)       )𝑇 (𝑡)
                                                                                −5                  −8              2 2
                                                                  + (−6.96 × 10           + 2.8 × 10 𝑐e (𝑥, 𝑡))𝑇 (𝑡) )         (5.63)


       Figure 5.5 shows a surface plot of the electrolyte conductivity as a function of initial
concentration 𝑐e,0 and cell temperature 𝑇cell . For the modelling task at hand, relevant aspects


                                                                                                                       1.4
                               2
                                                                                                                       1.2
                              1.5                                                                                      1
                  𝜅. (S m )
                         −1




                               1                                                                                       0.8

                              0.5                                                                                      0.6

                               0                                                                                       0.4
                              320
                                        300                                                              2000          0.2
                                                                                             1500
                                                280                                  1000
                                                      260                   500                                        0
                                      Temp. (𝐾 )                  0
                                                                                    𝑐e         −3
                                                                                         (mol m )

     Figure 5.5          Electrolyte conductivity as a function of cell temperature and initial concentration.



                                                                      187
                                                                                     5.3 Desktop Simulation


of this material property can be better understood through the simplifications afforded by the
simulation conditions applicable here. At equilibrium initial condition, 𝑐e is uniform over the
axial space 𝑥. Secondly, only isothermal cell behaviour is considered i.e., 𝑇 (𝑡) = 𝑇cell (0) = 𝑇cell .
Hence, eq. (5.63) reduces to


  𝜅𝑗 =     −4
         10 𝑐                            −3
                      (−10.5 + 0.668 × 10 𝑐                      −6 2
                e,0                              e,0 + 0.494 × 10 𝑐e,0
                                                       −5
                                   + (0.074 − 1.78 × 10 )𝑐e,0                −10 2
                                                                  − 8.86 × 10 𝑐e,0 )𝑇cell
                                                                           −5              −8         2     2
                                                              + (−6.96 × 10      + 2.8 × 10 𝑐   e,0 )𝑇cell )    (5.64)


    As inferred from fig. 5.5, the electrolyte conductivity 𝜅 is a smooth function of 𝑐e and 𝑇cell .
Thus eq. (5.64) can be effectively visualised through a parametric plot of 𝜅 versus 𝑐e with 𝑇cell
as the variable parameter as seen in fig. 5.6. From fig. 5.6, it is evident that at 𝑇cell = 298.15 K,
the maximum value of electrolyte conductivity is attained at 𝑐e =                              −3
                                                                                     1000 mol m .      It is advant-
ageous to operate the cell around this salt concentration so as to minimise the cell’s overall
resistance. Hence, the initial concentration 𝑐e,0 is chosen to be                             −3
                                                                                    1000 mol m .      It should be
noted that while the electrolyte concentration in the P2D model exhibits both spatial and
temporal variations during the simulation, in the SPM model, it remains constant throughout.

                         1.6
                                                                                  313.15K
                         1.4

                         1.2
                                                                                  298.15K
                          1
             κ. (S m )
                    –1




                         0.8                                                      285.65K

                         0.6

                         0.4
                                                                                  258.15K
                         0.2

                          0
                               0    200   400   600   800     1000 1200 1400 1600 1800 2000
                                                        ce         –3
                                                             (mol m )

  Figure 5.6 Electrolyte conductivity versus equilibrium concentration at various cell temper-
  atures. At 𝑇cell = 298.15 K, the maximum value of electrolyte conductivity corresponds to a salt
  concentration of 1000 mol m .  −3




                                                            188
                                                                      5.3 Desktop Simulation


   The reduction in parametrisation requirements discussed in section 5.3.1 is only one of
the factors contributing to the simplicity and ease of simulation. As discussed in section 5.1.1,
an important computational requirement that is present in the P2D model, but completely
eliminated from the SPM is the requirement of discretisation. As reported in table 5.2, with
15 nodes per region along the axial direction and with 10 shells per electrode in the radial
direction, the P2D model under simulation achieves mesh independence to a tolerance
of ≈2 % for the range of C-rates considered. For higher C-rates, coupling a thermal model
is of higher importance than incorporating further meshing refinements. The discretisation-
related parameters are specific to the P2D model and are highlighted accordingly in table 5.2.

Capacity Characterisation

First, it must be established that incorporating the parameters presented in table 5.2 into
the SPM model equations results in a cell with identical capacity as the DFN model. This is
to ensure the validity of comparisons in further simulations. Using the values of per-layer
C-rate as discussed in section 5.3.1, and the overall active surface area from table 5.2, the cell
under simulation has a capacity of 60 Ah.

   Present literature in battery modelling, both for the DFN model and for the SPM, do not
discuss any aspect of capacity characterisation. In particular, parameters such as the geometric
surface area of cells and even their 1C-rate are often not listed in publications. This practice
can be attributed to the fact that all one-dimensional and Pseudo Two-Dimensional models
operate on a per-layer basis, using an applied current density. Many a time, researchers
assume a unit surface area for the cell. This implicit normalisation is amenable to those
studies which strive to make numerical comparisons between models through simulation.
However, it leads to a lack of clarity on the actual capacity of the cells being modelled.
Furthermore, when comparing with experimental data from a real cell, such works resort
to ad hoc techniques such as empirical curve-fitting for obtaining the surface area. Often
the source of such parametrisation is not made clear. Section 3.4.1 documents the details of
obtaining the overall surface area of cells and arriving at the C-rate per layer of the specific
cell under consideration. Since the DFN model does not explicitly model the cell capacity,
a brief explanation is provided on how a simple numerical characterisation can be used for
determining cell capacity given a complete parameter list.



                                               189
                                                                        5.3 Desktop Simulation


    For experimental capacity characterisation of cells, the standard practice is to apply a
very small discharge current beginning at 100 % SOC, logging the charge passed using a high-
precision coulomb counter until the cell hits the voltage corresponding to 0 % SOC as specified
in the manufacturer’s datasheet. In order to decouple the effect of the cell’s dynamics from
its capacity, it is required to apply an infinitesimal bleeding current (tending towards, but not
reaching 0 A).

    Current sensors in battery cycler equipment use high-precision (typically 15–18 bit)
ADCs and are able to offer high Signal to Noise Ratios (SNRs) except at ultra-low currents.
The main difficulty with using very low C-rates is that it drastically slows down the
characterisation procedure. Using a discharge current of C/100 i.e., 0.6 A in this case, results
in a characterisation time of 100 h or ≈41/4 days (excluding soak-times and other set-up related
activities). Furthermore, for accurate coulomb-counting, a high data logging rate is needed,
producing large file sizes and corresponding difficulties in post-processing them. Considering
moderate buffer-sizes used in data logging modules of typical cell-cycler software (shared
between channels), and to avoid excessively large wait-times for characterisation, discharge
currents of C/20–C/25 are usually deemed sufficient.

    In order to validate that the choice of model parameters result in an intended capacity
of 60 Ah, an analogous procedure is carried out by means of computer simulation. A
characterisation simulation beginning at 100 % SOC with a discharge current of 0.6 A was
         ¶
performed .   If the assumed cell capacity is indeed consistent with the model parameters,
then this corresponds to a C-rate of 1/100. Therefore, both the P2D and SPM should run for
exactly 100 hours before cut-off due to charge depletion.

    Capacity validation through computer simulation is not bound by the limitations of
the experimental approach discussed earlier. Using 64-bit IEEE floating point arithmetic,
quantities as low as       −16
                       𝒪(10 )    can be safely computed, nullifying any SNR issues. Table 5.3
summarises the key data from this simulation run. For accurate coulomb counting, the data
logging interval is set to 50 ms. Both models ran close to 100 hours. The small deviations from
this expected termination time can be attributed to the fact that the current is not arbitrarily
small with the pragmatic goal of obtaining results in a reasonable time.

   ¶ Allcomputations were performed on a 64-bit Hewlett-Packard Z840 workstation with a 16-core   Intel ®

Xeon® E5-2640 v3 (Haswell) processor clocked at 2.60 GHz with 128 GB DDR4 RAM at 1866 MT/sec.


                                                190
                                                                            5.3 Desktop Simulation

  Table 5.3 Simulation data for capacity characterisation of P2D and SPM models. The P2D model
  is considered as the reference benchmark. The modelling error is defined as 𝜀𝑣 = 𝑉cellp2d − 𝑉cellspm

                    Parameter                                       Value    Units
                    Data-logging interval                           50.00       ms
                    Combined CPU time with warm cache               12.22      min
                    Total RAM used                                 603.90      MB
                    P2D run-time                                    99.94        h
                    SPM run-time                                    99.90        h
                    P2D discharge capacity                          59.96      Ah
                    SPM discharge capacity                          59.94      Ah
                    Worst case error, 𝜀𝑣max                        -94.30      mV
                    Mean error, 𝜇𝜀𝑣                                 -3.00      mV
                    RMS error, 𝜀𝑣 RMS                                8.20      mV
                    MAE error, 𝜀𝑣 MAE                                3.20      mV
                    Standard deviation of error, 𝜎𝜀𝑣                 7.60      mV


   As seen in table 5.3, even the combined CPU time to simulate both the P2D and SPM
models is two orders of magnitude lower than real-time. The only issue that remains to be
addressed is that of considerable memory and storage requirements due to high-rate data-
logging for accurate coulomb counting. For a standard computer workstation, this places
only a minor demand on its CPU. For comparable volume of data to be logged, the reliability
and ruggedness of a dedicated workstation far exceeds that of real-time cell cyclers, thereby
establishing numerical simulation as an amenable method for characterisation of cell capacity.
A major disadvantage of simulation based capacity validation is its extreme sensitivity to
parameters such as the maximum concentration of the electrodes and their stoichiometries,
which are generally difficult to characterise. In this context, the experimental procedure of
high-precision coulomb counting assumes a practical significance as it requires no knowledge
of the cell’s parameters other than the manufacturer’s datasheet.

   Figure 5.7 shows the voltage response of the SPM and P2D models, which overlap almost
entirely. It is clear that both the P2D and SPM models achieve a run-time of 100 hours. This
represents the first visualisation of results produced by the SPM model equations discussed
in section 5.1.3 and its numerical implementation from section 5.2.




                                                  191
                                                                                                  5.3 Desktop Simulation


                                      4.1                                                               P2d
                                                                                                        SPM
                                      3.9
            Cell Voltage, 𝑉cell (V)


                                      3.7

                                      3.5

                                      3.3

                                      3.1

                                      2.9

                                      2.7
                                            0   10   20   30     40       50       60       70    80   90     100
                                                                      Time (hours)

  Figure 5.7 Voltage response of P2D and SPM models to a discharge current input of 0.6 A. Both
  models achieve their charge depletion point after ≈100 h confirming that their modelled capacities
  match. Key simulation data for this characterisation run is shown in table 5.3.


   The voltage error is defined as

                                                          𝜀𝑣 = 𝑉cellp2d − 𝑉cellspm                                  (5.65)

The absolute maximum error is of 𝒪 (100) mV, which occurs towards the end of discharge.
Although this represents the worst case upper bound on the error, this is not strictly
representative of the overall error behaviour as evidenced by the standard deviation of
the error vector. The mean and Root Mean Square (RMS) error values indicate an accuracy
of 𝒪 (10) mV. It should be noted that throughout the simulation, the voltage response of the
SPM remains slightly above that of P2D, thereby leading to a negative value for the mean
voltage error. For continuous quantities such as time-domain simulation outputs of physical
variables, the Mean Absolute Error (MAE) is a suitable error metric and is defined as
                                                                          𝑛
                                                                         Σ𝑖=1 |𝜀𝑖 |
                                                               𝜀MAE =                                               (5.66)
                                                                             𝑛

Here, the numerical value of MAE is consistent with the order of magnitude of the RMS and
mean error metrics as well as with the standard deviation of the error vector.


                                                                                        [git] •


                                                                       192
                                                                      5.3 Desktop Simulation


   Thus, a common foundation for further simulations has been established by confirming
that the two models indeed simulate a cell with a capacity of 60 Ah. With the cell paramet-
risation discussed, simulation setup presented and capacities validated, the simulation results
are fully reproducible and are presented next in section 5.3.3.


5.3.3    Simulation Results

Constant current discharge

The left column of fig. 5.8 shows the time-domain voltage response of the basic SPM for
various constant discharge currents. The voltage response of the P2D model is also overlaid
on these plots and is used as a reference benchmark for comparisons. It is difficult to use
a common time-scale for the horizontal axes of the plots since the run-times differ by two
orders of magnitude for the C-rates considered.

   Since these comparisons have to be done across multiple C-rates, each yielding different
magnitudes in voltage responses, it is helpful to use a relative error metric such as the
percentage error, defined as

                                                𝑉cellp2d − 𝑉cellspm
                                𝜀𝑣̂ (%) = 100                                            (5.67)
                                                      𝑉cellp2d


   It is to be noted that, in all cases, the P2D model terminates faster than the SPM either
due to hitting lower cut-offs of either terminal voltage or SOC (see fig. 5.9). Consequently,
the error vector is defined only for the common time-region before cut-off.

   In fig. 5.8, the column on the right shows the percentage error in the voltage response
of the SPM with respect to the P2D model. At very low C-rates below ≈0.5C, the voltage-
response performance of the SPM is acceptable. However, the performance degradation is
rapid above this C-rate. It is clear that the error in the SPM response is monotonic and
unidirectional. This indicates that the source of the error is due to unmodelled dynamics. In
particular, as discussed in the modelling assumptions of section 5.1.2, the SPM ignores the
electrolyte dynamics. Thus, the overpotential in the electrolyte is not modelled, which results
in the terminal voltage of the SPM being always higher than its P2D counterpart.


                                                193
                                                                                             5.3 Desktop Simulation

             4.3                                                          0
                                                     P2d
            3.85                                     SPM                 –5
Vcell (V)




                                                              ε̂v (%)
             3.4                                                        –10

            2.95       0.20 C                                           –15       0.20 C
             2.5                                                        –20
                   0       5000   10000      15000     20000                  0       5000     10000     15000   20000
             4.3                                                          0
                                                     P2d
            3.85                                     SPM                 –5
Vcell (V)




                                                              ε̂v (%)
             3.4                                                        –10

            2.95       0.50 C                                           –15       0.50 C
             2.5                                                        –20
                   0       1875    3750      5625      7500                   0       1875     3750      5625    7500
             4.3                                                          0
                                                     P2d
            3.85                                     SPM                 –5
Vcell (V)




                                                              ε̂v (%)




             3.4                                                        –10

            2.95       1.00 C                                           –15       1.00 C
             2.5                                                        –20
                   0       1000    2000      3000      4000                   0       1000     2000      3000    4000
             4.3                                                          0
                                                     P2d
            3.85                                     SPM                 –5
Vcell (V)




                                                              ε̂v (%)




             3.4                                                        –10

            2.95       3.00 C                                           –15       3.00 C
             2.5                                                        –20
                   0        375     750      1125      1500                   0        375      750      1125    1500
                                  time (s)                                                    time (s)

    Figure 5.8 Voltage responses of the P2D and SPM models to various constant discharge
    rates. The left column shows the time-domain voltage response of the SPM plotted against the
    benchmark P2D response. The column on the right shows the percentage voltage error of the SPM
    with respect to the P2D model. The performance of the SPM degrades considerably at discharge
    currents above just 0.5C.


            Figure 5.9 shows the time-evolution of SOC computed by the P2D and the SPM models
for various discharge currents. Since the SOC of a cell is already a normalised quantity by
definition, the difference between the two models can be directly used for comparison across

                                                           194
                                                                                             5.3 Desktop Simulation

          100
                                                  P2d                   0.3
           75                                     SPM
SOC (%)




                                                             εsoc (%)
                                                                        0.2
          50

          25                                                            0.1
                    0.20 C                                                        0.20 C
           0                                                             0
                0       5000   10000      15000      20000                    0       5000    10000      15000   20000
          100
                                                  P2d                   0.3
           75                                     SPM
SOC (%)




                                                             εsoc (%)
                                                                        0.2
          50

          25                                                            0.1
                    0.50 C                                                        0.50 C
           0                                                             0
                0       1875    3750      5625       7500                     0       1875     3750      5625    7500
          100
                                                  P2d                   0.3
           75                                     SPM
SOC (%)




                                                             εsoc (%)




                                                                        0.2
          50

          25                                                            0.1
                    1.00 C                                                        1.00 C
           0                                                             0
                0       1000    2000      3000       4000                     0       1000     2000      3000    4000
          100
                                                  P2d                   0.3
           75                                     SPM
SOC (%)




                                                             εsoc (%)




                                                                        0.2
          50

          25                                                            0.1
                    3.00 C                                                        3.00 C
           0                                                             0
                0        375     750      1125       1500                     0        375      750      1125    1500
                               time (s)                                                       time (s)

    Figure 5.9 Plots in the left column depict the time evolution of SOC computed by the P2D and
    SPM models for various constant discharge rates. The column on the right shows the error of the
    SOC computed by the SPM with respect to that computed by the P2D model i.e., 𝜀soc = 𝑧p2d − 𝑧spm .
    In this case, the basic SPM remains quite accurate even at moderate currents such as 3C.


multiple C-rates. The SOC error is defined as

                                                  𝜀soc = 𝑧p2d − 𝑧spm                                             (5.68)



                                                         195
                                                                         5.3 Desktop Simulation


and like the error in the terminal voltage, remains unidirectional over time, and defined only
until one of the models hits cut-off. Table 5.4 shows a summary of various error metrics used
to quantify the performance of the basic SPM for various discharge rates.

  Table 5.4 Summary of error metrics of the basic SPM for terminal voltage and SOC in constant
  current discharge simulations.

                        C-rate          𝜀𝑣̂ (%)              𝜀soc (%)
                                  abs. max.       MAE    abs. max.      MAE
                          0.2        6.64         0.49      0.02        0.02
                          0.5        8.49         1.17      0.05        0.05
                          1.0       11.00         2.95      0.10        0.10
                          3.0       56.53         9.22      0.31        0.30


   A quick perusal of table 5.4 reveals a discrepancy that invokes surprise at first glance.
Whilst the performance of the SPM is quite poor in terms of terminal voltage prediction, it
is worth noting that its SOC prediction capabilities remain quite accurate even at moderate
discharge currents of about 3C and therefore, warrants a brief explanation.

   Referring to eq. (5.18), it is seen that the SOC of the cell is directly proportional to the bulk
(average) concentration in the negative electrode. Hence the plots of fig. 5.9 also represent
the solid phase concentration with a constant scaling factor. As per the assumptions listed
in section 5.1.2, the only transport phenomena modelled in the SPM is solid phase diffusion.
However, for computation of the terminal voltage, the electrolyte overpotential contribution
has been omitted (see eqs. (5.26) and (5.27)). This explains why the voltage accuracy suffers,
while the open-loop SOC computation remains accurate. The high accuracy of SOC (and
hence, solid-phase concentration) computation also validates the usage of the 4th order
polynomial approximation in the place of Fick’s law for modelling solid-phase diffusion.

   However, the discrepancy in accuracies of terminal voltage and SOC computed by the
basic SPM leads to an important implication. Even at moderate C-rates, the basic SPM cannot
be effectively used in the design of SOC observers. This is because, the measured voltage
maps to a vastly different operating point when using the SPM as the plant model, leading
to strong deviations of the estimated SOC.




                                                  196
                                                                                           5.3 Desktop Simulation


Constant current charge

The CCCV charging profile is a widely adopted standard charging strategy for charging
lithium ion cells [3]. In the constant current phase, a charging rate of 1C is used as an accepted
baseline, although faster charging strategies are presently being actively sought after.

             4.3                                                         100

            3.85                                                          75




                                                              SOC (%)
Vcell (V)




             3.4                                                          50

            2.95                                 P2d                      25                                   P2d
                                                 SPM                                                           SPM
             2.5                                                           0
                   0   1000    2000       3000         4000                     0   1000     2000       3000           4000

              3                                                            0


              2                                                     –0.05
                                                              εsoc (%)




                                  % |ε̂v |max : 2.54                                            % |ε̂soc |max : 0.10
ε̂v (%)




                                  % ε̂vmae : 2.05                                               % ε̂socmae : 0.10
               1                                                         –0.1


              0                                                      –0.15
                   0   1000     2000      3000         4000                     0   1000      2000      3000           4000
                              time (s)                                                      time (s)

     Figure 5.10 Time evolution of voltage and SOC (top row) of the P2D and SPM models upon
     charging with a constant current of 1C, i.e., 60 A starting at 0 % SOC. The bottom row shows the
     percentage in terminal voltage and SOC respectively of the SPM with respect to the P2D model.


            The top row of fig. 5.10 shows the evolution of terminal voltage and SOC of the P2D
and SPM models under an applied charging current of 1C i.e., 60 A. The constant-voltage
charging phase is not shown. The bottom row shows the corresponding errors of the SPM
model with respect to the reference P2D benchmark. The corollary behaviour of the constant
current discharge behaviour is observed here. The terminal voltage of the SPM remains
below the P2D model throughout. This is expected since, to account for the electrolyte
voltage drop modelled in the P2D dynamics, a higher terminal voltage needs to be applied.
The voltage error is thus unidirectional and remains positive (opposite to that observed for
the corresponding discharge case). Similarly, the SOC plots overlap very closely, thereby
validating the underlying polynomial approximation of solid phase diffusion. It is striking to

                                                          197
                                                                          5.3 Desktop Simulation


note that the error in SOC remains exactly around the same magnitude (≈0.1 %) in both the
charging and discharging cases.

Dynamic input profile

For automotive applications, it is important to characterise the performance of the cell model
under dynamic load conditions. Several standard vehicular driveycles have been defined and
adopted by regulatory agencies across the world. These drivecycles describe the profile of
the vehicle’s speed as a function of time. The profile of speed versus time of drivecycles is
typically available in intervals of 1 s, and is therefore consistent with the sample interval used
for the simulation (see table 5.2).

   The Urban Dynamometer Driving Schedule (UDDS) is one such well-known drivecycle,
originally introduced by the United States Environmental Protection Agency that represents
city driving conditions which can be applied to a typical mid-sized passenger vehicle. world.
Figure 5.11 shows the UDDS drivecycle wherein the vehicle’s speed has been converted to
SI units for use in further computations. One complete drivecycle runs for 1369 s. As seen in
fig. 5.11, the UDDS profile is highly dynamic consisting of many sets of rapid acceleration
and braking events. Hence, this drivecycle is chosen to provide representative results of the
model’s performance to dynamic inputs.


                    30

                    25

                    20
            (ms )
               –1




                    15
            speed




                    10

                     5

                     0
                         0    200       400      600      800      1000     1200     1400
                                                   time (s)

                    Figure 5.11   Profile of speed versus time for the UDDS drivecycle


                                                   198
                                                                     5.3 Desktop Simulation


   In an all-electric drivetrain wherein lithium ion batteries provide the propulsion power,
the speed profile can be suitably converted to a corresponding current profile experienced
by the cell through the application of basic governing equations from vehicle dynamics
(see section 3.5.2). Therefore, from the cell’s perspective, traversal of the drivecycle then
corresponds to the following events. During acceleration phases, the cell experiences a sharp
discharge spike of current. Similarly, assuming that regenerative braking is employed, each
deceleration event corresponds to a charging current. Thus a current versus time dynamic
load profile can be obtained. To briefly summarise the conversion process used here, the
computed power profile of the cell is divided by its nominal voltage and suitably scaled so
that the peak of the current profile corresponds to a discharge current of 3C. Considering that
all the braking energy cannot be recovered due to losses at the wheels, brake discs and other
mechanical components, a regenerative braking factor of 85 % (the fraction of recoverable
power) is assumed for the charging scenario.

   Figure 5.12 shows the simulation results obtained by applying the UDDS current input
profile (top row) to both the P2D and SPM models. The simulation is started at 50 % cell SOC.
This is representative of the median point for the operating window of SOC swing for both
BEVs and Plug-in Hybrid Electric Vehicles (PHEVs) [30]. Although regenerative braking is
employed, due to the reduced occurrence of braking events as well as considering efficiencies
of the drivetrain, as with any driveycle, the UDDS profile also results in a net-discharge. The
cell’s SOC at the termination of the UDDS run is ≈6 % lower than its starting value.

   The voltage output from the models is plotted in the middle row of fig. 5.12. The bottom
row shows the evolution of the cell’s SOC over time. Consistent with the error trends observed
in the constant current discharge and charge simulations, the error in terminal voltage is high
whereas that in SOC is low. In this work, the voltage error metrics are reported directly in
units of mV for the dynamic simulation run. Furthermore, it is a standard practice to report
the RMS error for such dynamic load profiles and is therefore included in the summary of
error metrics reported in table 5.5.
         Table 5.5   Summary of error metrics of the basic SPM with UDDS input profile.

                               Error metric   𝜀𝑣 (mV)    𝜀soc (%)
                               Abs. max.        97.37      0.21
                               MAE              19.38      0.04
                               RMS              25.88      0.06

                                              199
                                                                        5.3 Desktop Simulation



                            200


                            100
             Current (A)




                              0


                           –100


                           –200
                                  0   200   400   600     800    1000   1200         1400

                           3.95
                                                                               P2d
                            3.9                                                SPM


                           3.85
             Vcell (V)




                            3.8

                           3.75

                            3.7

                           3.65
                                  0   200   400   600     800    1000   1200         1400

                             50
                                                                               P2d
                                                                               SPM
                             48
             SOC (%)




                             46


                             44


                             42
                                  0   200   400   600      800   1000   1200         1400
                                                    time (s)

Figure 5.12 Simulation results for a UDDS current profile. The voltage prediction performance
of the SPM to dynamic loads is poor while its SOC computation accuracy is high.




                                                  200
                           5.4 Quadratic Approximation of Ionic Spatial Concentration


5.4     Quadratic Approximation of Ionic Spatial Concentration
As evidenced by the results from constant current charge, discharge and dynamic simulation
runs presented in section 5.3, the basic SPM suffers from poor voltage accuracy. The prior art
discussed in section 2.3.2 aim to tackle this issue through inclusion of electrolyte dynamics
using various state of the art methods. However, they lack in providing an in-depth analysis
and expository illustration of the fundamental deficiency of the standard P2D dynamics,
which is uncovered later in section 6.1.1. This is facilitated through the introduction of the
quadratic approximation model of ionic spatial concentration in this                     ‖
                                                                                  section .   The quadratic
approximation model is notable since it serves as the baseline reference for inclusion of
electrolyte dynamics into an SPM.


5.4.1       Model derivation

The schematic in fig. 5.13 shows the definition of the co-ordinate systems used in de-
riving the polynomial approximation of the electrolyte concentration profile. The three
regions {neg, sep, pos} are abbreviated to {𝑛, 𝑠, 𝑝} respectively in all mathematical expressions.
The globally defined 𝑥 co-ordinate starts at the negative current collector interface (𝑥 = 0)
and terminates at the positive current collector interface (𝑥 = 𝑙tot , where 𝑙tot = 𝑙n + 𝑙s + 𝑙p ).
Three local co-ordinate systems 𝑧 valid only within their respective regions are also defined.
In particular, it must be noted that the direction of the local 𝑧pos co-ordinate axis is opposite
to that of the other two local co-ordinate axes as well as the global co-ordinate axis.

    A standard quadratic expression is chosen a priori for approximating the electrolyte
concentration profile within each region.

                        𝑐e,n (𝑧, 𝑡) = 𝑎2   (𝑡)𝑧 2   + 𝑎1 (𝑡)𝑧 + 𝑎0 (𝑡)   0 ≤ 𝑧 ≤ 𝑙n                  (5.69)
                        𝑐e,s (𝑧, 𝑡) = 𝑎5   (𝑡)𝑧 2   + 𝑎4 (𝑡)𝑧 + 𝑎3 (𝑡)   0 ≤ 𝑧 ≤ 𝑙s                   (5.70)
                        𝑐e,p (𝑧, 𝑡) = 𝑎8   (𝑡)𝑧 2   + 𝑎7 (𝑡)𝑧 + 𝑎6 (𝑡)   0 ≤ 𝑧 ≤ 𝑙p                   (5.71)




    ‖ The  mathematical derivations here represents the author’s digested summary of literature, and is
particularly based upon a portion of Deng et al. [83]


                                                        201
                            5.4 Quadratic Approximation of Ionic Spatial Concentration




  Figure 5.13 Schematic diagram of the electrochemical sandwich consisting of a) negat-
  ive electrode, b) separator, and c) positive electrode depicting the co-ordinate system used
  in deriving the quadratic approximation profile. The global spatial co-ordinate is 𝑥 ∈ {0, 𝐿},
  where 𝐿 = 𝑙tot = 𝑙neg + 𝑙sep + 𝑙pos . Local co-ordinate systems 𝑧 specific to each region are also
  defined. It should be noted that the positive electrode’s local co-ordinate axis direction is reversed
  with respect to the global co-ordinate axis. Illustration reproduced from Deng et al. [83].


The time-dependent coefficient vector 𝑎⃗(𝑡) = [ 𝑎0 (𝑡) 𝑎1 (𝑡) … 𝑎8            (𝑡) ] 𝑇                      ∗∗
                                                                                        is to be determined .
Applying boundary conditions of the electrolyte diffusion equation from the DFN model (refer
eq. (1.4)) to eqs. (5.69)–(5.71), it is clear that 𝑎1 = 0 and 𝑎7 = 0. Thus, eqs. (5.69)–(5.71) become

                                𝑐e,n = 𝑎2   𝑧 2   + 𝑎0           0 ≤ 𝑧 ≤ 𝑙n                             (5.72)
                                𝑐e,s = 𝑎5   𝑧 2   + 𝑎4 𝑧 + 𝑎 3   0 ≤ 𝑧 ≤ 𝑙s                             (5.73)
                                𝑐e,p = 𝑎8   𝑧 2   + 𝑎6           0 ≤ 𝑧 ≤ 𝑙p                             (5.74)

with the coefficient vector being modified to 𝑎⃗ = [ 𝑎0 𝑎2 … 𝑎6 𝑎8                𝑇
                                                                                 ] .

    Table 5.6 lists the equations and boundary conditions for phenomena describing electro-
lyte diffusion and charge balance within the separator domain.

    Equation (5.75) and eq. (5.76) are obtained by applying the pertinent electrolyte equations
of the DFN model (eq. (1.4) and eq. (1.5) respectively) to the separator region. Applying the




   ∗∗ Hereafter,
               the explicit time-dependence of the coefficients is omitted. Similarly, the spatio-temporal
dependence of the electrolyte concentration 𝑐e,𝑗 is also dropped from the notation.


                                                         202
                                                 5.4 Quadratic Approximation of Ionic Spatial Concentration

  Table 5.6 Electrolyte-specific governing equations and boundary conditions of the Doyle-Fuller-
  Newman (DFN) model within the separator domain.

 Region                            Governing equations                                   Boundary conditions
                                                                                         (𝑙neg ≔ 𝑙n , 𝑙sep ≔ 𝑙s , 𝑙pos ≔ 𝑙p )

                            𝜕𝑐e           2
                                         𝜕 𝑐                                                                         𝜕𝑐               𝜕𝑐
                                           e                                         |
                                                                                  𝑐e |             |
                                                                                             = 𝑐e | ,           𝐷effn ||e |             e|
                                                                                                                               = 𝐷effs ||           (5.75)
                         𝜀𝛿     = 𝐷eff𝛿
                            𝜕𝑡          𝜕𝑥 2                                          𝑥=𝑙n−         𝑥=𝑙n+            𝜕𝑥 𝑥=𝑙n−         𝜕𝑥 𝑥=𝑙n+
                                                                                     |             |                 𝜕𝑐 e |           𝜕𝑐 e|
                                                                                  𝑐e |       = 𝑐e | ,           𝐷effs ||       = 𝐷effp ||
                                                                                      𝑥=(𝑙n +𝑙s )− 𝑥=(𝑙n +𝑙s )+      𝜕𝑥 𝑥=(𝑙n +𝑙s )−  𝜕𝑥 𝑥=(𝑙n +𝑙s )+
 Separator
             𝛿 ∈ {sep}




                             𝐼             2
                                          𝜕 𝜙e     2𝑅𝑇 0       𝜕 2
                                                                ln 𝑐e                                                𝜕𝑐               𝜕𝑐
                                                                                     |
                                                                                  𝜙e |             |
                                                                                             = 𝜙e | ,           𝜅effn ||e |             e|
                                                                                                                               = 𝜅effs ||           (5.76)
                               =   𝜅eff𝛿 ( 2     +    (𝑡+ − 1)        )
                             𝐴            𝜕𝑥        𝐹          𝜕𝑥 2                   𝑥=𝑙n−          𝑥=𝑙n+           𝜕𝑥 𝑥=𝑙n−         𝜕𝑥 𝑥=𝑙n+
                                                                                     |             |                 𝜕𝑐 e |           𝜕𝑐 e|
                                                                                  𝜙e |       = 𝜙e | ,           𝜅effs ||       = 𝜅effp ||
                                                                                      𝑥=(𝑙n +𝑙s )− 𝑥=(𝑙n +𝑙s )−      𝜕𝑥 𝑥=(𝑙n +𝑙s )− 𝜕𝑥 𝑥=(𝑙n +𝑙s )+



continuity and flux boundary conditions from eq. (5.75) at both separator interfaces,
                                               2
                                           𝑎2 𝑙n   + 𝑎0 = 𝑎 3                     (continuity at neg/sep interface)                              (5.77)
                                     2
                                 𝑎5 𝑙s   + 𝑎4 𝑙s + 𝑎3 =          2
                                                             𝑎8 𝑙p   + 𝑎6         (continuity at sep/pos interface)                             (5.78)
                                         2𝑎2 𝑙n 𝐷eff𝑛 = 𝑎4 𝐷eff𝑠                  (flux b.c. at neg/sep interface)                              (5.79)
                               (2𝑎5 𝑙s + 𝑎4 ) 𝐷eff𝑠 = −2𝑎8 𝑙p 𝐷eff𝑝               (flux b.c. at sep/pos interface)                              (5.80)

The negative sign in eq. (5.80) is due to the specific choice of the co-ordinate system used
for the positive electrode region (see fig. 5.13). Due to this, fluxes at the separator/positive
electrode interface have opposing directions. Let 𝑄e,j denote the number of moles of                                                        Li +   ions
in the electrolyte per unit cross-sectional area within each region 𝑗 ∈ {neg, sep, pos}. This
is computed as the product of a) the porosity and b) spatial integral of the concentration
                                          𝑙𝑗
function i.e., 𝑄e,j =                 𝜀𝑗 ∫ 𝑐e,𝑗 (𝑧) 𝑑𝑧.      Applying this to eqs. (5.72)–(5.74),
                                          0

                                                                   1     3
                                                      𝑄e,n   = 𝜀n ( 𝑎2 𝑙n + 𝑎0 𝑙n )                                                              (5.81)
                                                                   3
                                                                   1    3   1      2
                                                      𝑄e,s   = 𝜀s ( 𝑎5 𝑙s + 𝑎4 𝑙s + 𝑎3 𝑙s )                                                     (5.82)
                                                                   3        2
                                                                   1     3
                                                      𝑄e,p   = 𝜀p ( 𝑎8 𝑙p + 𝑎6 𝑙p )                                                             (5.83)
                                                                   3


         At this stage, 𝑄e,𝑗 (𝑡) are unknown. Since these are time-dependent functions, the
derivation naturally progresses towards seeking a set of ODEs that describe a relationship
for their time evolution. Transforming the 2nd order ODEs of eq. (1.4) (for electrodes) and

                                                                            203
                           5.4 Quadratic Approximation of Ionic Spatial Concentration


eq. (5.75) (for separator) to their respective local co-ordinates and integrate once along the
thickness of each region. Performing this sequence of steps for the negative electrode region

    𝑙n                        𝑙n    𝜕𝑐e,n
      𝜕                     𝜕                       0
𝜀n ∫ ( 𝑐e,n (𝑧, 𝑡)) 𝑑𝑧 = ∫ ( (𝐷eff𝑛       ) + (1 − 𝑡+ )𝑎s,n 𝑗n ) 𝑑𝑧             transposing integration &
    0 𝜕𝑡                  0 𝜕𝑧       𝜕𝑧
                                                                                differentiation operations in
          𝑙n                  𝑙n   𝜕𝑐e,n
    𝜕                      𝜕                       0                            the LHS
  𝜀n ∫ 𝑐e,n (𝑧, 𝑡) 𝑑𝑧 = ∫ ( (𝐷eff𝑛       ) + (1 − 𝑡+ )𝑎s,n 𝑗n ) 𝑑𝑧
    𝜕𝑡 0                 0 𝜕𝑧       𝜕𝑧                                          apply time-derivative
         𝑙n                   𝑙n      𝜕𝑐e,n                                     operator to the whole LHS
𝜕                             𝜕                       0
   (𝜀n ∫ 𝑐e,n (𝑧, 𝑡) 𝑑𝑧) = ∫ ( (𝐷eff𝑛       ) + (1 − 𝑡+ )𝑎s,n 𝑗n ) 𝑑𝑧
𝜕𝑡      0                   0 𝜕𝑧       𝜕𝑧
                                                                                apply integral to the RHS
                                   𝜕𝑐e,n |                         𝑙n
               𝑑                                   0
                  𝑄e,n (𝑡) = 𝐷eff𝑛       | + (1 − 𝑡+ )𝑎s,n ∫ 𝑗n 𝑑𝑧
               𝑑𝑡                   𝜕𝑧 |𝑧=𝑙n                0                                           (5.84)

Performing the identical sequence of operations starting from (eq. (5.75)) for the separator
and (eq. (1.4)) for the positive electrode yields

                          𝑑                   𝜕𝑐e,s |
                             𝑄e,s (𝑡) = 𝐷eff𝑠       |                                                   (5.85)
                          𝑑𝑡                   𝜕𝑧 |𝑧=𝑙s
                                              𝜕𝑐e,p |                   𝑙p
                          𝑑                                   0
                             𝑄e,p (𝑡) = 𝐷eff𝑝       | + (1 − 𝑡+ )𝑎s,p ∫ 𝑗p 𝑑𝑧                           (5.86)
                          𝑑𝑡                   𝜕𝑧 |𝑧=𝑙                 0
                                                           p




   In order to evaluate the integral term in the RHS of eq. (5.84) and eq. (5.86), the solid
phase charge conservation equation (eq. (1.6)) is integrated along the local co-ordinate axis
of the negative electrode and positive electrode respectively.

                                           𝑙n
                                                               𝐼
                                         ∫  𝑗 n 𝑑𝑧 =                                                    (5.87)
                                          0          𝑎s,n 𝐴𝐹
                                           𝑙p
                                                       −𝐼
                                         ∫  𝑗 p 𝑑𝑧 =                                                    (5.88)
                                          0          𝑎s,p 𝐴𝐹


   Substituting eqs. (5.87)–(5.88) into eqs. (5.84)–(5.86) respectively,

                            𝑑              𝜕𝑐e,n |         0           𝐼
                              𝑄e,s = 𝐷eff𝑛                    𝑎s,n
                                                 | − (1 − 𝑡+ )                                         (5.89)
                           𝑑𝑡               𝜕𝑧 |𝑧=𝑙n               𝑎     𝐴𝐹
                                                                
                                                                    s,n
                                                                      
                           𝑑               𝜕𝑐e,p |         0          −𝐼
                              𝑄e,p = 𝐷eff𝑝                    𝑎s,p
                                                 | − (1 − 𝑡+ )                                         (5.90)
                           𝑑𝑡               𝜕𝑧 |𝑧=𝑙                𝑎     𝐴𝐹
                                                                
                                                       p           s,p
                                                                     



                                                 204
                              5.4 Quadratic Approximation of Ionic Spatial Concentration


which leads to the general expressions for the cross-sectional molar density of        Li +   ions in
each of the three regions as

                                  𝑑               𝜕𝑐e,n |           0    𝐼
                                     𝑄e,n = 𝐷eff𝑛         | + (1 − 𝑡+ )                        (5.91)
                                  𝑑𝑡               𝜕𝑧 |𝑧=𝑙n             𝐴𝐹
                                   𝑑              𝜕𝑐e,s |
                                     𝑄e,s = 𝐷eff𝑠       |                                      (5.92)
                                  𝑑𝑡               𝜕𝑧 |𝑧=𝑙s
                                  𝑑               𝜕𝑐e,p |           0    𝐼
                                     𝑄e,p = 𝐷eff𝑝        | − (1 − 𝑡+ )                         (5.93)
                                  𝑑𝑡               𝜕𝑧 |𝑧=𝑙              𝐴𝐹
                                                              p


Substituting the assumed quadratic expressions for electrolyte concentrations in each of the
three regions eqs. (5.72)–(5.74) in the above system i.e., eqs. (5.91)–(5.93)

                                  𝑑                              0    𝐼
                                     𝑄e,n = 2𝑎2 𝑙n 𝐷eff𝑛 + (1 − 𝑡+ )                           (5.94)
                                  𝑑𝑡                                 𝐴𝐹
                                   𝑑
                                     𝑄e,s = 2𝑎5 𝑙s 𝐷eff𝑠                                       (5.95)
                                  𝑑𝑡
                                  𝑑                              0    𝐼
                                     𝑄e,p = 2𝑎8 𝑙p 𝐷eff𝑝 − (1 − 𝑡+ )                           (5.96)
                                  𝑑𝑡                                 𝐴𝐹

The initial ionic concentration in the electrolyte is identical in all three regions of the cell,
assuming equilibrium starting conditions i.e., 𝑐e,0𝑗 = 𝑐e,0 , 𝑗 ∈ {n,s,p}. Hence the initial number
of moles of   Li +   per unit area in each of the three regions is given by

                                            𝑄e,n (0) = 𝜀n 𝑐e,0 𝑙n                              (5.97)
                                            𝑄e,s (0) = 𝜀s 𝑐e,0 𝑙s                              (5.98)
                                            𝑄e,p (0) = 𝜀p 𝑐e,0 𝑙p                              (5.99)

and the initial coefficient vector which satisfies the system equations is obtained as


                                           ⎡ 𝑎0 (0)    𝑐
                                                   ⎤ ⎡ e,0 ⎤
                                           ⎢𝑎 (0)⎥ ⎢ 0 ⎥
                                           ⎢  2    ⎥ ⎢ ⎥
                                           ⎢𝑎3 (0)⎥ ⎢𝑐e,0 ⎥
                                           ⎢       ⎥ ⎢ ⎥
                                           ⎢𝑎4 (0)⎥ = ⎢ 0 ⎥ ⋅                                 (5.100)
                                           ⎢       ⎥ ⎢ ⎥
                                           ⎢ 𝑎5 (0)⎥ ⎢ ⎥ 0
                                           ⎢𝑎6 (0)⎥ ⎢𝑐e,0 ⎥
                                           ⎢       ⎥ ⎢ ⎥
                                           ⎣ 𝑎8 (0)⎦ ⎣ ⎦ 0

                                                    205
                          5.4 Quadratic Approximation of Ionic Spatial Concentration


   The system of three ODEs, (5.94)–(5.96) together with eqs. (5.97)–(5.99) representing the
initial conditions, form an IVP. Eqs. (5.77)–(5.83) represent a square system of seven linear
algebraic equations with seven unknown coefficients which must be solved at each time-step.
These algebraic constraints coupled with the aforementioned IVP form a DAE system.

   There are now two choices for proceeding with solution of the system. The naive
approach would be to solve the DAE using advanced DAE solvers specially designed to handle
index-1 semi-explicit systems such as DASSL [203] and DASPK [204]. For start-stop type of
input currents with discontinuities, the consistent initialisation of algebraic conditions and
derivatives is numerically challenging. All DAE solvers typically use adaptive time-stepping
algorithms. The feasibility of using such a complex scheme for real-time computation is
questionable. On the other hand, the overall system can be viewed as composed of two
numerical subsystems — a) an independent ODE system, and b) an independent algebraic
system. Each system is executed back to back in succession using solutions from the other
system from the previous time-step.

   To clarify the sequence of operations, in order to bootstrap the model, it is required to
compute 𝑄e,𝑗 (𝑡) in all three regions. The ODE system is integrated for one time-step by
retaining the coefficients at their initial value. The 𝑄e,𝑗 (𝑡) thus solved is substituted into the
                                                                      ⃗ = 𝑡𝑘 ). This new value
algebraic system to yield the updated value of the coefficient vector 𝑎(𝑡
of the coefficient vector is substituted back into the ODE system and the process continues.
Although the continuous simulation of the overall DAE is not accomplished, this scheme is
pragmatic from an engineering viewpoint. This is because, the periodic pauses needed to
update the intertwined sub-systems translate naturally into fixed time-steps and is well-suited
for a BMS controller operating at a fixed sample rate. This is also an effective workaround to
mitigate the complexities of having to implement and solve DAEs in real time.

   The simulation results of the quadratic approximation scheme and the analysis of its
strengths and weaknesses is presented next in section 5.4.2.




                                               206
                                5.4 Quadratic Approximation of Ionic Spatial Concentration


5.4.2     Numerical implementation, simulation results and analysis

Numerical implementation

From an analysis point of view, the quadratic approximation model for computing the
spatio-temporal evolution of electrolyte concentration can be simulated as an independent
subsystem, and hence can be implemented numerically as a standalone module as shown in
algorithm 5.3. In practice, this modular code is embedded as a subroutine within the main
SPM loop (see algorithm 5.2).

Algorithm 5.3       Quadratic approximation model for spatio-temporal electrolyte concentration
Require: Load profile                                                             ▷ e.g. a csv file of 𝑡 vs. C-rate
Require: Electrolyte model parameter set                                     ▷ e.g. stored in a struct ceparams
User data: 𝑡f , sample rate 𝑇𝑠 , 𝑐e,init
 1: function QuadraticElectrolyteModel
 2:     Set 𝑄e,init𝑗 as per eqs. (5.97)–(5.99)

 3:     ⃗ ←values from eq. (5.100)
        𝑎[1]
 4:     𝑉cell [1] ← ComputeCellVoltage(x[1], 𝐼 [1], params)                          ▷ from direct feedthrough
 5:     for 𝑘 ← 2 ∶ 𝑁max do
 6:        𝐼 [𝑘] ← interpolate from profile using ZOH
 7:        Solve continuous-time state equations–eqs. (5.94)–(5.96)                                     ⃗ − 1]
                                                                                                ▷ Using 𝑎[𝑘
 8:        𝑄e𝑗 [𝑘] ←last time-entry vector of soln. matrix                         ▷ if using an adaptive solver
 9:        ⃗ ←solution of linear system of equations–eqs. (5.77)–(5.83)
           𝑎[𝑘]                                                                               ▷ Using 𝑄e𝑗 [𝑘 − 1]
10:        Compute 𝑐e𝑗 as per eqs. (5.72)–(5.74)         ▷ Quadratic polynomial expressions for concentration
11:   end for
12: end function


Simulation results

Figure 5.14 shows the spatial distribution of           Li +   ions in electrolyte along the thickness of
the cell at various snapshots of time obtained by simulation of the P2D and the quadratic
approximation models using a 1C discharge current. The P2D model’s response is considered
as the reference benchmark. During the initial transient phase, the concentration profile
within each electrode region exhibits a characteristic inflection point. During this phase, the
concentration profile computed by the parabolic profile exhibits a large deviation in terms of
percentage error at each spatial location. However, with the passage of time, as a Quasi-Steady

                                                     207
                                   5.4 Quadratic Approximation of Ionic Spatial Concentration

                                                                           1200
           1040
                                            t=4s                           1100                            t = 18 s
(mol m )




                                                                (mol m )
           1020
      –3




                                                                      –3
           1000                                                            1000
            980
 ce




                                                                  ce
                       P2d                                                 900        P2d
            960        Quadratic                                                      Quadratic
                                                                           800
                   0               ln ln + ls            ltot                     0               ln ln + ls            ltot

           2000                                                            2000

           1500                             t = 357 s                      1500                            t = 1785 s
(mol m )




                                                                (mol m )
      –3




           1000                                                       –3   1000
 ce




                                                                  ce

            500        P2d                                                 500        P2d
                       Quadratic                                                      Quadratic
               0                                                              0
                   0               ln ln + ls            ltot                     0               ln ln + ls            ltot

           2000                                                            2000

           1500                             t = 2677 s                     1500                            t = 3570 s
(mol m )




                                                                (mol m )
      –3




                                                                      –3




           1000                                                            1000
 ce




                                                                  ce




            500        P2d                                                 500        P2d
                       Quadratic                                                      Quadratic
               0                                                              0
                   0               ln ln + ls            ltot                     0               ln ln + ls            ltot

    Figure 5.14 Spatial distribution of ionic concentration in electrolyte along cell thickness at
    various snapshots of time for a 1C discharge. The concentration profile obtained from simulating
    the P2D model is used as the reference. The performance of the quadratic model is quite poor
    during the initial transient duration, but improves over time as a quasi-steady state is reached.


State (QSS) is established, this inflection point flattens out, and the quadratic approximation
becomes closer to the true concentration value at each spatial location. Similar trends in
behaviour is exhibited for discharge and charging at higher C-rates and these results are
therefore omitted here in the interest of keeping the discussion succinct.

           It is important to note that while having a spatial concentration profile is useful, as seen
in eq. (2.4), it is the values of concentration at the current collector interfaces that are most
influential in computation of the electrolyte overpotential and hence, in the voltage accuracy

                                                            208
                                      5.4 Quadratic Approximation of Ionic Spatial Concentration


of the enhanced SPM. Thus, it is important to obtain this alternative perspective of time-
evolution of the electrolyte concentration at the two current collectors.
              2000                                                          1000
                         P2d                                                           P2d




                                                          (mol m )
                                                                –3
(mol m )
      –3




              1750       Quadratic                                          750        Quadratic

              1500                                                          500




                                                            ce (ltot , t)
  ce (0, t)




              1250                                                          250

              1000                                                             0
                     0    1000       2000   3000   4000                            0    1000       2000   3000   4000

               400                                                          400
(mol m )




                                                          (mol m )
      –3




                                                                –3
               250                                                          250

               100                                                          100
 εce,negcc




                                                           εce,poscc




              –50                                                           –50

           –200                                                         –200
                     0    1000     2000     3000   4000                            0    1000     2000     3000   4000
                                 time (s)                                                      time (s)

    Figure 5.15 Evolution of ionic concentration over time at the two current collector interfaces
    for a 1C discharge (top row). The time evolution of the corresponding error variables is shown in
    the bottom row of plots.

              Figure 5.15 shows the time evolution of ionic concentration in the electrolyte at the two
current collector interfaces computed by the P2D and quadratic approximation models for a
1C discharge current. The concentration values computed by the P2D model is considered
as the reference benchmark. At the negative electrode–current collector interface, the ionic
concentration exhibits a few oscillations of small amplitude owing to the complex interactions
of the ionic phase with the porous electrode and the charge transfer process at the electrode-
electrolyte boundary. The concentration evolution predicted by the quadratic approximation
model is rather simplistic and is unable to capture this intricate time-evolution pattern. This
is because the governing equation predicting time evolution of concentration in the quadratic
approximation model is that given by the first-order ODE of eq. (5.94) (with a proportional
mapping from 𝑄e,n to 𝑐e (0, 𝑡)). Following system theory, the step response of a first order
ODE is that of an exponential rise to a final settling value, which is exactly the shape seen in
the top-left plot of fig. 5.15.

                                                      209
                                                                              5.5 Conclusions


   The ionic concentration evolution at the positive current collector does not exhibit major
oscillations and even has a subtle monotonicity to its response. However, the classical first
order response predicated by the quadratic approximation model falls short of representing
its complete dynamics. Errors of similar magnitude are present in the ionic concentration at
both current collector interfaces, with a maximum absolute error of             −3
                                                                      ≈250 mol m .


5.5    Conclusions
This chapter dealt with the in-depth analysis of — a) the basic SPM and b) an electrolyte-
enhanced SPM employing the quadratic spatial approximation model for ionic concentration.
Simulation results for the basic SPM reveal that while its SOC computation is of acceptable
accuracy even at moderate C-rates, it suffers from poor performance in the prediction of
terminal voltage at currents above 0.5C. This renders the model unusable as the plant model
for state estimation tasks since the voltage measured from the model in a feedback estimator
shall map to a distant SOC operating point.

   The assumptions and governing equations of the popular quadratic approximation model
for the spatial profile of ionic concentration was presented. Simulation results reveal that
while its spatial profile computation for a galvanostatic operation is of acceptable accuracy,
the temporal performance of the model is mediocre. In particular, the time evolution of ionic
concentration at the current collector interfaces computed by the model fail to capture the
intricacies in the temporal evolution exhibited by the P2D model’s profile.

   This chapter concludes with a view that accuracy of the quadratic approximation model
needs to be improved upon before deployment in applications involving highly dynamic load
profiles such as a vehicular BMS. In chapter 6, causal factors of the lacklustre performance of
the quadratic approximation model is analysed in the context of developing at an improved
representation of electrolyte spatial dynamics through system identification.




                                              210
Implementing a New Electrolyte Model
                                                                                6
        for Augmentation of the Basic SPM

 6.1   Performance Analysis: Quadratic Approximation Model . . . . . . . . . . . . . 212

 6.2   A New Electrolyte Model through System Identification . . . . . . . . . . . . . 216

 6.3   Brief Introduction to System Identification . . . . . . . . . . . . . . . . . . . . 219

 6.4   Overview of Black Box System Identification . . . . . . . . . . . . . . . . . . . 220

 6.5   Introduction to Electrolyte Time-Evolution Subsystems . . . . . . . . . . . . . 223

 6.6   Design of Persistent Excitations . . . . . . . . . . . . . . . . . . . . . . . . . . . 223

 6.7   Investigation of Linearity and Time Invariance . . . . . . . . . . . . . . . . . . 228

 6.8   Transfer Function Identification Procedure . . . . . . . . . . . . . . . . . . . . 234

 6.9   Performance Analysis of System Id Model: Ionic Concentration . . . . . . . . 246

 6.10 Composite SPM Model with Electrolyte Dynamics . . . . . . . . . . . . . . . . 255

 6.11 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 266


                                             211
                          6.1 Performance Analysis: Quadratic Approximation Model



B     ased upon the insights gained from the extensive analyses performed in chapter 5,
      this chapter presents the thesis author’s attempts to surpass the performance of the
current pinnacle in modelling art through the development of a new electrolyte model. In
particular, this chapter describes the attempts towards arriving at an accurate description
of the spatio-temporal evolution of the electrolyte concentration in a lithium ion cell for
real-time applications. The performance of the quadratic approximation model which was
introduced in chapter 5 is analysed through the novel application of a symbolic regression
framework. This helps to expose the issue of equation deficiency in the underlying Doyle-
Fuller-Newman (DFN) model and questions its suitability for the purpose of reduced
order modelling of the electrolyte concentration dynamics with a pre-assumed equation
structure. Although this framework did not ultimately yield the desired outcomes, it did
nevertheless facilitate a comprehensive analysis of the strengths and weaknesses of the
quadratic approximation model which has not been performed in existing literature. Next,
the author’s unique contribution to the art of single particle modelling viz. a novel time-
evolution model of electrolyte concentration evolutions through the technique of system
identification is presented. The results of the new approach is compared against the baseline
quadratic approximation model as well as the benchmark Pseudo Two-Dimensional (P2D)
model. Finally, the new model equations are incorporated into an electrolyte-enhanced Single
Particle Model (SPM) and the improved performance of the newly developed composite model
is quantified.


6.1     Performance Analysis: Quadratic Approximation Model
In the author’s analysis of the quadratic approximation model, the origin and nature of
its sub-optimal performance can be explained as per the following rationale. The quadratic
approximation model uses a bottom-up approach wherein the final simplified model structure
is pre-assumed and then the physics are made to fit within this framework. Given that the
top-down approach to electrolyte modelling i.e., accounting for all physical phenomena and
then simplifying them yields mathematically intractable and overly complex models (see
section 2.3.2 for a detailed discussion), this approach seems to be a pragmatic alternative to
enhancing the SPM with electrolyte dynamics. However, a detailed look at this model from
an alternate viewpoint is necessary for further analysis.



                                             212
                              6.1 Performance Analysis: Quadratic Approximation Model


6.1.1       Symbolic regression using Multi-Gene Genetic Programming

The question boils down to whether a quadratic approximation is indeed the best model
structure that can be assumed a priori for the spatial profile of ionic concentration in the
electrolyte. This author embarked on a journey to find suitable alternate model structures
i.e., a single family of curves that can capture both the transient and Quasi-Steady State
(QSS) behaviour exhibited by the ionic concentration. The open-source MATLAB toolbox
GPTIPS2 [205] uses the state-of-the-art Multi-Gene Genetic Programming (MGGP) approach
for symbolic data mining and is ideally suited for such symbolic regression tasks (fitting
a mathematical equation structure, and not merely obtaining best-fit coefficients to a pre-
assumed curve as in classical numerical regression, to a given data).

    In employing the MGGP approach, it is important to recognise that the key criteria that
restricts a) the choice of gene-sequence depth, as well as b) the choice in number of parent
mutations, is the total number of unknown symbolic coefficients required to be solved in
the assumed model structure. There are a total of seven linear equations available from the
physics of the DFN model (see eqs. (5.77)–(5.83)). Hence, in order to guarantee a solution the
assumed family of curves cannot consist of more than seven coefficients. Furthermore, for
a unique solution, the number of coefficients must be exactly seven. Yet another restriction
on the choice of locus of feasible curves arises due to the fact that the behaviour of ionic
concentration in the negative and positive electrode regions are similar in                       ∗
                                                                                        complexity ,    and
hence need to be mathematically described by an identical family of curves.

    Upon a close inspection of the spatial concentration profile from the P2D simulation
results shown in fig. 5.14, it is evident the electrolyte approximation functions within the
electrode regions is of higher     complexity∗    than the approximation function suitable for use
in the separator region. Based on the results of the quadratic model, it is clear that at least
two coefficients are required within the electrode regions i.e., 𝑛c,elec ≥ 2. There exists an
inhibiting factor that prevents the use of a lower order function within the separator. As per
the simulation results of the P2D model, the time-domain change of number of moles per
square meter in the separator is non-zero. Since the time-derivative of a linear approximation

    ∗ The concept of complexity of curves used here is not based on a precise mathematical definition such as
that employed by Neumann-Coto and Arenas [206], but is loosely used to simply convey an empirical sense of
their curvature. However, the analysis here applies to the more rigorous definition as well.


                                                    213
                            6.1 Performance Analysis: Quadratic Approximation Model


applied to eq. (5.95) is zero, this straight-line equation is immediately ruled out. Among
the non-polynomial mathematical curves tried (such as trigonometric, hyperbolic, power
series among others), none could obtain the relatively simple shape of the separator function
without being forced to reduce the contribution from one of the coefficients to below machine
precision. This necessitates the retention of the quadratic approximation function used thus
far (with no missing terms) i.e., 𝑛c,sep = 3. Thus, the overall number of coefficients in the
best possible approximation shall be 2𝑛c,elec + 𝑛c,sep = 2 ⋅ 2 + 3 = 7, which is the total number
of electrolyte-specific physical constraints available from the DFN model. Hence it can be
concluded that the quadratic approximation model does indeed make the best use of all of the
available physical equations. The final question that remains to be answered is, with these
coefficient limitations, whether the quadratic equation structure is indeed the optimal one.
This was investigated through the MGGP approach described next.

   The GPTIPS2 toolbox uses a variety of heuristic algorithms from the theory of MGGP
to hypothesise a suitable equation structure for the data to be fitted. The dataset consisted
of electrolyte concentration at the three cell regions captured at various snapshots of time.
Both transient and QSS data were fed into this symbolic data mining process and a single all-
encompassing family of curves capable of capturing the electrolyte concentration behaviour
was sought for. However, the constraints in the number of coefficients that can be employed
results in a restriction of the depth of gene mutations as well as the number of parent/seed
populations. The best equation set (without strictly enforcing the aforementioned hard
constraints, yet minimising the distance to the constraint vector) that the symbolic regression
approach yielded was

                 𝑐e,n (𝑧, 𝑡) = 𝑎2   (𝑡) cosh 𝑧 2   + 𝑎1 (𝑡) sinh 𝑧 + 𝑎0 (𝑡)   0 ≤ 𝑧 ≤ 𝑙n    (6.1)
                 𝑐e,s (𝑧, 𝑡) = 𝑎5   (𝑡)𝑧 2   + 𝑎4 (𝑡)𝑧 + 𝑎3 (𝑡)               0 ≤ 𝑧 ≤ 𝑙s    (6.2)
                 𝑐e,p (𝑧, 𝑡) = 𝑎8   (𝑡) cosh 𝑧 2   + 𝑎7 (𝑡) sinh 𝑧 + 𝑎6 (𝑡)   0 ≤ 𝑧 ≤ 𝑙p    (6.3)


   Although eqs. (6.1)–(6.3) fit the transient and QSS profiles well, they violate the constraint
on the number of coefficients available resulting in an under-determined system of equations.
Both the least-squares and least-norm solution of this system were tried. However, the results
were inferior to that produced by the baseline quadratic approximation method.


                                                       214
                                        6.1 Performance Analysis: Quadratic Approximation Model


   Next, an attempt was made to obtain different mathematical structures for the transient
phase and QSS phase both of which respect the constraint on number of coefficients allowed.
The symbolic regression outputs for this approach are shown in table 6.1.
  Table 6.1 Best fit expressions for the transient and Quasi-Steady State approximation functions
  for the electrolyte functions obtained by the MGGP approach.

        Transient Function                                  Quasi-Steady State Function                    Region
                                 6     6                   𝑐e,nQSS = 𝑎1        (𝑡) sinh 𝑧 2   + 𝑎0 (𝑡)
       𝑐e,ntrans = 𝑎1        (𝑡)𝑧 ln 𝑧     + 𝑎0 (𝑡)                                                        0 ≤ 𝑧 ≤ 𝑙n
                                  2                        𝑐e,sQSS = 𝑎4        (𝑡)𝑧 2   + 𝑎3 (𝑡)𝑧 + 𝑎2 (𝑡) 0 ≤ 𝑧 ≤ 𝑙s
       𝑐e,strans = 𝑎4        (𝑡)𝑧     + 𝑎3 (𝑡)𝑧 + 𝑎2 (𝑡)
       𝑐e,p           = 𝑎6       6
                             (𝑡)𝑧 ln 𝑧 6   + 𝑎5 (𝑡)                                       2                0 ≤ 𝑧 ≤ 𝑙p
                                                           𝑐e,p         = 𝑎6   (𝑡) sinh 𝑧     + 𝑎5 (𝑡)
              trans                                               QSS



   Although the equations from table 6.1 produced a markedly improved response during
the transient phase, the performance during the QSS phase was merely at par to the baseline
quadratic approximation model. This raised the prospect of employing a blended approach,
wherein a model changeover between the transient and QSS was contemplated. However,
since there is no precise definition of what constitutes the transient phase of the electrolyte
concentration response, this approach required some ad hoc timing criteria for correctly
transitioning between the two MGGP equation sets. Further complications arise during
dynamic input conditions, wherein the concentration profiles are mostly in a state of flux
and could linger for longer durations at the contiguous boundary between transient-like
and QSS-like behaviours. In the interest of reproducibility across different cell-chemistries
and corresponding parameter sets, the proposed blended model transition approach was not
further pursued.

   Overall, the long and arduous process of symbolic regression was not a definitive success
in this case mainly due to the limitation of equation deficiency of physical constraints.
Perhaps if yet another Physics-Based Model (PBM) i.e., an alternative to the widely prevalent
DFN model, can be used as the baseline, a few more physical governing equations could
possibly be made available. This can perhaps result in a less restrictive gene-set for coefficient
determination and consequently pave the way for a successful implementation through this
hitherto unexplored route of MGGP-based equation synthesis.

   In conclusion, the quadratic model for electrolyte concentration approximation makes
the best use of the available physical equations. Given the constraints with respect to physical

                                                              215
                            6.2 A New Electrolyte Model through System Identification


equations discussed here, it is also deemed to be the optimum family of a priori chosen curves
capable of modelling the spatial profile of ionic concentration. Notwithstanding these merits,
the temporal performance of the quadratic approximation approach is sub-optimal as seen
in fig. 5.15. The author of this thesis addresses this specific issue with a completely different
approach that shall be discussed next in section 6.2.


6.2     A New Electrolyte Model through System Identification
Having performed a comprehensive analysis of the state of the art in SPM modelling with
electrolyte dynamics, this section presents the author’s unique contribution to the field. Firstly,
the scope of the contribution is identified. The methodology adopted and corresponding
results are presented thereafter.


6.2.1    Scope and motivation

This subsection is intended as a capstone summary helping to briefly recount the discussion so
far and to provide a context for the author’s work in the wider realm of the SPM modelling art.
In the same vein as the discussion in section 2.3.2, the scope of the proposed enhancement to
the SPM concerns entirely with improving the electrolyte subsystem since it has already been
established in section 5.3.3 that the simplified representation of the solid-phase subsystem
through a fourth order polynomial approximation method for diffusion of           Li 0   in the solid
particle is of sufficiently high accuracy.

   Inspecting the electrolyte domain, the contribution of electrolyte overpotential to terminal
voltage consists of a) diffusion overpotential b) time-dependent ohmic losses that originates
from differential concentration gradients (that is indirectly dependent upon concentra-
tion). Once electrolyte concentration at each time-step is available, eq. (2.4) proposed by
Prada et al. [99] may be used for the electrolyte overpotential computation. Hence, the
accurate determination of spatio-temporal values of electrolyte concentration merits focus.

   There exists a subtle detail in the use of eq. (2.4) which is discussed here upfront before
proceeding ahead to the refined context of the author’s work. The intrinsic conductivity
of electrolyte 𝜅 is a function of the ionic concentration (refer section 5.3.2). If the ionic
concentration at the corresponding current collectors are used for evaluating 𝜅neg and 𝜅pos ,

                                               216
                            6.2 A New Electrolyte Model through System Identification


this would lead to a lopsided computation of the overpotential in electrolyte. Furthermore,
under this scheme, the computation of electrolyte conductivity shall be rendered ambiguous
since it is unclear which separator interface shall be chosen for the separator’s ionic
concentration. Although this has not been discussed clearly in literature, the author of this
thesis chose to use the mean concentration within each cell region, defined as

                                            𝑙𝑗             𝑄e,𝑗 (𝑡)
                                        1
                              𝑐e,𝑗 (𝑡) = ∫ 𝑐e𝑗 (𝑧, 𝑡) 𝑑𝑧 =                                  (6.4)
                                        𝑙𝑗 0                𝜀𝑗 𝑙𝑗

though other measures of central tendency might be equally valid. Hence, the results
of this section have the associated variability in them depending on how the electrolyte
concentration computations are used in evaluating the intrinsic conductivity of electrolyte.

   As the ionic concentration has both a direct and indirect contribution in eq. (2.4), its
spatio-temporal computation is a critical aspect. As discussed in section 5.4, the quadratic
approximation is a widely used spatio-temporal model for electrolyte concentration which
makes the best use of available physical constraints. As established in the results of
section 5.4.2, while the spatial performance of the quadratic approximation approach is
acceptable, its time-domain performance, particularly at the crucial locations of the current
collector interfaces is mediocre at best.

   The scope of the author’s work is to obtain suitable alternate expressions for improving
the computation of time evolution of the electrolyte concentration whilst retaining the
quadratic approximation approach for describing its spatial profile. Such an approach is
motivated by the keen observation that the baseline quadratic approximation model has a
natural ‘pause’ in its model description. To clarify, eqs. (5.77)–(5.83) form a tightly coupled
square system i.e., a set of seven linear equations in seven unknowns. In this system, the time
evolution of 𝑄e,𝑗 are described through a separate system of first order Ordinary Differential
Equations (ODEs) given by eqs. (5.94)–(5.96). In a practical implementation, these ODEs are
solved independently in a decoupled manner i.e., by using the coefficients obtained from the
linear system of eqs. (5.77)–(5.83) in the previous time-step. The author’s hypothesis is that by
taking advantage of the natural break in the operational sequence which involves two separate
computations between two nearly independent subsystems, it must be possible to replace the
under-performing time-evolution ODEs from the baseline quadratic approximation with a
superior alternate model.

                                                 217
                            6.2 A New Electrolyte Model through System Identification


6.2.2    Selection of Methodology — Background and Rationale

This section presents the background and thought process in systematically arriving at
the choice of the methodology that was adopted for the new time-evolution model of the
electrolyte concentration dynamics.

    Based upon the experience gained in dealing with the literature presented in section 2.3.2,
it is the author’s view that, owing to the complex behaviour of electrolyte, a naive top-down
approach i.e., including all the physics upfront followed by a systematic simplification, might
only yield a model that is mathematically intractable for adoption in an embedded Battery
Management System (BMS) environment. The baseline quadratic approximation method has
proven that a bottom-up approach i.e., pre-assuming a simplified structure for the final model
and adapting its coefficients to physical constraints yields a viable candidate for describing
electrolyte dynamics and for later inclusion in the conventional SPM.

    Upon a closer examination of the rubrics of the baseline quadratic approximation model, it
comes to light that the natural ‘pause’ discussed towards the end of section 6.2.1 permeates to
a level more than merely having to operate sequentially on two pseudo-decoupled subsystems
— it goes to the extent of rendering the operating philosophy of fitting physical equations
semi-void. To clarify this statement and to substantiate the claim, while there is no doubt
that the linear algebraic equations of eqs. (5.77)–(5.83) do incorporate physical principles
from the DFN model, the same does not hold true for the ODEs of eqs. (5.94)–(5.96). In fact,
all the boundary conditions from the DFN model have been exhausted by this stage (refer
section 5.4.2). Although eqs. (5.91)–(5.93) are derived from the DFN model, the coefficients of
the diffusivities in the Right-Hand Side (RHS) of the next set of equations i.e., eqs. (5.94)–(5.96),
merely involve substitutions of the spatial derivatives of the assumed quadratic expression.

    Herein lies the weakness of the baseline quadratic approach. Unlike the spatial algebraic
equations, which are tightly bound by the continuity and flux boundary conditions at the
separator interfaces, there is no equality constraint on the spatial derivative, which is free to
grow or shrink without any explicitly imposed bounds. The onus of being accurate is therefore
on the spatial derivative evaluation which in-turn depends on the correctness of the quadratic
functions (eqs. (5.72)–(5.74)) themselves. It is not feasible to quantify the magnitude of error
introduced in the time-evolution of concentration given a small-signal perturbation in the

                                                218
                                                6.3 Brief Introduction to System Identification


coefficients of the quadratic spatial computation i.e., the implicit coupling between them is
not transparent. Since the quadratic approximation itself is not perfect i.e., does not capture
the spatial gradient exactly as the P2D model as seen in fig. 5.14, the internal coupling of
coefficients leads to errors in time-evolution computation.

    The author’s approach is to therefore break this detrimental coupling between spatial
derivative of concentration and its temporal evolution counterpart. Inspired by the fact that
the quadratic approximation model had almost achieved the desired goals with

   a) a bottoms-up approach i.e., assuming some model structure a priori, and

   b) not bound by any physical considerations due to the exhaustion of governing equations

led the author to broach a suitable modelling concept that exhibits these common traits, yet
of a completely different nature and hitherto unexplored in physics-based battery modelling
in general and electrolyte modelling in particular — black-box system identification.


6.3      Brief Introduction to System Identification
An in-depth coverage of the topic of system identification is well beyond the scope of this
thesis. However, keeping in mind the interests of the battery modelling community who might
not be familiar with this subject area, a brief overview of the core ideas that are essential for
tackling the specific problem at hand is presented. For readers further interested in this topic,
the author suggests the textbook by Ljung [207] for a comprehensive theoretical treatment
of the foundation topics in system identification.

    System identification aims to provide a mathematical model of the input-output mapping
of the   system †   under consideration. The three categories of system identification are:

a. White box        wherein underlying physical equations are completely known. The numerical
                    value of coefficients of governing equations are then to be parametrised from
                    input-output data.


    † The  precise definition of what constitutes a ‘system’ is detailed in Ljung’s textbook. However, for all
practical purposes, in this thesis the word ‘system’ stands for any unknown entity whose terminal behavioural
model is being sought for — primarily from input-output data.


                                                     219
                                          6.4 Overview of Black Box System Identification


b. Black box      wherein no governing equations are available for the system under consid-
                  eration. The model formulation is facilitated by a rich set of system theory
                  which proceeds by exciting the system with input waveforms with certain
                  desirable properties and correlating characteristics from the response to draw
                  conclusions about viable mathematical structures capable of emulating the
                  terminal behaviour of the system under generalised inputs. Black box system
                  identification was employed for the specific problem under consideration in
                  this thesis and hence all future descriptions will pertain to this class.

c. Grey box       is a hybrid of the two approaches wherein a part of the model’s governing
                  physics is known a priori e.g. the structure of a well-defined subsystem that is
                  part of a large, complex system may be known ahead of time, where the task
                  is to characterise the full system. Grey box system identification tasks can
                  often be reduced to a single sub-problem of black box system identification
                  by removal of the known physics and tackling them separately.

6.4     Overview of Black Box System Identification
Black-box system identification techniques are composed of the following — a) non-
parametric methods, and b) parametric methods.

6.4.1    Non-parametric methods

Non-parametric methods do not seek a pre-assumed mathematical structure for the system.
They aim to directly estimate the very kernel of what characterises every system viz. the
Markov parameters in the time-domain and the Frequency Response Function (FRF) in the
frequency domain, thereby requiring infinite number of data points for their representation.
Major non-parametric system identification methods include

    • Identification in time domain
         – Direct estimation of the system’s Markov parameters through statistical correla-
           tion of its response to an unit-pulse input.
    • Identification in frequency domain i.e., of the FRF
         1. Direct estimation through input-output statistical cross-correlation.
         2. Empirical Transfer Function Estimate (ETFE) using Discrete Fourier Transforms
               (DFTs) of input and output sequences.
                                                220
                                        6.4 Overview of Black Box System Identification


        3. Smoothed periodogram estimates using Welch’s method.
        4. Blackman-Tukey Estimate using standard filter windows in digital signal pro-
           cessing (such as Hamming, Hanning, Bartlett, Boxcar etc.).


6.4.2    Parametric methods

Parametric methods aim to fit specific input-output data to some family of well-known
mathematical constructs that are and widely applicable to a large variety of inputs. It
is important to recognise that, in contrast to white-box system identification, the salient
coefficients/properties of these mathematical structures do not, in any way correspond to
physical properties of the system under consideration. Major parametric system identification
methods use
    • Transfer-function based frequency domain model structures
         1. Output Error (OE) model
        2. Auto Regressive with Exogenous Inputs (ARX) model
        3. Auto Regressive with Moving Average and Exogenous Inputs (ARMAX) model
        4. Box-Jenkins (BJ) model
    • State-space time-domain model structures
         1. Ho-Kalman realisation
        2. Eigensystem Realisation Algorithm (ERA) realisation
        3. Deterministic and stochastic subspace structures


6.4.3    Investigation of suitable system identification methodology

Among the various system identification techniques mentioned, the non-parametric methods
have some serious drawbacks. As outlined in section 6.2.2, the author is inspired by the trait
of having a pre-assumed model structure that brought the baseline quadratic approximation
closer to a successful realisation. The non-parametric methods do not conform to this
philosophy. Furthermore, the requirement of infinite number of data samples in order to
fully quantify the system dampens its feasibility for implementation in resource constrained
environments. The author is of the opinion that resorting to truncation of the characteristic
sequence shall only yield a sub-optimal solution. Hence non-parametric methods are ruled
out for applying to the task at hand.

                                             221
                                       6.4 Overview of Black Box System Identification


   While parametric state-space identification is a feasible alternative, these methodologies
are tedious and error-prone. For instance, applying the Ho-Kalman algorithm requires
construction of large-sized Block-Hankel matrices followed by a Singular Value Decom-
position (SVD) operation. The ERA uses the identical set of operations of the Ho-Kalman
procedure, except that certain blocks in the Hankel matrices are chosen at random for deletion
for obtaining better estimates in low Signal to Noise Ratio (SNR) environments and for
capturing slowly decaying phenomena with long time constants. The subspace methods are
mathematically involved, requiring a profound understanding of concepts from linear algebra
such as projections to orthogonal subspaces. The system under consideration is presented in
section 6.5 and after linearity considerations, refined in section 6.7.2. It is composed of two
independent Single Input Single Output (SISO) subsystems. However, the inflection point
in the complexity-performance trade-off in state-space identification is achieved only when
dealing with Multi Input Multi Output (MIMO) systems that suggest strong cross-coupling
among its internal states or at least some degree of coupling among the various inputs and
outputs. Furthermore, the impulse responses of the system(s) under consideration do not
have long tails since they are characterised by relatively short time constants. Owing to these
reasons, it was decided that state space identification methods shall not be adopted here.

   Owing to a cornucopia of well-established technical know-how readily available in the
systems engineers toolkit, transfer function based model structures are naturally amenable
for control-oriented applications. However, there exists an apparent discrepancy to its usage
for this case, that must be addressed first. Transfer function methods are a frequency domain
technique and hence, the resulting model descriptions have mathematical structures radically
different from the time-domain model equations of the conventional SPM within which they
are to be embedded. This conundrum is resolved by closely inspecting the model’s scope and
its tractability for conversion to time domain as explained next.

   It is worth remembering that, as per section 2.2.1, for the reduced order modelling
of the entire cell, all frequency domain model groups were considered as out of scope of
this thesis specifically due to the overhead of conversion from frequency to time domain
for implementation and other associated difficulties. The blanket exclusion nature of this
statement is to be revisited considering the specific scope of the problem at hand. The body
of literature on frequency domain Reduced Order Models (ROMs) discuss obtaining physics-
based transcendental transfer functions for all electrochemical quantities of the coupled
                                             222
                              6.5 Introduction to Electrolyte Time-Evolution Subsystems


Partial Differential Algebraic System (PDAE) system of table 1.1 through a top-down approach.
However, the frequency domain system identification methods are concerned with obtaining
standard rational transfer functions for a much narrower scope viz. the time-evolution
subsystem, through a bottom-up approach. Such rational transfer functions are to obtained for
SISO systems for which an approximation-free effortless conversion already exists in classical
control theory and is presented in section 6.8.7. In view of their overwhelming simplicity
and familiarity to control engineers, after considering these arguments that circumvent their
only apparent impediment to adoption, transfer function based system identification was
chosen for tackling the problem at hand. The steps leading to the identification procedure is
presented next.


6.5    Introduction to Electrolyte Time-Evolution Subsystems
The first order ODEs of eqs. (5.94)–(5.96) in the baseline quadratic approximation model for
                                                                                          +
electrolyte concentration describe the time-evolution of the overall number of moles of Li in
each of the three regions of the cell 𝑄e,𝑗 . Through system identification, the author seeks to
obtain the two rational transfer functions of 𝑄e,neg and 𝑄e,pos to the applied current 𝐼 in the
                         𝑄e,n (𝑠)         𝑄e,p (𝑠)                                                     +
frequency domain i.e.,    𝐼 (𝑠)
                                    and    𝐼 (𝑠)
                                                   .   Based on the DFN model, the total moles of   Li     per
unit area in the separator 𝑄e,s is not a function of the exogenous applied current. Therefore,
the baseline quadratic approximation ODE is retained for computing its time-evolution.


6.6    Design of Persistent Excitations
In order to successfully apply any system identification technique, the input signal must be
carefully designed to be persistently exciting [207]. Narendra and Annaswamy [208, 209]
were among the earliest researchers to provide a detailed treatment of the desirable properties
of persistent excitation and their implication to the quality of the identification output. A
practical method to achieve persistent excitation is to subject the system under consideration
to a sequence of well-characterised input signals that are capable of exciting its hypothesised
modes. For this task, the author of this thesis chose to use the data-quality guidance provided
by The Mathworks Inc. [210] and performed an iterative refinement until the identification
procedure resulted in a generalisable model.



                                                          223
                                                       6.6 Design of Persistent Excitations


   Before discussing the shape characteristics of the input sequence, its magnitude must
be established. The various specially prepared input sequence families do not share a
common definition for their magnitudes. A guiding principle in system identification is
that it is important to have the input signal’s magnitude to be representative of standard
operating conditions if the system is linear. Although standardised drive cycle profiles are
available, from which a speed to current mapping can be performed, it is impossible to predict
a priori, the specific amplitudes of currents that the cell may undergo under real-life load
conditions. Without further deterministic information, the author of this thesis chose to
interpret magnitude as being the peak amplitude of the input current profile. As seen in
fig. 5.12, the representative Urban Dynamometer Driving Schedule (UDDS) drivecycle input
profile corresponds to a peak of 3C i.e., 180 A. Following the standard principles of system
identification, it is desirable for the inputs to the system to lie along some measure of central
tendency. This is to enable the identified system to generalise well i.e., not deviate too far
from the truth when subject to inputs that are far away from the central measure. Yet another
consideration is not to saturate the identified model by choosing input magnitude to be too
close to the peak of the expected operating range. Taking into account all aforementioned
considerations, the peak amplitude of the input current was fixed at 2C i.e.,   2/3rd   of the UDDS
profile’s peak current amplitude.


6.6.1    Training current profile

Since not much prior information is available about the poles and zeros of the electrolyte
subsystem(s) in question, a wide variety of special waveforms with a sampling interval of 1 s
were used for the current perturbation used in this system identification task. The specific
input sequence consisted of

   1. Random Binary Signal (RBS)       (0–199 s)
   2. ‘Chirp’ i.e., a swept cosine signal from 0–100 mHz     (200–799 s)
   3. Periodic Random Binary Signal with a period of 200 s and 2 such periods (800–1199 s)

thereby helping to obtain a wide-sense persistent excitation. The swept cosine signal is
designed to excite the low frequency (DC) modes of the electrolyte subsystem and helps to
capture the system’s response to constant and other systematically varying input profiles.
The two RBSs are intended to target the poles and zeros of the electrolyte subsystem that

                                              224
                                                                                 6.6 Design of Persistent Excitations


would typically be excited by highly dynamic input profiles. The periodicity in one of the
RBSs was introduced to draw out any repeated real pole or complex conjugate poles in the
system that might otherwise appear to be a single real pole. The presence of both low and
high frequency spectra in the combined training set presents a high degree of confidence to
capture the relevant dynamics of the electrolyte subsystem. The input current profile used
for this system identification task is plotted in fig. 6.1.

                                      RBS                       Chirp                        Periodic RBS
                           120
                            80
                            40
             Itrain (A)




                             0
                           –40
                           –80
                          –120


                                      100                                     100

                                        0                                       0

                                     –100                                   –100
                                         90   100 110 120 130 140              1000 1010 1020 1030 1040 1050

                                 0     100    200   300   400   500      600     700   800   900   1000     1100   1200
                                                                      time (sec)


  Figure 6.1 Input current profile used as the training set for system identification. The sequence
  consists of a) a Random Binary Signal, b) a chirp or swept cosine signal (0–100 mHz), and c) a
  periodic Random Binary Signal thereby covering both low and high frequency spectra while
  incorporating the potential to excite any periodic modes in the system to be identified.


6.6.2    Validation current profile

For the purposes of identification, the P2D model is considered as the true system. First, the
current profile from the training set is applied to the P2D model. Its simulation results, in
particular the numerically solved concentration values at each spatially discretised node in
each of the three regions per time-step is integrated over the thickness of the respective
regions and multiplied with their respective porosities to obtain the number of moles of                                  Li +

per unit area in each of the three regions 𝑄e,𝑗 . Only the quantities 𝑄e,n and 𝑄e,p are chosen
as the outputs for system identification and a transfer function model is fitted as per the
evaluation procedure discussed in section 6.8.

    As with any classical curve fitting (numerical regression) procedure, system identification
is also prone to overfitting the training data. In general, the ‘best’ transfer function that
                                            225
                                                                                        6.6 Design of Persistent Excitations


identifies the given system is the lowest order model that not only minimises the training
error, but also minimises the error on a previously unseen validation dataset. In the absence
of an independent validation dataset, the training error can be made arbitrarily small by
increasing the number of poles and zeros of the transfer function models without any bounds.
However, such a model shall not have truly identified the dynamics of the system and
shall not generalise well to real-world datasets outside the training realm. Hence, having
an independent validation current profile for the task at hand is of paramount importance.
The validation profile visualised in fig. 6.2 consists of the following sequence

   1. Periodic Random Gaussian Signal (RGS) with 4 periods of 200 s each                                                    (0–799 s)
   2. Pseudorandom Binary Signal (PRBS) for emulating white noise i.e., with a flat power
      spectra across the frequency spectrum (800–999 s)
   3. Multi-sine signal i.e., a signal consisting of sinusoids at various fundamental frequencies
      added together                         (1000–1199 s)

                                                   RGS              PRBS                       Multisine
                           120
                            80
                            40
             Itrain (A)




                             0
                           –40
                           –80
                          –120


                                      100                          100                            100

                                        0                            0                              0

                                     –100                         –100                           –100
                                            360 380 400 420 440          940   960       980         16801700172017401760

                                 0          200    400     600    800    1000    1200     1400      1600    1800    2000    2200
                                                                          time (sec)


  Figure 6.2 Input current profile used as validation set for system identification. The sequence
  consists of a) a Random Gaussian Signal, b) a Pseudorandom Binary Signal, and c) a multisine
  waveform. The overall sequence is intended to emulate the flat power spectrum of white noise
  (with the PRBS) and excite any poles and zeros within 3𝜎 spread of the RGS mean. The multisine
  signal is composed of sinusoids with fundamental frequencies from 100 mHz up to the Nyquist
  frequency. Its amplitude variation across the frequency spectrum increases the probability to
  capture the system’s modes that were possibly missed by the preceding two waveforms.


   The MATLAB code used for generating the training and validation input profiles is given
in code snippet 6.1.

                                                                         226
                                                     6.6 Design of Persistent Excitations



% Needs matlab's system identification toolbox
clear; close all; clc; format short g;
warning('off','Ident:dataprocess:idinput7'); % suppress sysid warnings
I_1C = 60; % Amps
range = 2*[-I_1C I_1C]; % peak-peak swing is ±2C = 40 A
NumCh = 1; % no of channels (used by sysid toolbox for multichannel id)
Ts    = 1; % sampling interval

%% Random Binary Input Signal (RBS)
N = 200; % samples per quantum of each waveform
u1 = idinput(N,'rbs',[],range); % 'idinput' from sysid toolbox
%% Chirp Signal (swept cosine)
t_chirp_start = 0;
t_chirp_end    = 3*N*Ts; %
t              = linspace(t_chirp_start,t_chirp_end,3*N);
f0             = 0;
f1             = 1e-1; % 𝑓1 = 100 mHz is the max chirp frequency
u2             = max(range)*chirp(t,f0,t(end),f1)';
%% Periodic Random Binary Input Signal (Periodic RBS)
bin_seq_Period    = N; % seconds
bin_seq_Period_N = ceil(bin_seq_Period/Ts); % samples
bin_NumPeriod     = 2;
u3 = idinput([bin_seq_Period_N,NumCh,bin_NumPeriod],'rbs',[],range);
%% Random Guassian Signal (RGS)
rgs_Period          = N; % seconds
rgs_Period_samples = ceil(rgs_Period/Ts);
rgs_NumPeriod       = 4;
u4 = idinput([rgs_Period_samples,NumCh,rgs_NumPeriod],'rgs',[],range/2);
%% PseudoRandom Binary Signal (PRBS)
prbs_Period          = N; % seconds
prbs_Period_samples = ceil(prbs_Period/Ts);
u5                   = idinput(N,'prbs',[],range);
%% Multisine signal (sum of sines)
samples_per_Period = 2*N;
NumPeriod           = 3;
[u6,freq] = idinput([samples_per_Period 1 NumPeriod],'sine',[],range);

%% Split into training and validation data sets
I_load_train    = [u1;u2;u3];
I_load_validate = [u4;u5;u6];

  Code snippet 6.1   Generation of training and validation input current profiles in MATLAB


                                            227
                                           6.7 Investigation of Linearity and Time Invariance


6.7          Investigation of Linearity and Time Invariance
The transfer function identification techniques listed in section 6.4 work best for Linear Time-
Invariant (LTI) systems. At first glance, this seems to be overly restrictive for the system(s)
at hand. When treated as a single macroscopic entity, a lithium ion battery, exhibits overall
non-linear characteristics, particularly due to strong non-linearities in a) the Butler-Volmer
reaction kinetics (see eq. (1.7)), and b) the Open Circuit Potentials (OCPs) of the two electrodes
(see eq. (5.58) and eq. (5.58)). However, we are dealing with a much narrower scope i.e., the
systems under consideration are just the two sub-system entities (one per electrode) that
transform the applied current at a particular time-step to the overall moles per unit area
of   Li +   ions in the corresponding electrode region of the electrolyte at that same instant.
Therefore, it is the linearity and time-invariance of these subsystems that must be investigated.


6.7.1         Time-invariance of the electrolyte time-evolution subsystems

A test for time-invariance is prescribed in the lecture notes on system identification by
Plett [211]. The steps involved therein are reproduced here after being suitably adapted to the
notation of the subsystems at hand.

     1. Apply input 𝑢1 (𝑡) = 𝐼 (𝑡) to the system and measure the outputs 𝑄e,n1(𝑡) and 𝑄e,p (𝑡).
                                                                                                   1


     2. Apply a delayed version of the input by 𝜏 seconds i.e., 𝑢2 (𝑡) = 𝐼 (𝑡 − 𝜏 ) to the system
            and measure the outputs 𝑄e,n2(𝑡) and 𝑄e,n2(𝑡).

     3. If 𝑄e,n2(𝑡) = 𝑄e,n1(𝑡 − 𝜏 ) and 𝑄e,p (𝑡) = 𝑄e,p (𝑡 − 𝜏 ) for all possible delays 𝜏, as well as for
                                             2         1
            all choice of input signals 𝐼 (𝑡), then the systems are time-invariant.

      For the systems at hand, it is not strictly required to apply this prescriptive test. Unless
a fundamental change in the underlying reaction phenomena/chemistry occur that alter the
performance over time, these systems can be treated as time-invariant. Factors that induce
time-dependent shift in the behaviour of lithium ion batteries are degradation phenomena
such as thickening of Solid-Electrolyte Interphase (SEI) layer, dendrite growth or mechanical
fatigue in electrodes which in-turn affect electrolytic diffusion and conductivity. Yet another
cause of time-dependent behavioural change is the drift in parameter values. However, these
phenomena are typically one or mode orders of magnitude slower than the P2D dynamics.

                                                    228
                                            6.7 Investigation of Linearity and Time Invariance


    This separation of time-scales imply that, in practice they can be decoupled. Therefore,
separate models can be identified for the faster and slower processes. A suitable model-
blending approach can then be considered to cover all processes across time-scales. Although
the concepts developed here for the fast electrolyte dynamics can be suitably adapted to such
slow phenomena, their study falls outside the scope of this thesis and is left as an exercise for
future work. Thus, the overall battery system, and hence by extension, the two subsystems
considered are deemed to be time-invariant. However, in the interest of completeness, this
author systematically applied the aforementioned test procedure with every combination
arising from the choice of ten time-delay values and the following six current profiles —
a) constant current 1C discharge, b) constant current 3C discharge, c) constant current
1C charge, d) UDDS input profile with peak amplitude of 3C, e) training profile used in
system identification (see fig. 6.1), and f ) validation profile used in system identification (see
fig. 6.2). Finally, these tests were repeated for a choice of five different initial States of Charge
(SOCs) — 90 %, 70 %, 50 %, 30 % and            ‡
                                           10 % .

    Figure 6.3 demonstrates the time-invariance of the subsystems considered at an initial
SOC of 50 % for a time-delay of 130 s using the highly dynamic system identification training
sequence that was synthesised by this thesis author (see fig. 6.1). The applied current
profile 𝑢1 (𝑡) (top row of the central column) produces the outputs 𝑄e,n1(𝑡) and 𝑄e,p (𝑡)
                                                                                                            1
shown in the top left and top right plots respectively. When the delayed version of this
input sequence 𝑢2 (𝑡) = 𝑢1 (𝑡 − 𝜏 ) (middle row, middle column) is applied, it results in the
outputs 𝑄e,n2(𝑡) and 𝑄e,p (𝑡) to its left and right respectively. Following the steps of the
                               2
test procedure, subtracting these outputs from the correspondingly delayed versions of
their original counterparts result in zero residuals, thereby proving time-invariance of these
subsystems under these representative test conditions. The residual sequences in the bottom
                        −15
row of plots are of 𝒪(10 ) and arise due to numerical round-offs that occur when operating
close to the noise floor of the machine’s floating point units.

    Similar to the case demonstrated here, all tests for time-invariance for all permutations
of the chosen operating conditions passed successfully i.e., the delayed version of the
original output signals accurately matched with the responses to the corresponding delayed
    ‡ The                          +
          number of moles of Li per unit area in the electrolyte does not depend on the electrode’s SOC.
However, different starting point of SOCs were considered to have a wide variety in the length of the recorded
data until cut-offs were hit. e.g. starting at 90 % SOC could mean that for a current spike early in the profile,
upper cut-off voltage shall be hit sooner leaving a smaller set of logged simulation data.

                                                      229
                                        6.7 Investigation of Linearity and Time Invariance




  Figure 6.3 Demonstration of time-invariance of the subsystems considered. The applied current
  profile 𝑢1 (𝑡) is the system identification training sequence from fig. 6.1 (top row of the central
  column). The top left plot shows the response 𝑄e,n1(𝑡), while that on the top right shows 𝑄e,p (𝑡).
                                                                                                   1
  The second row of the middle column shows the same input sequence delayed by 𝜏 = 130 s.
  Application of this current profile 𝑢2 (𝑡) = 𝑢1 (𝑡 − 𝜏 ) results in the outputs 𝑄e,n2(𝑡) and 𝑄e,p (𝑡)
                                                                                                    2
  to its left and right respectively. Subtracting these from the correspondingly delayed versions of
  the original outputs result in zero residuals, thereby proving time-invariance of these subsystems.
                                                       −15
  The jitter shown in the bottom row of plots is 𝒪(10 ) in magnitude and are due to the numerical
  roundoffs that occur when operating close to the noise floor of the machine’s floating point units.


input (down to machine precision), thereby confirming the time-variance of the subsystems
considered in the system identification problem, which enables us to proceed further.


6.7.2    Linearity analysis of the electrolyte time-evolution subsystems

De-biasing of input signals

In the analyses of linearity of systems, it is a recommended practice to de-bias the output
and input quantities about their mean operating conditions. The input signal in this case
is the applied load current 𝐼 (𝑡), which can be both positive (during discharge) and negative
(during charge). The mean of the training profile is −1.167 A and that of the validation profile

                                                  230
                                          6.7 Investigation of Linearity and Time Invariance


is −0.3273 A. Clearly, the mean values are dependent upon the actual current profile used. The
                                                     ̄ is to be used for training and validation
                                       ̃ = 𝐼 (𝑡) − 𝐼 (𝑡)
appropriately de-biased signal i.e., 𝐼 (𝑡)
data sets in the system identification procedure. For the purpose of linearity analysis, it is a
standard practice to simply apply a step change in input (from zero) and measure the output
responses, thereby bypassing the de-biasing requirements.

     For the output signals, bias values can be pre-computed analytically and accounted for.
The overall number of moles of          Li +   per unit area in any region within the cell cannot
be physically negative. Even though under high C-rates, ion depletion at localised spatial
locations (such as the current collectors) is certainly possible, the entire thickness of any
region cannot become devoid of ions at any point in time since the cell shall instantaneously
cease to work. Thus, for a typical well-designed cell operating within the manufacturer
prescribed C-rate limits, the output signals under consideration operate in a small window
about their initial values. In the author’s simulations, even at ±5C, the overall number of
moles of      Li +
             in any cell region exhibited a maximum change of less than 15 % from its initial
value. Thus, the de-biased output variables for system identification 𝑄̃e,𝑗 (𝑡) can be obtained
by subtracting their respective initial values 𝑄e,𝑗 (0) (see eq. (5.97) and eq. (5.99)) from 𝑄e,𝑗 (𝑡)

                                       𝑄̃e,n (𝑡) = 𝑄e,n (𝑡) − 𝑄e,n (0)                                  (6.5)
                                       𝑄̃e,p (𝑡) = 𝑄e,p (𝑡) − 𝑄e,p (0)                                  (6.6)

                                                                                            𝑄̃e,n (𝑠)
which implies that the transfer functions to be identified have to be modified to be            ̄
                                                                                              𝐼 (𝑠)
                                                                                                        and
𝑄̃e,p (𝑠)
    ̄
  𝐼 (𝑠)
            respectively. This does not affect the time-invariance proved in section 6.7.1 since the
initial values 𝑄e,𝑗 (0) are merely constants and hence not time-dependent.

Test for linearity

Similar to the test for time invariance described in section 6.7.1, a test for linearity is also
prescribed in the lecture notes on system identification by Plett [211]. The steps involved
therein are reproduced here after being suitably adapted to the notation of the subsystems at
hand. This is essentially a recipe for testing the superposition principle.

     1. Apply input profile 𝐼1 (𝑡) to the system and obtain outputs 𝑄̃e,n1(𝑡) and 𝑄̃e,p (𝑡).
                                                                                        1

    2. Apply a different profile 𝐼2 (𝑡) to the system and obtain outputs 𝑄̃e,n2(𝑡) and 𝑄̃e,n2(𝑡).

                                                    231
                                       6.7 Investigation of Linearity and Time Invariance


   3. Now apply an input profile 𝐼3 (𝑡) = 𝛼𝐼1 (𝑡) + 𝛽𝐼2 (𝑡) and obtain a corresponding set of
      outputs 𝑄̃e,n (𝑡) and 𝑄̃e,n (𝑡).
                   3             3

   4. If 𝑄̃e,n3(𝑡) = 𝛼 𝑄̃e,n1(𝑡) + 𝛽 𝑄̃e,n2(𝑡) and 𝑄̃e,p (𝑡) = 𝛼 𝑄̃e,p (𝑡) + 𝛽 𝑄̃e,p (𝑡) for all pos-
                                                       3            1           2
      sible {𝛼, 𝛽} and for all choice of input signals {𝐼1 (𝑡), 𝐼2 (𝑡)}, then the systems are
      linear.

   As in the time-invariance test, the same set of five different initial     SOCs ‡   — 90 %, 70 %,
50 %, 30 % and 10 %, was retained for these linearity tests. For each test run, a pseudo-random
number generator was used to select the values of {𝛼, 𝛽} from the set of real numbers ℝ (not
restricted to the set of integers ℤ) in the closed interval spanning [−1.25, 1.25]. Negative values
are acceptable for both the scaling coefficients since the resulting composite input 𝐼3 (𝑡) can
be either positive or negative. The composite signal 𝐼3 (𝑡) was obtained by taking a random
combination of any two of the following current profiles — a) step input with a constant
current 1C discharge, b) step input with a constant current discharge at C/5, c) step input
with a constant current 1C charge, and d) step input with a constant current charge at C/5.

   The scaling factors 𝛼 and 𝛽 were restricted to the range [−1.25, 1.25] in consideration of
limiting the peak applied current to within a ±3C window — the operating condition for most
Battery Electric Vehicles (BEVs), so that the isothermal assumption for the model shall remain
valid. This peak current corner case occurs when the pseudo-random generator chooses both
scaling factors at the selected range’s limits for the 1C constant current discharge or charging
cases. The limited range of the scaling factors are also motivated by the fact that most real-
world systems remain linear only within a certain operating window. In particular, care must
be taken to ensure that the cell’s SOC during the linearity test remains within its physical
limits for any initial SOC. Furthermore, localised saturation or depletion of ions for extended
durations must be avoided. Hence it can be concluded that, with the chosen range for the
scaling factors, if the two subsystems under consideration remain linear everywhere below a
peak current of ±3C in the isothermal case, then the linearity tests are considered as passed.
Future extensions to undertake a temperature-dependent system identification exercise can
potentially use a first-order Taylor expansion about this operating window. The discussion
thus far has fully established all the conditions for conducting the test for linearity.

   Figure 6.4 illustrates one instance of a linearity test wherein constant currents and integer
scaling factors are used for the sake of illustration. The plots in the left column deal with

                                                232
                                         6.7 Investigation of Linearity and Time Invariance




  Figure 6.4 Illustration of one instance of linearity tests for the subsystems under consideration.
  For this visualisation, constant current inputs are used throughout. The top row of plots shows 𝑄̃e,n
  and 𝑄̃e,p for two step inputs 𝐼1 (𝑡) = 60 A and 𝐼2 (𝑡) = 12 A i.e., discharge with 1C and C/5 currents
  respectively. The second row of plots shows 𝑄̃e,n3 and 𝑄̃e,p for 𝐼3 = 36 A, where 𝐼3 = 𝛼𝐼1 + 𝛽𝐼2
                                                                     3
  with (𝛼, 𝛽) = (1, −2). The last row of plots overlays these quantities with the manually computed
  linear combination of their two preceding responses. Had these sequences overlapped exactly,
  the systems would have been exactly linear. Despite exhibiting deviations over the considered
  horizon, the transient responses in both electrode regions do follow the superposition principle.
  Even past the transient, maximum error in both cases is an order of magnitude lower than the
  individual outputs. Hence, the two systems are deemed to be approximately linear.


the electrolyte time-evolution subsystem in the negative electrode region. Similarly, the plots
in the right column deal with the corresponding subsystem in the positive electrode region.
A discharge current of 1C i.e., 60 A is first applied and the corresponding outputs 𝑄̃e,n and      1
𝑄̃e,p are obtained. Secondly, a discharge current of C/5 i.e., is applied and the corresponding
    1


                                                  233
                                                6.8 Transfer Function Identification Procedure


outputs 𝑄̃e,n2 and 𝑄̃e,p are obtained. These set of responses are plotted in the top row of
                          2
fig. 6.4. Now, a third value of input current 𝐼3 , computed as a linear combination of the
previous input currents i.e., 𝐼3 = 𝛼𝐼1 + 𝛽𝐼2 is applied. For illustrative purposes, the integer
set (𝛼, 𝛽) = (1, −2) was chosen for the scaling coefficients, which implies 𝐼3 = 12 A. The
corresponding outputs 𝑄̃e,n and 𝑄̃e,p are plotted in the middle row. As per the test for
                                3           3
linearity, if these signals are equal to the signal generated by manually computing the linear
combination of the preceding two outputs, then the system is linear.

    The plots in the third row show 𝑄̃e,n3 and 𝑄̃e,p overlaid with their respective linear com-
                                                         3
bination signals. For the subsystem in the negative electrode region, the transient performance
matches precisely until ≈450 s, whereas that for the positive electrode region exhibits a good
matching for approximately the first 250 s. However, for the horizon considered the two
overlaid plots do not overlap exactly. Hence, the systems are not truly linear. However, the
exhibited behaviour is quite close to linearity, with the maximum absolute error in each
region being       −4
               𝒪(10 )    even past the initial transient, which is an order of magnitude lower
than its individual components. This behaviour was exhibited for all test instances considered.
Considering that for dynamic simulation runs, the transient performance is paramount to the
good performance of the model, in conjunction with the aforementioned low error metric,
these subsystems can be considered to be approximately linear.

    Based on the analysis presented here, LTI behaviour for the two subsystems is assumed,
which facilitates in proceeding with the actual system identification procedure.


6.8     Transfer Function Identification                         Procedure §


6.8.1       The transfer operator and its model form

In a classical system identification task, the discrete-time transfer functions for the systems
under consideration need to be determined. These discrete-time transfer functions are
based on Z-transforms in the frequency domain. However, for the purpose of working in
time-domain, an analogous linear operator 𝑞 that performs a forward shift on its input
i.e., 𝑞𝑢[𝑘] ⟼ 𝑢[𝑘 + 1]. Similarly, applying the backward shift operator               𝑞 −1   on the input
yields its value at the previous time-step i.e.,     −1
                                                    𝑞 𝑢[𝑘]    ⟼ 𝑢[𝑘 − 1].
    § The early stages of this section presents this author’s digested summary of the theoretical framework
adapted from a subset of content from the lecture notes on system identification by Plett [211–213].


                                                   234
                                                    6.8 Transfer Function Identification Procedure


    In a generic LTI system wherein measurements are corrupted by noise, the system
dynamics are represented by the transfer operator              𝐺(𝑞) ¶   that acts on the applied input 𝑢[𝑘],
whereas the noise dynamics are represented by the disturbance operator 𝐻 (𝑞) that acts to
filter (or shape) an assumed white noise input 𝑒[𝑘]. The overall output can be written as the
linear combination
                                        𝑦[𝑘] = 𝐺(𝑞)𝑢[𝑘] + 𝐻 (𝑞)𝑒[𝑘]                                          (6.7)
                  𝐵(𝑞)                 𝐶(𝑞)
where 𝐺(𝑞) =      𝐴(𝑞)
                         and 𝐻 (𝑞) =   𝐷(𝑞)
                                              are the transfer operators describing the dynamics of the
system and disturbance respectively.

    𝐴(𝑞), 𝐵(𝑞), 𝐶(𝑞) and 𝐷(𝑞) are rational polynomials in 𝑞. The two transfer operators 𝐺(𝑞)
and 𝐻 (𝑞) can be represented by

                                                      𝑏1𝑞 −1 + ⋯ + 𝑏 𝑛𝑏  −𝑛
                                                                        𝑞 𝑏
                                   𝐺(𝑞) =      −𝑛
                                              𝑞 𝑘                                                            (6.8)
                                                            −1          −𝑛
                                                    1 + 𝑎1 𝑞 + ⋯ + 𝑎𝑛𝑎 𝑞 𝑎
                                                       𝑞
                                                      𝑐1 −1  + ⋯ + 𝑐𝑛𝑐   −𝑛
                                                                        𝑞 𝑐
                                  𝐻 (𝑞) =      −𝑛
                                              𝑞 𝑙                                                            (6.9)
                                                            −1          −𝑛
                                                    1 + 𝑑1 𝑞 + ⋯ + 𝑑𝑛𝑑 𝑞 𝑑

where (𝑛𝑘 , 𝑛𝑙 ) are the number of transport delay samples, (𝑛𝑏 , 𝑛𝑐 ) the number of feedforward
coefficients and (𝑛𝑎 , 𝑛𝑑 ), the number of feedback coefficients in 𝐺(𝑞) and 𝐻 (𝑞) respectively.
Thus, the system identification task becomes one that of estimating the

    1.   number of transport delay samples 𝑛𝑘
    2.   number of feedforward coefficients (zeros) 𝑛𝑏
    3.   zeros themselves 𝑏1 , 𝑏2 , … 𝑏𝑛𝑏
    4.   number of feedback coefficients (poles) 𝑛𝑎
    5.   pole locations 𝑎1 , 𝑎2 … 𝑎𝑛𝑎
    6.                                         ‖
         coefficients of the noise filter 𝐻 (𝑞) .

for each of the two transfer operators 𝐺1 (𝑞) and 𝐺2 (𝑞) i.e., the electrolyte time-evolution
subsystems in the negative and positive electrode region respectively.
    ¶ The  term transfer operator in the time domain mathematically corresponds to the term transfer function
in the frequency domain. Mathematically, 𝐺(𝑞) = 𝐺(𝑧)|| .
                                                         𝑧=𝑞
     ‖ Inthe ARMAX estimation of non-linear dynamics, the noise-filter is capable of returning non-zero
coefficients even if the identification data set is obtained from a noise-free simulation of the P2D model as
is the case here. However, as a first-order approximation, in the interest of simplicity and considering that this
work serves as an introduction to the application of system identification to SPMs, this thesis author errs on
the side of making the linearity assumption, which is valid only for low C-rates, whilst acknowledging that this
limitation could be relaxed by incorporating the coefficients of the noise-filter 𝐻 (𝑞) in the future. For the rest
of this work, only the coefficients of the linear plant dynamics 𝐺(𝑞) are estimated.

                                                       235
                                            6.8 Transfer Function Identification Procedure


6.8.2     Estimation of transport delay

The transport delay 𝑛𝑘 can be estimated visually by inspecting the step response of the
systems under consideration.

    In fig. 6.4, step inputs of 𝐼1 = 60 A, 𝐼2 = 12 A, and 𝐼3 = 36 A were applied to the two
subsystems. Inspecting closely all the responses i.e., 𝑄̃e,n1 , 𝑄̃e,n2 and 𝑄̃e,n3 in the negative
electrode region, and 𝑄̃e,p , 𝑄̃e,p and 𝑄̃e,p in the positive electrode region, it is clear that all
                             1      2         3
these outputs start exactly at zero. Therefore, there is no delay term to be considered for the
transfer operators i.e., 𝑛𝑘 = 0 for both subsystems.


6.8.3     Choice of model structure

Among the transfer-function model structures mentioned in section 6.4.2, the ARX model
structure is too simplistic to consider. Despite the fact that its numerical computation involves
only basic linear algebra operations, that can be efficiently handled on modern computing
systems, it is considered to produce poor estimates of the system’s poles and zeros. In the
absence of contributions from the noise-term, the all-encompassing model structure used by
the Box-Jenkins approach is deemed to be unnecessary for the problem at hand. Therefore,
the two model structures considered were ARMAX and OE for the coefficient determination.


6.8.4      Starting guesses for coefficient orders

At first, the training profile of fig. 6.1 is de-biased (through mean removal) and applied as
the input current profile in a P2D simulation beginning at 50 % SOC. The outputs of this
simulation are suitably post-processed as per the following sequence of steps.

   1. The concentrations solved at various node locations within each electrode are numer-
        ically integrated over the corresponding electrode thicknesses using trapezoidal rule.

   2. The resulting integral value is multiplied with the porosity of the corresponding
        electrode region to obtain 𝑄e,ntrain (𝑡) and 𝑄e,p           (𝑡).
                                                            train


   3. These quantities are then de-biased by subtracting their initial values to obtain
      𝑄̃e,ntrain (𝑡) and 𝑄̃e,p (𝑡).
                            train



                                                  236
                                            6.8 Transfer Function Identification Procedure


     The same procedure is repeated for the validation current profile of fig. 6.2 to obtain
𝑄̃e,nval (𝑡) and 𝑄̃e,nval (𝑡). These data sets are used for all subsequent sub-tasks involved in this
system identification exercise.

    To facilitate a smaller search window for the coefficient determination in parametric
transfer function methods, a hand-estimation of coefficient order through non-parametric
methods may be first considered. This coarse estimate acts as a feeder to aid the faster
convergence of the non-linear optimisation algorithms used in parametric methods. In this
work, a basic spectral analysis using a Hanning window implemented using the MATLAB
command spa is applied to time-domain data to transform it into frequency response data.

    Figure 6.5 shows the Bode plots of the frequency response to the training set in the
negative electrode (left column) and positive electrode (right column) regions of the cell. It is
important to note that these Bode diagrams obtained by such non-parametric methods only
represent an approximation of the physical dynamics intended to help in initial estimates of
the system behaviour. Some preliminary understanding of the various characteristics of the
system can be gleaned from these Bode diagrams. The first visually striking feature is the
similarity in the general shape of the approximate frequency characteristics in the negative
and positive electrode regions, both in the magnitude response and in the phase response.
This confirms the author’s assumptions of equal ‘complexity’ in the symbolic regression
search discussed in section 6.1.1. This is also congruent with the physical behaviour of the
electrolyte in these two regions.

Finite DC gain

By visual extension of the frequency responses towards lower frequencies, it is clear that
the DC gains of both the systems are finite and below unity. This behaviour can clearly be
seen in the time-domain responses of fig. 6.4. For the plotted time-horizon, this effect is most
visible for the case of the 12 A constant current input, wherein the responses of both regions
settle to a finite value after an initial transient. Finally, the finiteness of the DC gain helps
to narrow down the search window for the parametric model structures. In particular, this
fact indicates that the model structures to be trialled must not have any integrator terms (or
poles at the origin of the complex plane).



                                                237
                                                     6.8 Transfer Function Identification Procedure


                             |Q
                              e
                                e,ntrain |                                                |Q
                                                                                           e
                                                                                             e,ptrain |
           –90                                                          –90


           –96                                                          –96


          –102                                                         –102




                                                                 dB
 dB




          –108                                                         –108


          –114                                                         –114


          –120                                                         –120
               –2      –1                      0         1                10–2     10–1                   100   101
             10      10                      10        10
                         6    Qe,ntrain
                              e                                                       6    Qe,ptrain
                                                                                           e
             0                                                         200

           –40                                                         160

           –80                                                         120
degrees




                                                             degrees




          –120                                                          80

          –160                                                          40

          –200                                                           0
             10–2    10 –1                   100       101                 –2       –1                   0        1
                                                                         10       10                   10       10
                    Frequency, ω (rad/s)                                         Frequency, ω (rad/s)

    Figure 6.5 Bode plots showing the estimated frequency response for the two subsystems under
    consideration. The frequency response data was obtained through a spectral analysis i.e., by
    computing the ratios of spectra of the de-biased input and output sequences. The sequences were
    smoothed using a Hanning window before computing the ratio.


Resonance and model order

First order transfer functions do not exhibit characteristic peaks or resonances in their
frequency responses. However, for the Bode magnitude plots in fig. 6.5, a pronounced
resonance around      0.15 rad s −1          is observable. This has an enormous impact — it presents
an important clue that the first order time-evolution ODEs of eq. (5.94) and eq. (5.96) are
inadequate to represent the system dynamics.


                                                         238
                                            6.8 Transfer Function Identification Procedure


Estimation of number of poles and zeros

The high-frequency roll-off in the slopes of the Bode magnitude plots in fig. 6.5 provide clues
on the number of poles in the system. The corner frequency 𝜔c in both cases appear to be
around             −1
         0.15 rad s .   The high-frequency slope of both systems is ≈20 dB per decade, which
implies that they have at-least one more pole than the number of zeros if using a continuous
time transfer function. For the corresponding z-domain transfer function, this implies 𝑛𝑎 ≥ 𝑛𝑏 .
Looking at the phase plot of the two electrode regions, it can be hypothesised that there exists
at-least one zero in these continuous-time systems around the 0.3–0.4 rad s −1   frequency range.
The discrete-time sampling process adds an additional zero to the system.

   Based on this preliminary analysis, the estimates are 𝑛𝑘 = 0, 𝑛𝑏 ≥ 2, 𝑛𝑎 ≥ 3. Only
asymptotic approximations to corner frequencies can be estimated from the Bode plots.
Furthermore, the estimated locations are not used in the parametric system identification
algorithms and is of much less importance than the model order estimates. With this initial
understanding, the parametric system identification procedure is carried out.


6.8.5     Refinement of coefficient orders using deterministic criteria

The initial estimate of coefficient orders in section 6.8.4 was performed based only on a visual
inspection of the Bode magnitude plots. Owing to the fact that the frequency response data
is the result of a crude ratio of spectra, there is a high probability of missing vital information
on the number and locations of poles and zeros. Hence only a lower bound on the coefficient
orders are available until this point. Next, a set of deterministic criteria is used to widen and
refine the coefficient order range.

   Although the ARX structure is deemed to be too simplistic (see section 6.8.3), owing to the
fact that only linear algebra operations are involved, as opposed to numerical optimisation
routines employed in the OE, ARMAX and Box-Jenkins structures, certain deterministic
criteria can be incorporated for coefficient order selection. This can serve as a refinement of
the initial number of coefficients guessed from the Bode magnitude plots of fig. 6.5.

   For any model structure used, its error can be defined as

                            𝜀[𝑘] = 𝑦[𝑘] − 𝑦̂m [𝑘]                                            (6.10)

                                                239
                                          6.8 Transfer Function Identification Procedure


where 𝑦[𝑘] are true measurements and
                        𝑦̂m [𝑘] = 𝐺(𝑞)𝑢[𝑘]                         (eq. (6.7) with 𝐻 (𝑞) set to 0)

are model outputs obtained using the assumed transfer operator 𝐺(𝑞) (to be determined).

   The number of numerator and denominator coefficients in 𝐺(𝑞) as well as their values are
to be determined. This set of unknowns can be collected into a parameter vector 𝜃. Thus, as
per eq. (6.10), the error sequence is parametrised by 𝜃, and its notation is amended to 𝜀[𝑘; 𝜃].

   For an input-output data set consisting of 𝑁 samples, a generic cost function that may be
applied for all the four model structures viz. ARX, ARMAX, OE and Box-Jenkins is

                                               𝑁
                                    𝑉𝑁 (𝜃) = ∑ 𝐿 (𝜀 [𝑘; 𝜃])                                 (6.11)
                                               𝑘=1
where 𝐿(⋅) is a positive-valued scalar loss function.

In a typical system identification task, the sum of squares of the error sequence is used as the
typical loss function, thereby yielding

                                               𝑁
                                    𝑉𝑁 (𝜃) =      2
                                               ∑ 𝜀 [𝑘; 𝜃]                                   (6.12)
                                               𝑘=1
The vector 𝜃 ̂ that minimises this cost function is desired
                                          𝜃 ̂ = arg min𝑉𝑁 (𝜃)                               (6.13)
                                                     𝜃


   For the ARX model structure, eq. (6.12) reduces to a standard quadratic optimisation
problem which may be solved analytically using least squares linear algebra. However, for
robustness against estimation bias, instead of the standard Ordinary Least Squares (OLS)
estimates, the Instrumental Variable (IV) estimation method [207] was used for this model
order selection task. Applying this to the ARX model structure, two deterministic model
order criteria have been defined — a) Akaike’s Information Criterion (AIC), and b) Rissanen’s
Minimum Description Length (MDL) [207].

   In the AIC, the optimal number of parameters 𝑑̂ in 𝜃 is obtained by minimising the
modified log likelihood cost function

                                                       2𝑑
                             𝑉𝑁 ,mod (𝜃) = ln 𝑉𝑁 (𝜃) +    ,     𝑁 ≫𝑑                        (6.14)
                                                       𝑁
                                               240
                                           6.8 Transfer Function Identification Procedure


In the MDL criterion, the cost function in eq. (6.14) is modified to

                                                        𝑑 ln 𝑁
                              𝑉𝑁 ,mod (𝜃) = 𝑉𝑁 (𝜃) (1 +        )                              (6.15)
                                                          𝑁


    For the two subsystems at hand, both criteria converged to the same choices for the
coefficient orders, yielding 𝑛𝑎 = 4, 𝑛𝑏 = 4 and 𝑛𝑘 = 0. Therefore, these values were used as the
starting points for the non-linear optimisation algorithms used in determining the exact pole
and zero locations for the discrete-time transfer functions which is described next.


6.8.6    Final transfer function coefficients — Nonlinear optimisation

For the ARMAX and Box-Jenkins model structures, eq. (6.12) results in a non-linear cost
function which is minimised iteratively using quasi-Newton approaches. The theoretical
foundation of standard non-linear optimisation methods such as L-BFGS and Levenberg-
Marquardt are well established whose detailed explanation is out of the scope of this thesis.
Although state of the art methods are not covered, the interested reader may consult the
textbook by Scales [214] for an introductory overview of this topic.

    The final model structures (for both the positive electrode and negative electrode time-
evolution subsystems) in the z-domain are given by

                                          𝑏1  𝑧 −1+ ⋯ + 𝑏𝑛𝑏  −𝑛
                                                            𝑧 𝑏
                                 𝐺(𝑧) =          −1           −𝑛                              (6.16)
                                        1 + 𝑎 1 𝑧 + ⋯ + 𝑎 𝑛𝑎 𝑧 𝑎

wherein the coefficients in the numerator and denominator are to be determined.

    The number of coefficients obtained from section 6.8.5 was used as the initial guess
for the coefficient orders in the non-linear optimisation. For the initial guesses for the
numerical values of the coefficients (𝑎1 , 𝑎2 , … 𝑎𝑛𝑎 ) and (𝑏1 , 𝑏2 , … , 𝑏𝑛𝑏 ), a randomised multi-
start algorithm was used. For the two transfer functions identified, no distinction is made
between whether the ARMAX structure or Box-Jenkins structure was used to arrive at the
                                             ̃        ̃               −3
coefficients. Since the output magnitudes of 𝑄e,n and 𝑄e,p are of 𝒪(10 ), a constant scaling
factor of 𝑘 = 1000 is used to bring the order of magnitude of output data values to unity.
A well-chosen scaling factor is often vital to the convergence of non-linear optimisation
algorithms. Since the system is linear, this constant gain shall not fundamentally change

                                                241
                                             6.8 Transfer Function Identification Procedure


the dynamics of the system and can be accounted for by using the reciprocal scaling factor
of 0.001 in numerical implementations. The identification procedure was carried out using
MATLAB’s System Identification Toolbox [215].

  Table 6.2 A sample of results showing the coefficients of four discrete-time transfer functions
  identified for the electrolyte time-evolution subsystem in the negative electrode region. Only
  those models that yielded similar errors (within 0.5 %) across both input datasets were retained.
  The fourth order model from case C (shaded in grey) performed the best across both training and
  validation profiles and is chosen as the final model. The 95 % confidence bounds on the coefficients
  were at least one order of magnitude lower than their mean values reported here.

                    Numerator                            Denominator               Training   Validation
Case                                                                               accuracy   accuracy
          𝑏1       𝑏2        𝑏3        𝑏4       𝑎1       𝑎2       𝑎3       𝑎4         (%)         (%)
 A     0.0026   −0.0025                      −1.922 0.923                           95.11       95.13
 B     0.0028   −0.0052 0.0025               −2.833 2.669 −0.836                    99.14       98.54
 C     0.0028   −0.0075 0.0066 −0.0019       −3.577 4.767 −2.801         0.612      99.73       99.28
 D     0.0026    0.0026 −0.0024 −0.0024       0.060 −1.906 −0.058        0.907      95.12       95.14


     Table 6.2 shows the results obtained by applying the aforementioned non-linear iden-
tification routines to the time-evolution subsystems in the negative electrode region. The
coefficient orders tried in the system identification procedure were informed by the inferences
from the bode magnitude plots as well as that obtained by applying the deterministic AIC
and MDL criteria. Only those models that yielded similar errors (within 0.5 %) across both
input datasets were retained.

     As discussed in section 6.8.4, a first order transfer function cannot capture all the dynamics
of the subsystems under consideration. Therefore, the lowest order tried in the identification
procedure was two (case A in table 6.2). As higher order models were tried, the system
accuracy improves steadily as seen in cases B and C. However in order to avoid overfitting,
the lowest order model that produces the highest matched accuracy across both training and
validation profiles must be chosen.

     Case D illustrates the importance of the initial values used in the non-linear optimisation
algorithms. Despite using an identical number of coefficients as case C, the optimisation
algorithm converges to a radically different set of zeros and poles resulting in a percentage
error comparable to that of the simple second order case. The fourth order model from case C
(shaded grey in table 6.2) performs the best across both training and validation profiles and is

                                                 242
                                            6.8 Transfer Function Identification Procedure


chosen as the final model. The number of numerators and denominators match exactly that
predicted by the deterministic criteria given in section 6.8.5. A similar selection procedure
was applied for the identification of the transfer function corresponding to 𝑄̃e,p in the positive
electrode region.

    The final identified transfer functions (for the scaled output) are

              𝑄̃e,n (𝑧) 0.002842𝑧 −1 − 0.00753𝑧 −2 + 0.006595𝑧 −3 − 0.001906𝑧 −4
                       =                                                                       (6.17)
                ̃𝐼(𝑧)       1 − 3.577𝑧 −1 + 4.767𝑧 −2 − 2.801𝑧 −3 + 0.6118𝑧 −4
              𝑄̃e,p (𝑧) −0.002809𝑧 −1 + 0.007139𝑧 −2 − 0.005944𝑧 −3 + 0.001614𝑧 −4
                       =                                                                       (6.18)
                ̃𝐼(𝑧)         1 − 3.464𝑧 −1 + 4.444𝑧 −2 − 2.495𝑧 −3 + 0.515𝑧 −4


    Figure 6.6 shows a comparison of the 𝑄̃e,n output for a) the P2D model, and b) the identified
transfer function of eq. (6.17) using the training current profile of fig. 6.1. The transfer function
of eq. (6.17) was obtained by scaling the output of the training profile to be of order 𝒪(1) by a
factor of 1000. Therefore, for final implementation and comparison purposes, the raw output
produced by applying the transfer function needs to be scaled back by its reciprocal. If the
system is linear, then this scaling factor shall have no impact on the frequency-dependent
dynamics of the subsystem. The output predicted by the identified transfer function is
virtually indistinguishable from the ‘true’ output computed by post-processing the P2D
model with an RMS error of                −6
                                 5.70 × 10 mol m −2     and a MAE of              −6    −2
                                                                        19.19 × 10 mol m .      This
high accuracy of the transfer function prediction justifies the linearity assumption for the
subsystem. Figure 6.7 presents the same comparison using the validation input profile for the
subsystem in the positive electrode region. The accuracy of the identified transfer function
for this independent data set is clearly illustrated.

    The poles of eq. (6.17) are located at (0.9969, 0.9870, 0.9106, 0.6829) while those of eq. (6.18)
lie at (0.9967, 0.9880, 0.8952, 0.5842) on the Z-plane i.e., close to each other. This confirms the
hypothesis that these two sub-systems exhibit similar dynamics. The slight differences in the
pole locations could be attributed to the variations in the physical parameters pertaining to
the two electrode regions. The numerator coefficients of eq. (6.17) and eq. (6.18) are also close
to each other except that their signs are opposite to each other. This is to be expected, since as
seen in the step response plots of fig. 6.4, 𝑄̃e,n and 𝑄̃e,p evolve in time in opposite directions.
This is also explained by the fact that, for a given applied current, a decrease in the number of

                                                243
                                                     6.8 Transfer Function Identification Procedure


                                  ×10–3                     Q
                                                            e
                                                              e,ntrain (t)
                       8.00
                                                                                         P2D
                                                                                         SysID

                       4.50
            mol m–2




                       1.00


                                                    ×10–3
                                            –0.90
                      –2.50                 –1.00
                                            –1.10
                                                     290         295         300
                      –6.00
                              0           300                  600                 900           1200
                                                             time (s)


  Figure 6.6 Time-evolution of 𝑄̃e,n computed using the P2D model and the identified transfer
  function of eq. (6.17) (scaled by 0.001) with the synthetic training input profile of fig. 6.1.
  The output predicted by the identified transfer function closely matches the ‘true’ output
                                                                           −6      −2
  obtained by a high-fidelity P2D simulation with an RMS error of 5.70 × 10 mol m and a MAE
               −6      −2
  of 19.19 × 10 mol m . Note that the transfer function in eq. (6.17) was originally obtained by
  scaling the output by 1000. The transfer function output is multiplied by the reciprocal of the
  same scaling factor to obtain the predicted response shown here, thereby once again justifying
  the linearity assumption for this subsystem.


ions in the negative electrode has to be accompanied by an increase in the positive electrode
and vice-versa (the values of the changes are not exactly equal owing to the presence of the
separator). The identified transfer functions are thus consistent and deemed to be suitable
for representing the electrolyte time-evolution in these regions.


6.8.7    Numerical implementation of identified transfer functions

The concept of deploying a Z-domain transfer function may seem incongruous to the one
of the major goals of this thesis viz. time-domain implementation of ROMs in an embedded
environment such as a BMS. While the majority of the models is derived and implemented
entirely in time-domain, only the two time-evolution subsystems of the electrolyte seems
to deviate from this trajectory. However, an explanation for this is provided in section 6.4.3.
In particular, it was mentioned that an approximation-free conversion to time-domain from
Z-domain exists, that mitigates this perceived drawback for these two sub-systems. This
conversion is amenable for discrete-time implementation without any other modifications.

                                                            244
                                                                    6.8 Transfer Function Identification Procedure

                                                                                Q e,pval (t)
                                    ×10–3
                                                                                e


                                                                                                                          P2D
                                                                                                                          SysID
                         4.00


                         2.00
              mol m–2




                         0.00


                        –2.00                    ×10–3
                                        –2.20
                                        –2.30
                        –4.00           –2.40
                                            1110         1112      1114

                                0           300            600            900              1200          1500      1800           2100
                                                                                time (s)


  Figure 6.7 Time-evolution of 𝑄̃e,p computed using the P2D model and the identified transfer
  function of eq. (6.18) (scaled by 0.001) with the synthetic validation input profile of fig. 6.2.
  The output predicted by the identified transfer function closely matches the ‘true’ output
                                                                            −6     −2
  obtained by a high-fidelity P2D simulation with an RMS error of 12.07 × 10 mol m and a MAE
               −6        −2
  of 31.59 × 10 mol m . Note that the transfer function in eq. (6.18) was originally obtained by
  scaling the output by 1000. The transfer function output is multiplied by the reciprocal of the
  same scaling factor to obtain the predicted response shown here, thereby once again confirming
  the linearity of this subsystem.


    Starting from the generic structure of the identified transfer functions (see eq. (6.8)),

                                                              𝑏1          𝑧 −1
                                                                      + ⋯ + 𝑏𝑛𝑏                    −𝑛
                                                                                                  𝑧 𝑏
                                                     𝐺(𝑧) =
                                                            1 + 𝑎1 𝑧 −1 + ⋯ + 𝑎𝑛𝑎 𝑧 −𝑛𝑎                                    Replace with analogous
                                                                                                                           transfer operator 𝑞 = 𝑧
                                                              𝑏1          𝑞 −1
                                                                      + ⋯ + 𝑏𝑛𝑏                    −𝑛
                                                                                                  𝑞 𝑏                      in time domain
                                                     𝐺(𝑞) =
                                                            1 + 𝑎1 𝑞 −1 + ⋯ + 𝑎𝑛𝑎 𝑞 −𝑛𝑎
                                                                                                                          Apply the definition

                                                                            −1                     −𝑛                     of 𝐺(𝑞) on the LHS
                                                     𝑦[𝑘]   𝑏1     + ⋯ + 𝑏𝑛𝑏
                                                                          𝑞                       𝑞 𝑏
                                                          =       −1          −𝑛
                                                     𝑢[𝑘] 1 + 𝑎1 𝑞 + ⋯ + 𝑎𝑛𝑎 𝑞 𝑎
                                                                                                                          Cross-multiply

      (1 + 𝑎1   𝑞 −1      + ⋯ + 𝑎𝑛𝑎          −𝑛
                                            𝑞 𝑎 ) 𝑦[𝑘]           = (𝑏1   𝑞 −1   + ⋯ + 𝑏𝑛𝑏          −𝑛
                                                                                                  𝑞 𝑏 ) 𝑢[𝑘]
                                                                                                                          Expand on both sides

𝑦[𝑘] + 𝑎1    −1
            𝑞 𝑦[𝑘] + ⋯ + 𝑎                        −𝑛
                                                 𝑞 𝑎 𝑦[𝑘]        = 𝑏1    −1
                                                                        𝑞 𝑢[𝑘] + ⋯ + 𝑏                   −𝑛
                                                                                                        𝑞 𝑏 𝑢[𝑘]
                                            𝑛𝑎                                                     𝑛𝑏                     Apply the definition
                                                                                                                          𝑞 −𝑝 𝑥[𝑘] = 𝑥[𝑘 − 𝑝]
𝑦[𝑘] + 𝑎1 𝑦[𝑘 − 1] + ⋯ + 𝑎𝑛𝑎 𝑦[𝑘 − 𝑛𝑎 ] = 𝑏1 𝑢[𝑘 − 1] + ⋯ + 𝑏𝑛𝑏 𝑢[𝑘 − 𝑛𝑏 ]
                                                                                                                          Rearrange to obtain
                                                                                                                          the final expression
                                                     𝑦[𝑘] = −𝑎1 𝑦[𝑘 − 1] − ⋯ − 𝑎𝑛𝑎 𝑦[𝑘 − 𝑛𝑎 ]
                                                                        + 𝑏1 𝑢[𝑘 − 1] + ⋯ + 𝑏𝑛𝑏 𝑢[𝑘 − 𝑛𝑏 ]                                       (6.19)

                                                                           245
                  6.9 Performance Analysis of System Id Model: Ionic Concentration


    We thus obtain a simple algebraic expression (a difference equation) that computes the
output at the given time-step given past inputs and outputs. This is a highly memory-efficient
implementation since, at any given time-step, only the previous 𝑛𝑎 (four) output samples
and 𝑛𝑏 (four) input samples need to be ‘remembered’ (stored). This concludes all the aspects
(derivation and implementation) of this author’s new model for the electrolyte time-evolution
subsystem. The performance of this model for computation of electrolyte concentration needs
to be evaluated, which is performed next.


6.9     Performance Analysis of System Identification Model:
        Ionic Concentration in Electrolyte
To demonstrate that a suitable advancement of the field has indeed been achieved through
this system identification exercise, a comparison with the existing state of the art in reduced
order electrolyte modelling is warranted. Secondly, to comprehend its extent of validity and
performance boundaries, the newly developed ROM must also be pitted against the full-order
P2D model. This section aims to provide such a comparative discussion for two types of
inputs — a) constant current inputs b) dynamic load profiles


6.9.1    Constant current inputs

Figure 6.8 shows the spatial distribution of ionic concentration in the electrolyte along cell
thickness for a 1C discharge beginning at 100 % SOC. The spatial concentration computed by
each of the three approaches — i) the P2D model, ii) the quadratic approximation model and
iii) the newly developed system identification model(s).

    During the initial phase of discharge, the P2D model exhibits a characteristic inflection
point near the separator interfaces that diffuses out over time until a QSS. This is due to the fact
the reaction front is initially established close to the separator, and as surface concentration
of lithium in particles near separator is depleted, the reaction starts moves further into the
electrode thickness. Neither of the two ROMs under consideration here could successfully
capture this characteristic inflection. This is explained by the fact that both of them use the
standard quadratic approximation profile for the spatial profile, which means that only one
apex point is possible per electrode, which is pinned to their separator interfaces by design.

                                                246
                         6.9 Performance Analysis of System Id Model: Ionic Concentration

                               ce (x, t)                                                      ce (x, t)
                                                                           1200
           1040
                                            t=4s                           1100                            t = 18 s
(mol m )




                                                                (mol m )
           1020
      –3




                                                                      –3
           1000                                                            1000
            980        P2d                                                            P2d
 ce




                                                                  ce
                       Quadratic                                           900        Quadratic
            960        SysID                                                          SysID
                                                                           800
                   0               ln ln + ls            ltot                     0               ln ln + ls            ltot
                               ce (x, t)                                                      ce (x, t)
           2000                                                            2000

           1500                             t = 357 s                      1500                            t = 1785 s
(mol m )




                                                                (mol m )
      –3




                                                                      –3
           1000                                                            1000
                       P2d                                                            P2d
 ce




                                                                  ce

            500        Quadratic                                           500        Quadratic
                       SysID                                                          SysID
               0                                                              0
                   0               ln ln + ls            ltot                     0               ln ln + ls            ltot
                               ce (x, t)                                                      ce (x, t)
           2000                                                            2000

           1500                             t = 2677 s                     1500                            t = 3570 s
(mol m )




                                                                (mol m )
      –3




                                                                      –3




           1000                                                            1000
                       P2d                                                            P2d
 ce




                                                                  ce




            500        Quadratic                                           500        Quadratic
                       SysID                                                          SysID
               0                                                              0
                   0               ln ln + ls            ltot                     0               ln ln + ls            ltot

    Figure 6.8 Spatial distribution of ionic concentration in electrolyte along cell thickness at
    various snapshots of time computed by each of the three models for a 1C discharge. The
    concentration profile computed by the P2D model is used as the benchmark reference. The system
    identification model performs noticeably better than the quadratic approximation model during
    the initial transient while delivering a similar performance as a QSS is reached.


           During the transient portion of discharge (approximately up to 357 s as shown in fig. 6.8),
the locus of the concentration profile computed by the newly developed system identification
model(s) lies closer to the P2D model than that computed by the quadratic approximation
model. After the initial transition phase, it appears that the concentration profile predicted
by both the ROMs converge to the P2D model’s concentration profile.



                                                            247
                  6.9 Performance Analysis of System Id Model: Ionic Concentration


    To obtain a quantifiable perspective on the accuracy of the newly developed model,
it is desirable to plot the temporal evolution of the concentration, particularly at the two
current collector interfaces. The behaviour of the baseline quadratic approximation model
in this regard was established in section 5.4.2. Therefore it is important to ascertain whether
a noteworthy improvement was achieved using the model arrived at using the system
identification procedure.

    Figure 6.9 shows time-evolution of ionic concentrations at the current collector interfaces
of the negative and positive electrodes for a 1C discharge. Concentration profiles computed
by the three approaches — i) P2D model, ii) quadratic approximation model and the iii) newly
developed system identification model(s) are overlaid in the top row of plots, wherein the left
hand side corresponds to the current collector interface at the negative electrode while the
right hand side corresponds to that at the positive electrode. The plots in the bottom row of
fig. 6.9 show the time-evolution of the absolute value of their errors. The concentration error
of each of the two ROMs is defined with respect to the benchmark P2D model i.e., 𝜀𝑐e,𝑗 (𝑡) =
𝑐e,𝑗ROM − 𝑐e,𝑗p2d (𝑡). The absolute value of the error is plotted so that the magnitude of the error
can be visualised better, aiding immediate comparisons based on the plots.

    For both current collectors, the newly developed system identification model outperforms
the quadratic approximation model during the transient phase. At the negative electrode/cur-
rent collector interface, the error of the system identification model remains strictly below that
of the quadratic approximation model until ≈650 s and remains comparable to it until ≈1600 s.
Beyond this time, the quadratic approximation model has a slightly better accuracy, although
the system identification model still remains at a comparable distance from it. After ≈2000 s,
both models yield the same response shape. For the positive electrode/current collector
interface, the error of the system identification model remains below that of the quadratic
approximation model until ≈3300 s.

    Figure 6.10 shows a zoomed version of the time-evolution of the ionic concentration
at the two current collectors, wherein the first 300 s after application of the load current
is plotted. The significant improvement in accuracy achieved by the newly developed
system identification model(s) is clearly demonstrated. At both the current collectors, the
concentration computed by the system identification model(s) closely track that of the
benchmark P2D model.

                                                248
                       6.9 Performance Analysis of System Id Model: Ionic Concentration

                             ce (0, t)                                                 ce (ltot , t)
          2250                                                       1000
                                            P2d                                                         P2d
          2000                              Quadratic                800                                Quadratic
                                            SysID                                                       SysID
     –3




                                                                –3
          1750                                                       600
mol m




                                                           mol m
          1500                                                       400
          1250                                                       200
          1000                                                         0
                 0   1000     2000         3000     4000                    0   1000     2000          3000     4000
                            |εce,negcc |                                               |εce,poscc |
          350                                                        350
                                            Quadratic                                                   Quadratic
          280                               SysID                    280                                SysID
     –3




                                                                –3
          210                                                        210
mol m




                                                           mol m
          140                                                        140
           70                                                         70
            0                                                          0
                 0   1000     2000         3000     4000                    0   1000     2000          3000     4000
                            time (s)                                                   time (s)

    Figure 6.9 Evolution of ionic concentration over time at the two current collector interfaces
    for a 1C discharge for i) the P2D model, ii) the quadratic approximation model and iii) the newly
    developed system identification model(s) (top row). For the quadratic approximation and system
    identification models, the time evolution of their absolute error relative to the P2D benchmark
    is also shown (bottom row). At both current collectors, the transient performance of the system
    identification model is superior to the quadratic approximation model. At QSS, the quadratic
    approximation model is slightly more accurate than the system identification model.


          The loss of fidelity exhibited past the initial transient phase warrants an explanation.
It should be recalled that the natural decoupling of the temporal and spatial systems were
taken advantage of in developing the system identification technique. This means that, for
the spatial profile, the system identification model reverts to the same quadratic profile
as the baseline quadratic approximation model. This explains why the two models have
similar shape past the initial transient. During the transient phase when the QSS behaviour
is yet to be established, it is reasonable to assume that the temporal dynamics are of
paramount importance in governing the concentration profile evolution. After a QSS has
been established with the reaction front diffusing out and a steady stream of ion-electron
separation/recombination in place, it is hypothesised that the temporal dynamics have settled
and the spatial configuration assumes importance.


                                                        249
                          6.9 Performance Analysis of System Id Model: Ionic Concentration

                              ce (0, t)                                                      ce (ltot , t)
          1800                                                              1000
                                          P2d                                                                P2d
                                          Quadratic                                                          Quadratic
          1600                            SysID                             750                              SysID
     –3




                                                                       –3
mol m




                                                                  mol m
          1400                                                              500


          1200                                                              250


          1000                                                                 0
                 0   60     120     180   240         300                          0   60   120     180      240         300
                              time (s)                                                        time (s)

   Figure 6.10 Transient phase of the temporal evolution of ionic concentration at the two
   current collector interfaces for a 1C discharge as computed by — i) the P2D model, ii) the
   quadratic approximation model, and iii) the newly developed system identification model(s). The
   significantly improved accuracy of the system identification model(s) relative to the state of the
   art quadratic approximation model is clearly demonstrated.


          With a sustained application of constant current past the initial transient, strong spatial
gradients in the ionic concentration are established within the cell i.e., the concentrations
are far from the initial equilibrium value. This precisely exposes the realm where the
system identification model exhibits its natural weakness. By following the theory of system
identification, which necessitates bias removal, the training and validation profiles of fig. 6.1
and fig. 6.2 had nearly zero mean. This means that the currents were as equally positive as
negative leading to a small-signal perturbation around the equilibrium value of the electrolyte
concentration. While this profile is ideally suited to excite the system’s dynamics, it fails to
capture the large signal behaviour. As a topic of future research, perhaps a spatially-coupled
system identification could be attempted to handle this issue. Table 6.3 provides a summary
of error statistics for the transient phase, thereby helping to compare the performance of the
quadratic and system identification models against the benchmark P2D simulation results.

          The main implication of these results is that the identified models are primarily suitable for
transient i.e., dynamic load profiles, which is typical of a real-life scenario in an electric/hybrid
electric vehicular operation. Such a model is less suitable for sustained constant current
application. This implies that a BMS in a vehicle undergoing a Constant Current Constant
Voltage (CCCV) charging cannot rely on these identified electrolyte models. However, this


                                                            250
                   6.9 Performance Analysis of System Id Model: Ionic Concentration

  Table 6.3 Summary of error statistics comparing the performance of quadratic approximation
  and system identification models. The input is a 1C constant current discharge applied for the
  first 30 minutes starting at 100 % cell SOC. The metric being compared is the absolute value of the
  concentration difference with respect to the P2D model at the two current collector interfaces.

                Error statistic            ||𝜀𝑐 || at Neg/CC       ||𝜀𝑐 || at Pos/CC
                                               e                       e
                         −3
                  (mol m )               Quadratic     SysID     Quadratic      SysID
                Max                        133.80       39.51      276.33       194.27
                Mean                        48.16       29.56      227.92       146.53
                Median                      25.60       30.17      218.96       173.14
                Standard Deviation          36.94        8.22       29.71        55.79


exclusion does not seriously hamper the model’s wider applicability since a simple coulomb-
counting approach with a high-precision Analog to Digital Converter (ADC) is much more
accurate than any other PBM in this particular scenario.

   Although constant current discharge is not a practical use-case for vehicular batteries,
performing this benchmark evaluation has helped in understanding the limits of the newly
developed model. This study has also helped in providing a glimpse of its potential strength
viz. significantly improved accuracy under dynamic load conditions, which is presented next.


6.9.2    Dynamic current inputs

To characterise the performance of the newly developed system identification electrolyte
concentration model(s) under dynamic load conditions, the UDDS drivecycle was used. The
details of this drivecycle such as its speed versus time data and its highly dynamic nature
was discussed in section 5.3.3. The peak of the applied load current used corresponds to a
discharge current of 180 A i.e., 3C. A plot of this current profile was shown in the top row of
fig. 5.12. This load profile was applied to the three models under consideration — a) P2D model,
b) quadratic approximation model, and c) newly developed system identification model(s) —
and the spatio-temporal evolution of ionic concentration in electrolyte computed by each of
them was studied.

   Since the load current is highly dynamic and continuously alternating between charging
and discharging at various magnitudes throughout the profile duration, it is difficult to discern
a specific pattern or trend within the spatial thickness of the cell. Hence, unlike the case

                                                 251
                  6.9 Performance Analysis of System Id Model: Ionic Concentration


of prolonged unidirectional current application wherein a clear reaction front that diffuses
gradually out can be visualised (see fig. 6.8), little information can be gained from visualisation
of spatial concentration profiles. Since the ionic concentrations at the two current collectors
have a direct (and two-pronged) influence on the electrolyte overpotential (see eq. (2.4)), it is
particularly important to characterise the accuracy at these two critical spatial locations.

   Since a direct correspondence between the time-dependent dynamics of the load profile
and that of the electrolyte concentration can be intuitively visualised, its values at the two
current collector interfaces are examined. The plots in the top row of fig. 6.11 shows the
time evolution of the ionic concentration at the two current collector locations for the UDDS
current profile computed by each of the three models under consideration. The plots to the
left pertain to the negative current collector location while that to the right correspond to
the positive current collector location. The bottom row of plots show the absolute value
of concentration error of the quadratic and system identification models relative to the
P2D reference benchmark. As seen in fig. 6.11, the absolute error of the newly developed
system identification models remain below that of the baseline quadratic approximation
model throughout the drivecycle.

   Based on the conclusions from the constant current input study of section 6.9.1, it is to
be expected that the system identification model(s) exhibit a superior performance during
the transient phase of the simulation. As seen in the initial duration of fig. 6.11, the absolute
error of the system identification model is indeed lower than that of the baseline quadratic
approximation model. Particular, when a sudden current spike is applied at ≈200 s, the
quadratic approximation model is unable to cope and its absolute error deviates far away from
its mean value. The absolute error of system identification model remains well controlled
and even with this instantaneous load demand, its standard deviation is remarkably close to
its median value as shown in table 6.4.

   While the superior accuracy of the newly developed model during the transient phase
was not surprising, the fact that its performance remains consistent throughout the entire
time horizon is noteworthy. Despite being subject to incessant changes in load demands, the
system identification model responds better than the quadratic approximation model well
past the initial transient. Figure 6.12 shows a zoomed view of the ionic concentration in the
electrolyte at the two current collector interfaces. To prove the improved performance of

                                               252
                          6.9 Performance Analysis of System Id Model: Ionic Concentration



                                ce (0, t)                                                      ce (ltot , t)
          1400                                                          1550
                                              P2d                                                              P2d
                                              Quadratic                                                        Quadratic
          1300                                SysID
                                                                        1250                                   SysID
     –3




                                                                   –3
mol m




                                                              mol m
          1200                                                          950

          1100                                                          650

          1000                                                          350
                 0   200 400 600 800 1000 1200 1400                            0   200 400 600 800 1000 1200 1400
                               |εce,negcc |                                                    |εce,poscc |
          300                                                           300
                                              Quadratic                                                        Quadratic
                                              SysID                                                            SysID
          225                                                           225
     –3




                                                                   –3
mol m




                                                              mol m
          150                                                           150

           75                                                            75

            0                                                             0
                 0   200 400 600 800 1000 1200 1400                            0   200 400 600 800 1000 1200 1400
                              time (s)                                                      time (s)

   Figure 6.11 Evolution of ionic concentration over time at the two current collector interfaces
   with a UDDS input profile (see topmost plot of fig. 5.12) as computed by i) the P2D model,
   ii) the quadratic approximation model and iii) the newly developed system identification model(s)
   (top row). The plots on the left pertain to the negative electrode/current collector interface,
   while that on the right corresponds to the positive electrode/current collector interface. For the
   quadratic approximation and system identification models, their absolute error relative to the P2D
   benchmark is also shown (bottom row). The system identification model is considerably more
   accurate than the quadratic approximation model for the entire time horizon of the drivecycle.



   Table 6.4 Summary of error statistics with a UDDS input current profile for the quadratic
   approximation and system identification models. The metric used is the absolute value of the
   concentration difference with respect to the P2D model at the two current collector interfaces.

                        Error statistic             ||𝜀𝑐 || at Neg/CC               ||𝜀𝑐 || at Pos/CC
                                                        e                               e
                                 −3
                          (mol m )                Quadratic        SysID           Quadratic       SysID
                        Max                         307.27         190.04           292.20         114.44
                        Mean                         66.38          54.98            55.15          25.02
                        Median                       49.65          47.12            40.39          20.93
                        Standard Deviation           66.80          37.18            60.50          20.17



                                                          253
                          6.9 Performance Analysis of System Id Model: Ionic Concentration


the developed model well into the operation of the cell, a 50 s window beginning at ≈60 %
of the overall profile duration is examined in detail. Although it exhibits some oscillations,
the system identification model(s) reasonably track the ‘true’ concentrations computed by
the P2D model. However, the baseline quadratic approximation model seems to suffer from
a large bias with respect to the P2D model. It should also be noted that nearly every ‘kink’ in
the two ROMs is identical. This could be attributed to the fact the spatial profile used in both
of them is identical. Hence, it must be concluded that the difference in their amplitude arises
from the improved calculation of coefficients 𝑎𝑘 (𝑡) in eq. (5.69) and eq. (5.71) through the
usage of more accurate 𝑄e,n and 𝑄e,p in the Left-Hand Side (LHS) of eq. (5.81) and eq. (5.83)
respectively. Detailed error metrics of the two ROMs is shown in table 6.4.

                              ce (0, t)                                              ce (ltot , t)
          1140                                                        875
                                          P2d                                                        P2d
                                          Quadratic                                                  Quadratic
          1127                            SysID                       857                            SysID

          1114                                                        839
     –3




                                                                 –3
mol m




                                                            mol m




          1101                                                        821

          1088                                                        803

          1075                                                        785
             850    860     870     880   890         900               850   860   870     880      890         900
                              time (s)                                                time (s)

   Figure 6.12 A zoomed view of the ionic concentration (showing a 50 s window beginning at
   ≈60 % of the overall profile duration) in the electrolyte at the two current collector interfaces for
   the UDDS profile of fig. 5.12 as computed by — i) the P2D model, ii) the quadratic approximation
   model, and iii) the newly developed system identification model(s). At both current collector
   interfaces, the system identification model(s) exhibits a reasonable tracking of the concentration
   profile computed by the benchmark P2D. The profile computed by the quadratic approximation
   model seems to suffer from offsets/bias issues that adversely affects its accuracy.


          Based on the evidence presented thus far, it can be concluded that the time-evolution sub-
system model(s) developed here using the system identification technique indeed represent
an advancement of the field of reduced order electrolyte modelling. With this aspect thus
tackled, it is imperative to explore the potential benefits of incorporating the discrete-time
model(s) thus obtained into the conventional SPM and is discussed next.



                                                        254
                                    6.10 Composite SPM Model with Electrolyte Dynamics


6.10     Composite SPM Model with Electrolyte Dynamics
At this stage, it must be recalled that the purpose of developing the system identification
electrolyte model was to mitigate the poor performance of the basic SPM at C-rates above 0.5C
(see section 5.3.3). This sub-optimal performance was attributed to the lack of electrolyte
dynamics in the basic SPM. The performance of the newly developed system identification
model has been proved to be superior to the current state of the art. The next step is to embed
this electrolyte model into the basic SPM so as to obtain a composite SPM. The performance of
this composite model is evaluated to ascertain its suitability towards online implementation.


6.10.1    Computation of electrolyte overpotential

The missing component in the terminal voltage computation of the basic SPM is the
contribution from the electrolyte overpotential term. This is the potential difference in the
entire electrolyte i.e., the electrolyte potential at the positive current collector interface with
respect to that at the negative current collector interface.

   As discussed in section 2.3.2, using the equation proposed by Prada et al. [99], the
overpotential in the electrolyte is computed as

                                      0   2𝑅𝑇     𝑐 e,pos/cc
            𝜙e,pos − 𝜙e,neg   = (1 − 𝑡+ )      ln
                                            𝐹     𝑐e,neg/cc
                                    𝐼      𝑙neg            𝑙sep   𝑙pos
                                −      (          +2            +         )   (eq. (2.4) revisited)
                                   2𝐴 𝜅eff,neg          𝜅eff,sep 𝜅eff,pos


   Equation (2.4) consists of two distinct terms — i) a diffusion overpotential due to
concentration gradient in the electrolyte, and ii) an ohmic resistance term that is dependent
upon a) the instantaneous value of applied current, b) the thicknesses of the three cell regions,
and c) the effective ionic conductivity in each of the three regions.

   The ohmic loss term of eq. (2.4) needs to be examined in closer detail. The dependence
of this term on instantaneous load current and cell thicknesses can be accounted in a
straightforward manner. However, there are ambiguities in computing the effective ionic
conductivity in each of the three cell regions. The effective value of ionic conductivity in



                                                   255
                                6.10 Composite SPM Model with Electrolyte Dynamics


the electrolyte depends on its intrinsic conductivity, the Bruggeman constants and porosities
of each of the three regions. The intrinsic electrolyte conductivity in-turn depends on the
electrolyte concentration.

   Ambiguities arise in interpreting the value of ionic concentration to be used for computa-
tion of electrolyte concentration. Since eq. (2.4) deals with overall potential drop across the
entire length of the cell, the concentration used for computing electrolyte conductivity could,
for example be that at the respective current collectors. This concept however introduces
inconsistencies with the separator term. Using the separator concentration from one of
the electrode interfaces introduces unequal weighting in this computation. If the ionic
concentration at the midpoint of the separator is used, this scheme becomes inconsistent with
that at the two current collectors. Another possibility for computing the effective conductivity
in a cell region is to use the mean of the concentration in that region. However, since the
mean is nothing but a simple statistical first moment is equally influenced by the entire
concentration profile within each cell region. This is questionable given that the electrolyte
overpotential across the entire cell thickness is most likely governed by the conductivities at
the two current collector interfaces. Some form of weighted mean could be conjured, wherein
the current collector locations are given the highest weight and the separator locations
the least weight. However, finding the weights becomes yet another exercise and from
the engineering perspective of computing these in real-time, seems to be in the realm of
diminishing returns.

   In published literature, only a cursory treatment has been accorded to the aforementioned
ambiguities. In Prada et al. [99], the usage of initial concentrations is used to only introduce
the concept of ohmic resistance in that article. However, the author of this thesis wishes to
extend this concept further. In the simulations conducted by this thesis author, it became clear
that the dependence on applied current was required in order to obtain reasonable accuracies.
Computing mean of concentrations in cell regions for calculation of ionic conductivities led
to a biased computation of overpotentials. Therefore, this author decided to use the value
of initial concentration for the computation of ionic conductivities in the current-dependent
contribution to electrolyte overpotential throughout the entire time horizon considered.




                                              256
                                   6.10 Composite SPM Model with Electrolyte Dynamics


   Hence, as per the adopted scheme eq. (2.4) gets modified as

                                    0   2𝑅𝑇    𝑐 e,pos/cc (𝑡)
    𝜙e,pos (𝑡) − 𝜙e,neg (𝑡) = (1 − 𝑡+ )     ln
                                         𝐹     𝑐e,neg/cc (𝑡)
                                  𝐼         𝑙neg                      𝑙sep             𝑙pos
                              −      (                      +2                  +                  ) (6.20)
                                 2𝐴 𝜅eff,neg (𝑐e (0))          𝜅eff,sep (𝑐e (0)) 𝜅eff,pos (𝑐e (0))

wherein the time-dependent terms are explicitly shown in the notation.

   Using eq. (6.20) for electrolyte overpotential computation has an important implication.
The two-pronged influence of the time-dependent electrolyte concentration on the electrolyte
overpotential viz. a) a direct influence in the form of concentration dependent diffusion
polarisation, and b) an indirect influence through its use in ionic conductivity calculations
has now been reduced to just one. This implies the results from the system identification
model are now required only in the first term of eq. (6.20).

   In the light of the decision of use the (constant) initial concentration for the ohmic term, it
is natural to question the gains from the circuitous route of the system identification exercise
that was undertaken to obtain the improved electrolyte model. Therefore, it is imperative to
quantify the relative weight of the concentration dependent diffusion resistance compared
to the bulk solution resistance.

   Figure 6.13 shows the contribution to the overall potential drop 𝜙e,pos and 𝜙e,neg in the
electrolyte from each of the two terms in eq. (6.20) for a 1C discharge. The bulk solution
resistance is constant owing to the fact that the initial electrolyte concentration is used
in computing the effective ionic conductivities in the three regions of the cell. The gradient
induced diffusion polarisation term, however has a stronger contribution in both the transient
and steady state. The entire dynamics of the overall potential drop during the transient phase
is governed by this concentration-dependent term, while its steady state contribution is in-
fact higher than the bulk solution resistance. The constant ohmic resistance term merely
provides a non-zero offset for the electrolyte solution overpotential. In questioning whether
the system identification exercise was indeed worthwhile, if the concentrations in the two
current collectors had not been computed at each time-step, then this diffusion polarisation
term would become zero. This is because, the numerator and denominator in eq. (6.20) would
have to be retained at the initial concentration, leading to a unit ratio whose natural logarithm


                                                  257
                                   6.10 Composite SPM Model with Electrolyte Dynamics

                    0


                 –0.04
                                                   Ohmic Loss in Bulk Solution

                 –0.08
             V                                     Concentration Polarisation
                 –0.12


                 –0.16                             Overall ∆φe (t) in Electrolyte


                  –0.2
                         0   500   1000   1500     2000     2500   3000     3500    4000
                                                 time (s)

  Figure 6.13 Contribution to the overpotential in the electrolyte from each of the two terms in
  eq. (6.20) for a 1C discharge. The bulk solution resistance is approximated as a constant value
  determined by the equilibrium initial concentration. The concentration dependent polarisation
  term governs the dynamic behaviour of the overall overpotential. Furthermore, this gradient-
  induced diffusion resistance has a strong contribution to the steady state, higher than the bulk
  solution resistance and cannot be neglected without introducing significant errors.


is zero. Therefore, it is clear that computing the concentrations at the two current collectors
through system identification has indeed helped in improving the modelling accuracy.

   Having established the relative importance of computing the diffusion-dependent polar-
isation overpotential, the next question that arises is whether the constant approximation for
the bulk solution resistance is indeed appropriate. It also remains to be seen if the accurate
computation of the ionic concentration through system identification (see section 6.9) has
translated into a similarly accurate computation of electrolyte overpotential. This is answered
by a comparing the electrolyte overpotential computed by the system identification model
with that obtained from the P2D model.

   Figure 6.14 shows a comparison of the electrolyte overpotential computed by the P2D
and system identification models for a 1C discharge. There is a discrepancy in the initial
offset of the overpotential value. However, this cannot be attributed to the use of the
constant concentration approximation in the computation of ionic conductivities in eq. (6.20).
This is because, at equilibrium the concentration used is exactly the initial concentration.
Furthermore, at the instant of applying the current, diffusion gradients in the electrolyte have
not yet been established. Hence, the contribution from the diffusion overpotential is zero,
                                           258
                                   6.10 Composite SPM Model with Electrolyte Dynamics

                                        ∆φe (t) = φe,poscc (t) – φe,negcc (t)
                  0.00


                 –0.08
                                             P2d model

                 –0.16
                                             SysID model
             V
                 –0.24


                 –0.32


                 –0.40
                         0        800          1600              2400           3200   4000
                                                      time (s)

  Figure 6.14 Comparison of electrolyte overpotential computed by the P2D model and the
  system identification model (using eq. (6.20)) for a 1C discharge. During the transient phase, the
  profile obtained by the system identification model closely matches that of the P2D model. The
  mismatch in the initial overpotential does not arise to the use of a constant concentration for the
  bulk resistance contribution, since at equilibrium this value is exact and not an approximation. Past
  the initial transient, accuracy of the system identification model degrades. This can be explained by
  its analogous behaviour for concentration computation in the Quasi-Steady State (see section 6.9.1)
  for constant current inputs.


which can also be seen in fig. 6.13. Thus, it can be concluded that this initial mismatch is due
to the presence of some other unmodelled phenomena that affects the DC offset of electrolyte
overpotential, and is not arising due to the approximations used by this author.

   In fig. 6.14, the shape of the transient profile of overpotential computed by the system
identification model closely matches that of the P2D model. This validates that the newly
developed model does indeed capture the electrolyte dynamics sufficiently well during the
initial transient. However, past the initial transient, the model’s accuracy degrades and the
resulting profile does not track the P2D model. This behaviour in overpotential is analogous
to that exhibited in the spatio-temporal concentration study discussed in section 6.9.1 for
constant current inputs, wherein it was deemed that this newly developed model is more
suitable for dynamic loads. The same conclusion for electrolyte overpotential accuracy is
reached from this constant current study. Nevertheless, even for constant current loads, using
the newly developed model is better than having no electrolyte model whatsoever as in the
basic SPM.

                                                   259
                                  6.10 Composite SPM Model with Electrolyte Dynamics


   Figure 6.15 shows a comparison of the electrolyte overpotential computed by the P2D
and system identification models for a UDDS load profile. The input current corresponding
to this load profile is shown in the top row of fig. 5.12. The system identification model is
able to reasonably track the overpotential profile computed by the P2D model. Unlike the
case of sustained unidirectional current input, the error in this case remains well-contained.
The Mean Absolute Error (MAE) obtained for this profile was 15.88 mV with an Root Mean
Square (RMS) error of 24.11 mV. This corresponds to 8.19 % and 12.44 % of the peak magnitude
of the overpotential (193.86 mV).

                                        ∆φe (t) = φe,poscc (t) – φe,negcc (t)

                               0.10                                                    P2d
                                                                                       SysID
                               0.00

                                  600   620    640    660     680      700
                   0.20
              V
                   0.12
                   0.04
                  –0.04
                  –0.12
                  –0.20
                          0       300           600              900            1200           1500
                                                      time (s)


  Figure 6.15 Comparison of electrolyte overpotential computed by the P2D model and the
  system identification model (using eq. (6.20)) for a UDDS load profile. The overpotential profile
  computed by the system identification model reasonably matches that obtained by the P2D model
  with a Mean Absolute Error (MAE) of 15.88 mV and a Root Mean Square (RMS) error of 24.11 mV.


   Hence, it can be concluded that the electrolyte overpotential computation using the
system identification model provides an acceptable performance for dynamic load profiles.
The next step is to incorporate this electrolyte overpotential calculation into the basic SPM
and to quantify the voltage accuracy of the resulting composite SPM.


6.10.2     Terminal voltage computation of composite SPM

In section 5.3.3, it was shown that in the basic SPM, the computation of the cell’s SOC is of
sufficient accuracy. However, its terminal voltage strongly deviates from the true value as
computed by a P2D model. This mismatch between SOC and terminal voltage hinders the
                                                   260
                                     6.10 Composite SPM Model with Electrolyte Dynamics


suitability of the basic SPM as the plant model in online state estimation applications. The
discrepancy in terminal voltage is due to the lack of electrolyte overpotential contribution in
its computation. Having obtained a suitable methodology to compute this (see section 6.10.1),
it is now possible to refine the computation of the cell’s terminal voltage.

    Referring to eq. (5.26) and eq. (5.27), the reaction overpotential in each of the two porous
electrode regions is given by

                                      𝜂pos = 𝜙s,pos − 𝜙e,pos − 𝑈pos                                  (6.21)
                                      𝜂neg = 𝜙s,neg − 𝜙e,neg − 𝑈neg                                  (6.22)

wherein the contribution from the electrolyte potential terms 𝜙e,pos and 𝜙e,neg are no longer
to be neglected.

    Subtracting eq. (6.22) from eq. (6.21)

                    𝜂pos − 𝜂neg = 𝜙 s,pos
                                  ⏟⏟⏟⏟⏟   − 𝜙 s,neg −𝜙e,pos + 𝜙 e,neg − 𝑈 pos + 𝑈 neg                (6.23)
                                           𝑉cell
whose rearrangement yields
                            𝑉cell = 𝜂pos − 𝜂neg + 𝜙 e,pos
                                                  ⏟⏟⏟⏟⏟   − 𝜙 e,neg +𝑈 pos − 𝑈 neg                   (6.24)
                                                           Δ𝜙e



    Substituting for Δ𝜙e from eq. (6.20) in into eq. (6.24), and expanding each of its terms
(see derivation of eq. (5.40) for details), the final expression for the cell’s terminal voltage is
obtained as


              2𝑅𝑇        ⎛                               −𝐼 (𝑡)                                 ⎞
                      −1
  𝑉cell (𝑡) =     sinh ⎜                                                                        ⎟
               𝐹         ⎜                                                                      ⎟
                           2𝐴𝑙pos 𝑎s,pos 𝐹 𝑘rpos 𝑐e 𝑐s,surfpos (𝑡) (𝑐s,maxpos − 𝑐s,surfpos (𝑡))
                         ⎝                      √                                               ⎠

             2𝑅𝑇          ⎛                                𝐼 (𝑡)                                  ⎞
                      −1
           −     sinh ⎜                                                                           ⎟
              𝐹           ⎜                                                                       ⎟
                            2𝐴 𝑙neg 𝑎s,neg 𝐹 𝑘rneg 𝑐e 𝑐s,surfneg (𝑡) (𝑐s,maxneg − 𝑐s,surfneg (𝑡))
                          ⎝                       √                                               ⎠
                0   2𝑅𝑇      𝑐e,pos/cc (𝑡)  𝐼        𝑙neg                     𝑙sep                𝑙pos
           +(1−𝑡+ )      ln                − (                    +2                    +                  )
                     𝐹       𝑐e,neg/cc (𝑡) 2𝐴 𝜅eff,neg (𝑐e (0))        𝜅eff,sep (𝑐e (0)) 𝜅eff,pos (𝑐e (0))
                                                    + 𝒰pos (𝑐s,surfpos (𝑡)) − 𝒰neg (𝑐s,surfneg (𝑡)) (6.25)

                                                    261
                                 6.10 Composite SPM Model with Electrolyte Dynamics


   All other expressions and computations of the basic SPM remain unchanged (see
section 5.1 for the complete set of equations constituting the model). The final step is to
show that the composite SPM thus obtained has an improved performance especially in those
scenarios that the basic SPM performed poorly.


6.10.3    Validation of composite SPM: Terminal voltage accuracy

The final step in this model development effort is the validation phase. In particular, the
voltage accuracy of the composite SPM is compared against the P2D model for standard
input conditions. In order to compare and contrast the gains achieved by the composite SPM,
the terminal voltage output of the basic SPM is also considered here.

Constant Current Inputs

The voltage accuracy of the newly developed composite SPM is first evaluated for the standard
test case of 1C discharge current starting from a cell SOC of 100 %.

   Figure 6.16 shows the terminal voltage output of various SPMs for a 1C discharge
beginning at 100 % SOC (top plot). Since it does not account for electrolyte overpotentials,
the voltage profile computed by the basic SPM lies above that of the benchmark P2D model.
On the other hand, the composite SPM tends to over correct for the electrolyte overpotential
so that its terminal voltage lies below the P2D output. Since the output of the two ROMs lie
on either side of the P2D model, it is appropriate to use the absolute value of their errors
with respect to the P2D benchmark to compare them. In the bottom plot, the percentage
deviation of the absolute error of the two ROMs is shown. The statistics of this deviation is
quantified in table 6.5 which additionally includes the performance metrics from the quadratic
approximation SPM.

  Table 6.5 Summary of statistics for the percentage absolute error in terminal voltage for the
  basic SPM and the composite SPM in constant current 1C discharge simulations.

                       Error Statistic   Basic    Quadratic   Composite
                          for %|𝜀𝑣̂ |    SPM        SPM         SPM
                       Worst Case        10.67         5.83      4.05
                       Mean               2.92         1.79      1.54
                       RMS                3.27         2.31      1.65


                                                 262
                                   6.10 Composite SPM Model with Electrolyte Dynamics




  Figure 6.16 Voltage output of various SPMs for a 1C discharge beginning at 100 % SOC (top
  plot). Since it does not account for electrolyte overpotentials, the voltage profile computed by the
  basic SPM lies above that of the benchmark P2D model. On the other hand, the composite SPM
  tends to over correct for the electrolyte overpotential so that its terminal voltage lies below the
  P2D output. Since the two ROMs have outputs on either side of the P2D model, it is convenient
  to use the absolute error to compare them. In the bottom plot, the percentage deviation of the
  absolute error of the two ROMs is shown. The composite SPM performs significantly better with
  a peak absolute error of ≈4 % in contrast to nearly 11 % for the basic SPM.


   In each of the error statistic considered, the composite SPM performs significantly better
than the basic SPM for the 1C discharge case.



                                                  263
                                6.10 Composite SPM Model with Electrolyte Dynamics


   One of the biggest drawbacks of the conventional SPM was its poor voltage accuracy at
moderate C-rates above 0.5C (see table 5.4). The high accuracy achieved for the 1C rate seems
to indicate that the composite SPM is indeed a viable solution for all high C-rates, especially
given the backdrop of its methodical derivation steeped in system identification.

   However, there exists a fundamental flaw in all models that use a priori assumptions of
simplified spatial profiles for ionic concentration in the electrolyte. In the case of both the
baseline quadratic and the system identification models, a parabolic profile spanning the
entire thickness of each region within the cell was chosen a priori. However, no attempt to
modify the profile upon encountering an ion starvation event at any spatial location.

   This critical flaw is exposed by the sustained application of any higher current that
induces an ion starvation at one of the electrodes during operation. Figure 6.17 depicts the
ionic concentration in the electrolyte over time at both current collectors for a 2C discharge.
The profiles computed by both the P2D and system identification models are plotted. For
the system identification model, the current collector interface at the positive electrode
experiences an ion starvation event at ≈150 s. The quadratic spatial profile used by this model
does not account for such a reduction in the effective electrode thickness. All the boundary
conditions and coefficients were formulated using the original electrode thickness. Therefore,
beyond 150 s, the concentration becomes negative which is not physically meaningful. The
author of this thesis has implemented a saturation mechanism in the code that detects an ion
depletion event and prevents the concentrations from becoming negative.

   Implementing this hard lower bound of zero for the ion concentration does not mit-
igate the problems associated with computing the electrolyte overpotential. Specifically,
computational difficulties are encountered when computing the concentration dependent
diffusion overpotential eq. (6.20). In the case of ion depletion at the positive current
collector, the argument of the logarithmic term becomes zero which leads to a non-feasible
computation (−∞). Ion depletion at the negative current collector is equally detrimental to
the computation. However, this scenario has a lower probability owing to the low C-rates
during charging operation (see section 5.3.2). Furthermore, in the absence of the lower bound
of zero for the concentrations, complex numbers are obtained from the logarithmic term,
which lead to physically erroneous overpotential calculations. An alternative is to simply



                                             264
                                        6.10 Composite SPM Model with Electrolyte Dynamics

                            ce (0, t)                                                       ce (ltot , t)
          2000                                                              1000
                                              P2d                                                                 P2d
                                              SysID                                                               SysID
          1750                                                              750
     –3




                                                                       –3
mol m




                                                                  mol m
          1500                                                              500


          1250                                                              250


          1000                                                                 0
                 0   50       100       150           200                          0   50      100          150           200
                           time (sec)                                                       time (sec)

   Figure 6.17 Time evolution of ionic concentration in electrolyte computed by the P2D and
   system identification models at — a) negative current collector interface (left plot), and b) positive
   current collector interface (right plot) for a constant current discharge at 120 A i.e., 2C. In the
   system identification mode, ion starvation occurs at the positive current collector interface
   at ≈150 s. The quadratic spatial profile used by the system identification model spans the
   entire electrode region and does not account for ion depletion scenarios. In this thesis, the
   author has implemented a saturation mechanism in the computer code to prevent the ionic
   concentration from becoming negative. Despite this mitigating action, the computation of
   electrolyte overpotential using eq. (6.20) is problematic in such scenarios.


omit the diffusion impedance term. However, since this term is responsible for the large-
signal dynamics of the overpotential (see fig. 6.13), omitting this and reverting to a simple
ohmic resistance contribution shall lead to significant errors in the electrolyte overpotential,
and consequently in the terminal voltage. Finally, setting the diffusion impedance to zero at
the transition boundary of ion starvation is also not a feasible solution. This is because, the
sudden inflection in the trajectory of the terminal voltage shall induce large errors in any
state estimation algorithms that depend on the composite SPM as the plant model.

          The difficulties encountered in electrolyte overpotential computations for ion depletion
scenarios have not yet been discussed in the literature by the research community that
use such quadratic approximation models. This thesis author therefore assumes that such a
scenario had not been previously encountered for the parameter set and C-rate combinations
used by those researchers. Despite the fact that this phenomenon might be an artefact of
the idiosyncrasies of the parameter set used here, it is nevertheless questionable to not have
mathematically adapted the parabolic profile to such events. The aspect of rendering the
model robust to such vagaries is currently an open problem in the field and can be the subject
                                                            265
                                                                             6.11 Conclusions


of future research. It can therefore be concluded that this composite SPM is unsuitable in
its present form for sustained constant current discharge at higher C-rates. Despite this
setback due to deficiencies in the mathematical formulation of the underlying spatial profile,
the superior performance of the system identification model in the computation of ionic
concentrations and overpotentials for dynamic conditions warrant such a study for the
composite SPM.

Dynamic Load Conditions

In order to evaluate the performance of the composite SPM to dynamic inputs, the input
profile corresponding to the UDDS drivecycle profile in fig. 5.12 with a peak current of 180 A
i.e., 3C was used.

   Figure 6.18 shows the voltage output of the composite SPM for a UDDS input profile with
a peak magnitude of 180 A i.e., 3C (see fig. 5.12). The voltage profiles computed by the basic
SPM and the benchmark P2D model is also overlaid (top plot). The percentage absolute error
of the two ROMs relative to the P2D model is shown in the bottom plot. It is seen that the
terminal voltage of the composite SPM is more accurate than the basic SPM (see table 6.6,
which additionally includes the performance metrics from the quadratic SPM). For instance,
the voltage profile computed by composite SPM matches the complex shape characteristics
of the P2D model while remaining very close to it in magnitude.

  Table 6.6 Summary of statistics for the percentage absolute error in terminal voltage for the
  basic SPM, quadratic approximation SPM and the composite SPM with UDDS input profile.

                       Error Statistic   Basic    Quadratic   Composite
                          for %|𝜀𝑣̂ |    SPM        SPM         SPM
                       Worst Case         2.59         1.68      0.72
                       Mean               0.51         0.36      0.11
                       RMS                0.68         0.39      0.16



6.11     Conclusions
In summary, while the newly developed composite SPM is not considered robust for use in
sustained discharge at high C-rates, it is indeed a suitable option for dynamic load profiles,
even for those with high peak magnitudes of instantaneous charge or discharge. Such load

                                                 266
                                                                                      6.11 Conclusions


                                       3.9                          P2d
                                                                    Basic SPM
                                      3.85                          Composite SPM


                                       3.8

                                               500     520
                           3.95
                           3.88
                  Vcell
                           3.80
                  (V)
                           3.73
                           3.65
                                  0          375        750       1125              1500



                             3
                                                                    Basic SPM
                                                                    Composite SPM

                           2.25


                  |ε̂v |
                            1.5
                  (%)


                           0.75



                             0
                                  0          375        750       1125              1500
                                                      time (s)

  Figure 6.18 Voltage output of the composite SPM for a UDDS input profile with a peak
  magnitude of 180 A i.e., 3C (see fig. 5.12). The voltage profiles computed by the basic SPM and the
  benchmark P2D model is also overlaid (top plot). The percentage absolute error of the two ROMs
  relative to the P2D model is shown in the bottom plot. The terminal voltage of the composite
  SPM is significantly more accurate than the basic SPM (see table 6.6).


profiles are typically encountered in vehicular applications, particularly in hybrid electric
vehicles. Thus, a suitable time-domain ROM that can be directly implemented in discrete-
time has been developed through system identification and its strengths and weaknesses have
been quantified. The applicability of this model has been proven for real-life scenarios using
a highly dynamic load cycle. Thus, this author concludes that the composite SPM developed
here does indeed represent an advancement to the present modelling art. This model may
now be used as the plant model in state estimation and control applications in a vehicular
BMS. This concludes the chapter as well as all the implementation aspects of physics-based
battery modelling discussed in this thesis.
                                                     267
                                                                     Conclusions
                                                                                     7
     7.1   Physics-Based Models as a Design Tool . . . . . . . . . . . . . . . . . . . . . . 269
           7.1.1   Conclusions from the model-based design study . . . . . . . . . . . . . 269
           7.1.2   Future work informed by the optimal layer design framework . . . . . 270
     7.2   Analysis of Salient Physics-based Reduced Order Models . . . . . . . . . . . . 271
           7.2.1   Conclusions from analysis of the DRA-based state-space ROM . . . . 272
           7.2.2   Future outlook for the DRA-based hybrid state-space ROM . . . . . . 272
           7.2.3   Conclusions from analysis of the SPM family of models . . . . . . . . 273
           7.2.4   Proposed analysis routes for the SPM modelling family . . . . . . . . . 275
     7.3   Implementation Aspects of Basic and Composite SPM . . . . . . . . . . . . . . 276
     7.4   Closing Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 278



I
    n this thesis, the deployment of physics-based computational modelling of lithium
    ion cells for electric vehicle applications has been rigorously examined with a three-
pronged strategy viz. through their analysis, design and implementation. The Pseudo
Two-Dimensional (P2D) implementation of the Doyle-Fuller-Newman (DFN) model was used
as the backbone of all modelling efforts. Salient conclusions drawn from each of these aspects
are presented in this chapter. Based upon the invaluable experience gained during the course
of this research, and particularly from the findings presented herein, key areas in physics-
based modelling that can benefit from further study in the future are also identified.

                                                268
                                                7.1 Physics-Based Models as a Design Tool


7.1      Physics-Based Models as a Design Tool

7.1.1     Conclusions from the model-based design study

Chapter 3 presented a computational framework to optimise the number of electrochemical
layers within a pouch cell so as to maximise its usable energy while meeting specific power
demands. In particular, this helped to construct a model-based deterministic approach to
optimally design cells that can be subjected to fast-charging without the concerns of plating.
In the context of electric vehicle applications, using this approach has the potential to alleviate
the two immediate concerns of consumers viz. range anxiety and long charging times.

      To facilitate immediate adoption by relevant stakeholders, the concepts developed in
the optimisation framework of chapter 3 was realised in computer code and presented in
the form of an open-source design toolbox, Battery Optimal Layer Design (BOLD). This
toolbox was applied to the optimal layer design of an example cell from literature to obtain
two sets of power-dependent optimal layer configurations for two drivetrains — a Battery
Electric Vehicle (BEV) and a Plug-in Hybrid Electric Vehicle (PHEV). By suitably adapting the
numerical values of parameters to a real-world cell, model-based cell designs can be obtained,
which can potentially help to eliminate the current trend of over-engineering of cells using
conservative empirical layer choices.

      From a perspective of technical advancements to the underlying Physics-Based Model
(PBM), the standard form of the P2D model has been suitably modified to facilitate a
direct application of input power densities. This was achieved through reformulation of
the boundary conditions on the solid-phase potential Partial Differential Equation (PDE).
Although this innate power input capability has been claimed as purportedly developed in
extant literature, its independent derivation and accessible documentation provided herein
shall help other researchers to apply this in a straight-forward manner for vehicle drivecycles,
acceleration tests and power-based charging protocols.

      This investigation also revealed that the fast charging process determines the optimal
layer configuration instead of either acceleration runs or drivecycle requirements. This may
help to counter the current trend in publications which often rely primarily upon a drivecycle-
based dynamic input current profile to evaluate various aspects of cell modelling such as
predicting degradation and for advanced control and estimation algorithms. While validation
                                               269
                                                 7.1 Physics-Based Models as a Design Tool


against such a dynamic input profile is certainly vital, for future advancements dealing with
aspects of cell design or plating-related degradation, validation against fast-charging power
profiles is deemed to be absolutely essential.

   The study also provided important guidelines about the role of thermal environment on
cell performance. It became clear that at very low temperatures, a high number of layers was
required for satisfying a specific charging power level relative to that needed at moderate
thermal environments such as room temperatures. A practical takeaway from this conclusion
is that it suffices to use a low number of layers in vehicles to be sold in territories with
perennial moderate temperature conditions.

   Finally, this design study revealed that the speed at which lithium intercalates into the
negative electrode during charging limits the charge-addition rate to the cell. Lowering the
charging times of electric vehicles requires the use of higher charging powers. However, this
necessitates a high number of layers to absorb the overpotentials and to provide adequate
number of thermal conduction pathways (owing to the higher number of current collectors)
to dissipate the additional heat generated. Consequently, this has a detrimental effect on the
capacity and hence, the All-Electric Range (AER) of the vehicle.


7.1.2   Future work informed by the optimal layer design framework

As a direct inference of the final conclusion in section 7.1.1, assuming that the electric grid
infrastructure is adequately equipped to cope with the surge in future power demands for
charging of electric vehicles, the solid state diffusion at the negative electrode becomes the
bottleneck. It is therefore important for future research to focus on the development of new
materials for the negative electrode possessing much higher solid phase diffusion coefficients,
particularly at low temperatures.

   From a perspective of improving the framework itself, at the outset, it is clear that the
plating threshold assessment can be made more accurate by incorporating the solid phase
diffusion coefficient as function of State of Charge (SOC). In the interest of simplicity and to
lay the foundation for such model-based cell designs, the scope of this work was intentionally
narrowed down to solely focus on changing the layer configurations within cells. In doing
so, certain assumptions were made that might have to be revisited and potentially relaxed
before its application to real-world cell designs.
                                              270
                          7.2 Analysis of Salient Physics-based Reduced Order Models


   For instance, adherence to the specific type of cooling phenomena used i.e., tab cooling, is
one of the stronger assumptions used in this work. In this work, the benefits of employing this
cooling mechanism has been enumerated, and it is desirable that future pack designs adopt
it. However, the vast majority of the current generation of battery packs use surface-cooled
designs. This means that temperature for all layers within the pouch shall not be the same,
which further implies that it longer suffices to simulate just a single layer. Therefore, the
framework needs to be suitably modified to handle multiple layer choices concurrently.

   Furthermore, using surface cooling shall invalidate the assumption of small thermal
gradients along the planar axis of the cell. This means that the lumped thermal model shall no
longer be accurate to model the temperature evolution of the cell. Furthermore, the differential
temperature evolution along the cross-sectional direction shall influence the transport and
kinetic properties of the cell. This electrochemical-thermal coupling along the planar direction
shall necessitate adding another spatial dimension to the underlying PBM, thereby rendering
the presently used P2D model ineffective. With the aim of minimising the optimising run-
times, future research may focus on how to suitably adapt the computational infrastructure
that was proposed in this thesis to account for these considerations.

   For real-world cell designs, it is prudent to examine the examine the role of variable
porosities to achieve the balancing of active materials per layer. Since the computational
framework developed in this thesis uses a modular approach, in the future the constant
volume-fractions used in the methodology could simply be replaced by values informed by
optimal porosity computations. For this purpose, researchers could investigate the feasibility
of adapting a suitable scheme from the available pool of literature that have focussed on
using model-based porosity optimisation [28, 29, 216]. Finally, experimental prototyping is an
important step in any cell design and it is no exception here either. Therefore, experimentally
applying the desired power levels to confirm the optimal layer choices predicted by the
framework is an important step to be undertaken before its large-scale deployment.


7.2    Analysis of Salient Physics-based Reduced Order Models
Chapters 4 and 5 of this thesis primarily focussed on performing an in-depth analysis of
two distinct Reduced Order Models (ROMs) from two distinct perspectives. In chapter 4, the
hybrid ROM obtained by using the Discrete-Time Realisation Algorithm (DRA) is analysed

                                              271
                          7.2 Analysis of Salient Physics-based Reduced Order Models


to investigate its computational bottlenecks. In chapter 5, an in-depth analysis of a niche
selection of candidate models from the family of Single Particle Models (SPMs) is presented
from the perspective of modelling accuracy i.e., their ability to faithfully compute the system-
level quantities of the cell such as its SOC and terminal voltage. Finally, the early portions
of chapter 6 provides a thorough analysis of the bottlenecks of the quadratic approximation
model for computing the spatial profile of ionic concentration in the electrolyte. The
conclusions drawn from all aforementioned analyses are presented next. Topics that may
be of interest to future researchers engaging with these ROMs are also proposed.


7.2.1   Conclusions from analysis of the DRA-based state-space ROM

In chapter 4, Singular Value Decomposition (SVD) of a large Block-Hankel matrix (≈27 GB)
was identified as a computational bottleneck in applying the classical DRA scheme for the
hybrid ROM discussed therein. It is concluded that this bottleneck arises due to slow dynamics
of solid phase diffusion which leads to the aforesaid large sized Block-Hankel matrix.

   To mitigate this bottleneck, an improved DRA scheme was presented, whose centrepiece is
an iterative SVD algorithm. This algorithm was obtained as a combination of the Golyandina-
Usevich and Lanczos algorithms discussed in chapter 4. The results of applying the improved
DRA scheme demonstrate a significant performance improvement achieved by using the
new method without trading-off model fidelity. At a single operating point of SOC and
temperature, for a Hankel block size of 8000, the ROM workflow incorporating the improved
DRA is approximately 100 times faster than that employing the classical DRA. On a standard
computer workstation whose specifications are given in chapter 4, for 100 operating points
(combinations of 10 SOC and temperature values), obtaining the ROM required only 6 hours
using the improved DRA, whereas the classical DRA consumed 666 hours (≈27 days).
Furthermore, for the same block-size, the improved DRA is demonstrated to be superior
in terms of memory efficiency, drastically reducing the memory requirements from 112 GB
down to 2 GB. Finally, the improved DRA demonstrates improved modelling accuracy even
in moderately equipped computing environments such as standard consumer-grade laptops.


7.2.2   Future outlook for the DRA-based hybrid state-space ROM

The improved DRA method proposed in chapter 4 opens up the possibility of applying this
hybrid ROM for physical quantities in other locations within the cell’s geometry e.g. in the
                                             272
                          7.2 Analysis of Salient Physics-based Reduced Order Models


middle of the electrode region, without being hindered by computational limitations that
would have otherwise rendered it intractable. Furthermore, high sample-rate ROMs capable
of handling highly dynamic load profiles can be deployed in future Battery Management
System (BMS) applications. The proposed scheme also empowers the ROM framework to
tackle other cell chemistries with slower diffusion coefficients or even those with completely
different rate-limiting mechanisms, and therefore prima facie, appears to be promising.

   Despite the benefits facilitated by the streamlining of the reduced order modelling
workflow through the improved DRA, there exists a fundamental deficiency in this hybrid
modelling approach that impede its near-term adoption in state estimation tasks. This aspect
was already discussed in chapter 2 and is reiterated here. The entries in the matrices of
the final state space model depend on the linearisation point of SOC and temperature. This
linearisation requirement adversely affects the usability of the model for state estimation
tasks, wherein the SOC is in fact an unknown quantity and is to be estimated. This cyclic
dependency between the linearisation point and the state-estimation entity renders this model
questionable for use in a demanding application such as in embedded BMSs on-board electric
vehicles. Therefore, the immediate future step is to analyse the stability of this internal
feedback loop. Once this has been performed, researchers may consider to engage in the
process of adapting the derivation of this hybrid state-space ROM approach to higher C-rates,
in conjunction with the numerical benefits afforded by the improved DRA developed here.


7.2.3   Conclusions from analysis of the SPM family of models

Based upon the holistic evaluation of various ROMs in chapter 2, owing to its simplicity, the
SPM family of models was identified as the most promising modelling candidate from an
implementation perspective. Chapter 5 provided an in-depth analysis of the strengths and
drawbacks of this modelling family.

   Results from simulation of the basic SPM revealed that two contrasting aspects. Firstly, the
SOC computation of the SPM was of acceptable accuracy even at moderate C-rates thereby
validating the fourth order polynomial approximation approach for capturing solid phase
diffusion dynamics. However, the basic SPM suffers from severe inaccuracies in computing the
cell’s terminal voltage at currents above 0.5C. This dichotomous behaviour, revealed through
this analysis, has not been explicitly commented upon in present literature. In particular,

                                             273
                           7.2 Analysis of Salient Physics-based Reduced Order Models


despite its overarching simplicity, it can be concluded that it is this contrasting aspect that
renders the model unusable as the plant model for state estimation tasks. This is because, the
voltage measured from the model in a feedback estimator shall map to a radically distant SOC
operating point requiring excessively strong gain factors for correcting it adversely affecting
the stability of estimators.

   Several research efforts from literature that have attempted to tackle the voltage inac-
curacies of the basic SPM through inclusion of electrolyte dynamics were also presented
in chapter 5. A critical evaluation of each of the salient efforts revealed that a suitable
approach that can successfully handle all possible operational scenarios is yet to be devised.
In particular, the existing modelling approaches for electrolyte inclusion either made far-
fetched assumptions that were easily violated or presented nearly intractable mathematical
expressions that pushed the SPM closer in computational complexity to the P2D dynamics.
The author’s analysis of pertinent literature also revealed the possibility of re-using certain
portions of existing work e.g. the electrolyte overpotential expression, whilst also arguing the
need for a fresh approach to model other aspects of electrolyte dynamics such as the ionic
concentration profile within the cell’s thickness.

   The final section of chapter 5 presented the assumptions and governing equations of
the quadratic approximation model for the spatial profile of ionic concentration. The results
obtained by simulating this model reveal that while its spatial profile computation for a
galvanostatic operation is of acceptable accuracy, its temporal performance is mediocre.
Particularly, the time evolution of ionic concentration at the current collector interfaces
computed by the model fail to capture the intricacies in the temporal evolution exhibited
by the P2D model’s profile. Furthermore, the spatial profile uses the Quasi-Steady State
(QSS) approximation which is violated during the initial transient. Hence, the most impactful
conclusion from the foregoing analysis is that the basic quadratic approximation model is
unsuitable for dynamic loads, thereby ruling it out for deployment in vehicular applications.

   The initial portions of chapter 6 analysed the causal factor contributing to the mediocre
performance of the quadratic approximation model. For this analysis, a genetic programming
approach was employed to synthesise suitable alternative reduced order equations for
modelling the spatial profile of the electrolyte concentration. The foregoing analysis helped
to reveal that given the constraints and interior-point boundary conditions of the underlying

                                              274
                             7.2 Analysis of Salient Physics-based Reduced Order Models


DFN model at the separator interfaces, the number of coefficients used in the quadratic spatial
profile does indeed make the best use of all available equations. The genetic programming
approach being able to synthesise suitable mathematical structures that can potentially
capture the spatial profile accurately during both transient and steady state conditions.
However, there is a shortfall in the number of equations in order to uniquely solve for these
extra coefficients. The final conclusion that stems from this fact is that, by decoupling the
spatial and temporal profiles of the electrolyte concentration dynamics, the performance of
the present state of the art can indeed be improved upon.


7.2.4    Proposed analysis routes for the SPM modelling family

Albeit extensive, the analyses of SPMs performed in this thesis is by no means complete. It is
more appropriate to say that this author chose to analyse SPMs from their implementation
perspective, particularly their voltage and SOC accuracies in an open-loop implementation.
However, a holistic evaluation covering other aspects are necessary before their deployment
in a vehicular BMS can be considered. For instance, the observability of models must be proven
before they can be employed in the feedback path of a state estimator. Even within the broad
stream of observability analysis, there are several details that need to be meticulously handled
of which some avenues for future exploration are identified.

   In the simplification of the state-vector of the basic SPM proposed by Di Domenico [96],
the bulk concentration in the two electrodes was assumed to be equal (see section 5.1.3). This
allowed to eliminate the bulk concentrations of one of the two electrodes, thereby reducing
the state vector to    3×1
                      ℝ .    This assumption hinges on the assumption that there is no loss of
cycleable lithium. However, such an assumption is valid only for a brand new cell. As the
cell ages, owing to various phenomena such as parasitic side reactions and decomposition of
the solid conductive matrix, this assumption shall no longer hold true. Therefore, analysis
of models obtained by augmenting the basic or electrolyte-enhanced SPMs with equations
describing degradation shall become critical. Not only does this force to retain both bulk
concentrations in the state vector, the states from the degradation rate-equations appear in
it, thereby enlarging it. In future studies, the effect of these augmented state variables on the
observability of the system needs to be quantified.




                                               275
                              7.3 Implementation Aspects of Basic and Composite SPM


   In this thesis, only an isothermal analysis of various SPMs have been performed. While
this is an important initial step to analyse the strengths and weaknesses of the state of the
art incumbent SPM models by isolating the purely electrochemical aspects, the effect of
temperature cannot be underplayed. It is well-known that the thermal conditions of the
cell affects its electrochemical and vice-versa. Therefore, future works shall benefit from
performing comprehensive analyses of coupled electrochemical-thermal SPMs. Considering
the simplicity of SPMs, the lumped thermal model might be a suitable candidate for it be
paired with. Finally, in addition to its influence on the accuracy of open-loop terminal voltage
and SOC, the effect of temperature on the observability of the holistic model needs to be
evaluated. Since the cell temperature is available as an additional measurement, it is likely to
improve the model’s observability. However, there is a trade-off since this comes at the cost
of increased size of the state vector. It is also worthwhile to explore the inflection point of
this trade-off to limit the model’s fidelity at a sufficient level whilst reaping the maximum
gains out of the additional temperature measurement.

   Based upon the conclusion that the performance of any reduced order spatial profile model
is hamstrung by the equation deficiencies in the underlying DFN model, it is worthwhile to
reproduce the Multi-Gene Genetic Programming (MGGP) approach with a different PBM.
For this future task, it is imperative to choose a model that provides additional interior-
point conditions i.e., not just at the separator, but perhaps a second order condition within
an interior location at each electrode. Once such a suitable PBM has been identified, this
thesis author is confident that the genetic programming approach shall indeed synthesise an
accurate description of the electrolyte’s spatio-temporal dynamics.


7.3    Implementation Aspects of Basic and Composite SPM
A driving impetus behind this thesis is to deliver ROMs amenable to embedded implement-
ation. Large portions of chapter 5 and nearly the entirety of chapter 6 were devoted to this
study. The conclusions that emerged from these implementation efforts are summarised here.
Future areas of research are also identified in-line.

   In chapter 5, the aspects of discrete-time implementation in a microcontroller were dis-
cussed. In particular, the computation of the discrete-time system and input matrices through


                                              276
                             7.3 Implementation Aspects of Basic and Composite SPM


the matrix exponential approach is presented. A straightforward conclusion from the discrete-
time implementation is that they run orders of magnitude faster than their continuous-time
counterparts. This is owing to the fact that adaptive time-stepping integrators are not required
and can be replaced by a simple matrix-vector multiplication scheme. This implementation
detail provides necessary starting point for battery researchers to start coding the ROMs
discussed herein. Future work in this direction shall benefit from including various real-
world issues such as accounting for sample delays as well as implementing a progressive
update scheme for the matrix entries to account for degradation effects. Important aspects
of numerical implementation arise during the design of state estimators. Having a robust
open-loop implementation of a discrete-time plant model shall facilitate easy implementation
of such feedback algorithms.

   Chapter 6 discussed the implementation aspects of ROM from a different perspective —
that of formulating a new electrolyte enhanced composite SPM for embedded implementation.
The temporal evolution of electrolyte dynamics in the two electrode regions were character-
ised through system identification techniques that have never been tried before in literature.
The identified model structures are presented in the final form as discrete-time difference
equations that can be readily incorporated into the discrete-time equations developed in
chapter 5 for the basic SPM. The salient conclusion from this modelling effort is that, system
identification is indeed a viable candidate for the derivation of ROMs of lithium ion batteries.
The improved accuracy of electrolyte concentration dynamics relative to the state of the art
quadratic approximation model corroborates the success of this strategy. Nevertheless, before
widespread adoption of this technique can be advocated, certain aspects of this approach must
be examined carefully. For instance, the assumptions of linearity and time-invariance must
be revisited for higher magnitudes of charge and discharge currents. Thermal effects must
also be incorporated into the overall system identification approach. Machine learning and
system identification are two complementary approaches to the same task i.e., identification
of internal dynamics from terminal measurements. Future research could also explore this
possibility and perhaps a combined system identification/machine learning strategy might
metamorphose into the approach that powers future generation of surrogate ROMs for electric
vehicle applications.




                                              277
                                                                       7.4 Closing Remarks


7.4    Closing Remarks
The feasibility of bringing PBMs of lithium batteries into electrified transportation has been
studied in this thesis from a multi-dimensional perspective. Yet, there exists a common
underpinning that connects these seemingly different routes to the enhancement of our
extant knowledge — that of parametrising the underlying PBM. The number of parameters
in any PBM is excessively large to the point of detracting potential adopters. Even without
considering degradation effects, obtaining the physical, geometric, transport and kinetic para-
meters of a cell shall require access to specialised laboratory equipment that are sometimes
exclusive to large scale research organisations. The studies discussed here shall assume real-
world significance only upon a successful demonstration of a cost-effective parametrisation
strategy. The author’s contributions to an optimal ‘Design of Experiments (DoE)’ numerical
procedure for identifying the parameters of an SPM is detailed in [217]. However, the broader
task of parametrising a full-order PBM is well beyond the scope of this thesis or indeed any
single researcher, and needs the concerted effort of the community as a whole to tackle it.

   The next task in the journey to real-world implementation of the advancements brought
about by this thesis is to experimentally validate them. However, this is contingent upon
obtaining a successful parametrisation strategy, and should be embarked upon as soon as
a robust procedure to identify the physical parameters is made available. Nevertheless, this
author hopes that through the three-pronged approach to cell modelling presented in this
thesis, the goal of bringing physics-based battery models to electrified transportation has
been brought a step closer to realisation.




                                             278
                                                                         References

 [1]   Martin Weiss, Pierre Bonnel, Rudolf Hummel, Alessio Provenza and Urbano Manfredi. “On-
       Road Emissions of Light-Duty Vehicles in Europe”. Environmental Science & Technology 45.19
       (Oct. 2011), pp. 8575–8581. issn: 0013-936X. doi: 10.1021/es2008424 [cited on page 34].
[2]    H. Ibrahim, A. Ilinca and J. Perron. “Energy storage systems—Characteristics and comparisons”.
       Renewable and Sustainable Energy Reviews 12.5 (June 2008), pp. 1221–1250. issn: 1364-0321. doi:
       10.1016/J.RSER.2007.01.023 [cited on page 34].
[3]    Davide Andrea. Battery management systems for large lithium-ion battery packs. Boston :
       Artech House, 2010, p. 290. isbn: 9781608071050 [cited on pages 34, 94, 171, 197].
[4]    Thomas B. Reddy and David Linden. Linden’s handbook of batteries. 4th ed. New York: McGraw-
       Hill, 2011, p. 1457. isbn: 9780071624213 [cited on pages 35, 36, 164].
 [5]   Gregory L. Plett. Battery Management Systems, Volume I: Battery Modeling. 1st ed. Norwood,
       Massachusetts: Artech House, 2015, p. 346. isbn: 978-1630810238 [cited on pages 35, 37, 39, 40,
       137, 138].
[6]    D. Grazioli, M. Magri and A. Salvadori. “Computational modeling of Li-ion batteries”. Computa-
       tional Mechanics 58.6 (Dec. 2016), pp. 889–909. issn: 0178-7675. doi: 10.1007/s00466-016-
       1325-8 [cited on page 37].
 [7]   Krishnan S. Hariharan, Piyush Tagade and Sanoop Ramachandran. Mathematical Modeling of
       Lithium Batteries : From Electrochemical Models to State Estimator Algorithms. Green Energy
       and Technology. Cham: Springer International Publishing, 2017. isbn: 9783319035277. doi:
       10.1007/978-3-319-03527-7 [cited on page 37].
[8]    Christopher D. Rahn and Chao-Yang Wang. Battery Systems Engineering. Oxford, UK: John
       Wiley & Sons Ltd, Feb. 2013. isbn: 9781118517048. doi: 10.1002/9781118517048 [cited on
       pages 37, 61, 83, 164].
[9]    Henk J. Bergveld, Wanda S. Kruijt and Peter H. Notten. Battery Management Systems : Design
       by Modelling. Dordrecht : Springer Netherlands, 2002, p. 295. isbn: 9789401708432. doi: 10.
       1007/978-94-017-0843-2 [cited on page 37].
[10]   Aden Seaman, Thanh-Son Dao and John McPhee. “A survey of mathematics-based equivalent-
       circuit and electrochemical battery models for hybrid and electric vehicle simulation”. Journal
       of Power Sources 256 (June 2014), pp. 410–423. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.
       2014.01.057 [cited on page 38].



                                                279
                                                                                       REFERENCES


[11]   Gregory L. Plett. “Sigma-point Kalman filtering for battery management systems of LiPB-based
       HEV battery packs: Part 1: Introduction and state estimation”. Journal of Power Sources 161.2
       (Oct. 2006), pp. 1356–1368. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2006.06.003 [cited
       on pages 38, 169].
[12]   Fengchun Sun, Xiaosong Hu, Yuan Zou and Siguang Li. “Adaptive unscented Kalman filtering
       for state of charge estimation of a lithium-ion battery for electric vehicles”. Energy 36.5 (May
       2011), pp. 3531–3540. issn: 0360-5442. doi: 10.1016/J.ENERGY.2011.03.059 [cited on
       page 38].
[13]   Gregory L. Plett. Battery Management Systems, Volume II: Equivalent-Circuit Methods. Nor-
       wood, Massachusetts: Artech House, 2016. isbn: 978-1-63081-027-6 [cited on pages 39, 103,
       171].
[14]   M. Ecker, T.K.D. Tran, P. Dechent, S. Kabitz, A. Warnecke and Dirk U. Sauer. “Parameterization
       of a Physico-Chemical Model of a Lithium-Ion Battery: I. Determination of Parameters”. Journal
       of the Electrochemical Society 162.9 (June 2015), A1836–A1848. issn: 0013-4651. doi: 10.1149/
       2.0551509jes [cited on pages 39, 164].
[15]   Marc Doyle, Thomas F. Fuller and John S. Newman. “Modeling of Galvanostatic Charge and
       Discharge of the Lithium/Polymer/Insertion Cell”. Journal of The Electrochemical Society 140.6
       (June 1993), pp. 1526–1533. issn: 00134651. doi: 10.1149/1.2221597 [cited on pages 40, 138,
       161].
[16]   Thomas F. Fuller, Marc Doyle and John S. Newman. “Simulation and Optimization of the Dual
       Lithium Ion Insertion Cell”. Journal of The Electrochemical Society 141.1 (Jan. 1994), p. 1. issn:
       00134651. doi: 10.1149/1.2054684 [cited on pages 40, 138, 148, 161].
[17]   Gregory L. Plett. Lecture Notes 04 & 06: ECE5710 - Modeling, Simulation, and Identification of
       Battery Dynamics. Colorado Springs, 2018. url: http://mocha-java.uccs.edu/ECE5710/
       ECE5710-Notes04.pdf; http://mocha-java.uccs.edu/ECE5710/ECE5710-Notes06.
       pdf [cited on page 41].
[18]   Marcello Torchio, Lalo Magni, R B. Gopaluni, Richard D. Braatz and Davide M. Raimondo.
       “LIONSIMBA: A Matlab Framework Based on a Finite Volume Model Suitable for Li-Ion Battery
       Design, Simulation, and Control”. Journal of The Electrochemical Society 163.7 (2016), A1192–
       A1205. issn: 0013-4651. doi: 10.1149/2.0291607jes [cited on pages 41, 105, 125, 308].
[19]   Stefan H. Thomke. “Simulation, learning and R&D performance: Evidence from automotive
       development”. Research Policy 27.1 (May 1998), pp. 55–74. issn: 00487333. doi: 10.1016/S0048-
       7333(98)00024-9 [cited on page 45].
[20]   Markus C. Becker, Pasquale Salvatore and Francesco Zirpoli. “The impact of virtual simulation
       tools on problem-solving and new product development organization”. Research Policy 34.9 (Nov.
       2005), pp. 1305–1321. issn: 00487333. doi: 10 . 1016 / j . respol . 2005 . 03 . 016 [cited on
       page 45].
[21]   Robert M. Spotnitz. “Battery modeling”. The Electrochemical Society Interface (2005), pp. 39–42.
       issn: 10648208. doi: 10.1109/MC.2003.1250886 [cited on page 45].
[22]   M S. Islam and Craig A. J. Fisher. “Lithium and sodium battery cathode materials: computational
       insights into voltage, diffusion and nanostructural properties”. Chemical Society Reviews 43.1 (Dec.
       2014), pp. 185–204. issn: 0306-0012. doi: 10.1039/C3CS60199D [cited on page 46].


                                                  280
                                                                                        REFERENCES


[23]   Ying S. Meng and M E. Arroyo-de Dompablo. “First principles computational materials design
       for energy storage materials in lithium ion batteries”. Energy & Environmental Science 2.6 (June
       2009), p. 589. issn: 1754-5692. doi: 10.1039/b901825e [cited on page 46].
[24]   Austin D. Sendek, Qian Yang, Ekin D. Cubuk, Karel-Alexander N. Duerloo, Yi Cui and Evan
       J. Reed. “Holistic computational structure screening of more than 12 000 candidates for solid
       lithium-ion conductor materials”. Energy & Environmental Science 10.1 (2017), pp. 306–320. issn:
       1754-5692. doi: 10.1039/C6EE02697D [cited on page 46].
[25]   Venkatasailanathan Ramadesigan, Paul W. Northrop, Sumitava De, Shriram Santhanagopalan,
       Richard D. Braatz and V. R. Subramanian. “Modeling and Simulation of Lithium-Ion Batteries
       from a Systems Engineering Perspective”. Journal of the Electrochemical Society 159.3 (Jan. 2012),
       R31–R45. issn: 0013-4651. doi: 10.1149/2.018203jes [cited on pages 47, 83, 84, 120, 121].
[26]   John S. Newman. “Optimization of Porosity and Thickness of a Battery Electrode by Means of a
       Reaction-Zone Model”. Journal of The Electrochemical Society 142.1 (1995), p. 97. issn: 00134651.
       doi: 10.1149/1.2043956 [cited on pages 47, 86].
[27]   Pankaj Arora, Marc Doyle and Ralph E. White. “Mathematical Modeling of the Lithium De-
       position Overcharge Reaction in Lithium-Ion Batteries Using Carbon-Based Negative Electrodes”.
       Journal of The Electrochemical Society 146.10 (Oct. 1999), p. 3543. issn: 00134651. doi: 10.1149/
       1.1392512 [cited on pages 48, 167].
[28]   Nansi Xue, Wenbo Du, Amit Gupta, Wei Shyy, Ann Marie Sastry and Joaquim R. Martins.
       “Optimization of a Single Lithium-Ion Battery Cell with a Gradient-Based Algorithm”. Journal
       of The Electrochemical Society 160.8 (May 2013), A1071–A1078. issn: 0013-4651. doi: 10.1149/
       2.036308jes [cited on pages 48, 271].
[29]   Nansi Xue, Wenbo Du, Thomas A. Greszler, Wei Shyy and Joaquim R. Martins. “Design of a
       lithium-ion battery pack for PHEV using a hybrid optimization method”. Applied Energy 115
       (Feb. 2014), pp. 591–602. issn: 03062619. doi: 10.1016/j.apenergy.2013.10.044 [cited on
       pages 48, 49, 271].
[30]   Dragan Maksimovic. Course Notes ECEN5017: Power Electronics for Electric Drive Vehicles. 2012.
       url: http://ecee.colorado.edu/%7B~%7Decen5017/ [cited on pages 49, 91, 99, 113, 129,
       199].
[31]   Changhong Liu and Lin Liu. “Optimal Design of Li-Ion Batteries through Multi-Physics Modeling
       and Multi-Objective Optimization”. Journal of The Electrochemical Society 164.11 (2017), E3254–
       E3264. issn: 0013-4651. doi: 10.1149/2.0291711jes [cited on page 49].
[32]   Ali Jokar, Barzin Rajabloo, Martin Désilets and Marcel Lacroix. “Review of simplified Pseudo-
       two-Dimensional models of lithium-ion batteries”. Journal of Power Sources 327 (Sept. 2016),
       pp. 44–55. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2016.07.036 [cited on pages 50, 51,
       58].
[33]   Guodong Fan, Ke Pan and Marcello Canova. “A comparison of model order reduction techniques
       for electrochemical characterization of Lithium-ion batteries”. 54th IEEE Conference on Decision
       and Control (CDC). IEEE, Dec. 2015, pp. 3922–3931. doi: 10.1109/CDC.2015.7402829 [cited
       on pages 50, 51, 58].
[34]   Kandler Smith and Chao-Yang Wang. “Solid-state diffusion limitations on pulse operation of a
       lithium ion cell for hybrid electric vehicles”. Journal of Power Sources 161.1 (Oct. 2006), pp. 628–
       639. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2006.03.050 [cited on pages 53, 157].

                                                  281
                                                                                      REFERENCES


[35]   Thanh-Son Dao, Chandrika P. Vyasarayani and John McPhee. “Simplification and order
       reduction of lithium-ion battery model based on porous-electrode theory”. Journal of Power
       Sources 198 (Jan. 2012), pp. 329–337. issn: 0378-7753. doi: 10 . 1016 / J . JPOWSOUR . 2011 .
       09.034 [cited on page 53].
[36]   Guodong Fan, Ke Pan, Marcello Canova, James Marcicki and Xiao G. Yang. “Modeling of
       Li-Ion Cells for Fast Simulation of High C-Rate and Low Temperature Operations”. Journal of
       The Electrochemical Society 163.5 (Feb. 2016), A666–A676. issn: 0013-4651. doi: 10.1149/2.
       0761605jes [cited on pages 53, 76, 77].
[37]   Guodong Fan, Xiaoyu Li and Marcello Canova. “A reduced-order electrochemical model of li-ion
       batteries for control and estimation applications”. IEEE Transactions on Vehicular Technology
       67.1 (2018), pp. 76–91. issn: 00189545. doi: 10.1109/TVT.2017.2738780 [cited on page 53].
[38]   Wikipedia. Padé approximant — Wikipedia, The Free Encyclopedia. 2018. url: https://en.
       wikipedia.org/wiki/Pad%C3%A9_approximant (visited on 03/12/2018) [cited on page 53].
[39]   Joel C. Forman, Saeid Bashash, Jeffrey L. Stein and Hosam K. Fathy. “Reduction of an
       Electrochemistry-Based Li-Ion Battery Model via Quasi-Linearization and Padé Approximation”.
       Journal of The Electrochemical Society 158.2 (Feb. 2011), A93. issn: 00134651. doi: 10.1149/1.
       3519059 [cited on pages 53, 65].
[40]   James Marcicki, Marcello Canova, A. Terrence Conlisk and Giorgio Rizzoni. “Design and
       parametrization analysis of a reduced-order electrochemical model of graphite/LiFePO4 cells for
       SOC/SOH estimation”. Journal of Power Sources 237 (Sept. 2013), pp. 310–324. issn: 0378-7753.
       doi: 10.1016/J.JPOWSOUR.2012.12.120 [cited on pages 53, 76].
[41]   Saeid Bashash, Scott J. Moura and Hosam K. Fathy. “Charge trajectory optimization of plug-in
       hybrid electric vehicles for energy cost reduction and battery health enhancement”. Proceedings of
       the 2010 American Control Conference. IEEE, June 2010, pp. 5824–5831. isbn: 978-1-4244-7427-1.
       doi: 10.1109/ACC.2010.5530497 [cited on page 53].
[42]   Hector Perez, Niloofar Shahmohammadhamedani and Scott J. Moura. “Enhanced Performance
       of Li-Ion Batteries via Modified Reference Governors and Electrochemical Models”. IEEE/ASME
       Transactions on Mechatronics 20.4 (Aug. 2015), pp. 1511–1520. issn: 1083-4435. doi: 10.1109/
       TMECH.2014.2379695 [cited on page 53].
[43]   Scott J. Moura, Miroslav Krstic and Nalin A. Chaturvedi. “Adaptive PDE Observer for Battery
       SOC/SOH Estimation”. Volume 1: Adaptive Control; Advanced Vehicle Propulsion Systems;
       Aerospace Systems; Autonomous Systems; Battery Modeling; Biochemical Systems; Control Over
       Networks; Control Systems Design; Cooperativ. ASME, Oct. 2012, pp. 101–110. isbn: 978-0-7918-
       4529-5. doi: 10.1115/DSCC2012-MOVIC2012-8800 [cited on pages 53, 156, 310].
[44]   Githin K. Prasad and Christopher D. Rahn. “Model based identification of aging parameters in
       lithium ion batteries”. Journal of Power Sources 232 (June 2013), pp. 79–85. issn: 0378-7753. doi:
       10.1016/J.JPOWSOUR.2013.01.041 [cited on pages 53, 58, 65].
[45]   Shifei Yuan, Lei Jiang, Chengliang Yin, Hongjie Wu and Xi Zhang. “A transfer function type
       of simplified electrochemical model with modified boundary conditions and Padé approximation
       for Li-ion battery: Part 1. lithium concentration estimation”. Journal of Power Sources 352 (June
       2017), pp. 245–257. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.03.060 [cited on
       pages 53, 65].



                                                 282
                                                                                    REFERENCES


[46]   Shifei Yuan, Lei Jiang, Chengliang Yin, Hongjie Wu and Xi Zhang. “A transfer function type
       of simplified electrochemical model with modified boundary conditions and Padé approximation
       for Li-ion battery: Part 2. Modeling and parameter estimation”. Journal of Power Sources 352
       (June 2017), pp. 258–271. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.03.061 [cited
       on pages 53, 65].
[47]   Kandler A. Smith, Christopher D. Rahn and Chao-Yang Wang. “Control oriented 1D electro-
       chemical model of lithium ion battery”. Energy Conversion and Management 48.9 (Sept. 2007),
       pp. 2565–2578. issn: 0196-8904. doi: 10.1016/J.ENCONMAN.2007.03.015 [cited on pages 54,
       65, 137].
[48]   James L. Lee, Andrew Chemistruck and Gregory L. Plett. “One-dimensional physics-based
       reduced-order model of lithium-ion dynamics”. Journal of Power Sources 220 (Dec. 2012), pp. 430–
       448. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2012.07.075 [cited on pages 55, 56, 62,
       66, 137–139, 141, 148, 152, 153].
[49]   James L. Lee. “Reduced-order physics-based model of lithium-ion batteries”. PhD thesis. Univer-
       sity of Colorado Colorado Springs, 2012, p. 150. url: http://hdl.handle.net/10976/250
       [cited on pages 55, 56, 62, 137].
[50]   James L. Lee, Lukas L. Aldrich, Kirk D. Stetzel and Gregory L. Plett. “Extended operating
       range for reduced-order model of lithium-ion cells”. Journal of Power Sources 255 (June 2014),
       pp. 85–100. issn: 03787753. doi: 10.1016/j.jpowsour.2013.12.134 [cited on pages 56,
       57].
[51]   Albert Rodríguez, Gregory L. Plett and M. Scott Trimboli. “Fast computation of the electrolyte-
       concentration transfer function of a lithium-ion cell model”. Journal of Power Sources 360 (Aug.
       2017), pp. 642–645. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.06.025 [cited on
       pages 57, 66].
[52]   Meng Guo, Xinfang Jin and Ralph E. White. “Nonlinear State-Variable Method for Solving
       Physics-Based Li-Ion Cell Model with High-Frequency Inputs”. Journal of The Electrochemical
       Society 164.11 (2017), E3001–E3015. issn: 0013-4651. doi: 10.1149/2.0021711jes [cited on
       pages 58, 66].
[53]   Githin K. Prasad and Christopher D. Rahn. “Development of a First Principles Equivalent
       Circuit Model for a Lithium Ion Battery”. Volume 2: Legged Locomotion; Mechatronic Systems;
       Mechatronics; Mechatronics for Aquatic Environments; MEMS Control; Model Predictive Control;
       Modeling and Model-Based Control of Advanced IC Engines; ASME, Oct. 2012, p. 369. isbn:
       978-0-7918-4530-1. doi: 10.1115/DSCC2012-MOVIC2012-8607 [cited on page 58].
[54]   Githin K. Prasad and Christopher D. Rahn. “Reduced Order Impedance Models of Lithium Ion
       Batteries”. Journal of Dynamic Systems, Measurement, and Control 136.4 (Apr. 2014), p. 041012.
       issn: 0022-0434. doi: 10.1115/1.4026652 [cited on pages 58, 66].
[55]   Xi Zhang, Jinling Lu, Shifei Yuan, Jun Yang and Xuan Zhou. “A novel method for identification of
       lithium-ion battery equivalent circuit model parameters considering electrochemical properties”.
       Journal of Power Sources 345 (Mar. 2017), pp. 21–29. issn: 0378-7753. doi: 10 . 1016 / J .
       JPOWSOUR.2017.01.126 [cited on pages 58, 59, 66].




                                                283
                                                                                        REFERENCES


[56]   Si Cheng, Yong Zhang, Xu-Feng Cheng and Xi Zhang. “State estimation using physics-based
       equivalent circuit models of a Li-ion cell and Kalman filter”. IECON 2017 - 43rd Annual Conference
       of the IEEE Industrial Electronics Society. IEEE, Oct. 2017, pp. 5280–5286. isbn: 978-1-5386-1127-2.
       doi: 10.1109/IECON.2017.8216914 [cited on page 58].
[57]   Yu Merla, Billy Wu, Vladimir Yufit, Ricardo F. Martinez-Botas and Gregory J. Offer. “An easy-
       to-parameterise physics-informed battery model and its application towards lithium-ion battery
       cell design, diagnosis, and degradation”. Journal of Power Sources 384 (Apr. 2018), pp. 66–79.
       issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2018.02.065 [cited on pages 58, 59, 66].
[58]   J. E. B. Randles. “Kinetics of rapid electrode reactions”. Discussions of the Faraday Society 1 (Jan.
       1947), p. 11. issn: 0366-9033. doi: 10.1039/df9470100011 [cited on page 58].
[59]   Xiaoyu Li, Guodong Fan, Giorgio Rizzoni, Marcello Canova, Chunbo Zhu and Guo Wei. “A
       simplified multi-particle model for lithium ion batteries via a predictor-corrector strategy and
       quasi-linearization”. Energy 116 (Dec. 2016), pp. 154–169. issn: 0360-5442. doi: 10.1016/J.
       ENERGY.2016.09.099 [cited on page 60].
[60]   Xing Xu, Wei Wang and Long Chen. “Order Reduction of Lithium-Ion Battery Model Based on
       Solid State Diffusion Dynamics via Large Scale Systems Theory”. Journal of The Electrochemical
       Society 163.7 (May 2016), A1429–A1441. issn: 0013-4651. doi: 10.1149/2.1251607jes [cited
       on page 60].
[61]   Matteo Corno, Nimitt Bhatt, Sergio M. Savaresi and Michel Verhaegen. “Electrochemical model-
       based state of charge estimation for li-ion cells”. IEEE Transactions on Control Systems Technology
       23.1 (2015), pp. 117–127. issn: 10636536. doi: 10.1109/TCST.2014.2314333 [cited on page 60].
[62]   Jocelyn Sabatier, Mathieu Merveillaut, Junior M. Francisco, Franck Guillemard and Denis
       Porcelatto. “Lithium-ion batteries modeling involving fractional differentiation”. Journal of Power
       Sources 262 (Sept. 2014), pp. 36–43. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2014.02.
       071 [cited on page 60].
[63]   Jocelyn Sabatier, Junior M. Francisco, Franck Guillemard, Loic Lavigne, Mathieu Moze and
       Mathieu Merveillaut. “Lithium-ion batteries modeling: A simple fractional differentiation based
       model and its associated parameters estimation method”. Signal Processing 107 (Feb. 2015),
       pp. 290–301. issn: 0165-1684. doi: 10.1016/J.SIGPRO.2014.06.008 [cited on page 60].
[64]   Xiaoyu Li, Guodong Fan, Ke Pan, Guo Wei, Chunbo Zhu, Giorgio Rizzoni and Marcello Canova.
       “A physics-based fractional order model and state of energy estimation for lithium ion batteries.
       Part I: Model development and observability analysis”. Journal of Power Sources 367 (Nov. 2017),
       pp. 187–201. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.09.049 [cited on page 60].
[65]   Hao Mu, Rui Xiong, Hongfei Zheng, Yuhua Chang and Zeyu Chen. “A novel fractional order
       model based state-of-charge estimation method for lithium-ion battery”. Applied Energy 207
       (Dec. 2017), pp. 384–393. issn: 0306-2619. doi: 10.1016/J.APENERGY.2017.07.003 [cited
       on page 60].
[66]   Baojin Wang, Zhiyuan Liu, Shengbo E. Li, Scott J. Moura and Huei Peng. “State-of-Charge
       Estimation for Lithium-Ion Batteries Based on a Nonlinear Fractional Model”. IEEE Transactions
       on Control Systems Technology 25.1 (2017), pp. 3–11. issn: 10636536. doi: 10.1109/TCST.2016.
       2557221 [cited on page 60].




                                                  284
                                                                                       REFERENCES


[67]   Chris Manzie, Changfu Zou and Dragan Nesic. “Simplification techniques for PDE-based Li-Ion
       battery models”. 2015 54th IEEE Conference on Decision and Control (CDC). IEEE, Dec. 2015,
       pp. 3913–3921. isbn: 978-1-4799-7886-1. doi: 10.1109/CDC.2015.7402828 [cited on pages 60,
       67].
[68]   Adolph Fick. “On liquid diffusion”. Journal of Membrane Science 100.1 (Mar. 1995), pp. 33–38.
       issn: 0376-7388. doi: 10.1016/0376-7388(94)00230-V [cited on pages 61, 158, 161].
[69]   Noble B. Ferguson. “Orthogonal collocation as a method of analysis in chemical reaction
       engineering”. Dissertation. University of Washingron, 1971, p. 201. url: https://digital.
       lib . washington . edu / researchworks / bitstream / handle / 1773 / 9876 / 7207350 .
       pdf?sequence=1 [cited on page 61].
[70]   Lloyd N. Trefethen. Spectral methods in MATLAB. Society for Industrial and Applied Mathem-
       atics (SIAM, 3600 Market Street, Floor 6, Philadelphia, PA 19104), 2000, p. 165. isbn: 0898719593
       [cited on pages 61, 108–110].
[71]   John P. Boyd. Chebyshev and Fourier spectral methods. Dover Publications, 2001, p. 668. isbn:
       0486411834 [cited on page 61].
[72]   Bernie D. Shizgal. Spectral methods in chemistry and physics : applications to kinetic theory and
       quantum mechanics. 2015, p. 415. isbn: 9789401794541 [cited on page 61].
[73]   Denys Dutykh. “A brief introduction to pseudo-spectral methods: application to diffusion
       problems”. June 2016. url: http://arxiv.org/abs/1606.05432 [cited on page 61].
[74]   Paul W. Northrop, Venkatasailanathan Ramadesigan, Sumitava De and Venkat R. Subramanian.
       “Coordinate Transformation, Orthogonal Collocation, Model Reformulation and Simulation of
       Electrochemical-Thermal Behavior of Lithium-Ion Battery Stacks”. Journal of The Electrochemical
       Society 158.12 (Jan. 2011), A1461–A1477. issn: 00134651. doi: 10.1149/2.058112jes [cited on
       pages 61, 67, 100, 121, 122, 126, 181, 186, 309].
[75]   Bharatkumar Suthar, Paul W. Northrop, Richard D. Braatz and Venkat R. Subramanian.
       “Optimal Charging Profiles with Minimal Intercalation-Induced Stresses for Lithium-Ion Batteries
       Using Reformulated Pseudo 2-Dimensional Models”. Journal of the Electrochemical Society 161.11
       (Oct. 2014), F3144–F3155. issn: 0013-4651. doi: 10.1149/2.0211411jes [cited on pages 61,
       67].
[76]   Adrien M. Bizeray, Shi Zhao, Stephen R. Duncan and David A. Howey. “Lithium-ion bat-
       tery thermal-electrochemical model-based state estimation using orthogonal collocation and a
       modified extended Kalman filter”. Journal of Power Sources 296 (Nov. 2015), pp. 400–412. issn:
       0378-7753. doi: 10.1016/J.JPOWSOUR.2015.07.019 [cited on pages 61, 67, 108].
[77]   Venkat R. Subramanian, Deepak Tapriyal and Ralph E. White. “A Boundary Condition for
       Porous Electrodes”. Electrochemical and Solid-State Letters 7.9 (Sept. 2004), A259. issn: 10990062.
       doi: 10.1149/1.1773751 [cited on page 62].
[78]   Venkat R. Subramanian, Vinten D. Diwakar and Deepak Tapriyal. “Efficient Macro-Micro Scale
       Coupled Modeling of Batteries”. Journal of The Electrochemical Society 152.10 (Oct. 2005), A2002.
       issn: 00134651. doi: 10.1149/1.2032427 [cited on pages 62, 161–163].
[79]   Venkat R. Subramanian, Vijayasekaran Boovaragavan and Vinten D. Diwakar. “Toward Real-
       Time Simulation of Physics Based Lithium-Ion Battery Models”. Electrochemical and Solid-State
       Letters 10.11 (Nov. 2007), A255. issn: 10990062. doi: 10.1149/1.2776128 [cited on pages 63,
       67].

                                                 285
                                                                                         REFERENCES


[80]   Horatio S. Carslaw and John C. Jaeger. Conduction of heat in solids. 1st ed. Oxford: Clarendon
       Press, 1947, p. 386 [cited on page 63].
[81]   Shengyi Liu. “An analytical solution to Li/Li+ insertion into a porous electrode”. Solid State Ionics
       177.1-2 (Jan. 2006), pp. 53–58. issn: 0167-2738. doi: 10.1016/J.SSI.2005.09.053 [cited on
       pages 63, 161].
[82]   Meng Guo and Ralph E. White. “An approximate solution for solid-phase diffusion in a spherical
       particle in physics-based Li-ion cell models”. Journal of Power Sources 198 (Jan. 2012), pp. 322–328.
       issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2011.08.096 [cited on page 63].
[83]   Zhongwei Deng, Lin Yang, Hao Deng, Yishan Cai and Dongdong Li. “Polynomial approximation
       pseudo-two-dimensional battery model for online application in embedded battery management
       system”. Energy 142 (Jan. 2018), pp. 838–850. issn: 0360-5442. doi: 10.1016/J.ENERGY.2017.
       10.097 [cited on pages 64, 67, 201, 202, 310].
[84]   Mohammed Farag, Matthias Fleckenstein and Saeid Habibi. “Continuous piecewise-linear,
       reduced-order electrochemical model for lithium-ion batteries in real-time applications”. Journal
       of Power Sources 342 (2017), pp. 351–362. issn: 03787753. doi: 10.1016/j.jpowsour.2016.
       12.044 [cited on page 64].
[85]   Bala S. Haran, Branko N. Popov and Ralph E. White. “Determination of the hydrogen diffusion
       coefficient in metal hydrides by impedance spectroscopy”. Journal of Power Sources 75.1 (Sept.
       1998), pp. 56–63. issn: 0378-7753. doi: 10.1016/S0378-7753(98)00092-5 [cited on page 68].
[86]   Gang Ning and Branko N. Popov. “Cycle Life Modeling of Lithium-Ion Batteries”. Journal of The
       Electrochemical Society 151.10 (Oct. 2004), A1584. issn: 00134651. doi: 10.1149/1.1787631
       [cited on page 68].
[87]   Shriram Santhanagopalan and Ralph E. White. “Online estimation of the state of charge of a
       lithium ion cell”. Journal of Power Sources 161.2 (Oct. 2006), pp. 1346–1355. issn: 03787753. doi:
       10.1016/j.jpowsour.2006.04.146 [cited on pages 68, 155].
[88]   Shriram Santhanagopalan and Ralph E. White. “State of charge estimation for electrical vehicle
       batteries”. 2008 IEEE International Conference on Control Applications. IEEE, 2008, pp. 690–695.
       isbn: 978-1-4244-2222-7. doi: 10.1109/CCA.2008.4629656 [cited on page 68].
[89]   Shriram Santhanagopalan, Qingzhi Guo and Ralph E. White. “Parameter Estimation and Model
       Discrimination for a Lithium-Ion Cell”. Journal of The Electrochemical Society 154.3 (Mar. 2007),
       A198. issn: 00134651. doi: 10.1149/1.2422896 [cited on page 68].
[90]   Shriram Santhanagopalan, Qi Zhang, Karthikeyan Kumaresan and Ralph E. White. “Parameter
       Estimation and Life Modeling of Lithium-Ion Cells”. Journal of The Electrochemical Society 155.4
       (Apr. 2008), A345. issn: 00134651. doi: 10.1149/1.2839630 [cited on page 68].
[91]   M. Safari, Mathieu Morcrette, A. Teyssot and Charles Delacourt. “Multimodal Physics-Based
       Aging Model for Life Prediction of Li-Ion Batteries”. Journal of The Electrochemical Society 156.3
       (Mar. 2009), A145. issn: 00134651. doi: 10.1149/1.3043429 [cited on page 68].
[92]   Shriram Santhanagopalan, Qingzhi Guo, Premanand Ramadass and Ralph E. White. “Review of
       models for predicting the cycling performance of lithium ion batteries”. Journal of Power Sources
       156.2 (2006), pp. 620–628. issn: 0378-7753. doi: DOI:10.1016/j.jpowsour.2005.05.070
       [cited on pages 68, 107, 155].



                                                   286
                                                                                        REFERENCES


[93]    Nalin A. Chaturvedi, Reinhardt Klein, Jake Christensen, Jasim Ahmed and Aleksandar Kojic.
        “Algorithms for Advanced Battery-Management Systems: Modeling, estimation, and control
        challenges for lithium-ion batteries”. IEEE Control Systems 30.3 (2010), pp. 49–68. issn: 1066033X.
        doi: 10.1109/MCS.2010.936293 [cited on page 68].
[94]    Alexander P. Schmidt, Matthias Bitzer, Árpád W. Imre and Lino Guzzella. “Experiment-driven
        electrochemical modeling and systematic parameterization for a lithium-ion battery cell”. Journal
        of Power Sources 195.15 (2010), pp. 5071–5080. issn: 03787753. doi: 10.1016/j.jpowsour.
        2010.02.029 [cited on pages 69, 77].
 [95]   Meng Guo, Godfrey Sikha and Ralph E. White. “Single-Particle Model for a Lithium-Ion Cell:
        Thermal Behavior”. Journal of The Electrochemical Society 158.2 (Feb. 2011), A122. issn: 00134651.
        doi: 10.1149/1.3521314 [cited on pages 69, 77].
[96]    Domenico Di Domenico, Anna Stefanopoulou and Giovanni Fiengo. “Lithium-Ion Battery
        State of Charge and Critical Surface Charge Estimation Using an Electrochemical Model-Based
        Extended Kalman Filter”. Journal of Dynamic Systems, Measurement, and Control 132.6 (2010),
        p. 061302. issn: 00220434. doi: 10.1115/1.4002475 [cited on pages 70, 78, 155, 160, 166, 167,
        275].
 [97]   Anupama Guduru, Paul W. Northrop, Shruti Jain, Andrew C. Crothers, T. R. Marchant and
        Venkat R. Subramanian. “Analytical solution for electrolyte concentration distribution in lithium-
        ion batteries”. Journal of Applied Electrochemistry 42.4 (Apr. 2012), pp. 189–199. issn: 0021-891X.
        doi: 10.1007/s10800-012-0394-4 [cited on page 71].
[98]    Venkat R. Subramanian, James A. Ritter and Ralph E. White. “Approximate Solutions for
        Galvanostatic Discharge of Spherical Particles I. Constant Diffusion Coefficient”. Journal of The
        Electrochemical Society 148.11 (Nov. 2001), E444. issn: 00134651. doi: 10.1149/1.1409397
        [cited on pages 71, 161].
[99]    Eric Prada, Domenico Di Domenico, Y. Creff, J. Bernard, V. Sauvant-Moynot and F. Huet.
        “Simplified Electrochemical and Thermal Model of LiFePO4-Graphite Li-Ion Batteries for Fast
        Charge Applications”. Journal of the Electrochemical Society 159.9 (Aug. 2012), A1508–A1519.
        issn: 0013-4651. doi: 10.1149/2.064209jes [cited on pages 73, 78, 216, 255, 256].
[100]   Saeed K. Rahimian, Sean Rayman and Ralph E. White. “Extension of physics-based single particle
        model for higher charge–discharge rates”. Journal of Power Sources 224 (Feb. 2013), pp. 180–194.
        issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2012.09.084 [cited on pages 73, 75, 78].
[101]   Paulo Kemper and Dongsuk Kum. “Extended Single Particle Model of Li-Ion Batteries Towards
        High Current Applications”. 2013 IEEE Vehicle Power and Propulsion Conference (VPPC) (2013),
        pp. 1–6. doi: 10.1109/VPPC.2013.6671682 [cited on page 74].
[102]   Weilin Luo, Chao Lyu, Lixin Wang and Liqiang Zhang. “An approximate solution for electrolyte
        concentration distribution in physics-based lithium-ion cell models”. Microelectronics Reliability
        53.6 (2013), pp. 797–804. issn: 00262714. doi: 10.1016/j.microrel.2012.11.002 [cited on
        pages 74, 75, 78].
[103]   Weilin Luo, Chao Lyu, Lixin Wang and Liqiang Zhang. “A new extension of physics-based
        single particle model for higher charge–discharge rates”. Journal of Power Sources 241 (Nov.
        2013), pp. 295–310. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2013.04.129 [cited on
        pages 74, 78].



                                                   287
                                                                                       REFERENCES


[104]   Changfu Zou, Chris Manzie, Dragan Nešić and Abhijit G. Kallapur. “Multi-time-scale observer
        design for state-of-charge and state-of-health of a lithium-ion battery”. Journal of Power Sources
        335.October 2016 (Dec. 2016), pp. 121–130. issn: 03787753. doi: 10.1016/j.jpowsour.2016.
        10.040 [cited on pages 75, 79].
[105]   Xuebing Han, Minggao Ouyang, Languang Lu and Jianqiu Li. “Simplification of physics-based
        electrochemical model for lithium ion battery on electric vehicle. Part II: Pseudo-two-dimensional
        model simplification and state of charge estimation”. Journal of Power Sources 278 (Mar. 2015),
        pp. 814–825. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2014.08.089 [cited on page 75].
[106]   Tanvir R. Tanim, Christopher D. Rahn and Chao-Yang Wang. “A Temperature Dependent, Single
        Particle, Lithium Ion Cell Model Including Electrolyte Diffusion”. Journal of Dynamic Systems,
        Measurement, and Control 137.1 (2014), p. 011005. issn: 0022-0434. doi: 10.1115/1.4028154
        [cited on pages 75, 78].
[107]   Robert D. Middlebrook. “Low-entropy expressions: the key to design-oriented analysis”. Proceed-
        ings Frontiers in Education Twenty-First Annual Conference. Engineering Education in a New
        World Order. West Lafayette: IEEE, 1991, pp. 399–403. isbn: 0-7803-0222-2. doi: 10.1109/FIE.
        1991.187513 [cited on page 76].
[108]   Robert D. Middlebrook, Vatche Vorperian and John Lindal. “The N Extra Element Theorem”.
        IEEE Transactions on Circuits and Systems I: Fundamental Theory and Applications 45.9 (1998),
        pp. 919–935. issn: 10577122. doi: 10.1109/81.721258 [cited on page 76].
[109]   Vatché Vorpérian. Fast analytical techniques for electrical and electronic circuits. Cambridge
        University Press, 2002, p. 476. isbn: 0521624428 [cited on page 76].
[110]   Tanvir R. Tanim, Christopher D. Rahn and Chao-Yang Wang. “A reduced order electrolyte
        enhanced single particle lithium ion cell model for hybrid vehicle applications”. Proceedings of
        the American Control Conference. 2. 2014, pp. 141–146. doi: 10.1109/ACC.2014.6858617
        [cited on page 76].
[111]   Scott J. Moura, Federico B. Argomedo, Reinhardt Klein, Anahita Mirtabatabaei and Miroslav
        Krstic. “Battery State Estimation for a Single Particle Model with Electrolyte Dynamics”. IEEE
        Transactions on Control Systems Technology 25.2 (Mar. 2017), pp. 453–468. issn: 10636536. doi:
        10.1109/TCST.2016.2571663 [cited on pages 77, 79].
[112]   Nima Lotfi, J. Li, Robert G. Landers and Jonghyun Park. “Li-ion Battery State of Health
        Estimation based on an improved Single Particle model”. 2017 American Control Conference (ACC).
        IEEE, May 2017, pp. 86–91. isbn: 978-1-5090-5992-8. doi: 10.23919/ACC.2017.7962935
        [cited on page 77].
[113]   J. Li, Nima Lotfi, Robert G. Landers and Jonghyun Park. “A Single Particle Model for Lithium-Ion
        Batteries with Electrolyte and Stress-Enhanced Diffusion Physics”. Journal of The Electrochemical
        Society 164.4 (2017), A874–A883. issn: 0013-4651. doi: 10.1149/2.1541704jes [cited on
        page 79].
[114]   J. Li, K. Adewuyi, Nima Lotfi, Robert G. Landers and Jonghyun Park. “A single particle model
        with chemical/mechanical degradation physics for lithium ion battery State of Health (SOH)
        estimation”. Applied Energy 212 (Feb. 2018), pp. 1178–1190. issn: 0306-2619. doi: 10.1016/J.
        APENERGY.2018.01.011 [cited on page 79].




                                                  288
                                                                                        REFERENCES


[115]   Yuan Chaochun, Bingjian. Wang, Zhang Houzhong, Chen. Long and Li Huanhuan. “State-
        of-Charge Estimation of Lithium-ion Battery Based on a Novel Reduced Order Electrochemical
        Model”. International Journal of Electrochemical Science (Jan. 2018), pp. 1131–1146. issn: 14523981.
        doi: 10.20964/2018.01.133 [cited on page 79].
[116]   Cheng Lin, Jilei Xing and Aihua Tang. “Lithium-ion Battery State of Charge/State of Health
        Estimation Using SMO for EVs”. Energy Procedia 105 (May 2017), pp. 4383–4388. issn: 1876-6102.
        doi: 10.1016/J.EGYPRO.2017.03.931 [cited on page 79].
[117]   Ngoc T. Tran, Mahinda Vilathgamuwa, Yang Li, Troy Farrell, San S. Choi and Joseph Teague.
        “State of charge estimation of lithium ion batteries using an extended single particle model and
        sigma-point Kalman filter”. 2017 IEEE Southern Power Electronics Conference (SPEC). IEEE, Dec.
        2017, pp. 1–6. isbn: 978-1-5090-6425-0. doi: 10.1109/SPEC.2017.8333564 [cited on page 79].
[118]   H. E. Perez, S. Dey, X. Hu and S. J. Moura. “Optimal Charging of Li-Ion Batteries via a Single
        Particle Model with Electrolyte and Thermal Dynamics”. Journal of The Electrochemical Society
        164.7 (June 2017), A1679–A1687. issn: 0013-4651. doi: 10 . 1149 / 2 . 1301707jes [cited on
        page 79].
[119]   H. E. Perez, X. Hu and S. J. Moura. “Optimal charging of batteries via a single particle model with
        electrolyte and thermal dynamics”. Proceedings of the American Control Conference. Vol. 2016-
        July. 7. 2016, pp. 4000–4005. isbn: 9781467386821. doi: 10.1109/ACC.2016.7525538 [cited
        on page 79].
[120]   Leonardo K. Maia, Zeynep Güven, Fabio La Mantia and Edwin Zondervan. “Model-based
        Optimization of Battery Energy Storage Systems”. Computer Aided Chemical Engineering 40
        (Jan. 2017), pp. 2563–2568. issn: 1570-7946. doi: 10.1016/B978-0-444-63965-3.50429-3
        [cited on page 79].
[121]   Yang Li, D. Mahinda Vilathgamuwa, Troy W. Farrell, San Shing Choi and Ngoc T. Tran.
        “An equivalent circuit model of li-ion battery based on electrochemical principles used in grid-
        connected energy storage applications”. 2017 IEEE 3rd International Future Energy Electronics
        Conference and ECCE Asia (IFEEC 2017 - ECCE Asia). IEEE, June 2017, pp. 959–964. isbn: 978-1-
        5090-5157-1. doi: 10.1109/IFEEC.2017.7992170 [cited on page 79].
[122]   Junfu Li, Lixin Wang, Chao Lyu, Enhui Liu, Yinjiao Xing and Michael Pecht. “A parameter
        estimation method for a simplified electrochemical model for Li-ion batteries”. Electrochimica
        Acta (Apr. 2018). issn: 00134686. doi: 10 . 1016 / j . electacta . 2018 . 04 . 098 [cited on
        page 79].
[123]   Barzin Rajabloo, Ali Jokar, Martin Désilets and Marcel Lacroix. “An Inverse Method for Estim-
        ating the Electrochemical Parameters of Lithium-Ion Batteries”. Journal of The Electrochemical
        Society 164.2 (Dec. 2017), A99–A105. issn: 0013-4651. doi: 10.1149/2.0221702jes [cited on
        page 79].
[124]   Adrien M. Bizeray, Jin-Ho Kim, Stephen R. Duncan and David A. Howey. “Identifiability and
        parameter estimation of the single particle lithium-ion battery model”. IEEE Transactions on
        Control Systems Technology PP (Feb. 2017), pp. 1–16. doi: 10.1109/TCST.2018.2838097
        [cited on page 79].




                                                   289
                                                                                       REFERENCES


[125]   Emil Namor, Dimitri Torregrossa, Rachid Cherkaoui and Mario Paolone. “Parameter identific-
        ation of a lithium-ion cell single-particle model through non-invasive testing”. Journal of Energy
        Storage 12 (Aug. 2017), pp. 138–148. issn: 2352-152X. doi: 10.1016/J.EST.2017.04.008
        [cited on page 79].
[126]   Donald J. Docimo and Hosam K. Fathy. “Analysis and Control of Charge and Temperature
        Imbalance Within a Lithium-Ion Battery Pack”. IEEE Transactions on Control Systems Technology
        (2018), pp. 1–14 [cited on page 79].
[127]   Pedro Ascencio, Alessandro Astolfi and Thomas Parisini. “Backstepping PDE-based adaptive
        observer for a Single Particle Model of Lithium-Ion Batteries”. 55th Conference on Decision and
        Control Cdc (2016), pp. 5623–5628. doi: 10.1109/CDC.2016.7799133 [cited on page 79].
[128]   Alexander P. Bartlett. Electrochemical Model-Based State of Charge and State of Health
        Estimation of Lithium-Ion Batteries. 2015. url: http://rave.ohiolink.edu/etdc/view?
        acc%7B%5C_%7Dnum=osu1432640190 [cited on page 79].
[129]   Carolyn R. Pals and John S. Newman. “Thermal Modeling of the Lithium/Polymer Battery”.
        Journal of The Electrochemical Society 142.10 (1995), p. 3282. issn: 00134651. doi: 10.1149/1.
        2049975 [cited on pages 87, 96].
[130]   Marie-Therese von Srbik. “Advanced Lithium-Ion Battery Modelling for Automotive Applica-
        tions”. PhD thesis. Imperial College London, 2015, p. 162. url: https://spiral.imperial.
        ac.uk/handle/10044/1/51498 [cited on pages 87, 308].
[131]   Jinming Liu, Mohammad Anwar, Peter Chiang, Shawn Hawkins, Youngsoo Jeong, Faizul
        Momen, Stephen Poulos and Seunghan Song. “Design of the Chevrolet Bolt EV Propulsion
        System”. SAE International Journal of Alternative Powertrains 5.1 (2016), pp. 1153–2016. issn:
        2167-4205. doi: 10.4271/2016-01-1153 [cited on pages 93, 99, 127].
[132]   C. Veth, D. Dragicevic and C. Merten. “Thermal characterizations of a large-format lithium ion
        cell focused on high current discharges”. Journal of Power Sources 267 (2014), pp. 760–769. issn:
        03787753. doi: 10.1016/j.jpowsour.2014.05.139 [cited on page 95].
[133]   Stephen J. Bazinski and Xia Wang. “Thermal Effect of Cooling the Cathode Grid Tabs of a
        Lithium-Ion Pouch Cell”. Journal of The Electrochemical Society 161.14 (2014), A2168–A2174.
        doi: 10.1149/2.0731414jes [cited on page 95].
[134]   Yan Zhao, Yatish Patel, Teng Zhang and Gregory J. Offer. “Modeling the Effects of Thermal
        Gradients Induced by Tab and Surface Cooling on Lithium Ion Cell Performance”. Journal of The
        Electrochemical Society 165.13 (2018), A3169–A3178. doi: 10.1149/2.0901813jes [cited on
        page 95].
[135]   Ian A. Hunt, Yan Zhao, Yatish Patel and J Offer. “Surface Cooling Causes Accelerated Degradation
        Compared to Tab Cooling for Lithium-Ion Pouch Cells”. Journal of The Electrochemical Society
        163.9 (2016), A1846–A1852. issn: 0013-4651. doi: 10.1149/2.0361609jes [cited on pages 95,
        96].
[136]   Gregory L. Plett. Lecture Notes 07: ECE5710 - Modeling, Simulation, and Identification of Battery
        Dynamics. Colorado Springs, 2018. url: http : / / mocha - java . uccs . edu / ECE5710 /
        ECE5710-Notes07.pdf [cited on page 96].




                                                  290
                                                                                      REFERENCES


[137]   Venkat R. Subramanian, Vijayasekaran Boovaragavan, Venkatasailanathan Ramadesigan and
        Mounika Arabandi. “Mathematical Model Reformulation for Lithium-Ion Battery Simulations :
        Galvanostatic Boundary Conditions”. Journal of the Electrochemical Society 156.4 (2009), A260–
        A271. doi: 10.1149/1.3065083 [cited on pages 100, 126, 180, 181, 184, 185].
[138]   General Motors. Drive Unit and Battery at the Heart of Chevrolet Bolt EV. 2016. url: https:
        //media.chevrolet.com/media/us/en/chevrolet/home.detail.html/content/
        Pages / news / us / en / 2016 / Jan / naias / chevy / 0111 - bolt - du . html (visited on
        18/07/2017) [cited on pages 100, 126].
[139]   Oliver Gröger, Hubert a. Gasteiger and Jens-Peter Suchsland. “Review—Electromobility: Bat-
        teries or Fuel Cells?” Journal of The Electrochemical Society 162.14 (2015), A2605–A2622. issn:
        0013-4651. doi: 10.1149/2.0211514jes [cited on pages 101, 126].
[140]   Automotive E. S. Corporation. Cell, Module and Packs for EV Applications: High energy cell. 2018.
        url: http://www.eco-aesc-lb.com/en/product/liion_ev/ (visited on 10/12/2018)
        [cited on page 101].
[141]   Kokam Inc. Datasheet of large format cells. 2018. url: http://kokam.com/cell/ (visited on
        10/12/2018) [cited on page 101].
[142]   Dennis W. Dees, Vincent S. Battaglia and Andre Belanger. “Electrochemical modeling of lithium
        polymer batteries”. Journal of Power Sources 110.2 (2002), pp. 310–320. issn: 0378-7753. doi:
        10.1016/S0378-7753(02)00193-3 [cited on page 104].
[143]   Alan C. Hindmarsh, Peter N. Brown, Keith E. Grant, Steven L. Lee, Radu Serban, Dan E.
        Shumaker and Carol S. Woodward. “SUNDIALS: Suite of nonlinear and differential/algebraic
        equation solvers”. ACM Transactions on Mathematical Software (TOMS) 31.3 (2005), pp. 363–396
        [cited on page 107].
[144]   Joel Andersson. “Faculty of Engineering Science A General-Purpose Software Framework for
        Dynamic Optimization”. PhD thesis. Katholieke Univeritait Leuven, 2013. isbn: 9789460187506
        [cited on page 108].
[145]   Steven G. Johnson. Chebyshev Nodes by Projection. 2018. url: https://commons.wikimedia.
        org/wiki/File:Chebyshev-nodes-by-projection.svg (visited on 03/12/2018) [cited on
        pages 109, 308].
[146]   Society of Automotive Engineers. “Surface vehicle recommended practice : SAE electric vehicle
        and plug in hybrid electric vehicle conductive charge coupler” (2010), p. 116. url: https://
        saemobilus.sae.org/content/j1772%7B%5C_%7D201710 [cited on pages 111, 126, 128].
[147]   Song Y. Choe, Xueyan Li and Meng Xiao. “Fast charging method based on estimation of ion
        concentrations using a reduced order of electrochemical thermal model for lithium ion polymer
        battery”. World Electric Vehicle Journal 6.3 (2013), pp. 782–792. issn: 20326653. doi: 10.1109/
        EVS.2013.6914966 [cited on page 115].
[148]   Thomas H. Cormen. Introduction to algorithms. 3rd ed. Cambridge Mass.: MIT Press, 2009,
        p. 1292. isbn: 9780262270830 [cited on page 117].
[149]   Toby Bond, Jigang Zhou and Jeffrey Cutler. “Electrode Stack Geometry Changes during Gas
        Evolution in Pouch-Cell-Type Lithium Ion Batteries”. Journal of The Electrochemical Society 164.1
        (Nov. 2017), A6158–A6162. issn: 0013-4651. doi: 10.1149/2.0241701jes [cited on pages 120,
        184, 308].


                                                  291
                                                                                        REFERENCES


[150]   Riza Kizilel, Rami Sabbah, J R. Selman and Said Al-Hallaj. “An alternative cooling system to
        enhance the safety of Li-ion battery packs”. Journal of Power Sources 194.2 (Dec. 2009), pp. 1105–
        1112. issn: 03787753. doi: 10.1016/j.jpowsour.2009.06.074 [cited on page 126].
[151]   Pontus Svens, Maria H. Kjell, Carl Tengstedt, Göran Flodberg and Göran Lindbergh. “Li-ion
        pouch cells for vehicle applications-studies of water transmission and packing materials”. Energies
        6 (2013), pp. 400–410. issn: 19961073. doi: 10.3390/en6010400 [cited on page 126].
[152]   S C. Chen, C C. Wan and Y Y. Wang. “Thermal analysis of lithium-ion batteries”. Journal of Power
        Sources 140.1 (2005), pp. 111–124. issn: 0378-7753. doi: 10.1016/j.jpowsour.2004.05.064
        [cited on page 126].
[153]   W Martienssen and Hans Warlimont. Springer Handbook of Condensed Matter and Materials
        Data. Berlin: Springer Berlin Heidelberg, 2005, p. 1119. isbn: 978-3-540-44376-6. doi: 10.1007/
        3-540-30437-1 [cited on page 126].
[154]   Guifang Guo, Bo Long, Bo Cheng, Shiqiong Zhou, Peng Xu and Binggang Cao. “Three-
        dimensional thermal finite element modeling of lithium-ion battery in thermal abuse application”.
        Journal of Power Sources 195.8 (2010), pp. 2393–2398. issn: 0378-7753. doi: 10 . 1016 / j .
        jpowsour.2009.10.090 [cited on page 126].
[155]   Dong H. Jeon and Seung M. Baek. “Thermal modeling of cylindrical lithium ion battery during
        discharge cycle”. Energy Conversion and Management 52.8-9 (2011), pp. 2973–2981. issn: 0196-
        8904. doi: 10.1016/j.enconman.2011.04.013 [cited on page 126].
[156]   Daniel Worwood, Quirin Kellner, Elham Hosseinzadeh, David Mullen, David Greenwood,
        James Marco, Ryan McGlen and Kevin Lynn. “Thermal Analysis of Fin Cooling Large Format
        Automotive Lithium-Ion Pouch Cells”. 2017 IEEE Vehicle Power and Propulsion Conference (VPPC).
        IEEE, Dec. 2017, pp. 1–6. isbn: 978-1-5386-1317-7. doi: 10.1109/VPPC.2017.8330874 [cited
        on page 126].
[157]   Li Song and James W. Evans. “Electrochemical-Thermal Model of Lithium Polymer Batteries”.
        Journal of The Electrochemical Society 147.6 (June 2000), p. 2086. issn: 00134651. doi: 10.1149/
        1.1393490 [cited on page 126].
[158]   Ui S. Kim, Chee B. Shin and Chi S. Kim. “Modeling for the scale-up of a lithium-ion polymer
        battery”. Journal of Power Sources 189.1 (2009), pp. 841–846. issn: 03787753. doi: 10.1016/j.
        jpowsour.2008.10.019 [cited on page 126].
[159]   The Mathworks Inc. MATLAB. Natick, 2017. url: https://www.mathworks.com/products/
        matlab.html [cited on page 125].
[160]   Paul Albertus and John S. Newman. FORTRAN Programs for the Simulation of Electrochemical
        Systems. 2007. url: http://www.cchem.berkeley.edu/jsngrp/fortran.html [cited on
        page 125].
[161]   Nisewanger; Jeff. 2017 Chevy Bolt EV Is Less of a Drag Than Originally Believed. 2017. url:
        http://www.hybridcars.com/2017-chevy-bolt-ev-is-less-of-a-drag-than-
        originally-believed/ [cited on page 127].
[162]   Chevrolet Bolt Features - Dimensions. url: http : / / www . chevrolet . com / byo - vc /
        client/en/US/chevrolet/bolt-ev/2017/bolt-ev/features/trims/?section=
        Highlights % 7B % 5C& % 7Dsection = Exterior % 7B % 5C& % 7Dsection = Dimensions % 7B %
        5C&%7DstyleOne=388584 [cited on page 127].


                                                   292
                                                                                      REFERENCES


[163]   Society of Automotive Engineers. SAE Standard J1666 ”Hybrid Electric Vehicle Acceleration,
        Gradeability, and Deceleration Test Procedure”. Tech. rep. Society of Automotive Engineers,
        2004, p. 25 [cited on page 127].
[164]   Chevrolet Bolt - Overview. url: http : / / www . chevrolet . com / bolt - ev - electric -
        vehicle-2 [cited on page 127].
[165]   Mehrdad Ehsani, Yimin Gao and Ali Emadi. Modern Electric , Hybrid Electric , and Fuel Cell
        Vehicles. Fundamentals, Theory and Design. Second. Boca Raton: CRC Press. Taylor & Francis
        Group, 2010. isbn: 9781420053982 [cited on pages 127, 128].
[166]   Murat Yilmaz and Philip T. Krein. “Review of charging power levels and infrastructure for plug-
        in electric and hybrid vehicles”. 2012 IEEE International Electric Vehicle Conference, IEVC 2012
        28.5 (2012), pp. 2151–2169. issn: 08858993. doi: 10.1109/IEVC.2012.6183208 [cited on
        page 128].
[167]   Ratil H. Ashique, Zainal Salam, Mohd J. Bin Abdul Aziz and Abdul R. Bhatti. “Integrated
        photovoltaic-grid dc fast charging system for electric vehicle: A review of the architecture and
        control”. Renewable and Sustainable Energy Reviews 69.May 2016 (2017), pp. 1243–1257. issn:
        18790690. doi: 10.1016/j.rser.2016.11.245 [cited on page 128].
[168]   Srdjan Srdic, Chi Zhang, Xinyu Liang, Wensong Yu and Srdjan Lukic. “A SiC-based Power
        Converter Module for Medium- Voltage Fast Charger for Plug-in Electric Vehicles”. Proceedings
        of the 2016 IEEE Applied Power Electronics Conference and Exposition (APEC). Long Beach, CA,
        IEEE, 2016, pp. 2714–2719. isbn: 9781467395502. doi: 10.1109/APEC.2016.7468247 [cited
        on page 128].
[169]   Chevrolet Bolt EV Specifications. url: http : / / media . chevrolet . com / media / us / en /
        chevrolet/vehicles/bolt-ev/2017.tab1.html [cited on page 128].
[170]   Frank Markus. General Motors Details New Modular I-3, I-4 Engines. 2014. url: http : / /
        www.motortrend.com/news/gm-introduces-extra-small-block-ecotec-engine-
        family/ [cited on page 128].
[171]   SAE Hybrid Committee. SAE Charging Configurations and Ratings Terminology. 2011. url:
        http://www.sae.org/smartgrid/chargingspeeds.pdf [cited on page 129].
[172]   Gregory L. Plett. Lecture Notes 03: ECE5710 - Modeling, Simulation, and Identification of Battery
        Dynamics. Colorado Springs, 2018. url: http : / / mocha - java . uccs . edu / ECE5710 /
        ECE5710-Notes03.pdf [cited on page 132].
[173]   Krishnakumar Gopalakrishnan, Teng Zhang and Gregory J. Offer. “A Fast, Memory-Efficient
        Discrete-Time Realization Algorithm for Reduced-Order Li-Ion Battery Models”. Journal of
        Electrochemical Energy Conversion and Storage 14.1 (Feb. 2017), p. 011001. issn: 2381-6872. doi:
        10.1115/1.4035526 [cited on pages 136, 310].
[174]   John D. Pryce. Numerical solution of Sturm-Liouville problems. Oxford: Clarendon Press, 1993,
        p. 322. isbn: 9780198534150 [cited on page 137].
[175]   James L. Lee, Andrew Chemistruck and Gregory L. Plett. “Discrete-time realization of tran-
        scendental impedance models, with application to modeling spherical solid diffusion”. Journal
        of Power Sources 206 (May 2012), pp. 367–377. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.
        2012.01.134 [cited on page 138].



                                                  293
                                                                                     REFERENCES


[176]   Β. L. Ho and Rudolph E. Kalman. “Effective construction of linear state-variable models from
        input/output functions”. Automatisierungstechnik 14.1-12 (Jan. 1966), pp. 545–548. issn: 2196-
        677X. doi: 10.1524/auto.1966.14.112.545 [cited on page 138].
[177]   Lennart Ljung. “System Identification”. Ed. by Alex Procházka, Jan Uhlíř, P.W.J. Rayner and N.G.
        Kingsbury. Birkhäuser, Boston, MA, 1998. Chap. Signal Ide, pp. 163–173. isbn: 978-1-4612-1768-8.
        doi: 10.1007/978-1-4612-1768-8_11 [cited on page 139].
[178]   G. H. Golub. Matrix computations. Fourth edi. Baltimore: Johns Hopkins University Press,
        2013, p. 756. isbn: 9781421407944. url: http://imperialcollegelondon.worldcat.org/
        title/matrix-computations/oclc/824733531?referer=br%7B%5C&%7Dht=edition
        [cited on pages 142, 145].
[179]   E. Anderson, Z. Bai, C. Bischof, S Blackford, J. Demmel, J. Dongarra, J. Du Croz, A. Greenbaum,
        S. Hammarling, A. McKenney, D. Sorensen, L. S. Blackford, J. Demmel, J. Dongarra, J. Du Croz,
        A. Greenbaum, S. Hammarling, A. McKenney and D. Sorensen. {LAPACK} Users’ Guide. 3rd
        editio. Philadelphia: Society for Industrial and Applied Mathematics, Jan. 1999, p. 407. isbn:
        0-89871-447-8 (paperback). doi: 10.1137/1.9780898719604 [cited on pages 142, 145].
[180]   Ichitaro Yamazaki, Kesheng Wu and Horst Simon. nu-TRLan User Guide Version 1.0: A High-
        Performance Software Package for Large-Scale Harmitian Eigenvalue Problems. Tech. rep.
        Berkeley, CA: Lawrence Berkeley National Laboratory (LBNL), Oct. 2008. doi: 10 . 2172 /
        944532 [cited on page 145].
[181]   R. B. (Richard B. Lehoucq, D. C. (Danny C. Sorensen, C. (Chao) Yang and Society for Industrial
        and Applied Mathematics. ARPACK users’ guide : solution of large-scale eigenvalue problems
        with implicitly restarted Arnoldi methods. Philadelphia: Society for Industrial and Applied
        Mathematics (SIAM, 3600 Market Street, Floor 6, Philadelphia, PA 19104), 1998, p. 142. isbn:
        9780898719628. doi: 10.1137/1.9780898719628 [cited on page 145].
[182]   Rasmus M. Larsen. PROPACK-software for large and sparse SVD calculations. 2004. url: http:
        //sun.stanford.edu/%7B~%7Drmunk/PROPACK/ [cited on page 145].
[183]   Rasmus M. Larsen. “Lanczos Bidiagonalization With Partial Reorthogonalization”. DAIMI Report
        Series 27.537 (Dec. 1998), p. 101. issn: 2245-9316. doi: 10.7146/dpb.v27i537.7070 [cited on
        page 145].
[184]   Å. Björck. “Numerics of Gram-Schmidt orthogonalization”. Linear Algebra and its Applications
        197-198 (Jan. 1994), pp. 297–316. issn: 0024-3795. doi: 10.1016/0024-3795(94)90493-6
        [cited on page 145].
[185]   James B. Elsner and Anastasios A. Tsonis. Singular Spectrum Analysis: A New Tool in Time
        Series Analysis. Boston, MA: Springer US, 1996, p. 164. isbn: 0306454726. doi: 10.1007/978-
        1-4757-2514-8 [cited on page 146].
[186]   Anton Korobeynikov. “Computation- and space-efficient implementation of SSA”. Statistics and
        Its Interface 3.3 (2010), pp. 357–368. issn: 19387989. doi: 10.4310/SII.2010.v3.n3.a9
        [cited on page 146].
[187]   Nina E. Golyandina and Konstantin D. Usevitch. “2D-Extension of Singular Spectrum Analyis :
        Algorithm and elements of theory”. Matrix Methods: Theory, Algorithms and Applications. Ed. by
        Vadim Olshevsky and Eugene Tyrtyshnikov. WORLD SCIENTIFIC, Apr. 2014, pp. 449–473.
        isbn: 978-981-4469-55-5. doi: 10.1142/9789812836021_0029 [cited on page 146].


                                                 294
                                                                                        REFERENCES


[188]   Nina E. Golyandina, Anton Korobeynikov, Alex Shlemov and Konstantin D. Usevich. “Mul-
        tivariate and 2D Extensions of Singular Spectrum Analysis with the Rssa Package”. Journal of
        Statistical Software 67.2 (Oct. 2015), pp. 1–78. issn: 1548-7660. doi: 10.18637/jss.v067.i02
        [cited on pages 146, 147].
[189]   COMSOL Inc. COMSOL Multiphysics. Burlington, MA, 2012. url: https://www.comsol.
        com/ [cited on page 152].
[190]   John S. Newman and Charles W. Tobias. “Theoretical Analysis of Current Distribution in Porous
        Electrodes”. Journal of The Electrochemical Society 109.12 (Dec. 1962), p. 1183. issn: 00134651.
        doi: 10.1149/1.2425269 [cited on page 157].
[191]   Qi Zhang and Ralph E. White. “Comparison of approximate solution methods for the solid phase
        diffusion equation in a porous electrode model”. Journal of Power Sources 165.2 (Mar. 2007),
        pp. 880–886. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2006.12.056 [cited on page 161].
[192]   Chao-Yang Wang, W. B. Gu and B. Y. Liaw. “Micro-Macroscopic Coupled Modeling of Batteries
        and Fuel Cells”. Journal of The Electrochemical Society 145.10 (Oct. 1998), p. 3407. issn: 00134651.
        doi: 10.1149/1.1838820 [cited on page 161].
[193]   Chao-Yang Wang and Venkat Srinivasan. “Computational battery dynamics (CBD)—electro-
        chemical/thermal coupled modeling and multi-scale modeling”. Journal of Power Sources 110.2
        (Aug. 2002), pp. 364–376. issn: 0378-7753. doi: 10.1016/S0378-7753(02)00199-4 [cited
        on page 161].
[194]   Christophe R. Birkl, E. McTurk, M. R. Roberts, Peter G. Bruce and David A. Howey. “A
        Parametric Open Circuit Voltage Model for Lithium Ion Batteries”. Journal of The Electrochemical
        Society 162.12 (Sept. 2015), A2271–A2280. issn: 0013-4651. doi: 10.1149/2.0331512jes [cited
        on page 164].
[195]   Gregory L. Plett. “High-Performance Battery-Pack Power Estimation Using a Dynamic Cell
        Model”. IEEE Transactions on Vehicular Technology 53.5 (Sept. 2004), pp. 1586–1593. issn: 0018-
        9545. doi: 10.1109/TVT.2004.832408 [cited on page 169].
[196]   Gregory L. Plett. “Extended Kalman filtering for battery management systems of LiPB-based
        HEV battery packs: Part 1. Background”. Journal of Power Sources 134.2 (Aug. 2004), pp. 262–276.
        issn: 0378-7753. doi: 10.1016/j.jpowsour.2004.02.032 [cited on page 169].
[197]   Gregory L. Plett. “Extended Kalman filtering for battery management systems of LiPB-based
        HEV battery packs: Part 2. Modeling and identification”. Journal of Power Sources 134.2 (Aug.
        2004), pp. 262–276. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2004.02.032 [cited on
        page 169].
[198]   Cleve Moler and Charles Van Loan. “Nineteen Dubious Ways to Compute the Exponential of a
        Matrix, Twenty-Five Years Later”. SIAM Review 45.1 (Jan. 2003), pp. 3–49. issn: 0036-1445. doi:
        10.1137/S00361445024180 [cited on page 170].
[199]   Steve C. Southward. ME5506 Advanced Control Engineering: Lecture Notes 03, Spring 2011.
        Blacksburg, VA [cited on pages 174, 310].
[200]   Gregory L. Plett. Lecture Notes 02: ECE 4540/5540- Digital Control Systems. Colorado Springs,
        2017. url: http : / / mocha - java . uccs . edu / ECE5540 / ECE5540 - CH02 . pdf [cited on
        pages 175, 310].



                                                   295
                                                                                      REFERENCES


[201]   Uri M. Ascher and Linda R. Petzold. Computer Methods for Ordinary Differential Equations and
        Differential-Algebraic Equations. Philadelphia: Society for Industrial and Applied Mathematics,
        1997, p. 332. isbn: 0898714125 [cited on page 177].
[202]   Lars O. Valoen̸ and Jan N. Reimers. “Transport Properties of LiPF[sub 6]-Based Li-Ion Battery
        Electrolytes”. Journal of The Electrochemical Society 152.5 (May 2005), A882. issn: 00134651.
        doi: 10.1149/1.1872737 [cited on pages 181, 182, 187].
[203]   Linda R. Petzold. DASSL code. Livermore, CA, 1989 [cited on page 206].
[204]   P. E. Van Keken, D. A. Yuen and L. R. Petzold. “DASPK: A new high order and adaptive time-
        integration technique with applications to mantle convection with strongly temperature-and
        pressure-dependent rheology”. Geophysical & Astrophysical Fluid Dynamics 80.1-2 (Sept. 1995),
        pp. 57–74. issn: 0309-1929. doi: 10.1080/03091929508229763 [cited on page 206].
[205]   Dominic P. Searson. “GPTIPS 2: An Open-Source Software Platform for Symbolic Data Mining”.
        Handbook of Genetic Programming Applications. Cham: Springer International Publishing, 2015,
        pp. 551–573. doi: 10.1007/978-3-319-20883-1_22 [cited on page 213].
[206]   Max Neumann-Coto and Macarena C. R. Arenas. “Measuring complexity of curves on surfaces”
        (Dec. 2017). url: http://arxiv.org/abs/1712.06671 [cited on page 213].
[207]   Lennart. Ljung. System identification : theory for the user. 2nd ed. Upper Saddle River N.J.
        ;;London: Prentice Hall PTR, 1999, p. 609. isbn: 9780136566953 [cited on pages 219, 223, 240].
[208]   Kumpati S. Narendra and Anuradha M. Annaswamy. “Persistent Excitation in Dynamical
        Systems”. 1984 American Control Conference. IEEE, July 1984, pp. 336–338. doi: 10.23919/ACC.
        1984.4788399 [cited on page 223].
[209]   Kumpati S. Narendra and Anuradha M. Annaswamy. “Persistent excitation in adaptive systems”.
        International Journal of Control 45.1 (Jan. 1987), pp. 127–160. issn: 0020-7179. doi: 10.1080/
        00207178708933715 [cited on page 223].
[210]   The Mathworks Inc. System Identification Overview - MATLAB & Simulink - MathWorks
        United Kingdom. url: https://uk.mathworks.com/help/ident/gs/about-system-
        identification.html%7B%5C#%7Dbsguh6g-1 (visited on 13/07/2018) [cited on page 223].
[211]   Gregory L. Plett. Lecture Notes 02: ECE5560-System Identification. Colorado Springs, 2015. url:
        http://mocha-java.uccs.edu/ECE5560/ECE5560-Notes02.pdf [cited on pages 228,
        231, 234].
[212]   Gregory L. Plett. Lecture Notes 03: ECE5560 - System Identification. Colorado Springs, 2015. url:
        http://mocha-java.uccs.edu/ECE5560/ECE5560-Notes03.pdf [cited on page 234].
[213]   Gregory L. Plett. Lecture Notes 04: ECE5560 - System Identification. Colorado Springs, 2015. url:
        http://mocha-java.uccs.edu/ECE5560/ECE5560-Notes04.pdf [cited on page 234].
[214]   L. E. Scales. Introduction to non-linear optimization. Springer-Verlag, 1985, p. 243. isbn:
        0387912525. url: https://dl.acm.org/citation.cfm?id=2973 [cited on page 241].
[215]   The Mathworks Inc. System Identification Toolbox. Natick, 2017 [cited on page 242].
[216]   John Christensen, Venkat Srinivasan and John Newman. “Optimization of Lithium Titanate
        Electrodes for High-Power Cells”. Journal of The Electrochemical Society 153.3 (Mar. 2006), A560.
        issn: 00134651. doi: 10.1149/1.2172535 [cited on page 271].



                                                  296
                                                                                   REFERENCES


[217]   Andrea Pozzi, Gabriele Ciaramella, Krishnakumar Gopalakrishnan, Stefan Volkwein and
        Davide M. Raimondo. “Optimal Design of Experiment for Parameter Estimation of a Single
        Particle Model for Lithium-Ion Batteries”. 57th IEEE Conference on Decision and Control (CDC).
        Ed. by Amir G. Aghdam. Miami Beach, FL: IEEE, 2018, WeB22.2. url: https://cdc2018.
        ieeecss.org/ [cited on page 278].




                                                297
                   Full Listing of Program Codes
                                                                  A
A.1   MATLAB codes for continuous-time SPM . . . . . . . . . . . . . . . . . . . . . 299

A.2 MATLAB codes for discrete-time SPM . . . . . . . . . . . . . . . . . . . . . . . 302




                                        298
                                                 A.1 MATLAB codes for continuous-time SPM


     Listing A.1    MATLAB code for simulation of continuous time SPM

 1   % Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu>
 2   % Author: Gopalakrishnan, Krishnakumar <krishnak@vt.edu>
 3
 4   clear;clc; format short g; format compact; close all;
 5
 6   %% User-entered data
 7   % case-sensitive string descriptive of cell to be simulated.
 8   cellIdentifier = 'Northrop';
 9
10   % string describing starting soc% and csv filename of load profile (time vs current through
     ↪ external circuit)
11   load_profile_name = 'cnst_dischg'; % a) 'cnst_dischg' b) 'cnst_chg' c) 'udds' etc
12
13   % Input CSV-profile setup. Note: Offsets use a 0-base numbering system
14   soc_col            = 1; % The starting SOC is in this column of top row
15   profile_row_offset = 2; % Load profile input data begins only from this row
16
17   Ts       = 0.5; % sec (how often are results needed?)
18   tf_user = 1.5; % sec (user-entered desired simulation end-time)
19   % Simulation might prematurely end if voltage/soc cutoffs are hit
20
21   termination_choice = 'max'; % valid choices are 'max' and 'min'
22   % The 'min' choice is helpful for trials. Whilst retaining the characteristics
23   % of the load profile, the user may do a short time trial simulation.
24
25   %% Pre-Process user data
26   profile_filename = [load_profile_name,'.csv'];
27
28   % Note: a positive C-rate implies discharge and vice-versa for charge
29   try
30       C_rate_profile = csvread(profile_filename,profile_row_offset,0);
31   catch
32       error('Invalid load profile specified. Quitting simulation ...');
33   end
34
35   % Compute expected end-time for allocation of storage & maximum loop indices
36   if strcmp(termination_choice,'max')
37        t_finish = max(tf_user,C_rate_profile(end,1)); % longer of the two prevails
38        % If the last time-entry in the input csv file is shorter than user-entered
39        % value, then the last C-rate from the csv file is held for rest of the
40        % simulation.
41   elseif strcmp(termination_choice,'min')
42        t_finish = min(tf_user,C_rate_profile(end,1)); % longer of the two prevails
43   else
44        error("Invalid termination choice. Valid strings are: 'max' or 'min'.");
45   end
46
47   % Starting SoC percentage
48   soc_init_pct = csvread(profile_filename,0,soc_col,[0 soc_col 0 soc_col]);
49
50   % struct of cell parameters
51   spm_params = parameters_spm_basic(soc_init_pct,cellIdentifier);
52
53   I_1C = spm_params.I_1C;
54   clear tf_user profile_row_offset soc_col profile_filename termination_choice;
55
56   %% Define the State-eqn and Output equation for simulation
57   stateEqn   = @spm_cts_stateEqn_three_states;
58   outputEqn = @spm_three_states_battery_voltage;
59
60   %% Allocate storage for simulated quantities
61   num_iterations = ceil(t_finish/Ts) + 1; % max no. of steps (assuming no cutoff)




                                                    299
                                                     A.1 MATLAB codes for continuous-time SPM


62
63    spm_sim_time_vector          =   nan(num_iterations,1);
64    load_current_vector          =   nan(num_iterations,1);
65    v_cell_sim_results_spm       =   nan(num_iterations,1);
66    soc_pct_results_spm          =   nan(num_iterations,1);
67    cs_avg_neg_sim_results_spm   =   nan(num_iterations,1);
68    q_pos_sim_results_spm        =   nan(num_iterations,1);
69    q_neg_sim_results_spm        =   nan(num_iterations,1);
 70
 71   %% Initialise SPM state vector and all other simulated quantities
72    spm_sim_time_vector(1)        = 0;
73    soc_pct_results_spm(1)        = soc_init_pct;
74    cs_avg_neg_sim_results_spm(1) = spm_params.cs_n_init;
 75   q_pos_sim_results_spm(1)      = 0;
 76   q_neg_sim_results_spm(1)      = 0;
 77
78    % load current applied at t = t0
79    load_current_vector(1) = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim_time_vecto ⌋
      ↪ r(1),'previous','extrap');
80
 81   x_spm_init = [q_pos_sim_results_spm(1); ...
82                  q_neg_sim_results_spm(1); ...
83                  cs_avg_neg_sim_results_spm(1)];
84
85    v_cell_sim_results_spm(1) = outputEqn(x_spm_init,load_current_vector(1),spm_params);
86
87    t_local_start      = 0;
88    t_local_finish     = Ts;
89    x_spm_local_finish = x_spm_init;
90
 91   clear x_init t_finish q_pos_init q_neg_init;
92
93    %% Simulate the SPM
94    progressbarText(0);
95
96    for k = 2:num_iterations % Need solution at k-th time-step
97        load_current_vector(k)        = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim ⌋
          ↪ _time_vector(1),'previous','extrap'); % load current that was held constant from (k-1)
          ↪ to (k)
98        t_span                        = [t_local_start t_local_finish];
99        [~,x_spm_local_finish_matrix] = ode45(@(t,x_spm_local_finish)
          ↪ stateEqn(x_spm_local_finish,load_current_vector(k),spm_params), t_span,
          ↪ x_spm_local_finish);
100       x_spm_local_finish            = x_spm_local_finish_matrix(end,:)';
101
102       q_pos_sim_results_spm(k)      = x_spm_local_finish(1);
103       q_neg_sim_results_spm(k)      = x_spm_local_finish(2);
104       cs_avg_neg_sim_results_spm(k) = x_spm_local_finish(3);
105
106       soc_pct_results_spm(k)      = 100*((cs_avg_neg_sim_results_spm(k)/spm_params.cs_max_n) -
          ↪ spm_params.theta_min_neg)/(spm_params.theta_max_neg - spm_params.theta_min_neg);
107       v_cell_sim_results_spm(k)   =
          ↪ outputEqn(x_spm_local_finish,load_current_vector(k),spm_params);
108
109       overall_exit_status =
          ↪ check_termination(soc_pct_results_spm(k),v_cell_sim_results_spm(k),spm_params);
110       if overall_exit_status ~= 0 % check for violation of cut-off conditions
111           k = k - 1; % Values in the last simulated index are incorrect.
112           fprintf('Exiting simulation ...\n');
113           break;
114       end
115
116       spm_sim_time_vector(k) = t_local_finish;
117       t_local_start          = t_local_finish;




                                                        300
                                                     A.1 MATLAB codes for continuous-time SPM


118       t_local_finish         = t_local_start + Ts;
119       progressbarText((k-1)/num_iterations);
120   end
121   fprintf('\n');
122
123   spm_sim_time_vector          =   spm_sim_time_vector(1:k);
124   load_current_vector          =   load_current_vector(1:k);
125   q_pos_sim_results_spm        =   q_pos_sim_results_spm(1:k);
126   q_neg_sim_results_spm        =   q_neg_sim_results_spm(1:k);
127   cs_avg_neg_sim_results_spm   =   cs_avg_neg_sim_results_spm(1:k);
128   soc_pct_results_spm          =   soc_pct_results_spm(1:k);
129   v_cell_sim_results_spm       =   v_cell_sim_results_spm(1:k);
130
131   %% Save results to disk
132   if exist('spm_results','dir')==0
133       mkdir('spm_results');
134   end
135
136   % Replace decimal point chars in soc% string with 'p' (stands for point)
137   soc_init_pct_savestr = strrep(num2str(soc_init_pct),'.','p');
138
139   % clear A_disc B_disc; % potentially useful varibles. comment out for debugging
140   clear soc_init_pct C_rate_profile I_1C k num_iterations; % redundant info
141   clear x_spm_init x_spm_local_finish t_local_finish t_local_start;
142   save(['spm_results/cts_sim_', cellIdentifier, '_', load_profile_name, ...
143         '_initial_soc_', soc_init_pct_savestr, 'pct', ...
144         datestr(now, '_mmm_dd_yyyy_HH_MM_SS')]); % save workspace to file
145
146   %% Plot results
147   close all;
148   figure(1);
149   h1 = subplot(211);
150   plot(spm_sim_time_vector,load_current_vector,'-');
151   ylabel('Current');
152   ylim([min(load_current_vector)-5 max(load_current_vector)+5]);
153
154   h2 = subplot(212);
155   plot(spm_sim_time_vector,v_cell_sim_results_spm,'m');
156   ylim([spm_params.CutoffVoltage spm_params.CutoverVoltage]);
157   ylabel('Cell Voltage [V]');
158
159   linkaxes([h1 h2],'x');
160   xlim([spm_sim_time_vector(1) spm_sim_time_vector(end)]);
161   xlabel('Time [sec]');
162
163
164   figure(2);
165   h1 = subplot(211);
166   plot(spm_sim_time_vector,load_current_vector,'-');
167   ylabel('Current');
168   ylim([min(load_current_vector)-5 max(load_current_vector)+5]);
169
170   h2 = subplot(212);
171   plot(spm_sim_time_vector,soc_pct_results_spm,'r');
172   ylabel('SOC [%]');
173
174   linkaxes([h1 h2],'x');
175   xlim([spm_sim_time_vector(1) spm_sim_time_vector(end)]);
176   xlabel('Time [sec]');
177
178   clear h1 h2;
179   figure(1);
180   shg;




                                                        301
                                                      A.2 MATLAB codes for discrete-time SPM


     Listing A.2    MATLAB code for simulation of discrete time SPM

 1   % Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu>
 2   % Author: Gopalakrishnan, Krishnakumar <krishnak@vt.edu>
 3
 4   clear;clc; format short g; format compact; close all;
 5
 6   %% User-entered data
 7   % case-sensitive string descriptive of cell to be simulated.
 8   cellIdentifier = 'Northrop';
 9
10   % string describing starting soc% and csv filename of load profile
11   % (time vs current through external circuit)
12   % a) 'cnst_dischg_soc_100_1C' b) 'cnst_chg_soc_100_1C' c) 'udds_soc_50' etc.
13   load_profile_name = 'cnst_dischg_soc_100_2C';
14
15   % Input CSV-profile setup. Note: Offsets use a 0-base numbering system
16   soc_col            = 1; % The starting SOC is in this column of top row
17   profile_row_offset = 2; % Load profile input data begins only from this row
18
19   Ts       = 1; % sec (how often are results needed?)
20   tf_user = 100; % sec (user-entered desired simulation end-time)
21   % Simulation might prematurely end if voltage/soc cutoffs are hit
22
23   termination_choice = 'max'; % valid choices are 'max' and 'min'
24   % The 'min' choice is helpful for trials. Whilst retaining the characteristics
25   % of the load profile, the user may do a short time trial simulation.
26
27   %% Pre-Process user data
28   profile_filename = [load_profile_name,'.csv'];
29
30   % Note: a positive C-rate implies discharge and vice-versa for charge
31   try
32       C_rate_profile = csvread(profile_filename,profile_row_offset,0);
33   catch
34       error('a) Error in specified file, OR b)the load profile is not in PATH. Quitting
         ↪ simulation ...');
35   end
36
37   % Compute expected end-time for allocation of storage & maximum loop indices
38   if strcmp(termination_choice,'max')
39        t_finish = max(tf_user,C_rate_profile(end,1)); % longer of the two prevails
40        % If the last time-entry in the input csv file is shorter than user-entered
41        % value, then the last C-rate from the csv file is held for rest of the
42        % simulation.
43   elseif strcmp(termination_choice,'min')
44        t_finish = min(tf_user,C_rate_profile(end,1)); % longer of the two prevails
45   else
46        error("Invalid termination choice. Valid strings are: 'max' or 'min'.");
47   end
48
49   % Starting SoC percentage
50   soc_init_pct = csvread(profile_filename,0,soc_col,[0 soc_col 0 soc_col]);
51
52   % struct of cell parameters
53   spm_params = parameters_spm_basic(soc_init_pct,cellIdentifier);
54
55   I_1C = spm_params.I_1C;
56   clear tf_user profile_row_offset soc_col profile_filename termination_choice;
57
58   %% Pre-Compute the System and Input Matrices
59   clc;
60
61   F = param.F;




                                                    302
                                                          A.2 MATLAB codes for discrete-time SPM


62    A = param.A;
63
64    R_pos   = param.R_p;
65    R_neg   = param.R_n;
66
67    Ds_pos = param.D_p;
68    Ds_neg = param.D_n;
69
 70   a_pos   = param.a_p;
 71   a_neg   = param.a_n;
72
73    L_pos   = param.len_p;
74    L_neg   = param.len_n;
 75
 76   %% System & Input matrices for continuous and discrete-time implementations
 77
78    A_cts = [-30*Ds_pos/(R_pos^2),                       0, 0; ...
79        0, -30*Ds_neg/(R_neg^2), 0; ...
80        0,                    0, 0];
 81
82    A_disc = expm(A_cts*Ts);
83
84    B_cts = [ (45/2)/(R_pos^2*a_pos*L_pos*F*A); ...
85        (-45/2)/(R_neg^2*a_neg*L_neg*F*A); ...
86        (-3/(R_neg*a_neg*L_neg*F*A))];
87
88    B_disc = nan(size(B_cts));
89    B_disc(1) = B_cts(1)*(exp(A_cts(1,1)*Ts)-1)/A_cts(1,1);
90    B_disc(2) = B_cts(2)*(exp(A_cts(2,2)*Ts)-1)/A_cts(2,2);
 91   B_disc(3) = B_cts(3)*Ts;
92
93    % Through built-in 'c2d' command by the dummy system-method (tricking MATLAB
94    % to believe we have an LTI system). The output matrix,C is chosen so that the
95    % states-themselves are the outputs with no feed-through term involved.
96
97    C_dummy = [1, 1, 1]; D_dummy = 0;
98    sys_cts = ss(A_cts,B_cts,C_dummy,D_dummy);
99    sys_disc = c2d(sys_cts,Ts);
100
101   outputEqn   = @spm_three_states_battery_voltage;
102
103   %% Allocate storage for simulated quantities
104   num_iterations = ceil(t_finish/Ts) + 1; % max no. of steps (assuming no cutoff)
105
106   spm_sim_time_vector          =   nan(num_iterations,1);
107   load_current_vector          =   nan(num_iterations,1);
108   v_cell_sim_results_spm       =   nan(num_iterations,1);
109   soc_pct_results_spm          =   nan(num_iterations,1);
110   cs_avg_neg_sim_results_spm   =   nan(num_iterations,1);
111   q_pos_sim_results_spm        =   nan(num_iterations,1);
112   q_neg_sim_results_spm        =   nan(num_iterations,1);
113
114   %% Initialise SPM state vector and all other simulated quantities
115   spm_sim_time_vector(1)        = 0;
116   soc_pct_results_spm(1)        = soc_init_pct;
117   cs_avg_neg_sim_results_spm(1) = spm_params.cs_n_init;
118   q_pos_sim_results_spm(1)      = 0;
119   q_neg_sim_results_spm(1)      = 0;
120
121   % load current applied at t = t0
122   load_current_vector(1) = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim_time_vecto ⌋
      ↪ r(1),'previous','extrap');
123
124   x_spm_init = [q_pos_sim_results_spm(1); ...




                                                        303
                                                          A.2 MATLAB codes for discrete-time SPM


125       q_neg_sim_results_spm(1); ...
126       cs_avg_neg_sim_results_spm(1)];
127
128   v_cell_sim_results_spm(1) = outputEqn(x_spm_init,load_current_vector(1),spm_params);
129
130   t_local_finish     = Ts;
131   x_spm_local_finish = x_spm_init;
132
133   clear x_init q_pos_init q_neg_init;
134
135   %% Simulate the SPM
136   progressbarText(0);
137
138   for k = 2:num_iterations % Need solution at k-th time-step
139       load_current_vector(k)       = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim ⌋
          ↪ _time_vector(k-1),'previous','extrap'); % load current that was held constant from (k-1)
          ↪ to (k)
140       x_spm_local_finish           = A_disc*x_spm_local_finish + B_disc*load_current_vector(k);
141
142       q_pos_sim_results_spm(k)      = x_spm_local_finish(1);
143       q_neg_sim_results_spm(k)      = x_spm_local_finish(2);
144       cs_avg_neg_sim_results_spm(k) = x_spm_local_finish(3);
145
146       soc_pct_results_spm(k)      = 100*((cs_avg_neg_sim_results_spm(k)/spm_params.cs_max_n) -
          ↪ spm_params.theta_min_neg)/(spm_params.theta_max_neg - spm_params.theta_min_neg);
147       v_cell_sim_results_spm(k)   =
          ↪ outputEqn(x_spm_local_finish,load_current_vector(k),spm_params);
148
149       overall_exit_status =
          ↪ check_termination(soc_pct_results_spm(k),v_cell_sim_results_spm(k),spm_params);
150       if overall_exit_status ~= 0 % check for violation of cut-off conditions
151           k = k - 1; % Values in the last simulated index are incorrect.
152           fprintf('Exiting simulation ...\n');
153           break;
154       end
155
156       spm_sim_time_vector(k) = t_local_finish;
157       t_local_start          = t_local_finish;
158       t_local_finish         = t_local_start + Ts;
159       progressbarText((k-1)/num_iterations);
160   end
161   fprintf('\n');
162
163   spm_sim_time_vector          =   spm_sim_time_vector(1:k);
164   load_current_vector          =   load_current_vector(1:k);
165   q_pos_sim_results_spm        =   q_pos_sim_results_spm(1:k);
166   q_neg_sim_results_spm        =   q_neg_sim_results_spm(1:k);
167   cs_avg_neg_sim_results_spm   =   cs_avg_neg_sim_results_spm(1:k);
168   soc_pct_results_spm          =   soc_pct_results_spm(1:k);
169   v_cell_sim_results_spm       =   v_cell_sim_results_spm(1:k);
170
171   %% Save results to disk
172   save_foldername = ['spm_results/', cellIdentifier,      '/',   load_profile_name];
173   if exist(save_foldername,'dir')==0
174       mkdir(save_foldername);
175   end
176
177   % Replace decimal point chars in soc% string with 'p' (stands for point)
178   soc_init_pct_savestr = strrep(num2str(soc_init_pct),'.','p');
179
180   clear soc_init_pct C_rate_profile I_1C k num_iterations; % redundant info
181   clear x_spm_init x_spm_local_finish t_local_finish t_local_start;
182   save([save_foldername, '/disc_sim_', ...
183       datestr(now, 'mmm_dd_yyyy_HH_MM_SS')]); % save workspace to file




                                                        304
                                                      A.2 MATLAB codes for discrete-time SPM


184
185   function v_cell = spm_three_states_battery_voltage(x,u,param)
186       % returns v_cell given the vector x and input u at any given time-step
187       % x(1) = q_pos, x(2) = q_neg, x(3) = cs_avg_neg
188       % u = load current (A). Positive implies discharge.
189
190       % Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu>
191       % Author: Gopalakrishnan, Krishnakumar <krishnak@vt.edu>
192
193       R       = param.R;
194       T       = param.Tref;
195       F       = param.F;
196
197       R_pos   = param.R_p;
198       R_neg   = param.R_n;
199
200       Ds_pos = param.D_p;
201       Ds_neg = param.D_n;
202
203       a_pos   = param.a_p;
204       a_neg   = param.a_n;
205
206       L_pos   = param.len_p;
207       L_neg   = param.len_n;
208
209       k_p     = param.k_p;
210       k_n     = param.k_n;
211
212       ce      = param.ce_init;
213       A       = param.A;
214
215       cs_max_n = param.cs_max_n;
216       cs_max_p = param.cs_max_p;
217
218       theta_min_neg   =   param.theta_min_neg;
219       theta_min_pos   =   param.theta_min_pos;
220       theta_max_neg   =   param.theta_max_neg;
221       theta_max_pos   =   param.theta_max_pos;
222
223       % Extract permissible bounds for solid concentrations
224       cs_surf_pos_lb = param.theta_max_pos*param.cs_max_p;
225       cs_surf_pos_ub = param.theta_min_pos*param.cs_max_p;
226       cs_surf_neg_lb = param.theta_min_neg*param.cs_max_n;
227       cs_surf_neg_ub = param.theta_max_neg*param.cs_max_n;
228
229       % Extract the function handles for Uocp_pos and Uocp_neg
230       compute_Uocp_pos = param.compute_Uocp_pos;
231       compute_Uocp_neg = param.compute_Uocp_neg;
232
233       %% Compute surface concentrations
234       cs_surf_neg = x(3) + (8*R_neg/35)*x(2) - (R_neg/(35*Ds_neg*a_neg*L_neg*F*A))*u;
235       cs_surf_neg = min(cs_surf_neg_ub, max(cs_surf_neg_lb, cs_surf_neg)); % saturation
236
237       cs_avg_pos = cs_max_p*(theta_min_pos + ((x(3) - theta_min_neg*cs_max_n)./((theta_max_neg -
          ↪ theta_min_neg)*cs_max_n))*(theta_max_pos - theta_min_pos)); % average concentration in
          ↪ pos electrodue (analytical expn using conservation of Li)
238       cs_surf_pos = cs_avg_pos + (8*R_pos/35)*x(1) + (R_pos/(35*Ds_pos*a_pos*L_pos*F*A))*u; %
          ↪ surface concentration of pos electrode
239       cs_surf_pos = min(cs_surf_pos_ub, max(cs_surf_pos_lb, cs_surf_pos)); % saturation
240
241       %% Compute overpotentials
242       eta_p = (2*R*T/F)*asinh(-u/(2*A*F*a_pos*L_pos*k_p*sqrt(ce*cs_surf_pos*(cs_max_p -
          ↪ cs_surf_pos))));




                                                     305
                                                         A.2 MATLAB codes for discrete-time SPM


243         eta_n = (2*R*T/F)*asinh(u/(2*A*F*a_neg*L_neg*k_n*sqrt(ce*cs_surf_neg*(cs_max_n -
            ↪ cs_surf_neg))));
244
245         %% Compute OCPs
246         surf_theta_p = cs_surf_pos/param.cs_max_p;
247         surf_theta_n = cs_surf_neg/param.cs_max_n;
248
249         U_p = compute_Uocp_pos(surf_theta_p);
250         U_n = compute_Uocp_neg(surf_theta_n);
251
252         phi_pos = eta_p + U_p;
253         phi_neg = eta_n + U_n;
254
255         v_cell = phi_pos - phi_neg;
256
257   end
258
259   function U_p = compute_Uocp_pos(theta_p)
260
261         U_p = (-4.656+88.669*theta_p.^2 - 401.119*theta_p.^4 + 342.909*theta_p.^6 -
      ↪     462.471*theta_p.^8 + 433.434*theta_p.^10);
262         U_p = U_p./(-1+18.933*theta_p.^2-79.532*theta_p.^4+37.311*theta_p.^6-73.083*theta_p.^8+95.96 ⌋
            ↪ *theta_p.^10);
263
264   end
265
266   function U_n = compute_Uocp_neg(theta_n)
267
268         U_n   = 0.7222 + 0.1387*theta_n + 0.029*theta_n.^0.5 - 0.0172./theta_n +
      ↪     0.0019./theta_n.^1.5 + 0.2808*exp(0.9-15*theta_n)-0.7984*exp(0.4465*theta_n - 0.4108);
269
270   end




                                                      306
                                      Permissions Summary
                                                                         B
B.1   Summary of Copyright Permissions . . . . . . . . . . . . . . . . . . . . . . . . 308

B.2   Copyright Permissions for reuse of Figure 3.4 . . . . . . . . . . . . . . . . . . . 311

B.3   Copyright Permissions for reuse of Figure 3.8 . . . . . . . . . . . . . . . . . . . 313

B.4   Copyright Permissions for reuse of text, figures and tables of Chapter 4 . . . . 315

B.5   Copyright Permissions for reuse of Figure 5.1 . . . . . . . . . . . . . . . . . . . 318

B.6   Copyright Permissions for reuse of Figure 5.3 . . . . . . . . . . . . . . . . . . . 322

B.7   Copyright Permissions for reuse of Figure 5.4 . . . . . . . . . . . . . . . . . . . 323

B.8   Copyright Permissions for reuse of Figure 5.13 . . . . . . . . . . . . . . . . . . 324




                                          307
                               Table B.1       Summary of permissions for reuse of third-party copyrighted material

        Page     Usage in                                Source                              Copyright holder &              Date of last        Have       Permission
         no.       thesis                                                                    contact (organisations only)   correspondence    permission?   remarks

      Page 87    Figure 3.1   Marie-Therese von Srbik. “Advanced Lithium-Ion Battery         Marie-Therese von Srbik             N/A              Yes       CC-BY-
                              Modelling for Automotive Applications”. PhD thesis. Imper-                                                                    NC-ND
                              ial College London, 2015, p. 162

      Page 89    Figure 3.2   Ian D. Campbell,        Krishnakumar Gopalakrishnan,           Pending transfer to Elsevier     05/01/2019          No        Pending
                              Monica Marinescu, Marcello Torchio, Gregory J. Offer and       by Ian D. Campbell              (manuscript                    publication
                              Davide M. Raimondo. “Optimising lithium-ion cell design        permissions@elsevier.com         accepted)
                              for plug-in hybrid and battery electric vehicles”. Journal
                              of Energy Storage (Accepted) (Jan. 2019). The highlighted
                              authors are joint first authors with equal contributions.

      Page 105   Figure 3.4   Marcello Torchio, Lalo Magni, R B. Gopaluni, Richard D.        The Electrochemical Society      27/09/2018          Yes       ‘Rightslink’




308
                              Braatz and Davide M. Raimondo. “LIONSIMBA: A Matlab            copyright@electrochem.org                                      agreement
                              Framework Based on a Finite Volume Model Suitable for                                                                         attached
                              Li-Ion Battery Design, Simulation, and Control”. Journal of                                                                   (see B.2)
                              The Electrochemical Society 163.7 (2016), A1192–A1205. issn:
                              0013-4651

      Page 109   Figure 3.5   Steven G. Johnson. Chebyshev Nodes by Projection. 2018         Steven G. Johnson                   N/A              Yes       CC-BY-SA

      Page 120   Figure 3.7   Toby Bond, Jigang Zhou and Jeffrey Cutler. “Electrode Stack    Bond, Zhou and Cutler               N/A              Yes       CC-BY
                              Geometry Changes during Gas Evolution in Pouch-Cell-Type
                              Lithium Ion Batteries”. Journal of The Electrochemical Soci-
                              ety 164.1 (Nov. 2017), A6158–A6162. issn: 0013-4651


                                                                                                                                            Continued on next page
                                                                                                                                                                           B.1 Summary of Copyright Permissions
                                                            Table B.1 — continued from previous page
        Page     Usage in                                 Source                             Copyright holder &              Date of last        Have       Permission
         no.       thesis                                                                    contact (organisations only)   correspondence    permission?   remarks

      Page 122   Figure 3.8    Paul W. Northrop, Venkatasailanathan Ramadesigan, Sum-        The Electrochemical Society      27/09/2018          Yes       ‘Rightslink’
                               itava De and Venkat R. Subramanian. “Coordinate Trans-        copyright@electrochem.org                                      agreement
                               formation, Orthogonal Collocation, Model Reformulation                                                                       attached
                               and Simulation of Electrochemical-Thermal Behavior of                                                                        (see B.3)
                               Lithium-Ion Battery Stacks”. Journal of The Electrochemical
                               Society 158.12 (Jan. 2011), A1461–A1477. issn: 00134651

      Page 131   Figure 3.9    Ian D. Campbell,        Krishnakumar Gopalakrishnan,          Pending transfer to Elsevier     05/01/2019          No        Pending
                               Monica Marinescu, Marcello Torchio, Gregory J. Offer and      by Ian D. Campbell              (manuscript                    publication
                               Davide M. Raimondo. “Optimising lithium-ion cell design       permissions@elsevier.com         accepted)
                               for plug-in hybrid and battery electric vehicles”. Journal
                               of Energy Storage (Accepted) (Jan. 2019). The highlighted




309
                               authors are joint first authors with equal contributions.

      Page 131   Figure 3.10   Ian D. Campbell,        Krishnakumar Gopalakrishnan,          Pending transfer to Elsevier     05/01/2019          No        Pending
                               Monica Marinescu, Marcello Torchio, Gregory J. Offer and      by Ian D. Campbell              (manuscript                    publication
                               Davide M. Raimondo. “Optimising lithium-ion cell design       permissions@elsevier.com         accepted)
                               for plug-in hybrid and battery electric vehicles”. Journal
                               of Energy Storage (Accepted) (Jan. 2019). The highlighted
                               authors are joint first authors with equal contributions.

      Page 133   Figure 3.11   Ian D. Campbell,        Krishnakumar Gopalakrishnan,          Pending transfer to Elsevier     05/01/2019          No        Pending
                               Monica Marinescu, Marcello Torchio, Gregory J. Offer and      by Ian D. Campbell              (manuscript                    publication
                               Davide M. Raimondo. “Optimising lithium-ion cell design       permissions@elsevier.com         accepted)
                               for plug-in hybrid and battery electric vehicles”. Journal
                               of Energy Storage (Accepted) (Jan. 2019). The highlighted
                               authors are joint first authors with equal contributions.


                                                                                                                                            Continued on next page
                                                                                                                                                                           B.1 Summary of Copyright Permissions
                                                               Table B.1 — continued from previous page
        Page     Usage in                                  Source                            Copyright holder &              Date of last       Have       Permission
         no.       thesis                                                                    contact (organisations only)   correspondence   permission?   remarks

      Page 136   All figures,   Krishnakumar Gopalakrishnan, Teng Zhang and Gregory          The American Society             18/04/2016         Yes       Copyright
                 tables and     J. Offer. “A Fast, Memory-Efficient Discrete-Time Realiza-   of Mechanical Engineers                                       agreement
                 captions of    tion Algorithm for Reduced-Order Li-Ion Battery Models”.     (ASME)                                                        attached
                 chapter 4      Journal of Electrochemical Energy Conversion and Storage     journalcopyright@asme.org                                     (see B.4)
                                14.1 (Feb. 2017), p. 011001. issn: 2381-6872

      Page 156   Figure 5.1     Scott J. Moura, Miroslav Krstic and Nalin A. Chaturvedi.     The American Society             02/10/2018         Yes       ‘Rightslink’
                                “Adaptive PDE Observer for Battery SOC/SOH Estimation”.      of Mechanical Engineers                                       agreement
                                Volume 1: Adaptive Control; Advanced Vehicle Propulsion      (ASME)                                                        attached
                                Systems; Aerospace Systems; Autonomous Systems; Battery      journalcopyright@asme.org                                     (see B.5)
                                Modeling; Biochemical Systems; Control Over Networks; Con-
                                trol Systems Design; Cooperativ. ASME, Oct. 2012, pp. 101–




310
                                110. isbn: 978-0-7918-4529-5

      Page 174   Figure 5.3     Steve C. Southward. ME5506 Advanced Control Engineering:     Steve C. Southward               09/10/2018         Yes       Granted
                                Lecture Notes 03, Spring 2011. Blacksburg, VA                                                                              via email
                                                                                                                                                           (see B.6)

      Page 175   Figure 5.4     Gregory L. Plett. Lecture Notes 02: ECE 4540/5540- Digital   Gregory L. Plett                 28/09/2018         Yes       Granted
                                Control Systems. Colorado Springs, 2017                                                                                    via email
                                                                                                                                                           (see B.7)

      Page 202   Figure 5.13    Zhongwei Deng, Lin Yang, Hao Deng, Yishan Cai                Elsevier                         27/09/2018         Yes       Elsevier
                                and Dongdong Li. “Polynomial approximation pseudo-           permissions@elsevier.com                                      license
                                two-dimensional battery model for online application in                                                                    attached
                                embedded battery management system”. Energy 142 (Jan.                                                                      (see B.8)
                                2018), pp. 838–850. issn: 0360-5442
                                                                                                                                                                          B.1 Summary of Copyright Permissions
B.2 Copyright Permissions for reuse of Figure 3.4




      311
B.2 Copyright Permissions for reuse of Figure 3.4




      312
B.3 Copyright Permissions for reuse of Figure 3.8




      313
B.3 Copyright Permissions for reuse of Figure 3.8




      314
                B.4 Copyright Permissions for reuse of text, figures and tables of Chapter 4

COPYRIGHT                       AGREEMENT                (as of February2010)
                        • TWO Park Avenue • New          NY
For

For                                           peg


Before publicatlon o' yo.r paper In a conference proceedings or Journal, ASME must receive a signed Copyright Agreement.
conference papers, this form should be received by the deadline Indicated by the Conference. Other forms may NOT be
suhtitut.d  for this form, nor may any         on the form be changed,


PAPERNUMBER                                           papers):JEECS-16•1050




AUTHOR(s):


CONFERENCE              NAME:



JOURNALNAME; danrnalrd                                             EnergyConversionand Storage




ASME requesb            that authors/copyright       owners assign copyright to ASME in ardor for a conforønce or Journal paper to be
pubished by ASME. Authors exempt from this request are direct employees or the U.S. Government. whereby papers are
not subject to copyright protection in the u.S., or non•u.S. government employees, Whose governments hold the copyright
to tie paper. Otherwise, the author/ copyright owner(s) Of the Paper should sign this form as instructed below. please refer
to the section below •Who Should Sign' and also to ASME'S               for more hrormation regarding copyr•t ownership
and the copyright

WHO      SHOULD          SIGN


Only the copyright owner(s) or the Paper, or an authorized representative. can sign Otis rorrn. If ono or he ronawing apples.
you may              own the copyright to        paper, or you may not be authorized to                 this               and you guy need to have
the appropriate copyright owner(s) or organizauon representative                         this Agreement:
(l) You creaEd tie paper within tho scope Of your employment,    your empbyeris                                the copyright owner
(2) You created the Paper under an hdependent contractor agreement"
(3) You received a grant that hjnded     Paper.

Pkase review yotr mmpMY policies regarding copy#t.                       and if you are not authorized to son this agreernent. please forward
to rue appropriate organization            Ptease review applicable company. institutional, and grant policies and your
employment,qndependent contrætor agreement to determine who holds the rights to your Paper. For rmre information, please
         the


"Note to U.S. Gavemment Contractors:         Wyou             Paper under        With the US. Government. e.g„ U.S.
Government hbs, the paper may be subject to copyright, and you or your employer may own the copyright. Please review
your companyinstitutional  policies and your contractor agreement. Your Paper may also require a       acknowledghg
contract in%rmation and also the fogowi•g staternene

•The             StaB     Governrnent re*s,   and by acepting tle atEIe                   pLHiGtbn, tie pu&her æknowledges tlat he LJr&d
States                    rebins, a non-exclusrv•e,        irrevoæble,                        Itense b puÜ.h or         the pubßhed
Of tlis work. or äNOWothers to do              for United States Government         purpose     •

It is your                      to ensure that the       PDF            of he paper          submit includes         necßsary            and
             under         contract

COPYRIGHT              ASSIGNMENT
The                       Of copyright                        to          l. 2.     3.              4      5

The undersiW1ed hereby assigns irrevocably to ASME all worldwße rights under copyright                                  Paper.

Authors retain an proprietary rfihts in any idea.                           procedure.        articles of manuEure           described in tie Paper.
includhg the             to seek           protection for them.             may perform,                teæh, cmduct                 research display




                                                                              315
         B.4 Copyright Permissions for reuse of text, figures and tables of Chapter 4

or pert Of  Paper, and create       works in print or elecb•onicforrnaL Authors may reproduce and distribute tho Paper
for non-commercial purposes                   applies only to the sale Of the paper per se. For all coples of    Paper
made by Authors, Authors must acknowledge ASME as original publisher and Include the names Of                      the
publk:ation title, and an appropriate copyright notEe that identifies ASME as the copyr"ht holder.

PLEASE READ THE IEBMHNQ-GQNQII.IQNS               WHICH ARE FULLY INCORPORATED IN THIS AGREEMENT.

PAPERS OWNED BY ONE AUTHOR OR JOINT AUTHORS; DESIGNATED AUTHORS (For jolnuy                                 works. au
authors should submit e signed Agreement, or one Designated Author may sign on behalf of the other authors, but ONLY IF
    deslgnated author has secured written authorization to do so trom all other authors, Tho desbnated author must be able
to produce su@'written authorization if mquested,)

AuthM, Co.Aufror, or Deslgnated Author




Name:Krishnakumar Gopalakrishnan

                                                                    TWO:        Student



                                                                                                     United   K    m




      (App•n.d       you                Other)




                                                              316
                 B.4 Copyright Permissions for reuse of text, figures and tables of Chapter 4

ASME         COPYRIGHT                       FORM TERMS                   AND CONDITIONS

                             and                   are      inmrporated                               Form,



REPRESENTATIONS,                           OBLIGATIONS.              ACKNOWLEDGEMENTS,                         AND INDEMNIFICATION

       rvesent    and                         hat:

(A) This                                                                                  the                       of an                        Of                        a
o'           as                              by

(B) You have the r"ht to                    into this Copy*t              end to nuke                          of           to ASME. the              containsexcerpts
ether                   mat"al       (hck'ding without limitatbn ony                                                        taxi). you have acquired      writing an
ri*üs                  partho                                in                      and have                                 credl     that third-patty rmterial                    or


           are                this Form boh       any                                                                  have                                          from a'
        aumors                         holdersto make this ass"nrnent                   r•ts        to ASME.

(D) TOthe best Ofthe authM's              au StatenmtS cnMained in the                 to b'     are     or support«i by
scientific        the Paper        not u»ntalnany deramatMYor I&bus material aruldws not infringe any third pørtys cgMight. *nt.
trat% secret. Ottw prtvdetwy rights anddoes not violate me right 01        or pWicny o' my third party             violate any other
              furthermore elat to the best Of           you are resp-üBiWøfor ensuing the          of y-m_rr•seÜch          p


(E)                    was                  in the             an         envloyment by. mntractual                                 wÄh, ttw u.s. Federal or State
                                                       materi* it has been awopriawy  cleMed for publc r&ase                      and such Is

(F) Tho           is         Su*t          any                                                and     not                          for puMlcatbn

(G) You have                         Od                                                                                              in the Paper's               aspe&.

(H) ASME is                                  my                           errors or                  by

(I) All pru•üand             of the P»er                                  to ASME                   ASMEs *tysu                                 of whetter        not A
mibUshestle Paper. and thatASME is not                                 to mJblBhyour                (sn ttw Tertwnation                        i' your             not

(J) ASME is                           for any               expensesincurredin                              prepar"g me                            methgs          prent       It.
      ASEE pay you any                       cmpensatÉn        if    ptnlshes          Papa.

(k) Su*t                 to                        extent                 law.        agree                                           ASMEfromanydanuge
relaW to a breachof any ot the                                         warranbes


TERMINATION


If        decø— not to                      yow P»er, ns FM"',                       all of                      ymr papÜ.                                   thereafterfree to
                         pub—iM            elsewtwe.


GENERAL           PROVISIONS


This                            Terms &                                                                               the                                  ASME.
and supMse&s           a' gior or ament                                               and repres*ltations,       Whettw Oral or Written, between you md A9dE
             the Paper.

This Agreenwnt     is                 by. md stould be constt_æd in                             wit'. the laws       the State 01         York, United States of America
            to                      made md perforrned Tiete, except to                             that pur mstitution is                Sy law from entering contracts
           by New York                in                            this Agreement    is governed by , and Should                                         With,                Of
ji_risdictior, which your                         is          Any       dispute. action or proceedng relatingto this Agreernent be brought only in
applÉ±k                                           in the State and Cwnty of New         aM you           mnsent to persmal W•nsdicihnand venue in any




                                                                                               317
B.5 Copyright Permissions for reuse of Figure 5.1




      318
B.5 Copyright Permissions for reuse of Figure 5.1




      319
B.5 Copyright Permissions for reuse of Figure 5.1




      320
B.5 Copyright Permissions for reuse of Figure 5.1




      321
                                                       B.6 Copyright Permissions for reuse of Figure 5.3

Go      alakrishnan.      Krishnakumar

                                        Southward, Steve             •exchange.vtedu>
Sent:                                   09 October   2018   1741
To:                                     Gopalakrishnan, Krishnakumar
                                        Re:Requestfor permissionto adapta schematicfrom your lecturenotesfor thesis



Hi Krishna,

                             Youarewelcometo usemyslidewith citationasyouhavedone.Goodluckl
SorryforthedelayIn responding.
Dr. Southward




          On Sep 26, 2018, at 2:55 PM, Gopalakrishnan, Krishnakumar <

          Dear prof Southward,

          Greetings'

          Hopeyou rememberme from our previousinteractions.I am KrishnakumarGopalakrishnan
          (Krishna),whowas registeredat VirginiaTechfrom Fall2009throughFall2011as anM.Engstudent
                         l ComputerEngineering(ECEdep
          Inthe Electricaand                           ) artment.InSpring2011,t had registeredfor
                                                                           taughtbyyou.I
                                                          ControlEngineering,
                                                 6 Advanced
                                      g rse'MES50—
          andcompletedthecredit-bearincou
          am therefore in possessionof the electronicPDFSof the lecture notesamongother associated
          material   for this course.


          Forusein my PhDthesis(non-profit CC-BY-NC-Nuse)   D ,I'd liketo adapt a schematicfrom L03Of
          your coursenotesthat presentsthe timing diagramof a real-time control/software loop.
          I shallof coursecite the sourceof the originalschematicin the figure caption.

          I haveattachedmyadaptedversionherewithfor yourperusal.I hopeyouan accordmewithyour
          permissions for thesis reuse.


          Best Regards,
          Krishna




                                                                   322
                                                    B.7 Copyright Permissions for reuse of Figure 5.4

Go     lakrishnan,      Krishnakumar

                                    Gregory Plett
                                    28 September 2018 2028
                                    Gopalakrishnan, Krishnakumar
                                                                              fromyour lecturenotesin my PhD
                                    Re:Requestfor permissionto reusea schematic
                                    thesis




Yes,youarewelcometo use/adaptthe figure.I'm sureI Stoleit from somewheremyself.

Congratulations for reaching this pointl

Dr. Gregory L prett
professor,Departmentof Electricaland ComputerEngineering
                              in InnovativeDrivetrainsin ElectricAutomotiveTechnologyEducation
Director,GATECenterOfExcellence
University of Colorado Colorado Springs
1420 Austin Bluffs parkway, Colorado Springs,CO80918
p:




        On Sep 28, 2018, at 10:13 AM, Gopalakrishnan, Krishnakumar


        Dear prof Plett,


        Greetings'How areyou doing?I am about to submit the thesisOfmy thesis(hopefullyearly next


                                                                  use),I'd liketo adapt a
        ForuseIn my PhDthesis(non-profit, non-commericalCC-BY-NC-ND
                                        0 sthatdepictsa cartoonrepresentationof the timing
        schematicfrom Lecture2 of ECE554note
        diagramof a real-time control/software loop. I shallof coursecite the sourceof the original
        schematic in the caption.

        I have attachedthe relevantschematicherewith for your perusal. I hope you canaccordme with
        your permissions for thesis reuse.


        Best Regards,
        Krishna




                                                          323
B.8 Copyright Permissions for reuse of Figure 5.13




       324
B.8 Copyright Permissions for reuse of Figure 5.13




       325
B.8 Copyright Permissions for reuse of Figure 5.13




       326
B.8 Copyright Permissions for reuse of Figure 5.13




       327
B.8 Copyright Permissions for reuse of Figure 5.13




       328
                                                                         C
                                                                      Colophon

This thesis was created using LATEX 2𝜀 and BibLATEX/Biber wherein the source code was
edited in neovim using the vimtex plugin. The typesetting engine is LuaTeX, Version 1.07.0
(TeX Live 2018). The body copy is set in a 12pt Libertinus Serif text with the section headers
set in Libertinus Sans. A value of 1.618 (golden ratio) is used as the spacing factor between
baselines in the body copy. Source code listings are set in 9pt Latin Modern Mono.




                                             329                                                 ,
</pre>
</body>
</html>
