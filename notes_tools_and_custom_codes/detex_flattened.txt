



pdf.setminorversion(7)
shellesc [debrief]silence
[l2tabu, orthodox]nag

xstring
n .0 ([] 

a-3b,pdf17 18rm .xmpdata filecontents*.xmpdata
     Krishnakumar Gopalakrishnan
https://creativecommons.org/licenses/by-nc-nd/3.0/
 2018 by Krishnakumar Gopalakrishnan. The copyright  of  this thesis  rests  with the  author  and is  made available  under a  Creative Commons  Attribution Non-Commercial  No Derivatives licence. Researchers are free to copy,  distribute or transmit the thesis on the condition  that they  attribute  it, that  they  do not  use  it for  commercial purposes and that they  do not alter, transform or build upon  it. For any reuse or redistribution,  researchers must make clear  to others the licence  terms of this work.
LuaTeX  and pdfx.sty with options 
Lithium-ion batteries electric vehicles mathematical modelling
icc_profiles/coated_FOGRA39L_argl.icc
icc_profiles/sRGB_IEC61966-2-1_black_scaled.icc
LuaTeX  and pdfx.sty with options 
book
Imperial College London
Computational modelling of lithium ion batteries for electric vehicle applications: analysis, design and implementation

 filecontents*

pdfx
tablexcolor
luatexpdflscape
pdfahyperref

title, titletocappendix
makeroomcancel
backend=biber, style=numeric-comp, sorting=none, citestyle=numeric-comp, maxbibnames=50, url=true, doi=true, eprint=false, backref=true, backrefstyle=threebiblatex
margin=10pt, font=small, labelfont=bf, labelsep=quadcaption
type=CC, modifier=by-nc-nd, version=4.0doclicense
normalengord
inlineenumitem
draftfixme
bottomfootmisc
luatex, paper=a4paper, hmarginratio=1:1, vmarginratio=1:1, scale=0.75geometry
local, markgitinfo2
frac, vfrac, multskipmathfixs
sectionplaceins
separate-uncertainty = true, multi-part-units=single, detect-allsiunitx
nottoctocbibind
normalemulem
no-math, quietfontspec
warnings-off=mathtools-colonunicode-math
britishbabel
final, activate=true, nocompatibility, factor=1100, stretch=10, shrink=10, babel=truemicrotype
britishselnolig
newfloat=trueminted
minted, mosttcolorbox
allhypcap
nomain, acronym, xindyglossaries-extra
depth=4, open=true, openlevel=0, numbered=truebookmark
hyphenation, lastparline, nosingleletterimpnattypo
defaultlines=2, allnowidow

 




  


 








     

           

     

    

      

    

    


        










 



 




    
 








 



 

 

LibertinusSerif[Extension         = .otf,
Path              = ./fonts/,
UprightFont       = *-Regular,
BoldFont          = *-Bold,
ItalicFont        = *-Italic,
BoldItalicFont    = *-BoldItalic,
Numbers           = Proportional, Lining,
Ligatures         = TeX, Common, Required,
SmallCapsFeatures = Letters = SmallCaps,
Kerning           = Uppercase, On,
]

LibertinusSans[Extension         = .otf,
Path              = ./fonts/,
UprightFont       = *-Regular,
BoldFont          = *-Bold,
ItalicFont        = *-Italic,
BoldItalicFont    = *-BoldItalic,
Numbers           = Proportional, Lining,
Ligatures         = TeX, Common, Required,
SmallCapsFeatures = Letters = SmallCaps,
Kerning           = Uppercase, On,
]



Latin Modern Mono



 Scale = MatchLowercase 
[] Scale = 1

LibertinusMath-Regular.otf[Path       = ./fonts/,
bold-style = ISO, ]

libertinusmath-bold.otf[Path       = ./fonts/,
bold-style = ISO, version    = bold,
]

[range = ,,,Scale = MatchUppercase]Latin Modern Math

 

   

  

 

     





    




    anchorcolor        = black,
    breaklinks         = true,
    citecolor          = [RGB]0,68,136,     colorlinks         = true,
    final              = true,
    linkcolor          = [RGB]0,68,136,     linktocpage        = true,
    pdfborderstyle     = /S/U/W 1,
    pdfcenterwindow    = true,
    pdfdisplaydoctitle = true,
    pdffitwindow       = true,
    pdflang            = en-GB-oed,
    pdfstartview       = Fit,
    pdftoolbar         = true,
    plainpages         = false,
    unicode            = true,
    urlcolor          = [RGB]0,68,136, 





  





 

 

 






































 



























































 








    >0        
        
        
        
        [ALG@ind@]        1
        <+1
        
    
failed to patch


algorithmic0pt



Initialise:
[]

User data:
[]

Note:
[]



[2][]#1 #2


[NAME]ISREND[2][Unknown]begin Interrupt Service Routine #1(#2)return []resume suspended line in Main()

[NAME]OutputEqnEndOutputEqn[2][x]subroutine ComputeCellVoltage(#2)return  []resume suspended line in Simulatespm





algorithmchapter


algorithm
[ruled]font=small,labelfont=bf,labelsep=quad































    save@pt@#1#2

    #1    #2

pic    ,#1    #1
    
        #1,(0pt,0pt)
    
    save@pt@        
                save@pt@        
        
                by -
        by -
    




mymark









 chapters/backmatter/thesis_refs_bibertool.bib

 


    [datatype=bibtex]
        
            [fieldsource=doi,final]
            [fieldset=url,null]
        
    


english    backrefpage = cited on page,    backrefpages = cited on pages,

pagerefparensbrackets   




    [datatype=bibtex]
        [overwrite]
            [fieldsource=month, match=, replace=1]
            [fieldsource=month, match=, replace=2]
            [fieldsource=month, match=, replace=3]
            [fieldsource=month, match=, replace=4]
            [fieldsource=month, match=, replace=5]
            [fieldsource=month, match=, replace=6]
            [fieldsource=month, match=, replace=7]
            [fieldsource=month, match=, replace=8]
            [fieldsource=month, match=, replace=9]
            [fieldsource=month, match=, replace=10]
            [fieldsource=month, match=, replace=11]
            [fieldsource=month, match=, replace=12]
        
    





    url    urlyear    doi*in:


*
maxnames99    minnames99    uniquename2    citetracker    pagetrackerprenote
labelname    labelname
    
    postnote




  



#1 
#1#2#2
#1 
  #1  #2  #2
#1
#1









 

.pdf, .png, .jpg, .jpeg Ginwidth=0.75 

 


 



note
 

listings
appchapappendixappendices
filePrglistinglistings
filePrgListingListings


equationeqs. (#3#1#4)--(#5#2#6)

 





 

[p-delims = . , p-nudge = 0]
 

[enumerate,itemize,description]topsep=0em

descriptcount
enumdescriptnumdescription1
[enumdescriptnum]     before=0    
 







 



















 

theme=color, marginface=

  





 

  








 

filePrg

[use counter=filePrg,number within=chapter,list inside=mypyg][3][]    listing engine=minted,
    minted language=matlab,
    listing file=#2,
    title=Listing #1,
    listing only,
    list entry= #1,
    enhanced jigsaw,
    breakable,
    minted options=
        fontsize=,
        breaklines,
        autogobble,
        linenos,
        numbersep=3mm,
        mathescape,
        baselinestretch=1,
        breakanywhere=true
    ,
    colback=white,
    colframe=imperialnavy,
    left=5mm,
    overlay=
            [imperiallightgray] (frame.south west) rectangle ([xshift=5mm]frame.north west);
        
    ,
    label=#3


mypyg




listingname=Code snippet  

latexMarginpar on page
titlesecNon standard sectioning command detected
microtypeprotrusion codes list
latexfontFont
latexfontSome font shapes
 


    locale = UK ,
    per-mode = reciprocal-positive-first,
    binary-units = true

range-phrase=--
range-units=single

Ah
Wh

[1]#1 


 

16211em


*0pt1ex plus 0.5ex minus 0.5ex0.22ex plus 0.11ex minus 0.11ex

*0pt1ex plus 0.5ex minus 0.5ex0.22ex plus 0.11ex minus 0.11ex

*0pt0.5ex plus 0.25ex minus 0.25ex0.11ex plus 0.055ex minus 0.055ex

 




 

displaystyle,tikz=font=

 


P[1]>0ptp#1
C[1]>p#1







=    >

+    >







tabular*

















 

calc
decorations.pathreplacing






    O     O     m       m       m           [overlay,remember picture]
        [decoration=brace, amplitude=, aspect=, #2, decorate, thick, draw=blue, text=black, #1]
            () --
            ()
            node [below=, midway] #5;
     








height 0.7ex depth 0.4pt-0.7ex0pt





[1]#1@
























3 3    

 [display]

14050lightgray-0ex
5050
[]




























 








    function myord ( n )         m = n 100     if m>3 and m<21 then tex.sprint ( "th" )
    elseif m 10 == 1 then tex.sprint ( "st" )
    elseif m 10 == 2 then tex.sprint ( "nd" )
    elseif m 10 == 3 then tex.sprint ( "rd" )
    else tex.sprint ( "th" )
    end
    end

[2]#1#2#2



 s o m 

    #1
     *#3 
     #2  [#2]#3   #3  
    ^T

[1]  
  _vect:n  #1   
_new_protected:Npn _vect:n #1

    _set_split:Nnn _tmpa_seq  ,   #1 
    _use:Nn _tmpa_seq  




 














 







9
9
20
9















 

acronymnohyperfirsttrue [acronym]long-short 










[firstplural=States of Charge (SOCs)]socSOCState of Charge
[firstplural=Akaike's Information Criteria (AICs)]aicAICAkaike's Information Criterion

adcADCAnalog to Digital Converter
aerAERAll-Electric Range
armaxARMAXAuto Regressive with Moving Average and Exogenous Inputs
arxARXAuto Regressive with Exogenous Inputs
bevBEVBattery Electric Vehicle
bmsBMSBattery Management System
boldBOLDBattery Optimal Layer Design
casCASComputer Algebra System
cccvCCCVConstant Current Constant Voltage
cpuCPUCentral Processing Unit
cpCPConstant Power
dacDACDigital to Analog Converter
daeDAEDifferential Algebraic Equation
dfnDFNDoyle-Fuller-Newman
dftDFTDiscrete Fourier Transform
dmcDMCDimethyl Carbonate
draDRADiscrete-Time Realisation Algorithm
ecmECMEquivalent Circuit Model
ecECEthylene Carbonate
eisEISElectrochemical Impedance Spectroscopy
emcEMCEthyl Methyl Carbonate
eraERAEigensystem Realisation Algorithm
etfeETFEEmpirical Transfer Function Estimate
fdmFDMFinite Difference Method
fftFFTFast Fourier Transform
frfFRFFrequency Response Function
fvFVFinite Volume
gittGITTGalvanostatic Intermittent Titration Technique
gpmGPMGalerkin Projection Method
iceICEInternal Combustion Engine
imaIMAIntegral Method Approximation
isrISRInterrupt Service Routine
ivpIVPInitial Value Problem
ivIVInstrumental Variable
lcoLCOLithium Cobalt Oxide
lfpLFPLithium Iron Phosphate
lhsLHSLeft-Hand Side
ltiLTILinear Time-Invariant
maeMAEMean Absolute Error
mdlMDLRissanen's Minimum Description Length
mggpMGGPMulti-Gene Genetic Programming
mimoMIMOMulti Input Multi Output
mpmMPMMarkov Parameter Matrix
ocpOCPOpen Circuit Potential
ocvOCVOpen Circuit Voltage
odeODEOrdinary Differential Equation
oeOEOutput Error
olsOLSOrdinary Least Squares
p2dP2DPseudo Two-Dimensional
pbmPBMPhysics-Based Model
pdaePDAEPartial Differential Algebraic System
pdePDEPartial Differential Equation
phevPHEVPlug-in Hybrid Electric Vehicle
pmsmPMSMPermanent Magnet Synchronous Motor
pp2dPP2DPolynomial Profile P2D
prbsPRBSPseudorandom Binary Signal
pwlPWLPiecewise Linear
qssQSSQuasi-Steady State
ramRAMRandom Access Memory
rbsRBSRandom Binary Signal
rgsRGSRandom Gaussian Signal
rhsRHSRight-Hand Side
rmsRMSRoot Mean Square
romROMReduced Order Model
seiSEISolid-Electrolyte Interphase
simoSIMOSingle Input Multiple Output
sisoSISOSingle Input Single Output
snrSNRSignal to Noise Ratio
soapSOAPState of Available Power
sovSoVSeparation of Variables
spdtSPDTSingle Pole Double Throw
spmSPMSingle Particle Model
ssaSSASingular Spectrum Analysis
svdSVDSingular Value Decomposition
uddsUDDSUrban Dynamometer Driving Schedule
vopVOPVariation of Parameters
xeVxEVBattery Electric/Plug-in Hybrid Electric Vehicle
zohZOHZero Order Hold



  













 



arabic 

[link, pages=-, pagecommand=plain]coverpage.pdf


plain


*Declaration of Originality 



I declare  that the material presented  in this thesis  is the result of  my own
research except  for specific portions wherein  contributions from collaborators
are acknowledged. Throughout this thesis, references are made to other published
works and  these have been appropriately  cited. The material contained  in this
thesis has  not been  submitted, either  in whole or  in part,  for a  degree at
Imperial College London or any other university.



        @p.4inp2.1in@
            & <Picture black_ink_sign_from_jpg>

            Signed: & 

                    & Krishnakumar Gopalakrishnan 

                    & October 02, 2018

                    & London 

        


*Declaration of Copyright




[b]0.3275
    <Picture chapters/backmatter/doclicense-CC-by-nc-nd.pdf>


*0.0225
[b]0.65
    The    copyright    of    this     thesis    rests    with    the    author.
    Unless   otherwise    indicated,   its    contents   are    licensed   under
    a   https://creativecommons.org/licenses/by-nc-nd/4.0/Creative
    Commons   Attribution-NonCommercial-NoDerivatives  4.0   International  (CC
    BY-NC-ND 4.0) Licence.


Under this licence, you may  copy and redistribute the material in any
medium or format on the condition that; you credit the author, do not use it for
commercial purposes  and do not distribute  modified versions of the  work. When
reusing or sharing this work, ensure you  make the licence terms clear to others
by naming  the licence and linking  to the licence text.  Please seek permission
from the copyright  holder for uses of  this work that are not  included in this
licence or permitted under UK Copyright Law.



 


chapters/frontmatter/

*Dedication





    
    




    
    
    <Picture narayam_sanskrit.pdf>
    The image `Thaliyola.jpg' (on which the Gita verse
        is overlaid by this thesis author) was sourced from Wikimedia Commons and is licensed CC-BY-SA 2.5



 1.348361657291667 

*Abstract
tocchapterAbstract



The  realisation of  pbm  of lithium  ion cells  in  the bms  of
electric  vehicles is  studied through  a three-pronged  strategy ---  analysis,
design  and  implementation.   The  survey  of  literature   undertaken  in  the
backdrop of  this broad landscape  reveals a  dearth of model-based  designs for
automotive-grade  pouch  cells,  which  is therefore  addressed  in  this  work.
Perusal of  prior art in  reduced-order battery modelling provides  key guidance
on  topics meriting  further  investigation  the  dra  scheme and  the
electrolyte-enhanced spm which are  therefore carefully analysed here from
the perspective of  their embedded implementation. Owing to  its familiarity and
wide-spread popularity among relevant stakeholders, the p2d implementation
of  the dfn  model  is used  as the  pbm  underpinning all  research
presented herein.

A  computational framework  to  optimise the  number  of electrochemical  layers
within a pouch  cell is developed. The chosen  optimality criterion specifically
addresses the  two most pertinent  issues that currently hinder  the mass-market
adoption of electric vehicles --- range anxiety and fast charging. Driven by the
need  for  a balanced  capacity  loading  at  both electrodes,  a  deterministic
criterion for  computation of  electrode thicknesses  is formulated.  The search
space of layer choices across all  thermal scenarios is traversed with the least
operation  count through  a novel  application of  the binary  search algorithm.
Numerical  simulations of  a lumped  thermal  model coupled  with the  p2d
electrochemical  model in  conjunction with  judiciously chosen  exit conditions
help  to inform  the  number of  layers  needed to  maximise  the cell's  usable
capacity  whilst  simultaneously  satisfying  the  power  requirements  of  fast
charging.  The p2d  model is  reformulated to  accord it  with the  innate
ability to  accept power  inputs. The model-led  optimal layer  design procedure
thus developed  is plating-aware, facilitating  the extension of  pack lifetimes
whilst helping to bypass expensive empirical prototyping.

Owing to its simplicity, the spm family of models is deemed to be the most
promising  rom candidate  that  can usher  in the  use  of pbm  in
electric vehicles.  An in-depth  analysis of the  spm reveals  an inherent
mismatch  between  the accuracies  of  its  voltage and  soc  predictions,
thereby rendering it unsuitable as the  plant model in state-estimation tasks. A
comprehensive evaluation  of the  salient electrolyte-enhanced  spm from
literature reveals that most solutions  are either mathematically intractable or
overly  simplistic. For  the ionic  concentration in  the electrolyte,  analysis
of  the quadratic  approximation  model, which  straddles  the boundary  between
computational complexity and mathematical  tractability, reveals a poor temporal
performance particularly  at the  current collector  interfaces. However,  it is
capable of  delivering acceptable  levels of accuracy  in computing  the spatial
profile of ionic concentration. Application  of the mggp technique exposes
that the  causal factor for this  mediocre temporal performance is  the equation
deficiency of the underlying p2d model.

From an implementation perspective, the discrete-time formulation of spm
is presented  by using the matrix  exponential approach and its  advantages over
its continuous-time counterparts enumerated.  Despite its inherent shortcomings,
it  is  deemed  that  operating  within the  confines  of  the  well-established
foundations of  the p2d dynamics  represents a definitive step  forward in
bringing  into fruition  the goal  of incorporating  pbm into  vehicular
bms. Therefore,  the existing quadratic approximation  model is retained
for  the   electrolyte  spatial  concentration,  whilst   advocating  the  novel
application  of  a  system  identification method  for  its  temporal  dynamics.
After  establishing  linearity  and  time-invariance  of  the  subsystems  under
consideration, discrete-time transfer functions of  the number of moles per unit
area of  lithium ions in each  electrode region is identified  for the pertinent
range of applied  currents. The identified transfer functions  are then employed
in a  composite spm which  demonstrates superior accuracy compared  to the
incumbent state of the art electrolyte-enhanced spm, thereby demonstrating
a  substantial accomplishment  from  an implementation  viewpoint. Although  the
advancements herein are reported for an isothermal implementation of the models,
future  enhancement through  thermally coupled  model derivations  is advocated.
Finally,  the  importance of  parametrisation  of  the underlying  pbm  is
acknowledged as a  crucial unsolved aspect which needs the  collective effort of
the battery research community.






 
[link, pages=-, pagecommand=plain]project_outputs.pdf





protrusion=false [chapter]toc 


1.1 




tocchapterList of Algorithms tocchapterList of Program Code [*]mypygList of Program Code 

1.0 
[type=acronym, title=List of Acronyms, nonumberlist, style=super]

protrusion=true 






1.348361657291667 0


chapters/introduction/figures/
Introduction



Tightening emissions  regulations in various  industrial sectors
have led  to a renewed interest  in sustainable energy sources  in recent years.
In  particular,  the  burgeoning  demand  for  clean  energy  has  prompted  the
automotive and  consumer electronics industries  to explore advanced  methods of
energy storage . Li-ion batteries 









  are  seen  as  key
enablers  in this  quest due  to  the attractiveness  of their  high energy  and
power  densities compared  to  other competing  non-conventional energy  storage
technologies .  However, with  this  surge  in energy  storage
demands  comes  stricter  requirements  for  cell  longevity,  performance,  and
adhesion  to  safety  requirements,  particularly  for  adoption  in  mainstream
transport  electrification .  In  contrast to  other  incumbent
technologies,  lithium-ion cells  have several  advantages such  as high  energy
density,  long life-cycles,  low internal  resistance, low  self-discharge, long
cycle life,  fast charge  and discharge  cycles . This
makes them the preferred choice for storage and on-demand retrieval of energy in
modern consumer electronics and xeV.





Working Principle

This section  provides a  brief overview of  the essential  chemistry principles
that  helps  to  describe the  working  principle  of  a  lithium ion  cell  and
represents the author's digested summary  of the introductory concepts presented
in Plett .

fig:chargetransferprocess depicts the construction of one electrochemical
layer of a lithium ion cell. The positive electrode consists of porous particles
of  Lithium-Transition  Metal  Oxide  (MO)  compounds.  The  negative  electrode
typically employs some variant of microporous graphite. The porous nature of the
electrodes provide pathways for lithium  ion conduction through the electrolyte.
Due  to  the  special  construction  of the  electrode  structure,  there  exist
interstitial  sites  which act  as  intercalation  spots for  lithium  shuttling
between the two electrodes. The electrolyte, which floods the cell, helps in the
conduction of Li^+ ions. The separator membrane allows the passage of these
ions  between  the  two  electrodes,  but  prevents  internal  short-circuit  by
inhibiting electronic  conduction through it. The  current collectors facilitate
passage of electrons generated during the charge transfer at particle surface to
the external circuit.








At the fully charged condition, the majority  of lithium in the system is stored
within the negative electrode  microstructure. During discharge, Li^0 atoms
diffuse out of  deep interstitial sites towards the surface  of the particles in
the  negative  electrode.  At  the  surface  (electrode-electrolyte  interface),
a  charge-transfer  process  takes  place according  to  Butler-Volmer  kinetics
(see  eq:butlervolmer), leading  to the  formation of  Li^+ ions and
electrons. The electrons are passed to  the external circuit through the Cu
current collectors  onto which  the conductive matrix  composed of  the negative
electrode material and binders is  coated. The Li^+ ions travel through the
electrolyte phase,  crossing the  separator membrane  to the  positive electrode
where they  encounter an  electron influx  from the  external circuit.  A charge
transfer  reaction  takes  place  at  the  surface  of  the  positive  electrode
particles, leading to the formation of neutral Li^0 atoms that diffuse into
the positive electrode microstructure.

During  the   charging  process,  the   reverse  phenomena  occur.   Lithium  is
de-intercalated  from  the  positive  electrode and  a  similar  charge-transfer
happens  at  the surface,  leading  to  the  formation of  Li^+ ions  which
reach  the  negative  electrode  by   passing  through  the  separator.  At  the
surface of  the negative electrode  particles, these ions absorb  electrons from
the  external  circuit,  leading  to the  formation  of  neutral Li^0  that
diffuses  into  interior  vacant  spaces  in  the  layered  graphite  electrode.
eq:NegElectrodeRxn,eq:PosElectrodeRxn summarise the  reactions during the
charging and discharging process at the surfaces of both electrode materials.

    Li_ C                            &<=>[discharge][charge] C +  Li^+ +  e^-

    Li_1- M O2 +  Li^+  +  e^- &<=>[discharge][charge] LiMO2

where    M represents    a    transition   metal    compound   such    as
Ni_1/3Co_1/3Mn_1/3 (NMC),   Ni_0.8Co_0.15Al_0.05 (NCA)
amongst other  choices . Assuming  no loss of  cycleable lithium
due to  parasitic side  reactions or  through other  mechanisms, the  process is
fully reversible.


The electrochemical potential at each electrode  is dependent upon the extent of
its  lithiation. An  empirical  relationship of  each  electrode's potential  as
a  function  of  its  stoichiometry  can be  obtained,  and  is  dependent  upon
the  specific design  and  material  properties of  each  active material  under
consideration. Finally, the ocv of the cell is obtained by subtracting the
negative electrode potential from its positive electrode counterpart.


Battery Modelling

Through accurate model representations  of the electrochemical-thermal behaviour
of  the cell,  advanced monitoring  and control  strategies can  be deployed  to
tackle  the current  research  topics  in Li-ion  batteries  such as  increasing
cycle-life,  improving  operational   safety  and  performance .
Over  the past  two  decades, efforts  have  been made  to  construct models  to
describe  the physical,  electrical, thermal,  electrochemical and  system-level
performance  of  Li-ion cells,  leading  to  modelling strategies  with  various
levels  of   sophistication.  For   the  interested   reader,  the   article  by
Grazioli   provides  a broad introduction to  the topic
of computational  modelling of  lithium ion batteries.  Large in-roads  into the
depth of the modelling  art can be made by perusing  comprehensive books on this
topic such  as those by  Plett , Hariharan ,
and Rahn and Wang .

The  need  to  address  the  operational challenges  of  lithium  ion  batteries
in   an   embedded   environment   such  as   on-board   an   electric   vehicle
has   led   to  an   increased   impetus   on   the  development   of   advanced
bms . In vehicular  applications, the only measurable
quantities  of  a  lithium  ion  cell are  its  terminal  voltage,  current  and
temperature. This implies  that several internal states of the  cell such as its
soc, whose  real-time computation is  vital to the optimal  performance of
the cell, need to be estimated from these available measurements. Therefore, the
performance  of  a bms  for  tasks  such  as  online state  estimation  is
dependent upon the  fidelity of the underlying cell  model. Sophisticated models
of  the  cell enable  these  quantities  to  be  estimated more  accurately  and
facilitate the implementation  of advanced control algorithms.  Therefore, it is
imperative  that  the cell  model  used  is suitable  for  being  embedded in  a
real-time bms.

Most battery  models have the primary  goal of accurately predicting  the cell's
terminal  voltage  at each  time-step.  This  is so  that  the  output from  the
predictor routine  can be compared  to the  measured voltage and  the difference
between  them may  be used  in a  suitable corrector  routine to  improve future
predictions. The  combined information  from the model  and measurement  is then
blended in a suitable way to estimate the cell's soc.

More   advanced  models   strive   to  provide   insight   into  various   other
physico-chemical quantities  that could affect  the cell's health. The  field of
Li-ion battery modelling can be classified into two broad categories
---
*[label=*)]
    empirical/ad-hoc ecm, and
    detailed  pbm that are based  upon first principles.

A  comprehensive summary  of  various models  that  belong to  each  of the  two
categories  is  discussed  in Seaman  .  A  characteristic
aspect that contrasts  them is the fact that they  are typically
at loggerheads with each other in terms of their computational complexity.

ecms

ecm  employ circuit  elements  such as  voltage  sources, resistors  and
capacitors to  model the behaviour  of batteries at their  electrical terminals.
The cell's  thermal subsystem may  also be  modelled by an  analogous electrical
circuit. The  parameters of the  circuit are  typically functions of  the cell's
current, soc and  temperature. These can be incorporated as  a lookup table by
curve-fitting  the model  to experimental  data. Using  such equivalent  circuit
models, two simple methods are available to compute the cell's soc ---
*[label=*)]
    by using manufacturer-supplied  lookup table or graph of ocv versus soc, and
    by numerically integrating the charge passed in and out of the cell over time (commonly referred to as coulomb counting).

Both methods are computationally  amenable for small-scale embedded applications
such as  consumer electronics; however, neither  one is robust enough  to handle
the stringent demands in performance imposed by modern vehicular applications.

Advanced state estimation algorithms such  as nonlinear Kalman filters may still
be able to use ecm as the plant model and obtain reasonable estimates of
the  cell's  soc . However,  the  usefulness  of
ecm is limited by the fact that their parameters are derived essentially
by a  curve-fitting process using a  standard set of training  data. Since these
models are  not based on  any physical phenomena,  their ability to  predict the
cell's general behaviour  is extremely poor especially when  subject to current
profiles well  outside their training  realm. Another important  disadvantage of
equivalent circuit  models is that they  do not allow insights  into the various
internal states of the cell.

ecm  of  lithium  ion  batteries   have  been  extensively  studied  and
are  widely  applied.  However,  the aforementioned  difficulties  render  their
reliability and  accuracy questionable,  especially under highly  demanding load
profiles  experienced by  the battery  packs in  xeV. The  boundaries of
their  performance have  been well-quantified  (see ).
Although  various estimation  and control  algorithms continue  to be  developed
around them, the  ecm themselves are no longer the  subject of extensive
research. Hence, this thesis does not discuss them further.

pbms

pbm

pbm consist of  governing equations that construct a  realisation of the
behaviour of the cell based  upon electrochemical principles such as equilibrium
thermodynamics,  material  diffusion  and  reaction  kinetics.  The  fundamental
advantage  to this  modelling approach  is that  it is  possible to  compute the
evolution of  internal states of  the cell  for arbitrary current  profiles. The
difficulty with  the physics-based  modelling approach  lies with  obtaining the
values  of all  the physical,  geometric, electrochemical,  thermal and  kinetic
parameters  of the  cell. Usually,  these parameters  are closely  guarded trade
secrets by cell manufacturers.

In  some  cases, it  may  be  possible to  obtain  a  subset of  these  physical
parameters   by  dissecting   cells  in   an  inert   environment  followed   by
further  characterisation   using  specialised  lab  equipment.   For  instance,
Ecker     demonstrate   the    reverse-engineering   of   a
7.5 pouch  cell by Kokam  Ltd. in  order to obtain  its physical
parameters. Nevertheless,  this is a tedious  process and is feasible  only with
access  to  such sophisticated  lab  equipment.  Furthermore, the  results  from
these  experiments are  susceptible to  characterisation  errors as  well as  to
cell-to-cell variations due to production spread. Therefore, some form of system
identification method  needs to be employed  for estimating the majority  of the
physical  parameters required  for  a  pbm. Furthermore,  it  is a  common
practice to  rely on published  data for the  values of certain  cell parameters
that do  not depend on physical  construction, especially for those  that remain
universally true for a particular Li-ion chemistry.

The challenges involved  in model parametrisation is a research  exercise of its
own merit and  is not addressed in  this thesis. A redeeming factor  is that the
task of  parametrisation is a  one-off problem that  appears early in  the model
deployment  stage,  after which  the  rewards  of  superior performance  of  the
pbm can be reaped. Once  the model parameters are available, pbm
can be used in  aiding a deeper understanding of the working of  the cell and in
answering research  questions that could  otherwise not be answered  with simple
ecm. One area  of focus of this  thesis is to broach  a less-probed area
--- exploring  the possibility  of using  a pbm  for the  design of
pouch  cells  used  in  automotive  applications which  shall  be  presented  in
ch:modelbaseddesign.

A major disadvantage of pbm from an implementation point of view is that
solving for  the model's field  variables is time-consuming. In  particular, the
more  sophisticated  pbm  require  the use  of  multi-physics  pde
solvers  and  hence  are  not  typically  suitable  for  embedded  applications.
Nevertheless,  for   high  performance   applications  such  as   in  automotive
bms  wherein   state-of-health  monitoring  is  crucial,   there  is  an
overwhelming  demand for  obtaining insight  into internal  cell variables.  For
instance, the real-time computation of surface concentration of Li^0 in the
solid particles enable the bms to regulate  power flow into and out of the
cell to proactively avoid plating and degradation of the cell.

In view of this consideration, model  order reduction techniques are seen as key
enablers that facilitate in porting the first-principles based predictive powers
of pbm  into a  real-time microcontroller.  This thesis  shall therefore
have  a  strong  focus  on  both the  analysis  and  implementation  aspects  of
rom.

The dfn model

Doyle,  Fuller and  Newman   developed an  isothermal
physics-based  porous electrode  model of  the  cell capable  of describing  its
internal variables such as
*[label=*)]
    potential on the solid particles ,
    potential in the electrolyte solution ,
    concentration of Li^0 in the solid particles ,
    ionic concentration in the electrolyte solution , and
    molar flux density of lithium at the solid-electrolyte boundary .

The most popular computational implementation  of the dfn equations is the
p2d  model . In  the p2d  implementation, all  field
variables  of  the  dfn  model  are  computed  at  each  spatial  location
along  the axial  thickness of  the cell.  However, the  solid concentration  in
spherical electrode particles  is solved in a radial co-ordinate  system that is
perpendicular to  the axial  direction of  the cell's  thickness. The  axial and
radial dimensions are coupled at each  particle's surface through the molar flux
density  describing the  rate of  pore-wall flux  that crosses  from solid  into
electrolyte  or  vice-versa.  The  equations and  boundary  conditions  for  the
p2d implementation of the dfn model is shown in tbl:dfneqns.














































































 
In  this  thesis,  this  p2d  implementation of  the  dfn  model  is
considered as  the reference (and  only) pbm. Although  thermal dependence
of  parameters  such  as  electrolyte  conductivity  and  diffusivity  is  shown
in tbl:dfneqns, a sophisticated description  of detailed thermal dynamics
 a description  of spatio-temporal evolution of cell's  temperature using a
set of ordinary/partial  differential equations is not considered  in this work.

For those aspects of this thesis dealing with the analysis and implementation of
various  rom and  the  improvements  imparted herein  to  them, only  an
isothermal  implementation  (at  298.15) of  the  p2d
equations  is  considered.  The  performance  of  the  various  rom  are
compared  against this  reference benchmark.  In consideration  of the  relative
sparsity of  such detailed analysis  of rom in existing  literature (see
ch:littreview),  the  author  of  this  thesis  considers  that  such  an
analysis, albeit isothermal, is  the need of the hour and  is imperative to gain
a  deeper  understanding  of  the  performance  boundaries  of  various  popular
rom.



Since temperature  plays a crucial  role in the  operation of cells  and battery
packs in xeV,  an isothermal model is unsuitable for  design purposes. A
model-based design that does not consider thermal effects is likely to stray far
from the operating regimen and fail  spectacularly. On the other hand, including
a sophisticated thermally coupled model  is unlikely to yield significant gains.
Firstly, running  fully coupled electrochemical-thermal model  based simulations
over the entire design space  is computationally expensive. Secondly, the design
results  of the  model have  to  be anyway  verified using  a reasonable  number
of  experimental prototypes.  Taking  into account  these  considerations it  is
deemed  that, for  the design  aspect  of this  thesis, a  lumped thermal  model
suffices.  This  simplified thermal  model  is  bidirectionally coupled  to  the
p2d equations  (see tbl:dfneqns)  of the electrochemical  model and
is  used as  the  pbm  underpinning the  model-based  design discussed  in
ch:modelbaseddesign.

The rest of the thesis is organised as follows. ch:littreview presents an
overview of pertinent modelling art.  The literature on model-based design shall
be  evaluated  here and  the  present  shortcomings  identified. The  survey  of
literature  also  considers the  advancements  in  the  field of  reduced  order
modelling from  their analysis and implementation  perspectives. A computational
framework  for  optimising the  number  of  layers  within an  automotive  pouch
cell  is  presented  in  ch:modelbaseddesign.  In  ch:improveddra,
the  computational   bottlenecks  in   a  specific  rom   method   the
dra is  analysed in  detail and  an improved  alternative is  proposed. In
ch:spmanalysis,  the simplest  time-domain  pbm,  the spm  is
introduced  and  its  performance  is analysed.  Salient  advancements  made  to
the  basic spm  in the  literature  are presented  and their  shortcomings
analysed. A  discrete-time formulation focusing on  the numerical implementation
aspects is  also presented. In ch:newelectrolytemodel,  the causal factor
for  the lacklustre  performance  of  a state  of  the art  electrolyte-enhanced
spm is  unearthed. Additionally, ch:newelectrolytemodel  proposes a
new  electrolyte  model which  represents  a  novel  application of  the  system
identification technique. The superior  performance of this electrolyte-enhanced
composite spm  is demonstrated. Finally,  ch:conclusions highlights
the salient  conclusions that can be  drawn from the findings  presented in this
thesis and paves  the way for future research by  identifying key unsolved tasks
in physics-based battery modelling for such automotive applications.













 1



chapters/litt_review/figures/



Review of Literature
[chapters]
[chapters]11




This chapter  discusses the  state of  the art  in the  field of
lithium ion battery modelling pertinent  to the research sub-topics discussed in
this thesis.  Consequently, the modelling  art is  presented in two  parts, each
providing a critical review of
[topsep=0pt, before=*-0.25]
    the body of literature discussing model-based design of lithium ion cells.
    prior works dealing with the analysis and implementation aspects
        of reduced order modelling of lithium ion cells.


 
Model Based Design for Batteries: Overview of Prior Art






Introduction

In  sharp  contrast to  the  cornucopia  of  published literature  dealing  with
reduced order modelling of cells (see sec:classificationscheme), there is
currently  a relative  paucity  of  prior art  that  discusses model-based  cell
design. Albeit the relevant pool of  knowledge is presently sparse, this section
nevertheless aims to critically evaluate it.

At the outset, it is important to  clarify this thesis author's general views on
model-based design. It is  also important to state why this  topic was chosen as
an  aspect of  this  thesis. In  the recent  decades,  industries pertaining  to
different  walks of  life,  cutting across  any one  discipline,  have begun  to
establish a model-led product/process development culture. For instance, a broad
overview of  industrial research policy by  Thomke  towards the
turn of  the last  millennium provides quantifiable  evidence that  a simulation
based design  approach in the automotive  industry has had a  positive impact in
the  crash-worthiness of  resulting  vehicular  designs. At  a  high level,  the
salient benefits of any model-based design include ---
*[label=*)]
    reducing the number of design iterations thereby speeding up the time to a production-ready prototype, and
    facilitating improved understanding of the variables influencing design that is gained by formalising empirical/ad-hoc knowledge through modelling.

Furthermore, it  is a well-known fact  that computer time is cheaper  than human
time. Therefore, with a simulation-oriented design approach, it is often cheaper
to  explore  Monte Carlo-like  design  scenarios using  a  computer  model  than
iterating over a series of rudimentary  prototypes in the lab. Finally, once the
results predicted  by the  model have  stabilised enough  to satisfy  the design
specifications, prototypes closely  matching the final design  objectives can be
realised, thereby reducing the overall lead time to the market.

The   aforementioned    views   of    the   thesis    author   is    echoed   by
Becker    who present  a  persuasive view  that, since  it
shall be  mandatory to have  a deeper understanding  of the simulation  tools in
order  to successfully  employ a  model-led  design, this  can trigger  sweeping
changes percolating  into the  very core  of the  problem-solving culture  in an
organisation. Although relatively  at its infancy when it comes  to cell design,
model-based designs have been applied at the battery pack-level in the past, and
is therefore not a newcomer to the battery industry in general. In the middle of
the  last decade,  a clarion  call  for industry  to adopt  simulation tools  in
battery  engineering was  issued  by Spotnitz .  In the  said
article,  the author  questioned  the anachronistic  industry  trend of  relying
heavily on `making and testing' rather than aiming to understand the fundamental
governing equations  and principles  of a  battery and  using this  know-how for
design.  Spotnitz  further argues  that  using  pbm of  batteries  could
provide reliable understanding of their behaviour and that, as the understanding
of the community steadily grows, it  could bring about a significant speed-up of
battery development.

The nature and  scope of `model-based design' as intended  by this thesis author
needs to  be clarified. Since  this thesis focuses exclusively  on physics-based
modelling,  the  term  `model'  as  used  here  pertains  to  pbm
(pbm) and not to ecm or any other type of battery models
including other empirical/ad-hoc models such as surrogate models. Therefore, the
survey of  literature here  does not  include any  prior efforts  on model-based
design that lie outside of this scope.

Among  the published  set of  literature, there  is evidence  that computational
modelling  has  been   successfully  used  to  facilitate   the  development  of
novel   energy   storage   materials.   The  review   article   by   Islam   and
Fisher  provides an  overview of the use  of computer simulation
to gain  a deeper insight  into the working of  new types of  cathode materials.
Meng  and  Arroyo-de Domp   also  surveyed  the  topic  of  using
computational tools for the design and optimisation of energy storage materials.
The computer models referred to in these review articles are not volume-averaged
models operating  at the cell-level,  but detailed ab-initio  models constructed
using techniques such as Density Functional Theory (DFT). While it is heartening
to see such  comprehensive studies of computational techniques  being applied to
energy storage, there are two distinct reasons why the body of research reviewed
in  the aforementioned  articles do  not align  with the  goals of  this thesis.
Firstly,  in  the  works  reviewed  in  the  aforementioned  articles,  computer
simulation is  used primarily to  enhance researchers' current  understanding of
these materials that  can help to develop the next  generation of energy storage
components. The computational methods  presented therein are not directly
employed as design  tools. Secondly, these articles  use computational modelling
to study  structural properties  at the  meso and nano  scales. While  these are
of  utmost importance  to  researchers involved  in  synthesising prototypes  of
next  generation  of  energy  storage  materials, they  are  less  relevant  for
production-ready cell-designs at scale. Since this  thesis has a strong focus on
providing readily  applicable solutions  to industry  for incumbent  lithium ion
chemistries,  it  was  decided  not  to pursue  the  methods  discussed  in  the
aforementioned works for the design studies discussed herein.

A      holistic      computational      screening     was      performed      by
Sendek    to  study  the  suitability  of  12831 candidate
materials for their  suitability as solid state  electrolytes in electrochemical
cells. These  authors cite the  same rationale  of this thesis  author  rapid
prototyping, as the motivation behind  their model-based design simulations. The
study helped to  prune the initial candidate pool down  to just 21 viable family
structures. This effort  serves as a concrete example in  this literature survey
wherein computer simulation is directly used  as a design tool for components of
a lithium  ion cell. The  scope of  the aforesaid work  falls into the  realm of
material  synthesis  and applied  physics  ---  topics outside  the  educational
background and  expertise of  this thesis author.  Nevertheless, the  success of
this effort  strongly motivates  the case for  performing a  computational study
of  similar scale,  wherein  instead  of screening  out  thousands of  candidate
materials, the framework presented in ch:modelbaseddesign computationally
screens out thousands of layer configurations within a pouch cell.

Curiously,  the  use  of  volume-averaged   models  for  design  simulations  of
pbm  at the  cell-scale has  not  yet gained  sufficient traction.  This
is  despite  the prevalence  of  the  popular  p2d implementation  of  the
dfn  model in  areas such  as degradation  analysis and  state-estimation.
Ramadesigan   postulate  that this slow  uptake could
be attributed to the computational challenges presented by the complex reaction,
diffusion and kinetics of lithium ion  cells occurring over different length and
time scales. A few design efforts using electrochemical models at the cell scale
have  nevertheless been  reported  in  literature, which  are  examined next  in
sec:cellscaledesignlittreview.

State of the art in cell-scale model-led design optimisations

The  pioneering work  by  Newman   was the  first  of its  kind
to  develop  a scheme  to  optimise  cell  design  based on  an  electrochemical
model. The two  parameters optimised were electrode  thicknesses and porosities.
The  aforesaid study  makes  the  assumption that  electrode  kinetics are  fast
relative to diffusion, and furthermore  ignores local concentration gradients. A
reaction-zone model, which considers that reactions occur in a narrowly confined
area, was used  as the underlying model. The separator  thickness was assumed to
be  fixed and  the  specific energy  of  the cell  was  maximised. However,  the
aforesaid work does  not impose any constraints on the  extent of specific power
that can be drawn from the  cell. Nevertheless, this seminal effort provided the
key guidance to other researchers  that electrode thicknesses and porosities can
be considered  as the critical  design variables to be  optimised for in  a cell
design. Building  upon the foundation  laid by  the aforementioned study,  a few
other model-led design efforts have been published. However, in order to provide
a focused review,  only a subset of  the prior art that is  deemed pertinent for
the model-based design of  pouch cells for automotive applications
is considered here.

Arora    used an  electrochemical  model  to inform  design
decisions on cell parameters such as particle size, electrode thickness and mass
ratio. Furthermore, the model thus obtained was used to optimise the cell design
against the  risk of lithium  plating. Cells  are susceptible to  plating during
fast charging and  hence, this is a  key aspect to consider in  their design for
electric  vehicles. This  thesis  author  considers this  contribution  to be  a
vanguard  in model-based  design for  cells that  is potentially  applicable for
vehicular applications. Nevertheless, the aspect of stacking layers inside pouch
cells  and how  this influences  the optimisation  of the  aforementioned design
variables has not been studied.

Xue    presented a  simulation based  design study  wherein a
cell design  was optimised using  a gradient-based algorithm.  Specifically, the
said  work dealt  with  a  numerical framework  for  providing automated  design
outputs for maximising  the cell's energy density whilst  meeting specific power
density  requirements. This  criterion  appears  to be  highly  relevant in  the
context of cell design for electric vehicles and hence, was adopted as the basis
for the layer optimisation framework presented in ch:modelbaseddesign. In
the aforementioned  work, various power  levels were also tried.  However, these
power requirements were  computed indirectly rather than  a direct reformulation
of the p2d model to accept power density inputs.

The  design   study  by  Xue    represents   a  rare  example
of  a  model-led  design  attempt  performed  in  the  backdrop  of  electrified
transportation.  In  the  said  work, an  electrochemical  cell  model   the
p2d model was successfully adapted to perform the design optimisation of a
phev. Although the underlying model operates at the cell-scale, this study
considers  a  pack-level  optimisation  through  a  series-parallel  combination
of  cells.  Furthermore, an  advanced  numerical  algorithm  in  the form  of  a
hybrid  solver was  used. This  solver adopted  a unique  scheme of  employing a
gradient-free optimiser in conjunction with a gradient-based optimiser. Albeit a
standout example  in the  context of vehicular  application, the  aforesaid work
falls slightly  outside the  scope of  this thesis wherein  the design  study is
strictly confined  to be at  the cell level.


The  article  by  Xue    does take  into  account  pack-level
constraints  such  as  safety  limits  as  well  as  energy  and  power  levels.
Furthermore,  these authors  even accounted  for important  details such  as the
presence  of layers  within  each  cell in  their  design optimisation  process.
The  system-level   constraints  considered  in   Xue    were
instrumental  in  informing  the  choice  of constraints  in  the  design  study
presented in ch:modelbaseddesign. However, in the aforementioned article,
the translation from pack-level into  cell-level quantities does not account for
secondary effects  the  influence of layers on pack mass  (a quantity that is
optimised in the said publication) is not studied. Simulations conducted as part
of the work reported in ch:modelbaseddesign reveals that such effects are
non-negligible.



A critical issue in the approach  by Xue   is that the number
of design variables were excessively large which necessitated the use of complex
numerical  algorithms. The  said  work  assumes that  cell  design  shall be  an
integral part  of pack optimisation.  However, in real-world designs,  cells are
sourced from a  specialised manufacturer. Furthermore, these  cells are designed
independently to merely  adhere to certain specifications .
Pack configuration  decisions such  as the choice  of number  of series-parallel
modules in  the vehicular pack are  undertaken at a system  level in conjunction
with the  rest of the  drivetrain specifications by vehicle  manufacturers. This
natural separation  paradigm helps  to decouple  the cell  design from  the pack
design  thereby  drastically reducing  the  number  of  degrees of  freedom  and
simplifying  the optimisation  task.  This is  a key  assumption  in the  design
optimisation study presented in ch:modelbaseddesign.

A  comprehensive multi-objective  optimisation for  optimal design  of batteries
was  recently  proposed  by  Changhong  Liu  and Lin  Liu .  This
optimisation  involved a  multiphysics model  of the  cell wherein  a number  of
design variables  such as electrode  thicknesses, porosities and  particle sizes
were considered. The optimisation objectives were to maximise the specific power
and specific energy  during discharge as well as to  minimise capacity loss. The
model  was solved  by  using a  genetic algorithm.  While  this contribution  is
certainly  the first  of  its kind  to use  a  formal mathematical  optimisation
framework for cell design, in the  opinion of this thesis author, the complexity
of the problem is excessively  high --- both mathematically and computationally.
For  instance, with  three design  variables considered,  it requires  a careful
interpretation  of the  resulting  pareto front  to  distinguish their  relative
importance. While  prima facie this is not  an issue, the question  of resolving
the pareto front for cells with  different parameter sets needs to be addressed.
The optimisation algorithm  used is an exotic  genetic algorithm to be  run on a
parallel cluster. From a near-term industrial application viewpoint, this scheme
is less  attractive since real-world  constraints such as  supply-chain dictated
raw-material  sourcing  typically restrict  the  number  of degrees  of  freedom
available  for  optimisation.  Nevertheless,  this scheme  is  valuable  from  a
long-term research perspective and  merits attention from researchers interested
in model-based design.

From the  body of the  relevant literature surveyed here,  it is clear  that the
issue of  optimally stacking up  layers within a pouch  cell has not  been dealt
with in a  systematic manner. Pouch cells  are the most common type  of cells in
automotive  applications.  Therefore,  optimising  their design  shall  yield  a
beneficial improvement to the overall driving range and fast charging capability
of electric  vehicles while simultaneously  helping to increase the  lifetime of
their  battery  packs.  With  these goals  in  mind,  ch:modelbaseddesign
presents  a mathematical  framework for  a model-based  optimal design  of pouch
cells.


 
Reduced Order Models: A New Classification Scheme


rom

Battery  modellers face  the  classic conundrum  of  conjuring pbm  that
remain  amenable  for control  applications.  The  prior  attempts made  by  the
research  community  to  tackle  this  challenge  is  examined  here.  The  term
`control-oriented model' can  be considered synonymous with  the term rom.
This  is  due  to  the  fact  that  the  complexity  of  pbm  inherently
necessitates the  use of  some order  reduction strategy  for their  adoption in
control and  real-time applications. In this  thesis as well as  in the relevant
literature discussed here, these two terms have been used interchangeably.

Research   into  rom   is  motivated   by  the   pressing  need   for  a
real-time   model   with   accuracy   properties   of   full-order   pbm
but   possessing    the   computational    simplicity   of    ecm   (see
subsec:ecmssubsec:pbms for  an overview).  A number  of approaches
to  reduce  the  computational  complexity of  pbm  have  been  explored
in  literature.  Jokar    provide  a  comprehensive  review
of  the  various  categories  of  reduced  order  pbm  for  lithium  ion
batteries.  However,  the  aforesaid  work  does  not  aim  to  classify  models
based  on  time-vs-frequency  domains.  Fan    conducted  a
review  of  reduced  order  modelling   methods,  but  only  provide  a  generic
overview of  deriving and implementing models  in these dual domains  without an
expository  analysis of  the  implications of  these  modelling choices.  Unlike
Jokar  , the review by Fan  did not aim to provide a
classification  of various  reduced order  models, but  instead emphasises  on a
broad survey of relevant methodologies  and tools towards obtaining them.
Hence,  neither  of  these  works  provide  an  insight  into  the  rubrics  and
implications  of  the  choice  of  either  of  these  domains  to  underpin  the
rom. Although  in principle,  the transformation  between them  is often
a  straightforward  mathematical  exercise,  availability of  models  for  final
implementation in the time domain aids immediate uptake by industry for adoption
in  online bms.  The treatment  of rom  from this  aspect is  so
germane to the central hypothesis of this  thesis (a simple time domain model is
the  key to  large scale  deployment of  pbm), that  the author  of this
thesis feels  compelled to  undertake a simpler  classification exercise  of the
existing  modelling art,  within the  context  of their  suitability for  online
implementation.


In this discussion,  various modelling methodologies and  their resultant models
are viewed as  a single continuum. Consequently this thesis  discusses them from
such a  unified perspective without  microscopic separation of the  final models
from their progenitor mathematical methods. Furthermore, there is also a need to
highlight the salient works among the more recent advances and extensions to the
then  prevailing models  to obtain  an updated  view of  the modelling  art that
have  gained  traction  since the  publication  of  Jokar  
and  Fan  . Hence,  the specialised  review of  reduced order
modelling  literature  covered  in  this  section  intends  to  supplement,  not
supplant,  the breadth  of  research  covered between  the  aforesaid works.  In
particular, care has been taken to minimise repetition of background art already
analysed in these aforementioned review articles, thereby striving to report the
subset of prior research that is  pertinent to illustrate the new classification
scheme introduced  here. The author  does not aim  to adhere to  a chronological
presentation of such  background works. Instead, salient  rom families are
introduced  in  the  context  of  discussion  of  their  significance  within  a
particular mathematical modelling technique.


In the views of this thesis author, physics-based control-oriented models can be
classified as belonging to one of the following categories

    Frequency domain roms
    Quasi-hybrid time/frequency domain roms
    Hybrid roms based on equivalent circuits
    Time-domain roms

It is important to distinguish between those models that are derived directly in
the time  domain versus  those that  are derived first  in the  frequency domain
and  later  converted  to  time  domain.


In  principle, any  modelling  method  that yields  a  time domain  mathematical
description  of physical  phenomena that  is lower  in computational  complexity
by  some  arbitrary   magnitude  than  the  original  dfn   model  can  be
considered  as  a  candidate  for  further  investigation.  In  the  absence  of
a  canonical  or  quantitative  definition  of  what  constitutes  a  rom,
the  number  of  candidate  family  of  models  to  consider  is  overwhelmingly
large.  In  practice,  the  constraint  imposed   by  the  scope  of  this  work
 suitability  for real-time  implementation, limits  the choice  of candidate
modelling  families.  For  instance,   models  relying  primarily  on  classical
finite  difference , Galerkin's  approximation  or
Galerkin's  projection   methods  for  transformation  and
order  reduction of  one or  more  field variables  of the  dfn model  are
excluded from  further study. This  is done in  view of the  impracticability of
implementing  such  models in  a  resource-constrained  environment such  as  an
embedded bms controller.

Frequency   domain   roms

Owing  to the  low entry-barrier  for adoption  in a  real-time controller  that
typically logs data samples at  specific time intervals, this thesis prioritises
those models  that are cast in  a mathematical form directly  suitable for final
implementation in  the time domain. This  choice implies the exclusion  of those
models that  are derived and implemented  entirely in the frequency  domain. For
the sake of readers interested in  frequency domain methods, the discussion here
briefly introduces  salient literature  employing the Padé  approximation method
that serves as a backbone of a wide variety of frequency domain models.


The     transfer     function     oriented     Padé     approximation     method
for    low    order    physics-based     battery    modelling    pioneered    by
Forman      has   gained    widespread   adoption    in
the    areas     of    cell     design ,    charge-trajectory
optimisation ,    controller    design     and
state    estimation .     Although    Prasad    and
Rahn  present  an online identification  of a subset  of ageing
parameters  using  a Padé  model  and  the  recursive least  squares  algorithm,
specific implementation details  such as the transformation of  the Padé reduced
impedance to discrete-time  difference equations were not  provided. Padé models
are typically limited to offline applications owing to the aggressive trade-offs
required in  its approximation order  so as  to maintain high  accuracies. Those
models truncated  to very low  Padé order exhibit  poor fidelity and  perform no
better  than  classical  ecm,  although recent  research  attempts  have
focused to mitigate this drawback .


Quasi-hybrid time/frequency domain roms

Smith   pioneered a semi-hybrid approach to reduced order
modelling and  obtained closed  form expressions  for all  electrochemical field
variables  in  the frequency  domain  except  for those  describing  electrolyte
concentration and  potential (which were  solved separately using  the classical
finite  difference  discretisation  method).  To the  author's  knowledge,  this
is  the  earliest published  instance  wherein  all  the  dynamics of  the  full
order  model  were  completely  retained  in  the  frequency  domain.  This  was
facilitated through  the use  of transcendental  transfer functions  that helped
to  avoid  the  accuracy  degradation brought  about  by  truncation  techniques
such  as  Padé  approximation.  In  the first  stage  of  the  model  derivation
detailed in  the said  article, a  composite impedance  model for  the frequency
range  of interest  from  010 was  obtained.  This was  then
converted to a 12 order state  space model using the technique of
residue  grouping  and  truncation,  thereby demonstrating  the  first  instance
of  the   so-called  hybrid  modelling   workflow.  The  rom   derived  in
Smith    was capable  of predicting  the cell's  terminal
voltage within 1 of the full-order dfn model.

The  modelling  effort by  Smith    also  has the  unique
distinction of being  the first of its  kind to render a  pbm suitable for
implementation in the classical lti state-space formulation







    where       x   R^n1,    A   
    R^nn,   B  R^nm,y
    R^p1,  C   R^pn,  D  
    R^pm and   u R^m 
    1
    && 

that is amenable  for controller design and for  further system-level simulation
studies   as a  component  in  the energy  storage  subsystem  of a  (hybrid)
electric vehicle drivetrain.


The requirement  of a  relatively large  number of  state variables  (12 in this
case) for  describing the system's  dynamics dilutes the effectiveness  of state
estimation  algorithms.  In  the  classical isothermal  implementation  of  this
rom, with  the cell's terminal  voltage being the only  measured quantity,
the  observablity of  the model  degrades significantly.  Although Smith 
performed  an  observablity analysis  of  the  model  in a  noise-free  context,
the  presence of  process noise  (via unmodelled  electrochemical phenomena  and
parameter uncertainties)  coupled with corruption of  measurement values through
sensor  noise  in  a  harsh  electrical  environment  such  as  in  a  vehicle's
drivetrain, makes  this model  unattractive for state  estimation tasks  in such
embedded applications.


Several attempts have been undertaken to  improve and extend the ideas pioneered
in Smith   For instance,  Lee   addressed a
critical missing aspect  the derivation of transcendental transfer functions
for  both  the  electrolyte  concentration and  its  potential.  These  transfer
functions were  obtained by  using a Sturm-Liouville  approach by  retaining the
first  five modes  of an  eigenfunction  expansion procedure  which is  detailed
in . To  the author's best  knowledge, this is  the first
published  work wherein  all electrochemical  field variables  of the  dfn
model were  considered for  inclusion in a  deterministic model  order reduction
procedure whilst keeping the derivation entirely in the frequency domain.


Obtaining closed form expressions for  the electrochemical variables achieved in
Smith  (for all quantities other than electrolyte transfer functions) and
Lee  (all  quantities including electrolyte transfer  functions) also has
an important computational implication.  With these capstone derivations serving
to complete the  model description in the frequency  domain, all electrochemical
variables  of the  dfn  model could  now be  solved  independently at  any
desired spatial location, in particular at certain crucial locations such as the
interface of each electrode with  the respective current collector or separator.
This groundbreaking idea sharply contrasted with the then prevalent state of the
art  in  reduced  order  modelling.  For  the  simplification  of  the  original
pdae of  equations in tbl:dfneqns, most  order reduction approaches
(excluding the spm that shall  be discussed later) invariably required the
solution of all electrochemical quantities  at multiple node locations along the
thickness of  the cell, thereby adding  to the computational burden.  This was a
significant deterrent to  the adoption of such rom,  particularly if the
intended purpose of  the model is to simply predict  the cell's terminal voltage
or serve as the plant model in soc estimation applications.


In the  same publications , Lee  also  devised the
dra,  a  novel  scheme  to  systematically  transform  all  transcendental
transfer functions to  the time domain so as to  obtain an lti state-space
model  given  by  eq:LTIstatespace.  The  dra  method  retains  the
physical character of the original dfn  equations until the very last step
wherein the matrices governing the  system's dynamics are generated. This yields
a one-dimensional  discrete-time rom  of the cell  that is  entirely based
upon fundamental  physical principles.  The rom  thus obtained  could then
be  used to  compute  the  time-evolution of  all  the internal  electrochemical
quantities of the dfn model. As an illustrative application of the method,
Lee   performed a simulation study of
*[label=*)]
    the reaction flux density,
    surface concentration of Li,
    ionic concentration of Li^+ in the electrolyte,
    potential in electrolyte, and
    potential in solid

in   the  anode   and  cathode   at   the  respective   domain  boundaries   and
demonstrated  their high  accuracies relative  to a  benchmark dfn  model.
In  Lee  , the  cell  voltage  was computed  through
linear  combinations of  these  time-domain variables  with suitable  non-linear
corrections. Yet another advantage of this model order reduction process is that
the method does not involve any  form of non-linear optimisation that is typical
of other order reduction schemes that attempt a top-down approach of simplifying
the pbm equations. In  particular, the dra scheme provides
a deterministic method for selection of the order of the simplified model, which
is a pioneering  contribution in the field of reduced  order modelling of Li-ion
cells.


The author  of this thesis  considers the formulation of  the dra to  be a
breakthrough  contribution that  has  helped in  bringing physics-informed  time
domain models a step closer to online implementation without having to resort to
forming a lumped impedance and then truncating it suitably. This seminal work is
a first  of its  kind that  is amenable to  implementing real-time  controls for
an  entire  cell  without  relying  upon such  empirical  and  ad-hoc  modelling
constructs. In a  subsequent paper by the same  lead author , this
approach was  then extended to  a wider  range of operating  conditions spanning
various  choices  of  initial  soc, temperature  and  C-rates.  Although
the  final  state  space  model  thus  obtained  is  simple  to  implement,  the
classical dra scheme suffers from significant computational bottlenecks in
forming the  required block-Hankel  matrices during the  model-derivation phase.
A  memory-efficient  version  of  the dra  exploiting  the  skew-symmetric
structure  of  these  Hankel  matrices   was  proposed  by  this  thesis  author
 Gopalakrishnan  ,  which drastically  lowers
the requirements for  computational memory and processing power.  The details of
this contribution shall be presented in ch:improveddra of this thesis.


In both the original as well  as the improved dra, the eigenfunction modal
expansion  of electrolyte  concentration  transfer  function is  computationally
intensive.  A  slightly  less  detrimental   disadvantage  with  the  series  of
transcendental transfer functions associated  with the electrolyte concentration
was   that  their   derivation  entailed   mathematically  cumbersome   symbolic
manipulations that  dictated the need  of a  capable cas. Although  from a
standalone  viewpoint  this  requirement  does  not seem  to  be  critical,  the
Ho-Kalman  algorithm  that  forms  a  core  component  of  the  dra
scheme  is  steeped  in  numerical linear  algebra  routines.  Furthermore,  for
facilitating  state  estimator  and  controller designs,  it  is  convenient  to
implement the resultant  state-space model in a  classical numerical computation
environment   such  as   MATLAB.  Taking   these  into   consideration,
Rodriguez    introduced a  simplified computation  of
the  electrolyte  concentration  transfer  function by  applying  the  vop
scheme.  With  this  final  improvement,  the  hybrid  rom  implementation
originally envisaged by Lee  can  be considered feature-complete with low
computational  requirements  during  both model  derivation  and  implementation
phases.


A  key  drawback  of  the  transcendental  transfer  function  approach  is  the
requirement for  linearisation at  a specific soc.  This implies  that the
entries in  the matrices of the  state space model depends  on the linearisation
point. In all published works  employing this approach, these transfer functions
were  obtained by  linearising the  p2d equations  of the  dfn model
(see tbl:dfneqns), typically  at an operating point  of 50
soc.  The linearisation  requirement renders  the model  usable only  in a
narrow range of  soc. Furthermore, this adversely  affects the usability
of the  model for state  estimation tasks, wherein the  soc is in  fact an
unknown quantity and is to be estimated.


In order to extend the model's range of validity, Lee   had
used a  simple model-blending approach  by interpolating between  several linear
models  pre-computed at  different  soc and  temperature combinations.  To
guarantee robustness  during change-over, a  naive approach is to  incorporate a
large  number  of  break-points  in  the  look-up  table.  Since  the  model  is
intended  for  online  operation,  this would  entail  significant  requirements
of  both operating  memory  and non-volatile  storage.  An alternative  approach
is  to  implement  a  fairly  coarse  break-point  table  with  a  sophisticated
changeover  mechanism. However,  this  demands careful  tuning  of the  blending
parameters  and  gain values,  an  in-depth  treatment  of  which has  not  been
provided in Lee  .  Furthermore, employing these interpolated
matrices---whose  entries are  obtained  from pre-computed  matrices at  various
soc and temperature---for state-estimation creates a subtle cyclic loop.
The  stability of  this  internal feedback  loop thus  introduced  has not  been
analysed in  literature. This  renders the idea  of state-estimation  using such
run-time interpolated models questionable.


The author  of this thesis hypothesises  that any perceivable drawbacks  such as
non-smooth changes  in soc estimates  arising from using  blended matrices
could  be potentially  mitigated by  using  smoothing filters  and other  ad-hoc
mathematical apparatus. However,  there exists no published  work that discusses
these engineering aspects  or on how to actually implement  them in bms.
Coupled with  the absence  of a  theoretical analysis  of loop  stability, these
models are deemed  as not being suitable for immediate  adoption by industry, at
least until  these aforementioned gaps  have been addressed  satisfactorily. The
non-linear state variable model  presented by Guo   aims to
address this  issue through a rom  in the frequency domain  by eliminating
the linearisation phase  from the workflow. However, the online  solution of its
field  variables  entails  a complex  prediction-refinement  procedure,  loosely
defined as  implicit and explicit  solution methods,  for each subsystem  of the
dfn model. The  formulation of the final model is  not clearly illustrated
and in the views of this author, is not easily comprehensible. In the absence of
actual source  code, a numerical example  or pseudo-code of the  model reduction
workflow could  have immensely  helped with the  reproducibility of  the results
claimed in the aforesaid publication.

In summary, the  concept of hybrid rom is  certainly promising, although
more work is required to address the  present gaps, most prominently the need to
linearise their equations at certain operating points.


Hybrid roms based on equivalent circuits

Physics-inspired
ecm 
are a class of hybrid models that have rapidly gained prominence since the
publication of Jokar   and Fan  . In
this case, the derivation of the relevant model equations is performed in
the frequency domain. This frequency domain representation is then converted
to a form suitable for implementation as an equivalent circuit. Prasad
and Rahn  extended their Padé order reduced model, first
presented in , by converting their impedance model into
standard equivalent circuits. A key point to be highlighted is that these
family of models do not necessarily strive to retain the classical Randles
structure  for their equivalent circuit representation.
Instead, the values of the electrical circuit components such as series
resistance and equivalent capacitance are obtained through various mechanisms
such as eis measurements under load. The biggest advantage of such
models is that they serve as drop-in replacements to traditional ecm
whilst still retaining their origins in physical principles rather than on
empirical curve-fitting.


A  common  characteristic  of all  hybrid  models  is  the  lack of  a  physical
meaning to  their model  parameters. This severely  limits the  insights offered
by  such  models  into  electrochemical  phenomena internal  to  the  cell.  The
biggest  attraction  of  using  pbm is  the  possibility  of  predicting
quantities such as the soap or  phenomena such as cell degradation through
accurate computation  of the solid  phase surface concentration  and potentials.
Furthermore,  a model  capable  of  implying a  direct  and causal  relationship
between a  group of physical  parameters and internal overpotentials  at various
spatial locations within the cell serves as a powerful tool for in-situ lifetime
estimation  of batteries.  Although the  circuit components  of physics-informed
ecm and the state-space models discussed here trace their origins to the
original parameters  of the dfn  model, the  link between the  final model
coefficients and their progenitor physical parameter sets is tenuous at best.


With  the  goal of  translating  physical  parameters  of  a cell  into  circuit
components, Zhang   presented a lumped ecm based on
Padé approximation and  model truncation. However, the sensitivity  of the final
model values owing to perturbations in  the original physical parameters was not
evaluated. Consequently, there  is a lack of clarity in  the relative importance
of physical parameters and their influence on circuit component values.


Merla   introduced an ecm  that can be parametrised
by attempting  a systematic  decoupling of  the kinetics  and diffusion  at both
electrodes  and the  electrolyte. Although  these interacting  phenomena can  be
complex to  resolve over  all length and  time-scales, acceptable  trade-offs in
accuracy  was  demonstrated to  be  achievable  from a  system-level  simulation
perspective. A  drawback of this approach  is that key physical  parameters such
as  solid and  electrolyte  diffusion  coefficients are  attributed  to the  two
electrodes  through  ad-hoc,  non-verifiable assumptions.  Furthermore,  in  the
aforesaid article, notable discrepancies exist  in the values of parameters such
as  electrolyte  conductivity  (obtained  through  calculations  from  eis
measurements) to that typically reported in literature.

It must be acknowledged that presently  there exists no modelling candidate that
provides  all the  desirable  characteristics  sought after  in  a rom  to
unconditionally adopt it  for final implementation in the  time domain. However,
it is  strongly desirable  that the  majority of the  final model  values retain
their physical meaning, yielding system  engineers and cell designers alike with
a  direct  and  causal  relationship  between groups  of  parameters  and  their
influence on the cell's operational performance.  Since one of the goals of this
thesis is to  provide a readily usable rom that  is immediately deployable
in an online implementation, the author  concludes that at present, the benefits
offered by physics-inspired hybrid ecm  do not decisively outweigh their
drawbacks.

Time-domain  roms

The working rubric of all time  domain rom typically consist of attempts
to  reformulate the  original  p2d  model equations  towards  the goal  of
simplifying  them to  as much  extent  as possible.  In contrast  to the  hybrid
models, all tasks involved in both model derivation and final implementation are
carried out  entirely within the time  domain. While a subset  of prior research
has  focused  only  on  simplifying  certain aspects  of  the  cell's  dynamics
 diffusion  in  the two  electrodes,  other  published  works have  aimed  at
providing a  simplified description of  the time domain evolution  of all
physical quantities of  the cell. An evaluation of the  salient literature based
upon both these approaches is performed here.


In  this discussion,  the  modelling approaches  that  entail computations  with
medium or large dense matrices  or those involving
concepts such  as fractional  order derivatives 
  shall not be discussed. In the  views of this author,
it appears that  the academic community has implicitly considered  them to be so
abstruse that there has not yet  been a comparative study pitting these families
of models against  the prevalent art. Comparing with the  typical published work
in  this field,  it  is not  clear  on how  such  models distinguish  themselves
uniquely within the broader landscape of reduced order battery modelling.


A few mathematical  techniques for pde simplification in  the time domain,
such as Hilbert space representation and singular perturbation, were applied for
cell  modelling in  Manzie  . However,  their presentation
lacks expository  visual information such as  plots of time domain  evolution of
the internal and terminal variables  for dynamic load profiles. Furthermore, the
authors  have  not provided  a  tabulated  set  of  physical parameters  of  the
cell being  simulated which  therefore impedes  reproducibility of  the results.
Consequently, these methods have not seen a healthy uptake either in academia or
in industry. The  author of this thesis  considers this presentation to  be of a
cursory nature  and therefore,  it shall  not be  discussed here.  The remainder
of  this  section discusses  several  popular  families  of time  domain  models
and  provides a  summary evaluation  of  their relative  merits and  weaknesses.
ch:spmanalysis presents a formal in-depth  analysis of all aspects of the
state of the art  in the field of single particle  modelling. The author reckons
that  the  spm---reviewed briefly  later  in  this section---is  the  most
promising  candidate identified  among  these time-domain  models  to nurture  a
latent  potential  to  facilitate  faster  adoption  of  pbm  in  online
applications.

In the dfn model, the evolution of lithium in the solid phase is described
by the classical  diffusion equation given by  Fick's first law .
In order  to solve for  this concentration profile  in full-order models,  it is
required to discretise every spherical particle (represented by the placement of
a  node  in  the  axial   through-thickness  direction)  along  its  radial
direction (pseudo  dimension). This  additional discretisation along  the pseudo
dimension dramatically increases the overall  number of discretisation nodes and
adversely  affects  computational  efficiency.  The impact  of  such  high  node
densities  on the  computational requirements  of the  original p2d  model
coupled  with the  fact  that diffusion  in  the solid  phase  is typically  the
rate-limiting  aspect  of  batteries  have  led  researchers  to  adopt  various
mitigation strategies  to tackle this issue.  In contrast to the  pure frequency
domain and the semi-hybrid/hybrid approaches  discussed thus far, these attempts
typically strive  to arrive at  a simpler  computational mesh, whilst  aiming to
retain high  fidelity. It should  be noted that  high node densities  are mainly
required near the  surface of the spherical particles for  the pseudo dimension.
Similarly, the clustering  of nodes is desirable near the  separator and current
collector interfaces along the axial dimension.
Thus, a sizeable number  of order reduction strategies in the time  domain seek
to adopt non-uniform node  spacing towards lowering the aforesaid computational
issues.

Computationally    efficient     pseudo-spectral    schemes     for    numerical
solution   of   pde   can   be  employed   by   placing   discretisation
nodes    at    orthogonal    collocation     points    obtained    by    solving
for     the     zeros    of     certain     class     of    polynomial     basis
functions . The
accuracy of such  schemes extend beyond the algebraic orders  of that achievable
with  classical Finite  Difference,  Finite Element  or  Finite Volume  Schemes.
Northrop    pioneered  their  application  in  battery
modelling  by  employing  Jacobi  polynomials  as  underlying  basis  functions.
Suthar    replaced  Jacobi  polynomials  with  Chebyshev
polynomials to  extend the  applicability of the  resulting rom  to higher
C-rates. Bizeray   provide a  detailed treatment of the
usage  of Chebyshev  discretisation for  the full  p2d model  on a  global
scale  along both the axial and radial directions for all equations of the
dfn  model. A  Lagrangian-like integral  method was  proposed by  Rahn and
Wang   to  deal  with  electrolyte  and  solid-state  diffusions.
However, this method works well only at low C-rates.


The  reduced  number   of  nodes  as  well  as  their   clustered  placement  at
the  desired  spatial  locations  facilitated by  these  discretisation  schemes
lowers  the computational  burdens  of simulating  a  physics-based cell  model.
Gopalakrishnan   undertook a  hybrid approach by
retaining a  standard finite volume  discretisation in the axial  domain, whilst
adopting  the  Chebyshev  discretisation  only  for  the  critical  solid  phase
diffusion  component in  the  radial  direction. The  details  of  this work  is
presented in the context of the research methodology on delivering a model-based
pouch cell  design discussed  in ch:modelbaseddesign.  In pseudo-spectral
methods, the  p2d equations,  their boundary conditions  and corresponding
field variables  are mathematically  transformed to  the Chebyshev  space within
which they  are solved. The details  of this transformation is  presented in the
context  of the  author's  aforementioned  work in  sec:hybridfv-spectral
for  the  solid-phase  diffusion  equation.  Finally,  these  solved  quantities
are  converted  back to  the  physical  space  through a  corresponding  inverse
transformation.   Although   this   bi-directional  transformation   is   purely
algebraic  in nature,  the requirement  of  running a  spatially resolved  model
coupled  with  the  overheads  of such  variable  transformations  render  these
class  of   models  unsuitable  for  online   implementation.  The  contribution
of   Lee     the   ability  to   solve  for   any
electrochemical   variable  at   arbitrary  spatial   locations  by   completely
eliminating the need for  spatial discretisation assumes particular significance
in this context.


In all  non-uniform discretisation schemes  discussed here, the  implications of
using  a non-adaptive  support mesh  obtained by  the placement  of nodes  whose
locations are optimised a priori, must be considered carefully. For instance, in
the prolonged operation of the cell with a net unidirectional charge flow  in
an electric vehicle  application, the reaction front drifts  from separator back
towards the current collectors. This is due  to the exhaustion of lithium at the
surface  of particles  near  the  separator interfaces.  In  this scenario,  the
solutions  produced by  these models  could be  worse than  simpler models  with
uniform mesh-density. Although  adaptive meshing strategies can  be employed for
desktop simulation  with minimal effort,  it remains to be  seen if this  can be
deployed successfully in a resource-constrained  environment such as an embedded
bms controller, and hence is  a candidate for future research.


The   computational   bottlenecks  arising   due   to   discretisation  in   the
radial   direction    have   motivated   researchers   to    explore   mesh-free
approaches   to    solve   for   the   solid    phase   concentration   profile.
Subramanian    pioneered  the  concept  of  employing
polynomial approximations of the Fickian diffusion equation to solve for lithium
concentrations  in the  porous  electrodes. In  this  approach, the  solid-phase
surface  concentrations were  expressed  as correction  terms  applied to  their
average concentrations (which  was described using a  second degree polynomial).
In  a   follow-on  study ,  the  same   authors  presented
a  solution  using  higher  order  polynomials  and  performed  a  dimensionless
analysis of  their proposed reformulation.  The details of  the 4
order  polynomial approximation  is  presented  in the  context  of this  thesis
author's  comprehensive  analysis  of  the  spm  modelling  art  and  will
be  presented  in subsec:basicspmfurtherdimensionalityreduction.  In  the
2 and  4 order solutions, the  polynomial equation
for  surface concentration  was  accompanied by  a  corresponding ode  for
describing  the temporal  evolution  of average  concentration, thereby  leading
to  a  system  of  dae.  Furthermore,  Subramanian   convincingly
demonstrated the  application of  polynomial approximation  for the  solid phase
diffusion  equation in  the numerical  simulation of  a complete  dfn cell
model .


Using polynomial  approximation for the  solid phase concentration results  in a
drastic reduction  in the number of  dae needed to solve  the full model
since now discretisation  needs to be performed only along  the axial direction.
The  polynomial  approximation  solution  applied   to  solve  for  the  surface
concentration in  the solid phase can  hence be viewed as  a dimension reduction
approach, as  it removes  the model's  dependence in  the radial  direction. The
textbook by Carslaw and  Jaeger  provides detailed derivations
for obtaining the standard analytical solution to Fick's law of diffusion in the
context of heat conduction in solids. Liu  derived this analytical
solution for the  lithium intercalation process in the solid  phase, taking into
account  the idiosyncrasies  of porous  electrodes.
However, this  expression involves an  infinite sum
expansion of eigen modes. Guo  and White  formulated an expression
for a  truncated approximation of  this solution  to arbitrary number  of terms.
Furthermore, they demonstrated  the validity of this  approximation by comparing
the analytical solution truncated  to the first 5 terms to  that obtained from a
classical finite  element solution. However, this  truncated analytical solution
involves exponential and trigonometric terms  and is non-trivial to implement on
bms  chips, particularly  in those  that lack  support for  floating point
computations.  Moreover,  there  has  been  no  extensive  study  comparing  the
analytical solution to the polynomial  approach. Consequently, this approach has
not yet gained  widespread popularity in the inherent elimination  of the radial
dimension that is so  deeply ingrained as a core aspect  of the cell-level order
reduction  approaches  discussed  here.

The computational  speed-up facilitated  by using polynomial  approximations for
the  solid  phase diffusion  has  motivated  other  researchers to  extend  this
approach  to  all  other  electrochemical  variables  of  the  dfn  model.
Deng    presented a  polynomial-centric evaluation  of the
full  p2d  model, whose  notable  contribution  is  in providing  such  an
approximation for the molar flux density along the thickness of the cell. To the
best knowledge  of this  thesis author,  this is the  first published  work that
provides a  spatially dependent simplified  computation of the  interfacial flux
density. This represents a balanced choice  between the need to use the strongly
non-linear Butler-Volmer kinetics eq:butlervolmer or  having to resort to
a lumped  representation of average  kinetic behaviour. Hence, this  approach is
particularly suited  to reduced order  modelling of cells with  medium electrode
thicknesses wherein the  lumped representation of flux density  is not generally
applicable.

One  serious drawback  in Deng    is the  use of  a Finite
Difference approximation for computing the spatial gradients of the ocp at
three electrode locations. This  adversely affects computational performance and
is not  suitable for online  implementation. Unless  a proven solution  for such
computational  challenges is  made available,  it is  worthwhile to  continue to
explore other avenues to identify the  most apropos first candidate for adoption
in real-time bms environments.

Farag    proposed   a  pwl  approximation   of  all
governing equations of the electrochemical  model. Given that straight-line fits
to complex phenomena  are inherently too simplistic,  these authors acknowledged
that a naive implementation of their  approach shall therefore result in a crude
approximation of  the cell's dynamics.  Hence, an optimal  knot-placement scheme
was proposed and solved through a  genetic algorithm to compute the break-points
of the pwl fit. Since  this computationally intensive step occurs offline,
it does not  adversely affect the real-time performance of  the model. The final
rom  is implemented  using  standard state-space  matrices. However,  this
model  also exhibits  the primary  drawback of  all hybrid  modelling approaches
 a complete lack of physical  interpretation of its parameters. As with any
other rom involving soc-based linearisation points, the stability of
the model  to uncertainties in  physical parameters is questionable.  A detailed
sensitivity analysis  of the knot  placement scheme's output to  such parametric
variation is  to be performed  in order to  establish confidence in  the model's
robustness, before such  pwl approaches can gain  widespread acceptance in
online applications.


It  is evident  that all  physics-based  rom presented  thus far  entail
extensive  parametrisation  efforts to  render  them  suitable for  a  practical
application. The difficulties associated with such parametrisation, coupled with
inherent  uncertainties  in  the  obtained  parameter values  act  as  a  strong
deterrent  to stakeholders  outside  academia to  adopt  pbm for  online
implementation  in  a  bms.  This  motivates the  need  for  even  further
simplified pbm. One such modelling  candidate is briefly introduced next
and is analysed in detail in ch:spmanalysis.


Haran    proposed a  highly simplified  representation of
porous  electrodes  for the  metal  hydride  cell  chemistry. In  the  aforesaid
article,  each   porous  electrode  was   represented  as  a   single  spherical
particle.  This concept  was  adopted  for lithium  ion  batteries  by Ning  and
Popov  and has since become  quite popular. Models employing this
lumped  representation  of  electrodes  are referred  to  as  spm
(spm).  These models  have  three advantages.  Since  they involve  only
a  subset  of  parameters  of  the   original  dfn  model,  most  of  them
being  geometric quantities  that  can be  directly  measured without  extensive
chemical  or electrical  testing,  spm are  easier  to parametrise  than
other physics-based  rom. Furthermore,  they are  computationally cheap,
especially when coupled with the  polynomial approximation for solving the solid
diffusion  equation for  each electrode.  Finally, all  model parameters  in the
spm  retain their  physical character,  aiding in  a direct  and intuitive
understanding of physical parameters on the cell's operation.

This concludes  the author's review of  literature of the various  reduced order
modelling  strategies. Based  on the  wealth  of information  gleaned from  this
study,  it was  possible to  make  an informed  choice to  pursue the  spm
approach  for further  research.  In particular,  it came  to  light that  there
has  been  no systematic  analysis  of  the  state  of the  art  spm-based
approach with  a view  to quantify their  performance boundaries.  This author's
contributions to  the time-domain  implementation-focus reduced  order modelling
field include
[noitemsep,topsep=0pt, before=*-0.25]
    a thorough analysis of the existing spm variants ranging from the rudimentary to the sophisticated
    enumeration of issues plaguing each spm variant, including current state of the art
    study of further literature on the current tactics to overcome the current challenges along with their associated drawbacks
    conducting a  wide range of hypotheses-driven trials in an attempt to enhance  the basic spm (some of which did not yield the desired
        improvements), and
    arriving at  a  feasible  approach  capable  of  moulding  the
        spm  framework into  a  readily implementable  solution in
        electric vehicle applications

This research was  performed through an iterative cycle of  analysis, design and
simulation-based verification  and shall be  elucidated in a  discourse spanning
two chapters  ch:spmanalysis and ch:newelectrolytemodel.

  2


chapters/layer_opt/figures/


[Model-based Design of Pouch Cells]    Model-based  Design Of  Pouch Cells 





















*-1em
[chapters]
[chapters]11



xeV



[Introduction]Introduction



The issue of `range anxiety'  is a pervasive mental blockade for
potential buyers  of electric  vehicles which  in-turn hampers  their widespread
adoption. From  a consumer viewpoint,  yet another  practical issue is  the fact
that on  encountering a `low battery'  scenario in a long  distance journey, the
charging  times required  for sufficiently  replenishing the  battery to  enable
completion  of the  journey  are  prohibitively large,  to  the  point of  being
non-competitive against conventional fossil fuel powered vehicles.

Unfortunately,  the  aforementioned  scenarios  are not  unimaginable  with  the
present  state  of the  art  in  lithium  ion  batteries. Hence,  improving  the
aer and  providing fast charging  capabilities are two near-term  goals of
manufacturers  of electric  vehicles.  Increasing the  aer necessitates  a
battery pack with  higher energy content in it while  lowering the charging time
demands a  pack with higher  power capability.  The contrasting nature  of these
goals can  be traced  all the way  down to  the cell level  and is  presented in
sec:energypowertradeoff. By trading  off the number of layers  in a pouch
cell  against  the content  of  active  electrode material  accommodated  within
it,  bespoke cell  designs  addressing either  the energy  demand  or the  power
demand  can  be  obtained.  In  the  absence  of  accessible  documentation  (as
either  industry white  papers or  academic literature)  on the  layer selection
methodologies employed in automotive pouch  cell designs, this author postulates
that manufacturers  iterate through  an extensive  empirical testing  process of
prototypes with  a range of  layer choices. In the  view of this  thesis author,
this  procedure is  not only  time-consuming, but  is also  likely to  result in
sub-optimal designs.  This chapter envisages a  model-based engineering solution
to more  optimal cell designs  by determining  the appropriate number  of layers
needed  to maximise  its  usable energy  while simultaneously  satisfying
certain  power  capability constraints.  The  rest  of  the chapter  provides  a
detailed treatment of topics such  as the proposed layer optimisation framework,
its assumptions involved,  and various modifications to  standard numerical code
required to facilitate this design procedure.

 
Energy/Power Trade-off in Pouch Cells by Layer Selection



Varying the  number of electrochemical  layers stacked  within a pouch  cell has
contrasting effects  on its energy  storage and power handling  capabilities. In
this section,  a high-level  intuitive explanation of  this phenomenon  is first
offered, before  delving into  a detailed  presentation of  this effect  and its
implications for a specific  example cell in sec:energypowertradeoffdemo.
Interwoven  into  the  narrative  is  a set  of  simplifying  assumptions  which
establishes  the broader  context  within which  a  computational framework  for
determining the optimum  number of layers for a specific  target design shall be
formalised (to be discussed in sec:layeroptframework).

Preliminary assumptions

To  obtain a  balanced  loading of  both electrodes  and  to avoid  asymmetrical
exhaustion  of lithium  from  one  of the  electrodes  during  operation, it  is
desirable to carefully calculate the  volume of electrochemical active materials
to be accommodated  within the cell. This concept is  well-known and is commonly
discussed  in  standard  textbooks in  the  field  such  as  those by  Rahn  and
Wang  wherein  example calculations are presented  for non-porous
electrodes. The study  by Ramadesigan   also supports
the  statement that  capacity  matching  of anode  and  cathode  materials is  a
standard practice in cell design.


In  the  case of  lithium  ion  cells with  porous  electrodes,  the concept  of
electrode-balancing  involves  an additional  variable   the porosity  of
the  active  materials.  The  roles  of porosity  and  its  corollaries   the
material   volume  fraction   and  filler/binder   fraction  are   discussed  in
subsec:spmp2dparametrisation.  In this  work,  a  major assumption  about
material porosities  (and hence active-material/filler volume  fraction) is that
they are held constant. The rationale behind using this simplified assumption is
as follows.

This  author  visualises  the  integration  of  cell-level  design  optimisation
(through  an optimal  layer  selection procedure)  into  the overall  drivetrain
design  by the  cell manufacturer  before  a custom  design is  delivered
to  vehicle/system  integrators.   Cell  manufacturers,  especially  small-scale
manufacturers do not necessarily  synthesise each electrochemical component, but
instead may opt  to source certain raw-materials from  an upstream supply-chain.
From  a  manufacturing  viewpoint,  the  porosity  of  the  electrode  materials
is  governed  by  the  extent  of  calendaring  of  the  electrode  reel.  Using
pre-calendered electrode materials or sourcing  large volumes of electrode reels
with a fixed extent of calendaring can help to keep costs low. Since researchers
in  the  field are  typically  not  privy to  the  specifics  of the  industrial
procurement process,  in the absence  of further information, the  assumption of
constant  porosities provides  a  good starting  point  for this  model-oriented
design study.

From a technical  viewpoint, there exists another redeeming  argument to support
the constant  porosity assumption. Keeping material  porosities constant enables
to  eliminate  one  degree  of  freedom  from  the  design  optimisation  study,
thereby narrowing  the dimensionality of  the search space.  To the best  of the
author's knowledge,  there has not  yet been  any published work  tackling layer
optimisation  of  pouch  cells.  Building an  initial  infrastructure  in  terms
of  a  computational  framework  that  is  based  upon  this  constant  porosity
approximation  shall at  least  provide a  solid foundation  to  build upon  for
such  real-life  use-cases.  The  author  foresees  this  study  as  a  vanguard
research into  cell engineering and therefore  places a high value  in obtaining
ballpark estimates of  an optimal layer count, albeit  with constant porosities.
Ramadesigan   present  an opinion that the  choice of
porosities of electrode  materials is currently being done on  a trial and error
basis. Nevertheless, for  real-world use, the influence of  varying the material
porosities  on the  cell's  performance is  to be  quantified.  Hence, prior  to
adopting  this  model-based  methodology  for  production  yields  at  scale,  a
fully-integrated design optimisation process with  variable porosities has to be
developed. Therefore, in this work, the study is restricted to constant porosity
values, whilst  acknowledging variable porosity  designs as an  important aspect
for future studies.

At  a  system level,  the  efficiency  of the  drivetrain  is  considered to  be
constant. The  drivetrain of  an electric  vehicle consists of  a whole  host of
electrical and mechanical components such as power electronics, electric motors,
gearing, differential shaft and other  transmission systems. The efficiencies of
each  of these  individual  components has  a cascading  effect  on the  overall
drivetrain efficiency.  The efficiency of  each component is  strongly dependent
upon the operating point. For instance, the efficiency of an electric motor is a
function  of  its  torque-speed  curve.  In  practice,  it  is  rarely  easy  to
decouple  these efficiencies  at  least  during the  initial  design stage.  The
datasheet/technical specification of each component  in the platform is required
to make  a comprehensive multiphysics-based  design optimisation study.  This is
well  beyond the  scope  of this  work  and requires  access  to various  design
blueprints. Therefore, a constant lumped  efficiency value for the drivetrain is
adopted  for this  work. However,  the  proposed optimisation  methodology is  a
modular one  which implies that  it can be suitably  adapted  to  include a
efficiency  value dependent  upon power  delivered at  the wheels.  However, the
biggest redeeming  aspect (observed after the  completion of the study)  is that
using a constant  efficiency value did not influence the  final layer choice for
the cell  design. As  seen in  sec:accpathway, the  drivetrain efficiency
plays a role  only during acceleration studies. As per  the results presented in
sec:resultslayeropt, the  layers required  for satisfying even  the basic
fast-charging  requirements far  exceed  the layers  required  for handling  the
acceleration power demands. Therefore, this  assumption is justified for keeping
the computations tractable.

From  a  pack  perspective,  the   primary  assumption  in  the  formulation  of
the   proposed  optimisation   methodology  is   that  the   pack  configuration
(series/parallel arrangement  of modules, number  of cells per module  and other
system-level specifications) are held constant  throughout. The validity of this
assumption  is easily  justified  since  a cell-level  design  may be  performed
independently of  the larger drivetrain  design. In fact, the  author postulates
that  present design  process for  electrified transportation  is a  modular one
 empirical cell designs are  developed based on certain specifications laid
out by vehicle  manufacturers and is not integrated into  the drivetrain design.
This  modularity  in the  design  approach  enables  to keep  such  system-level
parameters constant.

A further assumption  in this study is  that the overall height of  the pouch is
held constant. In  the absence of this constraint, any  arbitrary pouch size can
be chosen,  leading to an  infinite-dimensional optimisation problem  wherein no
unique optimality  criterion exists.  This assumption is  in-fact enforced  by a
current  trend  in the  automotive  industry   adoption  of  common-module
designs wherein  the physical  dimensions of  the pack  are chosen  a priori and
modularising the  pack helps in  tailoring them  suitably to cater  to different
market segments. Extending this philosophy down to the cell level, it is easy to
visualise the  benefits of  having cells of  identical exterior  dimensions. For
instance, having a  common inventory helps a vehicle manufacturer  to keep costs
in check  for subsequent designs   for  derivative model families  of their
product  portfolio. This  means that,  for  any layer  choice to  be tried,  the
constituent components  of the cell is  to be arranged and  contained within the
same  pouch  (of  fixed  exterior  dimensions).  This  naturally  leads  to  the
assumption that the  thickness of the pouch material used  shall remain constant
throughout, which in-turn implies that the overall height of the electrochemical
stack  within the  pouch is  constant. The  detailed calculations  of the  stack
height is presented in sec:surfareaperlayer.

The  current collectors  and the  separator  in each  electrochemical layer  are
assumed  to  have  uniform  thickness  irrespective  of  the  number  of  layers
used.  Barring  minor manufacturing  variability  and  tolerances, these  values
are  merely  factual data  requiring  no  further justification.  For  instance,
a  constant  separator thickness  was  used  in  the design  optimisation  study
by  Newman .  The  final  assumption  from  an  electrochemical
point  of view,  introduced specifically  for the  first time  in literature  by
this  thesis author,  is  that the  relative thicknesses  of  each electrode  is
held  constant to  a  fixed ratio.  This warrants  further  explanation, but  is
ill-suited  for this  introductory discussion.  The details  of this  aspect are
discussed  in  sec:electroderatio. Certain  assumptions  are  to be  made
about the  temperature distribution  within the  layers owing  to the  choice of
cooling arrangement.  These aspects merit  more than  a cursory listing  in this
introductory section and hence is discussed in sec:celllevelxeVinfo.

Motivation

This section aims to provide a  qualitative description of the effect of varying
the number of layers  within a pouch cell and presents  the motivation to embark
upon this layer optimisation effort.

Given the  assumptions listed in subsec:layeroptassumptions,  it is clear
that  changing the  number  of layers  in  a pouch  of  fixed thickness  results
in  different  absolute  electrode  thicknesses.   This  in  turn,  affects  the
electrochemical-thermal behaviour  of the  cell. Having a  low number  of layers
means  that the  proportion of  energy-storing  materials within  the volume  is
higher, leading  to greater nominal capacity.  However, owing to the  large time
constants necessary for  lithium ions to diffuse through thick  domains, not all
of this stored energy might be available for utilisation. With thick electrodes,
the power  handling capability  of the  cell suffers  since lithium  deficits at
electrode surfaces shall lead to the collapse of its terminal voltage.

Prima facie,  based  on the  above  discussion,  although  it appears  that  the
absolute lowest possible  number of layers ( one layer)  is the best choice
for maximising  driving range, there  exist two  other goals that  conflict with
this design  intent. Firstly, there must  be a minimum electrode  active surface
area  to  handle the  power  demands,  and hence,  a  minimum  number of  layers
typically far  greater than one. Higher  power capability is achieved  by way of
larger electrode surface  area and higher electrical  and thermal conductivities
owing to the presence of more current collectors. Secondly, the acceptable limit
on  lifetime  degradation of  cells  places  an  upper  bound on  the  allowable
temperature rise during vehicle operation. Increasing the number of layers has a
two-fold mitigating effect on the  temperature-rise experienced by the cell. The
power  density within  each  layer  is diminished  due  to the  increased
available  surface area,  leading to  reduced ohmic  heat generation  within the
cell. With  each layer requiring a  Al-Cu current-collector pair, the  number of
heat conduction  pathways increases  linearly with the  number of  layers. Thus,
increasing the number of layers has a beneficial effect on pack lifetime.



















In summary,  for very low number  of layers, there exists  more active material,
leading  to a  high  energy  capacity. However,  the  reaction  surface area  is
diminished proportionately leading to lower power capability. Furthermore, owing
to the presence  of very thick electrodes, the current  density within the solid
conductive  matrix shall  not  be  homogeneous , nullifying  some
fundamental modelling assumptions of the  standard dfn model. On the other
hand,  very  high  number  of  layers  imply  vanishingly  thin  electrodes  and
correspondingly  less  active material  accommodated  within  the cell,  thereby
resulting  in  a lower  energy  capacity.  fig:energyvspowercell shows  a
qualitative comparison of the construction of one layer of an energy cell versus
power cell which helps to illustrate all the aspects discussed thus far.



Therefore, there exists  a research question on what constitutes  the best layer
choice  that straddles  this  trade-off  with the  least  penalty  to the  power
capability  of  the  cell  whilst simultaneously  having  the  maximum  possible
capacity. This  saddle point determination needs  to be performed for  a curated
set of power input/output conditions to the cell. This niche problem has not yet
been  tackled by  researchers  and therefore  motivates the  need  to perform  a
careful design study which is documented in this chapter.



Quantitative demonstration of energy/power trade-off

The discussion in subsec:layeroptmotivation has motivated the need for an
in-depth exploration of the energy to power trade-off expressed as a function of
the number of  layers. Before embarking on constructing a  framework to optimise
the layer choice by formalising various constraints that govern this optimality,
this section aims to quantitatively  demonstrate this relationship by applying a
fixed galvanostatic discharge to an example cell. Additionally, the crucial idea
of usable energy versus total stored energy is also introduced.

A  lco  cell  whose  physical  properties  and  simulation  parameters  is
drawn from  the combined set of  data from tables 
and  is  used as the  example cell. The only  set of
values that overlap between these two tables are ---
*[label=*)]
    the cut-off voltages, and
    the number of nodes  used for numerical  discretisation of  the governing  pdae equations.

For these conflicting quantities,  the values in tbl:lcoSimParamslayeropt
prevail for all simulation studies  in this chapter. Furthermore, the individual
electrode thicknesses from tbl:lcoSimParamsSPMp2d  are not directly used,
but  instead  calculated  for  every  layer  choice  by  keeping  the  ratio  of
their  relative  thicknesses  constant.  This   aspect  shall  be  explained  in
sec:electroderatio.

fig:fig_CC_discharge_curves  illustrates  the  influence  of  the  number
of  layers   on  the  energy   and  power   capability  of  the   example  cell.
Starting  at  100  soc,  a constant  current  discharge  of
60  is applied  to a  dfn model  of the  cell
until reaching the  lower cut-off voltage. For each discharge  run, the model is
reconfigured with  a different  layer choice. Five  distinct layer  choices have
been carefully chosen so as to  provide a clear illustration of the energy/power
trade-off phenomenon.

The   rationale   behind   choosing   this   specific   magnitude
of   applied    current   is   explained    in   the   section    dealing   with
refcellselectionselection  of a  suitable reference  capacity cell
(also see sec:surfareaperlayer).






























As  seen  in fig:fig_CC_discharge_curves,  during  the  initial phase  of
discharge, the terminal voltage  of the cell is the highest  for the two highest
layer  choices   and . Consistent  with  the explanation  in
subsec:layeroptmotivation, these  two layer choices have  thin electrodes
and  hence  comparatively low  resistances  leading  to  only a  small  internal
overpotential drop. However,  as expected, their total energy is  lower than the
cell with   layers as  evidenced by  their relative run-times  until lower
cut-off voltage.  This is to  be expected as the  thin electrodes of  these high
layer count cells cannot  store a large volume of active  material. Based on the
explanation  from subsec:layeroptmotivation,  it  is  expected that  this
trend will continue  the lower the layer count, the higher the run-time until
cut-off. If this were the case, prima facie it seems that the layer optimisation
task is trivial.

Inspecting the  discharge curves of  lower layer  choices brings into  light the
concept of usable energy. Contrary  to expectations, the discharge curves
corresponding  to very  low layer  counts in  fig:fig_CC_discharge_curves
terminate even earlier than . This is  owing to the fact that although the
total  stored energy  in cells  with low  layer counts  is much  higher, only  a
fraction  of it  is usable.  This  aspects introduces  non-trivial dynamics  (as
discussed below) to an otherwise linear optimisation task.

For  instance,  when ,  the terminal  voltage  of  the cell  collapses
instantaneously, reaching cut-off  voltage whilst its soc  remains as high
as 96. At very low layer  counts, the thickness of each electrode
is high. This presents a high resistance  to the flow of charges thereby leading
to  high overpotential  drops  within the  cell. The  usable  energy under  this
60 galvanostatic  discharge for various layer  choices is compared
in tbl:CC_discharge_curves_table. It can be  seen that for very low layer
counts,  the usable  energy that  can be  extracted is  minuscule, albeit  their
theoretical  capacity   are  in-fact  the highest.  The  usable  energy  in
 reported in tbl:CC_discharge_curves_table is obtained by
multiplying the integral  of the area under each discharge  curve by the applied
current  (60)  with  the  appropriate  scaling  of  the  time-base
( conversion from minutes to hours).

























 
tbl:CC_discharge_curves_table  also brings  into view  the fact  that the
C-rate of the  cell becomes a variable quantity even  for a galvanostatic
discharge,  due to  the dependence  of  its nominal  capacity on  the number  of
layers . This represents a departure from the norm in the modelling community
wherein the  performance of cells  are quantified as  a function of  the applied
C-rate   in  chapters  and 
of  this thesis.  However, the  preliminary investigation  thus far  has quickly
revealed that  this normalised  quantity does  not hold  much importance  in any
study where the number of layers within a pouch cell is varied.

Taking into account  these factors, a reasonable choice of  the number of layers
in  this specific  60 galvanostatic  application for  this example
cell  could  be .  This  represents  a  practical compromise  between  the
surface area  available for  reaction and  the total  volume of  active material
accommodated.  Out of  the finite  layer configurations  considered, this  layer
choice offers the highest usable energy for the given discharge rate.

In this  sample study, only  a handful of  layer choices were  considered, which
represents  only  a  small  possibility  of  the  overall  design  space  to  be
considered. Furthermore,  thermal considerations were  not explored so  far. For
robust  cell design,  manufacturers  shall need  a  widely applicable  model-led
design tool  that can tackle the  various scenarios that can  occur in real-life
operating conditions. A  deterministic set of optimality criteria  for the layer
selection  is also  to  be formulated.  The choice ,  therefore does  not
represent the general optimal layer choice  even for this example cell. However,
this sample study  serves as an illustrative demonstration of  the trade-offs in
energy  versus  power handling  capability  of  a cell  for  a  specific set  of
conditions. Furthermore, it introduces  the complicating aspect of usable
capacity into what would have otherwise been a trivial exercise, thereby setting
the tone for the development of a general layer optimisation framework for pouch
cells.

 
Scope and Context within xeV Powertrain



It is  important to provide the  contextual setting for this  layer optimisation
work since it is nestled deep  within the broader horizon of electric drivetrain
optimisation. fig:fig_PowertrainSchematic  provides a  graphical overview
depicting the hierarchical architecture of  a typical xeV powertrain, from
the  system level  down to  a  single electrochemical  layer. The  rest of  this
section describes the scope of this  layer optimisation work and its integration
into this  overall architecture. A further  set of assumptions that  were deemed
inopportune to be discussed  in subsec:layeroptassumptions, is introduced
at apropos junctures  throughout this narrative. The overall  architecture of an
xeV  powertrain  can  be  studied through  a  systematic,  hierarchical
evaluation at ---
*[label=*)]
    the system-level,
    the pack-level, and
    the cell-level.



























System-level --- vehicular platforms

The top row of  fig:fig_PowertrainSchematic represents the typical layout
of a series-hybrid powertrain . Partly to supply the
mechanical  power and/or  partly  to  charge the  battery  during propulsion,  a
downsized ice is  employed. The ice is coupled to  the pack's DC bus
through  a  generator  and  three-phase  rectifier.  While  tackling  the  power
handling  requirements,  irrespective  of  whether  a  bev  or  phev
powertrain is  being considered, the  cells in the pack  are to be  designed for
the  worst-case operating  scenario  without  any power  support from  the
ice. This implies that all discharge  simulations of the phev are to
be conducted with  the powertrain operating in all-electric mode  resulting in a
net charge-depletion. The only distinction is that the magnitude of power
to  be handled  by the  pack in  this worst  case scenario  is vastly  different
between the bev and phev  cases. This allows for some simplification
as explained  below and  helps to  narrow down the  scope of  the problem  to be
tackled.

Omitting the  components to the  left of the  battery pack (represented  as text
boxes with light grey border) shall render a powertrain corresponding to that of
a  bev.  The proposed  layer  optimisation  methodology is  developed  and
presented in the context of this  bev powertrain. However, being a modular
framework, the optimisation methodology may  be readily extended to a phev
powertrain.

As  shown   in  fig:fig_PowertrainSchematic,  the   bev  powertrain
typically comprises of ---
*[label=*)]
    a battery pack,
    a three phase inverter,
    a pmsm,
    a gearbox for  torque multiplication, and
    the rest of the  powertrain  (differential shaft  and driven  wheels).

Considering the  worst-case scenarios, the  power to  be handled by  the battery
pack arises due to  ---
*[label=*)]
    fast charging from  the mains  (charge), or
    acceleration  from standstill  (discharge).

The   acceleration  power   is  computed   from  the   power  required   at  the
wheels .  The   details  of  this  calculation   is  presented  in
sec:accpathway.  The  sign  convention  used  in  this  chapter  is  that
the  charging power  is positive  (and  consequently, the  discharging power  is
negative).

Pack-level --- strings, modules  cells

Delving  into the  battery pack  under  consideration, this  thesis considers  a
standard  modular  layout wherein  the  phev  pack  has one  string  while
the  bev  pack  has  three  parallel strings.  Within  each  string,  both
vehicular  platforms employ  8 series-connected  modules.  Taking cognisance  of
the  benefits  of common  module  design,  identical  pack modules  are  assumed
across  both  xeV  platforms  which  is  then  extrapolated  to  impose  a
stronger  condition  of  identical  geometry  for  the  constituent  cells  (see
subsec:layeroptassumptions). The  exterior dimensions of the  pouch cells
under consideration are listed in tbl:lcoSimParamslayeropt.

Each module consists  of 12 identical series-connected cells  denoted by battery
circuit symbols (cyan-filled  blocks in fig:fig_PowertrainSchematic). The
phev pack is  smaller and consists of only 13  of the cells in
the bev pack. Assuming that the bev pack consists of a 96S-3P
cell  assembly,  this implies  that  the  phev  pack  shall conform  to  a
96S-1P layout. The DC bus voltage is unaltered since both packs have same
amount of  series cells. The power  flow is assumed to  be uniformly distributed
across all  the cells within  the pack(s). At first,  the power required  at the
terminals of the  pack is computed. From this, a  first-order design ball-parking
of the layers of the cell is made through a single cell simulation. This process
enables reduced simulation run-time with the conditions of one cell assumed to be
representative of all cells in the pack.




While the aforementioned assumption of identical cell conditions across the pack
seems infeasible at first glance, three careful considerations have been made to
justify  this assumption.  Firstly,  power  (and not  current)  is  used as  the
stimulus to the cell. This  implies that, despite the parallel connection
of cells  (in groups of three  cells within each module),  each cell experiences
the same  power. Even  across parallel-connected strings,  the power  handled by
each cell shall be the same.  This necessitates the modification of the standard
dfn  model in  order to  accommodate power  inputs which  is discussed  in
sec:innatepowerinput. Secondly,  although the current  in all cells  of a
series  string remain  the same  (by virtue  of Kirchoff's  current law),
their  terminal voltage  levels could  drift away  from each  other and  becomes
unbalanced over  time . This naturally raises  questions on the
assumption  of  identical  conditions  for  all  cells.  However,  this  voltage
unbalance is mitigated with the help of modern bms that employ balancing
techniques  such as  passive  bleeder resistors  or  sophisticated active  dc/dc
converters. Yet another adverse effect that  poses a threat to the assumption of
identical  conditions  is  the  uneven distribution  of  cell  temperatures.  In
automotive packs employing natural convection, cells that are physically located
innermost in  the string tend  to get hotter  than the outermost  cells. Through
good thermal management  design  forced cooling through  circulation of the
coolant through conduits grooved into the pack, thermal balance may be achieved.
Therefore,  it  can be  argued  that,  when  operating  in a  well-designed  and
controlled environment,  cell-to-cell deviations  are minimised.  This justifies
the  global representation  of  all  cells in  the  pack  through a  single-cell
simulation, although modifications to the  simulation model are deemed necessary
to facilitate power inputs.




Cell-level --- layers, cooling, electrochemical  thermal models

The    illustration    at     the    centre    of    the     bottom    row    in
fig:fig_PowertrainSchematic shows  a schematic  representation of  a cell
arranged within  each module. In practice,  the physical layout of  cells within
a  module  is  slightly  more  complex.  For  instance,  a  typical  arrangement
consists  of  groups   of  3 parallel  cells.  However,   the  illustration  in
fig:fig_PowertrainSchematic  suffices to  explain  the necessary  details
required for the specific task at hand.

Each cell in the pack consists of a number of identical layers . Each layer
consists of ---
*[label=*)]
    a positive current-collector,
    a positive electrode region,
    a separator material,
    a negative electrode region, and
    a negative current-collector.

Particular attention is called out in  regard to the distribution of temperature
within  the cell.  In  the schematic  of fig:fig_PowertrainSchematic  the
shading scheme  is such that greener  tints represent the hotter  regions of the
cell while bluer tints represent colder regions. Furthermore, heat exchange with
the surroundings is also graphically  illustrated through cooling plates mounted
at the tabs  of the cell. This  highlights the specific type  of cooling assumed
 tab-cooling  as  opposed to  conventional  surface-cooling
historically employed for automotive applications. The assumption of tab-cooling
is an  essential requirement for  upholding the  validity of the  proposed layer
optimisation scheme, and therefore warrants further justification.

An  experimental  study  by   Hunt    compared  tab  cooling
of  cells  against conventional  surface  cooling.  It  was found  that  
8 increase in the usable  capacity of pristine cells was achieved
with tab cooling relative to that  achieved with surface cooling. Secondly, with
surface  cooling, the  loss rate  of usable  capacity over  thousand cycles  was
nearly thrice of that with tab cooling.  This implies that using tab cooling can
potentially help to extend the lifetime of  the pack by three times. Thirdly, at
higher discharge rates,  surface cooling resulting in a loss  of usable capacity
of 9.2 compared  to just 1.2 for  tab cooling. The
simulations  discussed  as  part  of  the  optimisation  framework  reported  in
sec:layeroptframework are intended to  obtain robust cell designs capable
of handling  worst-case power inputs.  In these  scenarios, tab cooling  is more
appropriate.  Therefore,  this author  has  no  qualms about  recommending  this
specific cooling mechanism  to be used in conjunction with  the results reported
(see  sec:resultslayeropt) by  applying the  proposed layer  optimisation
scheme.

Apart  from  its  aforementioned  beneficial   effects  on  cell  longevity  and
performance,  with the  integral  assumption  of tab  cooling,  there exists  an
important side effect  that affects the very  core of the numerics  of the layer
optimisation methodology.  Carefully examining the  shading scheme used  for the
schematic  in the  centre-bottom  of  fig:fig_PowertrainSchematic, it  is
clear that  at any vertical  co-ordinate in space  within the cell,  the shading
across the entire cell width remains  uniform throughout. This implies that each
layer  along  a  one-dimensional  cross-section  of the  cell  is  at  the  same
temperature. Based  on the inferences from  Hunt  , with tab
cooling, only  small thermal gradients are  induced in the planar  direction. In
this unique scenario,  the thermal effects within the cell  are not large enough
to warrant a detailed numerical discretisation.  On the other hand, ignoring the
temperature distribution  of the  cell shall  not lead  to robust  cell designs,
especially given  that design simulations  typically involve high  magnitudes of
power.

In  situations akin  to  aforementioned circumstances,  a  lumped thermal  model
of  the cell  has  been  recommended by  Pals  and Newman .  This
represents a good trade-off between accuracy and simplicity and hence, is deemed
to  be  appropriate for  this  design  application.  A  suitable value  for  the
convective heat transfer  coefficient  (see tbl:lcoSimParamslayeropt),
comparable  to the  typical  magnitudes in  forced air  convection,  is used  to
represent the heat transfer from the  cell to the environment. The heat exchange
area is the combined  surface area of the two cooling tabs  that are situated at
either end  of the  cell. The temperature  of the coolant  (a thermal  `sink' in
thermodynamic  terminology) is  denoted by .  In this  work, this
ambient temperature is held constant during  the course of a simulation run, but
is allowed  to change to  different constant  values between set  of simulations
as  per relevant  vehicle  testing  standards. The  details  of  this aspect  is
discussed  in  sec:layeroptframework.  The  material  properties  of  the
constituent components  of each layer  coupled with  the total number  of layers
used  determine  the  lumped  mass  and specific  heat  capacity  of  the  pouch
cell.  These  computations  are  discussed  in  sections 
and  respectively. The  assumption of tab cooling  thus leads to
this qualitative  description of  the lumped  thermal model to  be used  for the
design simulations.  Further quantification by  way of relevant  model equations
and  the computation  of  the constituent  parameters of  the  thermal model  is
embedded as an integral aspect of  the layer optimisation framework and shall be
presented in sec:spheat.

As a final observation, all layers  within the cell are electrically in parallel
which implies that their terminal voltages are identical. The current (or power)
at the  cell terminals is  shared equally  among each layer.  The aforementioned
considerations have important  ramifications on the cell modelling  and helps to
drastically  simplify  it. Specifically,  these  considerations  imply that  the
electrochemical  performance  of any  one  layer  is  identical to  every  other
layer.  Therefore,  in conjunction  with  a  lumped  thermal model,  a  standard
p2d  discretisation  of  the  dfn  model  suffices  to  capture  the
electrochemical behaviour of  the entire cell. The  bottom-right illustration of
fig:fig_PowertrainSchematic presents a  one-dimensional discretisation of
the  cell layer  across its  thickness. The  spheres along  the axial  direction
represent computational nodes  wherein the solid-phase diffusion  equation is to
be solved  (see sec:dfnmodel for a  brief overview). It is  this standard
dfn  model,  suitably  amended  to  accept  power  inputs,  that  will  be
the  backbone of  the  electrochemical  aspects of  the  design simulation.  The
electrochemical model shall be strongly coupled  in a bidirectional sense to the
lumped thermal model   the temperature of the cell  shall influence various
cell parameters  (see tbl:lcoSimParamslayeropt) while  the overpotentials
and currents in  the cell shall play a  role in the rate of  heat generation and
cell temperature simultaneously.

Thus, through a  systematic set of simplifying assumptions  that are justifiable
in a real-world  design, the system-level requirements at the  pack-level can be
suitably  scaled  down  to  power-density  inputs at  the  layer  level.  Having
established the  contextual setting and  scope of  this work within  the broader
landscape of drivetrain  optimisation, it is now possible to  proceed to the set
of numerical enhancements  required to be incorporated into  the dfn model
to handle the specific requirements of this layer optimisation task.

 
Enhancements/Modifications to Standard dfn Model


Augmentations to parameter set

Cell capacity and electrochemically active surface area

The  p2d implementation  of  the standard  dfn  model lacks  certain
parameters that are vital to the  layer optimisation process. The cell's nominal
capacity is a fundamental quantity that gets  altered as the number of layers is
varied. However, it may be surprising  to discover that this parameter is absent
in present  research literature  discussing the  p2d model.  The rationale
behind this glaring omission becomes clear  upon closer examination of the model
equations presented in  tbl:dfneqns. These equations do not  operate on a
cell level, but  instead are formulated on a normalised  basis. To clarify, only
one layer of the  cell is being modelled wherein the  stimulus driving the model
is  the applied  current  density per  unit area  rather  than the  total
external current. The model to be  used in the layer optimisation task therefore
faces  a unique  predicament ---  the need  to adhere  to the  present modelling
paradigm for compatibility  with the status quo whilst being  flexible enough to
incorporate the cell's capacity as a function of number of layers.

To  tackle  the  aforementioned  quandary,  it   is  key  to  realise  that  the
core  parameter  that  varies  with  the  number  of  layers  in  a  pouch  cell
is  the electrochemically  active cross-sectional  surface area .
Curiously, published  literature on  physics-based cell  modelling do  not place
rigorous  emphasis on  this key  parameter. More  often, much  to this  author's
chagrin, this parameter  is simply listed in a standard  table of parameters and
is typically sourced from a historic parameter-set without further explanation.

For  a pouch  cell, the  overall electrochemically  active surface  area can  be
defined as



where  is the number of layers and  is the active surface area
per layer.

Surface area per layer

A  literature search  reveals that  akin  to the  cell's capacity,  there is  no
information of cross-sectional  geometry in articles dealing  with the p2d
implementation of the dfn model. To  determine the surface area per layer,
relying on  certain assumptions and  present literature, a novel  methodology is
proposed involving  a sequence  of steps.  The process  involves selection  of a
real-world  cell, and  determining  its  surface area  per  layer.  To the  best
knowledge of the author, this  reverse parametrisation process (explained next),
mapping from a real-world cell to a new p2d parameter, is a unique idea.

[ label=*), leftmargin=0pt, itemindent=20pt, labelwidth=15pt, labelsep=5pt, listparindent=0.7cm, align=left]
    refcellselectionSelection of a suitable reference capacity cell

        This is a crucial first-step  towards obtaining a complete parameter set
        --- particularly to determine the surface area per layer.

        The  focus of  this chapter  is to  provide a  ready-to-use solution  to
        industry  that  improves  upon  the present  empirical  designs  through
        optimal  layer   configuration  of  pouch   cells.  There  is   a  clear
        motivation  to  further  increase  cell capacities  so  as  to  maximise
        the  aer, as  laid  out  in the  beginning  of  this chapter  (see
        sec:layeroptintro).

        With  this guiding  principle, as  a starting  point towards  choosing a
        reference  capacity  cell,  a  survey  was  performed  to  identify  the
        production bev  with the  highest driving  range. As  of 2018, the
        Chevrolet  Bolt bev  bears  this   distinction  with  a  range  of
        383  as  rated  by  the  United  States  Environmental
        Protection  Agency (EPA).  The  specifications of  its  battery pack  is
        listed in Liu  . The  battery pack of this bev
        consists of 288 cells  arranged in a 96S-3P  configuration, in agreement
        with  the  configuration  discussed   in  the  drivetrain  hierarchy  of
        sec:packlevelhierarchy.

        The    Chevrolet   Bolt    bev   pack    has   an    energy   capacity
        of   60.0    with   a    nominal   pack    voltage   of 350 .  However,  for   this  specific  task,  the
         capacity is required. This can be obtained as
        
             capacity of reference cell & = Pack Energy  ()Nominal pack voltage (V) No. of cells in parallel 

                                                          & = 60000350 3                                                                                            

                                                          & = 57.14
        

        [ leftmargin=10pt, itemindent=15pt, labelwidth=5pt, labelsep=5pt, listparindent=0.7cm, align=left]
            DC bus voltage and revised cell capacity

                Even  without  a  dc/dc  boost   converter,  robust  design  of  the
                powertrain during  brown-outs should  allow for  continued operation
                even   with   a  slightly   diminished   DC   bus  voltage   
                45 lower than nominal .
                Considering a maximum permissible dip of 4 in the bus
                voltage  336, the cell's capacity may be refined as
                
                     capacity of reference cell & = Pack Energy  ()Lowest pack voltage (V) No. of cells in parallel 

                                                                  & = 60000336 3                                                                                           

                                                                  & = 59.52
                
                The  reference   cell's    capacity   is  therefore
                rounded  to 60 






.

            celllowercutoffLower cutoff voltage for cells

                In  this  layer  optimisation work,  following  the  assumptions
                of    subsec:layeroptassumptions,   the    overall   pack
                configuration remains  unchanged  independent of  number of
                layers  within the  pouch.  This implies  that the  undervoltage
                threshold  for  DC  bus   voltage  throughout  this  work  shall
                remain  fixed  at 336.  Therefore,  with  96 series
                connected cells  in a string,  the lower cut-off voltage  for an
                individual  cell  is 3.5.  This  value  is
                reported  in tbl:lcoSimParamslayeropt  and is  used as  a
                termination  condition  for  all  simulations  as  explained  in
                sec:layeroptframework.

        

    Computation of electrochemically overall active surface area for reference cell

        For   the  cell   properties  in   tables 
        and ,    the    majority    of    parameters
        are      sourced      from      Subramanian  
        and                Northrop  .                In
        Northrop  ,  the   current  density  that
        corresponds to a 1C-rate discharge of  a cell with this parameter set is
        reported to be 30. With the help
        of carefully designed numerical simulations  (very slow discharge with a
        trickle current from  fully charged state until  charge depletion), this
        value is refined to 29.23.

        The  task of  determining the  electrochemically active  overall surface
        area of the reference cell is now straightforward, and is obtained as
        
            Overall surface area of reference cell, A_refcell &= Cell capacity ()1C-rate density () 

                                                                            &= 6029.23 

                                                                            &= 2.053
        
        This  value  is  listed  in  tbl:lcoSimParamsSPMp2d  for  use  in
        ch:spmanalysisch:newelectrolytemodel,  but  is  not
        used directly in  this layer optimisation work. This is  because, as the
        number  of  layers change,  the  overall  surface  area changes  as  per
        eq:overallarea. However,  determining this value is  an important
        initial step in the determination of the surface area per layer.

    Setting the pouch height for the reference cell

        Although  the   official  press   release   from
        the  manufacturer  of  the  Bolt  bev does  contain  data  on  the
        cross-sectional  geometry of  the cell,  it does  not report  the cell's
        height. Hence,  this information  needs to  be assumed  by extrapolation
        from an alternate source wherein the  conditions are similar and so that
        value may be applied for the reference cell.

        The   review  article   by  Groger     discusses
        the   state   of   the   art    in   energy   densities   of   electrode
        materials    used   in    various    lithium    ion   chemistries.    At
        the    time    of   its    publication,    the    areal   capacity    of
        cells  were 2.0.
        These    authors   recommended    an    areal    capacity   target    of
        4.0  for future  automotive
        applications. The said publication also considers the aspect of stacking
        layers  into  pouches  of   certain  geometries.  In  particular,  table
        4  of Groger    considers a  pouch
        of  10 height,  for  which  the aforementioned  areal
        capacities were calculated.

        In       the        case       of       the        reference       cell
        under       consideration,       the      areal       capacity       is
        


        which is  close to the desired  value in automotive applications  as per
        the recommendations  in Groger .  Considering that  the reference
        cell is based on the high  energy density Chevrolet Bolt bev cell,
        a pouch height of 10 is justifiable for this task and
        is reported  in tbl:lcoSimParamslayeropt. As per  the assumptions
        discussed  in  subsec:layeroptassumptions,  this  value  is  held
        constant throughout the layer optimisation process.

    stackthicknessComputation of stack thickness of reference cell

        In a  pouch of given height,  the available space to  accommodate layers
        therein is restricted  by a number of factors. For  instance, the wiring
        from the  current collectors  to the tabs,  protective elements  such as
        fuses  etc. consume  physical  space. Furthermore,  the pouch  material
        itself has a  finite thickness and hence after accounting  for this, the
        stack thickness  available for layer  placement is lower than  the pouch
        thickness.
        
            Stack thickness, L_stack & = Pouch height - 2pouch thickness 

                                                   & = H_pouch - 2 T_pouch                    

                                                   & = 10.0 - 2(160e-3)                         

            L_stack                         & = 9.68
        
        The computed  value of stack  thickness is  held constant for  all layer
        choices trialled in the entire layer optimisation process.

    Determination of number  of layers within  reference cell

        The  next  step  is  to  determine  the  number  of  layers  within  the
        reference pouch  cell . The  thickness of  a complete
        electrochemical sandwich multiplied  by the number of  layers yields the
        total stack height
        



        The product of number of layers  and the thickness of an electrochemical
        sandwich  cannot exceed  the  overall stack  height.  This implies  that
        the  equality in  eq:stackheightrefcell is  to be  changed to  an
        inequality, with  the upper bound of  the expression on the  lhs of
        eq:stackheightrefcell set to the stack height.
        
            n_refcell (l_Al + l_pos + l_sep + l_neg + l_Cu) & L_stack 

            n_refcell                                                                            & L_stackl_Al + l_pos + l_sep + l_neg + l_Cu
        

        Since fractional layers do not have  any physical meaning, the number of
        layers that  can be  accommodated within  any pouch  must be  an integer
        quantity. Therefore,   is  computed as the  `floor' of
        the quantity in the rhs of eq:stackheightrefcellmod
        
            n_refcell &= *L_stackl_Al + l_pos + l_sep + l_neg + l_Cu 

             &= *9.68(15 +  72 + 25 + 88 + 10) 10^-3 

            n_refcell &= 46
        
        The reference cell is thus determined to consist of 46 layers.

    Computation of surface area per layer

        Substituting  the values  of  and  
        into  eq:overallarea, the  electrochemically active  surface area
        per layer is obtained as
        
            A_elec & = A_refcelln_refcell 

                        & = 2.05346     

                        & = 44.63
        

        The   surface   area   per   layer    thus   computed   is   listed   in
        tbl:lcoSimParamslayeropt and  is held  constant across  all layer
        choices  tried during  the layer  optimisation process.  This assumption
        is  immediately  justifiable  from   a  physical  viewpoint,  since  the
        process  of assembling  layers is  performed along  the axial  thickness
        direction (aligned with  pouch height) and is independent  of the planar
        (cross-sectional) direction.



Modification of standard dfn model to handle power inputs

As   discussed  in   sec:packlevelhierarchy,   assuming  identical   cell
conditions during operation necessitates that the external stimulus to each cell
is an applied power value. The cell's terminal voltage and current can be viewed
as its  natural response  to this  power input. To  simulate this  condition and
achieve a model-based optimal layer  design, the standard dfn model, which
conventionally handles  current stimuli, has  to be suitably modified  to accept
power inputs.

Plett   suggests  a methodology  for  applying  power inputs  to
equivalent circuit models  for simulation at a fixed sample  rate. This involves
converting the input  power  to a current  using  an equivalent series
resistance . The  value of  is  updated at each time  index  as per
eq:PlettPower.



where  is the  cell's terminal voltage at time index  , evolved from the
applied current up to and including the  time step.

There  are  two disadvantages  in  using  Plett's  simplified approach  for  the
proposed layer optimisation study. Firstly, this necessitates the quantification
of  a  lumped  electrical  resistance  for  a pbm.  Such  an  idea  is  at
loggerheads  with the  fundamental  philosophy of  pbm  which strive  to
represent  a  detailed  picture  of  underlying phenomena,  as  opposed  to  the
system-level terminal  behavioural characterisation facilitated  by ecm.
Translating  power  to current  in  this  manner  also necessitates  a  two-pass
conversion between the  physical and electrical domains --- a  process likely to
significantly degrade modelling fidelity. Since  the results from application of
the model  shall inform the  number of  layers to be  used in a  real-world cell
design, such loss of fidelity is unacceptable. Secondly, the constraint of using
fixed interval updates  implies that a high-speed  adaptive time-stepping solver
cannot be used for handling this power input condition. This shall slow down the
simulation speed considerably since the search space of layer combinations to be
considered is  fairly large.  Furthermore, the simulations  have to  be repeated
over  multiple combinations  of  initial and  ambient  temperatures which  shall
significantly  slow  down the  model-based  design  simulations and  offset  its
advantages over a conventional prototype-based design.

Dees    identified the  requirement  of  having a  p2d
model that  can run on applied  power. However, in the  aforementioned work, the
relevant equations for reformulation of  solid-phase boundary conditions are not
presented. An  independent derivation  of reformulating  the p2d  model to
facilitate  an  innate  power  input capability  is  therefore  provided.  Since
the  equations  are  derived  for  a single  layer,  the  power  density,
obtained by  dividing the  applied power by  the overall  active cross-sectional
area , is used as the driving input.

In  the  p2d  model,  charge  conservation in  solid  phase  is  given  by
eq:solidchargeconserve,  which is  revisited  below.  The subsequent  two
equations pertain to the corresponding  boundary conditions. In these equations,
the current density  represents the applied input.

    x (_eff _s(x,t)x ) &= a_s F j(x,t) eq:solidchargeconserve revisited

    _eff _s(x,t)x _x_pos/Alcc
x_neg/Cucc &= -i

    _eff _s(x,t)x _x_pos/sep
x_neg/sep &= 0


eq:undiscretisedPhiSpowerBC   replaces   the    boundary   condition   in
eq:solidchargeconservecurrBC  to use  the  applied  power density   to
drive the model.








    eq:ctspowerconstrainteq:cellpositivity  represent the  constraints
    pertaining to physical laws and are to be satisfied.
    
	    vi  - p & = 0  

	    v       & > 0 
    
    eq:ctspowerconstraint  conveys  the  condition that  the  product  of
    the  terminal  voltage   and  computed  current  density   shall  equal  the
    externally applied  power density, whereas  eq:cellpositivity implies
    that  the  cell's  terminal  voltage shall  always  remain  positive  during
    operation.   eq:undiscretisedPhiSpowerBCeq:cellpositivity  are
    then discretised for numerical implementation as follows.

    fig:1d_fv_mesh describes  a schematic  overview of  a one-dimensional
    cell-centred fv  discretisation scheme. Here, evenly  spaced nodes are
    considered to form the support mesh along the through-thickness dimension of
    a  layer.  Vertical  lines  denote  the edges  of  control  volumes  whereas
    the  filled circles  depict  computational nodes  where the  axial-direction
    variables from tbl:dfneqns are solved.

    








    eq:discretisedPhiS      represents     the      weak     form      of
    eq:solidchargeconserve  applied   on  the  fv  mesh   for  each
    control  volume, wherein  subscripts   and  denote  the
    th  fv node  and  its associated  left and  right
    edges respectively.
    



    At this juncture, a simplifying approximation for the solid-phase potentials
    can be considered.  In the standard fv scheme, the  solution values at
    the faces (edges  of control volumes) is obtained by  interpolating from the
    two nearest fv node values.  At either extrema of this one-dimensional
    computational  domain,  a  linear  extrapolation  of  the  values  from  the
    first  and last  nodes  can be  performed. This  increases  the accuracy  of
    computations, thereby  providing good estimates  of solid potentials  at the
    two current collector interfaces. However, with the increased fidelity comes
    the  penalty  of  a  mathematically  complex  set  of  boundary  conditions.
    When  using high  node  densities  in the  negative  and positive  electrode
    regions (see tbl:lcoSimParamslayeropt), for the two outermost control
    volumes, the values of  become small. With a reasonably
    small mesh interval, the potentials at the cell centres can be considered to
    be nearly equal to that at their corresponding current collector interfaces.
    This  assumption  helps  to  keep  the  resulting  mathematical  expressions
    tractable.

    Applying    eq:discretisedPhiS    to    the    first    control    volume
    (0th node) in  the positive electrode and to  the last control
    volume (nth node) in the negative electrode,
    
	    -_eff_pos _s_0x_pos + _eff_pos _s_1x_pos + i &= a_s_pos F j_0 x_pos

	    -_eff_neg _s_nx_neg + _eff_neg _s_n-1x_neg - i &= a_s_neg F j_n x_neg
    

    Multiplying    eq:PhiSappliedBCpos    by     and
    eq:PhiSappliedBCneg by  and subtracting,
     
        -_eff_pos ^2_s_0x_pos -
        _eff_neg ^2_s_nx_neg +
        _eff_pos _s_0 _s_1x_pos +
        _eff_neg _s_n _s_n-1x_neg 
+ p -
        a_s_pos F j_0 x_pos _s_0 - a_s_neg F j_n x_neg
        _s_n = 0
    



    Two     solutions     exist     for    the     quadratic     equation     in
    eq:pinputBCcomplete.  However, the  solid  phase  potential, being  a
    physical quantity of the cell, has a unique solution. Therefore, in order to
    achieve  numerical convergence,  an  additional  positivity constraint,  the
    fv-discretised equivalent of eq:cellpositivity, is imposed.
    


    Finally,   since   the  input   to   the   model   is  the   applied   power
    density ,  the  current  density  within  each  layer ,  needs  to  be
    solved  for.  This   is  facilitated  by  employing   the  discretised  form
    of  eq:ctspowerconstraint.   Furthermore,  since  this   equation  is
    mathematically simple, the aforementioned assumption of using node values at
    current  collector  interfaces is  no  longer  required. Applying  a  linear
    extrapolation  scheme  at  the  outermost  control  volumes,  the  algebraic
    residual equation is obtained as
    


    The    computer    code    used    (LIONSIMBA v2.0,    to    be    discussed
    in    sec:platformlionsimba)    employs    the    dae    solver
    IDA  to handle such algebraic constraints.

    eq:pinputBCcompleteeq:currdensityresidual therefore represents
    the discretised form  of the reformulated boundary  condition and associated
    algebraic constraints  for the solid  phase potential pde that  can be
    applied to either electrode to facilitate  the use of an input power density
    to the p2d model.

    Hybrid spectral-fv scheme

    Fast  and accurate  estimation  of the  solid  phase lithium  concentration,
    particularly  its  value  at  the  surface  of  electrode  particles  is  an
    inherent  requirement  of  the  layer optimisation  procedure  presented  in
    sec:layeroptframework.  The  high  power  densities  to  be  handled,
    particularly  at  low layer  counts  necessitate  this requirement.  It  has
    been  acknowledged  that  solid-phase concentration  calculations  employing
    polynomial   approximations   lack   fidelity   at   high   charge/discharge
    rates . Hence, a  conventional full-order solution
    based on  Fick's law of  diffusion is  required for this  layer optimisation
    task.

    With full-order solid phase diffusion dynamics, applying the fv scheme
    (that has been employed in LIONSIMBA v1.0x (see sec:platformlionsimba
    for   a  discussion   of  this   modelling  platform)   to  discretise   all
    through-thickness pde of the p2d model) results in a very large
    system of equations. This  is due to the requirement of  using a high radial
    node density per spherical particle for improved accuracy. Consequently, the
    computational cost is  high and simulation run-time  becomes prohibitive when
    exploring the search  space of all possible  layer configurations. Moreover,
    with a cell-centered fv discretisation,  it is non-trivial to directly
    apply  the ionic  flux boundary  condition  at the  particle surface,  since
    this  involves  extrapolation from  at  least  two  other nodes  within  the
    particle. While  such extrapolations are  acceptable in the  axial dimension
    ---  particularly  with  high  node  densities  providing  small  values  of  --- they are  undesirable in the radial dimension. This
    is because the cell's ocp and terminal voltage strongly depends on the
    concentration at the particle surface.  Spectral methods offer a combination
    of  high accuracy  and speed  while  permitting the  use of  a lower  number
    of  radial  discretisation  nodes.  To  implement a  spectral  scheme  on  a
    non-periodic domain, a  Chebyshev discretisation  may be
    applied. Bizeray   discretised all of the p2d
    model equations using this approach.  However, this entails a bi-directional
    mapping of all  field variables between the physical  and Chebyshev domains,
    incurring computational overhead.

    For the proposed layer optimisation simulations, a hybrid formulation of the
    p2d model is proposed wherein a  standard fv scheme in the axial
    dimension and  a spectral scheme in  the radial domain are  used. Exploiting
    this natural separation of the axial and radial domains enables to ---
    *[label=*)]
        retain  the   ability  to  easily   couple  the   molar  flux  density   at  the particle  surface  through  reformulation  of the  boundary  conditions  of  the solid  diffusion pde,  and
        solve  for  solid-phase  lithium  concentration  in  the  Chebyshev  domain  and locally transform  to physical  domain, without requiring  system-wide Chebyshev reformulations.
    
    Although  the  proposed  implementation   does  not  globally  employ
    a  spectral  scheme,  the   combined  beneficial  effects  of  radial-domain
    spectral   scheme  and   automatic  differentiation   of  system   equations
    using  CasADi  facilitate  rapid simulations,  enabling
    the   completion  of   the   layer  optimisation   in   a  short   duration.
    eq:defineChebNodeseq:solidDiffEqChebDomain  detail  the  steps
    leading  up to  the reformulated  solid phase  diffusion and  its associated
    boundary conditions in the Chebyshev domain.

    The  Chebyshev   collocation  nodes,  defined  on   a  1D  mesh
    in   the   radial   direction,  are   given   by   eq:defineChebNodes
    (see ).
    


    Assuming constant diffusivity, expanding the derivative in the standard form
    of the Fickian spherical diffusion equation (see eq:dfnsoliddiff) for
    each particle, we obtain  eq:quotientappliedpde, presented along with
    its Neumann  boundary conditions, eqs. eq:quotientappliedpdeBCcentre
    and eq:quotientappliedpdeBCsurface.   is the  molar flux  density
    (mol.m^-2.s^-1) and  is the particle radius (m).
    
    
    
        
            
            c_st &= D^eff_s ( r c_sr + ^2 c_sr^2 ) r [0, R_p]

            c_srr = 0 &= 0

            D^eff_sc_srr = R_p &= -j
        
    
    

    Mapping ,
    



    Applying mappingChebDomain to
    eq:quotientappliedpdeeq:quotientappliedpdeBCsurface whilst
    retaining  in the physical space yields
    eq:solidDiffEqChebDomaineq:solidDiffEqChebDomainBCsurface.
    
        
	        c_st                         & = 4 D^eff_sR_p^2 ( 2r + 1 c_sr + ^2 c_sr^2 ) 

            c_srr=-1 & = 0                                                                                                                                                                                                                

            2 D^eff_sR_p c_srr=1 & = -j
        
    

    During  the  iterative solution  process,  the  spatial gradients  of  solid
    phase  lithium  concentration  in  eq:solidDiffEqChebDomain  in  this
    case  are  not  computed   through  an  explicit  differentiation  procedure
    as  usual,  but  instead  evaluated  by  pre-multiplying  the  concentration
    values  at the  collocation  nodes by  a  Chebyshev differentiation  matrix.
    This  particular  aspect  is  responsible  for  the  inherent  reduction  of
    simulation  run-time  achieved  by  introducing a  spectral  method.  In  the
    updated  version  of LIONSIMBA v2.0  (created  specifically  for this  layer
    optimisation work; see sec:platformlionsimba  for a brief overview of
    the  modelling platform),  differentiation matrices  of suitable  dimensions
    as  well  as  the  Chebyshev  collocation  nodes  are  generated  using  the
    MATLAB  function   cheb.m  distributed  along  with   the  book  by
    Trefethen .





 
Computational Framework




Introduction and guidelines for flow diagram traversal

The  methodology adopted  by the  proposed layer  optimisation framework  can be
explained by  using the  flow diagram in  fig:fig_strategy_schematic. The
power  handled by  the cell  during normal  operation (evaluated  by considering
various drivecycles)  is much  lower than  that experienced  during acceleration
(discharge)  and  fast-charging (charge)  scenarios.  sec:resultslayeropt
provides  a brief  summary of  the peak  and median  powers across  all standard
drivecycles. Therefore, from a design  perspective, it is sufficient to consider
the power  requirements for  these two  extreme cases.  Hence, the  schematic in
fig:fig_strategy_schematic can  be studied  by broadly dividing  the flow
diagram into two parts ---
*[label=*)]
    an acceleration pathway (primarily consisting of blocks shaded in grey), and
    a fast-charging pathway (predominantly composed of blocks shaded in cyan).




















As indicated by  the legend in fig:fig_strategy_schematic,  blocks with a
light grey border represent input  data/parameters for computations. Blocks with
a standard black  border represent computations common to  both acceleration and
fast charging pathways. The design output  is given by the double-bordered block
at  the  bottom  centre  of fig:fig_strategy_schematic.  Other  types  of
blocks  and arrows  are  appropriately listed  in  the legend  key.  To aid  the
understanding of the  layer optimisation framework, the reader  is encouraged to
correlate  the narrative  in this  section  with the  blocks and  arrows in  the
schematic.  The  acceleration  and  fast  charging  pathways  are  not  amenable
for  standalone comprehension  and  are to  be parsed  in  conjunction with  the
flow  of  control through  the  infrastructure  blocks  as  if the  entire  flow
diagram  is a  single  cohesive unit.  These `control'  blocks,  common to  both
pathways  in fig:fig_strategy_schematic,  govern how  these two  pathways
are  to be  traversed  with the  presently trialled  layer  choice and  quantify
the  suitable  reformulations needed  whenever  a  new  layer  choice is  to  be
used.  The  computational aspects  covered  by  these  blocks are  described  in
sec:searchalgosec:spheat.

Acceleration pathway

The computations for acceleration-based layer  optimisation begins at the anchor
block labelled `Start Acc. Calcs.'.

Determination of acceleration rate, final speed and acceleration time

The  first  step is  to  determine  the rate  of  acceleration  to be  used  for
computing the power requirements for  accelerating an xeV from standstill.
For  various  other  regulatory  reasons, vehicular  standards  for  electrified
transport are  codified by various  standardisation bodies ( the SAE J1772
standard ). The  standards published by these  regulatory agencies
typically specify  a minimum  required acceleration rate  for the  vehicle under
consideration  to be  certified as  an electric  vehicle. Additionally,  vehicle
manufacturers  often provide  their own  specifications, which  typically exceed
these minimum standards. However, for  certain classes of electric vehicles such
as golf carts,  the manufacturer-specified standards might fall below  that of a
roadworthy  electric vehicle.  This thesis  advocates a  conservative design  by
choosing the higher of the two values.

The  acceleration  rate  is  calculated   by  dividing  a  pre-determined  final
speed   by the  time  taken  to attain  that speed  from
standstill.  The  manufacturer-specified  acceleration  rate   is
compared  against  the minimum  acceleration  rate  specified by  the  governing
vehicular   standards .  The   two  spdt   switches  assign
the  final  speed   and  acceleration  time   using  the
corresponding values from  the appropriate source depending on which  of the two
acceleration rates is higher.

Computation of acceleration power at the wheels

The  next  step  is  to  calculate   the  acceleration  power  required  at  the
driving wheels .  Using the  governing equations from  basic vehicle
dynamics , the power at the wheels of an xeV is given
by eq:wheelpower.

    
        
        P_w     & = P_mass + P_drag + P_roll + P_grade                   

        P_mass  & = 12 M_v(n)t_a (v_b^2 + v_f^2)  

        P_drag  & = 12 (_air C_d A_vv_f^3)             

        P_roll  & = C_r M_v(n) g v_f                                                  

        P_grade & = M_v(n) Z g v_f 
    


The  individual  components  contributing   to  the  summation  for  wheel-power
computation   presented   in    eq:wheelpower   is   briefly   explained.
 represents  the  power  required  to  accelerate  the  vehicle's
mass.    and   denote   the  powers   required  to
overcome   air  resistance   and  rolling   resistance  respectively.   Finally,
 represents  the power  required to  negotiate a  road gradient.
Except for   which is described next, all terms  in the rhs
of eq:masspowereq:gradepower  are constants. The  nomenclature for
each  of  these  terms   is  explained  in  tables 
and   along with  their  numerical  values used  in
simulation.

Computation of layer-dependent vehicle mass

Changing  the layer  count used  within a  cell changes  its mass.  This in-turn
affects the mass of the pack, which further influences the overall vehicle mass.
Hence, for  precise computation  of  in  eq:masspower, the
vehicle's  mass is  computed  as a  function  of number  of  layers within  each
cell .

In  the  schematic  of fig:fig_strategy_schematic,  this  layer-dependent
calculation of  mass of all cells  in the pack  is  shown by the
product of  the signal  labelled  and  the triangular  gain block
representing the overall number of cells in the pack .




The  mass of  the vehicle  is  given by  the sum  of chassis  mass ,
vehicle payload , pack overhead  and the layer-dependent
mass   of   all   cells   in   the  pack    as   computed   in
eq:massofallcells.   The   computation  of   mass   of   a  single   cell  is detailed in sec:massofonecell.

Computation of acceleration power density per layer

Since the p2d equations of the dfn model are based upon a normalised
unit area and is  applicable only to each electrochemical layer,  the goal is to
compute the  power density experienced  by each layer. This  is arrived at  by a
sequence of simple scaling steps.

Firstly, the power demanded  at the pack terminals  is
computed  by  dividing  the  power  at  the wheels  by  the  efficiency  of  the
drivetrain.  As explained  in subsec:layeroptassumptions,  the drivetrain
consists of  a number  of components,  the efficiencies of  which depend  on the
operating point  (such as the  speed and torque  of the electric  motor, current
drawn  by the  power electronics  etc.). Following  the assumptions  detailed in
subsec:layeroptassumptions,  a single  lumped efficiency 
can be  used for the powertrain.  The power demand  on the pack is  then divided
by  the  number of  cells  in  the pack   to  obtain the  power
demand  at the  input  of the  cell's terminals .  For
each  layer choice ,  the overall  electrochemically active  surface area  is
computed  using by  using eq:overallarea,  wherein the  surface area  per
layer  listed in tbl:lcoSimParamslayeropt is held constant
throughout.  Finally, the  acceleration power  density per  layer 
is  computed  by  dividing   by  the  overall  surface
area .

Thermally-coupled p2d simulation and exit
conditions

For  the  presently trialled  layer  choice ,  a thermally-coupled  p2d
simulation is performed for a duration  of  seconds with the applied
power  density   corresponding  to  the present  layer
choice  as input  to  the  model. When  the  simulation  terminates, the  cell's
condition is compared against three criteria

    the maximum possible values of cell temperature ,
    the minimum allowed terminal voltage , and
    the lowest allowed cell soc .

This helps  to determine  whether the  cell constructed  from the  present layer
choice is  able to  successfully satisfy the  acceleration power  demands. These
comparison operations are represented by  decision blocks placed in the leftmost
region of the schematic in fig:fig_strategy_schematic.

If  any one  of the  three aforementioned  exit checks  fail, the  present layer
configuration is deemed  to be not feasible and the  entire workflow is repeated
by  trialling a  new  layer  choice. A  sophisticated  search  algorithm, to  be
described  in  sec:searchalgo, is  employed  to  minimise the  number  of
iterations  needed  until  a successful  layer  choice 
is  obtained.  The above  process  is  repeated  for different  combinations  of
initial and ambient temperatures . The largest
successful  layer value  from  all  temperature combinations  is  deemed as  the
canonical  optimal design  choice  when considering  acceleration demands.  This
concludes the narrative describing the acceleration-specific pathway.


Fast-charging pathway

The  workflow describing  the optimal  layer calculation  for the  fast charging
scenario begins  with the  anchor block labelled  `Start Fast-Charge  Calcs.' in
fig:fig_strategy_schematic. The charging algorithm used in this framework
is based  upon the model-based strategy  proposed by Choe  ,
wherein  the surface  concentration is  never allowed  to exceed  its saturation
value.  Adopting  this charging  scheme  leads  to  a  robust cell  design  that
is  resilient  to  lithium  plating.  A  major  departure  from  the  scheme  in
Choe    is the  fact that  the constant  current phase  used
therein is replaced  by a constant power  phase. This is so  that the assumption
of  identical  conditions  across  all  cells   in  the  pack  holds  true  (see
subsec:layeroptassumptions for  details). Furthermore, the  pulsing phase
used to  top-up the cell's  soc in Choe    is omitted.
This  is because,  the level 3  fast charging  specifications typically  require
charging to a  target soc that is typically  well below 100
(see tbl:lcoSimParamslayeropt).

At     first,     the    charging     power     applied     at    the     pack's
terminals  is scaled down by the overall number of
cells in the pack.  This results in the charging power  experienced by each cell
in  the  pack .  Following the  strategy  used  in
sec:accpathway, the power  at the cell's terminals is scaled  down by the
electrochemically active  overall surface area . This  yields the
power density  experienced by each  layer in the cell and is
now  amenable  to be  applied  to  the  normalised  p2d equations  of  the
dfn model (that has been suitably modified to handle power inputs).

Thermally-coupled fast-charging simulations and exit conditions

After computing  the power  density per  layer, the  thermally-coupled p2d
model  is  then  invoked.  While  the  simulation  runs,  the  cell's  state  is
continually evaluated against various termination criteria.

    the maximum possible values of cell temperature ,
    the maximum allowed terminal voltage , and
    the surface concentration  not to exceed the saturation concentration 


If any  of these three criteria  are violated, the simulation  immediately stops
and the trialled layer  choice is deemed to not satisfy  the fast charging power
requirements. The  search algorithm then  updates the layer choice  suitably and
the entire workflow is repeated.

If the  simulation for  any layer choice  passes the  aforementioned termination
criteria,  the  soc   achieved  by  the  cell  is   compared  against  the
fast-charging   target .  If ,   then  the   present
layer  choice  represents   the  minimum  (and  therefore   optimum)  value  for
this  specific  fast  charging  application.  The  successful  layer  choice  is
labelled . If the surface concentration has not yet
reached the saturation limit, then the charge time is compared against the upper
bound for  fast charging specifications . If  this preset duration
has not been reached, then the simulation is allowed to advance further in time,
with the aforementioned  termination criteria being continuously  tested at each
subsequent time-step.

The above process is repeated for  different combinations of initial and ambient
temperatures .  The  largest  successful
layer value from all temperature combinations is deemed as the canonical optimal
design choice when  considering the fast charging power  demands. This concludes
the  narrative describing  the  fast charging  pathway.

Finally, the  maximum of the  layer choices across all  temperature combinations
from the  acceleration and  fast charging  scenarios is  deemed as  the globally
optimal  number of  layers  to be  used  for this  model-led  cell design.  This
concludes the overall narrative describing the layer optimisation framework. The
results obtained by applying this methodology to a specific numerical example is
presented next in sec:resultslayeropt.



Search algorithm

A  customised binary  search algorithm  is designed  for the  layer optimisation
framework.  Binary  search  is  a  computationally  efficient  search  algorithm
requiring a worst-case  operational count of   where  is
the  overall  number  of  layer  candidates  to  be  searched .
However, this  algorithm is  applicable only  when the array  to be  searched is
already  sorted in  either ascending  or  descending order.  By recognising  the
relationship between the  magnitude of power density applied  versus the factors
that deem a  layer suitable or unsuitable for the  application, a customised set
of `exit conditions'  that meet the aforementioned  sorted-array requirement can
be  enforced. This  specific  mapping is  a  unique  idea and  is  claimed as  a
contribution by this thesis author to the art.

This search  strategy is  equally applicable (with  small modifications  to exit
conditions as explained next) for both acceleration and fast charging pathways.

Binary search for acceleration pathway

If all the termination criteria are  successfully met, the exit condition is set
to a  value of 1. If any  of these conditions  fail, then the exit  condition is
assigned a value of 0. Thus, the search vector in this bespoke strategy consists
of only two Boolean possibilities. For ultra-low layer counts, the applied power
densities are extremely high. Therefore, one of the exit conditions is likely to
fail. For  very high layer  counts, the power  densities are very  low, implying
that acceleration runs shall always be successful. When considering layer counts
from  the lowest  to  the  highest, there  exists  a  critical transition  point
 the  first layer  count  for which  the exit  vector  toggles from 0  to 1.
Through a systematic  bisection of the layer search space,  the search algorithm
speedily converges to the optimal layer value.

Binary search for fast-charging pathway

If all  the fast-charging  termination criteria are  successfully met,  the exit
condition is  set to  a value  of 1. For  violating any  of the  following three
failure conditions (see sec:fastchgpathway)  exceeding
*[label=*)]
    upper cutoff temperature  and/or,
    upper cutoff voltage and/or
    the maximum allowed charging despite encountering surface saturation,

the exit condition is  assigned the value of 0. The search  array is bisected by
using  this failed  layer  choice as  the  new lower  bound.  If no  termination
criterion is  violated, then  the presently  trialled layer  choice is  deemed a
success and the exit condition is set to 1. The search space is narrowed down by
using the current layer choice as the new upper bound.

However,  there exists  an additional  third possibility  for the  fast charging
case.  If the  aforementioned termination  criteria  are not  violated, but  the
charging process fails to meet  the target soc specification, this implies
that the number of layers used is too high (see fig:fig_CapacityQuadrants
and sec:resultslayeropt for  a brief explanation of this  case). The exit
condition corresponding to this failure mode is assigned a value of 2. Thus, the
search vector in this bespoke strategy  consists of three distinct numbered exit
conditions. Despite being a failure, from  the perspective of narrowing down the
search space,  exit condition 2 is treated  in the same way  as exit condition 1
 the trialled layer choice is deemed to be too high.

Akin to the acceleration pathway, the  optimal layer choice for fast charging is
deemed to be at the critical transition point wherein the exit condition toggles
from 0 to 1 and  hence, minimal customisation is needed in  the computer code to
handle these two cases.  The handling of exit condition 2 is  shown in the lower
rightmost portion of fig:fig_strategy_schematic. Despite being a failure,
from the search algorithms point of view  this is treated as a success, with the
only difference  being the  assignment of  the exit  condition value  purely for
logging and debugging purposes.

Alternative search algorithm --- linear search

A  simpler alternative  to using  the binary  search algorithm  is the  standard
linear  search  algorithm. This  is  a  simple  search strategy  which  involves
sequentially iterating  from  to   until arriving at
the lowest  value   that satisfies all  the termination
criteria. However, a naive use of the linear search algorithm is computationally
expensive with a worst case operation count of . Therefore, this
thesis author  recommends the use  of the  bespoke binary search  algorithm. The
choice of minimum and maximum values for  the layer search space is discussed in
sec:layersearchbounds.

Upper and lower bounds on search space


It is  helpful to determine  the highest possible number  of layers that  can be
physically  accommodated in  a stack  of height .  For instance,
this value may be used as the  upper bound to the binary search algorithm (which
compulsorily requires  such an upper bound)  described in sec:searchalgo.
This can be obtained by defining a  simple integer optimisation task as shown in
eq:maxlayersopt. The objective function here  is to maximise the value of
the layer count   subject to the physical constraint that  the thicknesses of
both electrodes always remains positive.










eq:analytical_nmax represents the analytical  closed-form solution to the
integer optimisation problem of eq:maxlayersopt.





The  first   argument  to  the   function  in  eq:analytical_nmax
represents the maximum number of physically feasible odd layers while the second
argument  represents  the  maximum  such  value  when  considering  odd  layers.
Therefore, the greater of these two  values is chosen as the maximum permissible
layer choice  and is used as an input to the search algorithm.


In  the absence  of published  information on  how the  minimum layers  within a
pouch  cell is  currently set,  there is  presently no  unique way  to determine .  Therefore, for  this  layer optimisation  study,  the value  of
 used  by the  search algorithm  is currently set  to one  --- the
minimum physically feasible number of layers. Design engineers from industry may
opt  to tweak  this to  a higher  value based  on insights  gained from  present
empirical designs.




Electrode thickness ratio for capacity balancing

A key idea of the layer optimisation  scheme is that, for computing the physical
lengths of  electrodes as a  function of number of  layers, the ratios  of their
thicknesses , is  held constant. This coefficient  is germane to
the concept  of capacity balancing of  electrodes with a view  to equalise their
loading. The  idea of matching  the capacity of  anode and cathode  materials is
widely accepted  as a standard principle  in cell design .
The computation of this  parameter is discussed here.

Equating  the active material volume of both electrodes,




While  stacking the  layers  within a  pouch cell,  for  the negative  electrode
layers, there exists  an extra overhang of  with  respect to the
positive  electrode layers.  fig:anodeoverhangpouchcell  shows a  CT scan
depicting the two-dimensional longitudinal-sections with a close-up view of this
overhang region. This is a design feature  and helps to avoid plating of lithium
at the edges.














Neglecting   overhangs    of   the    negative   electrode    (typically   below
    to    avoid    plating    at    the    edges),    both
electrodes  have  the   same  cross-sectional  area .  Therefore,
eq:electrodeCapacity reduces to

    A_elecl_pos  _s,pos & = A_elecl_neg  _s,neg  

    l_pos  _s,pos                       & = l_neg  _s,neg




Owing to  the reasons outlined in  subsec:layeroptassumptions, the volume
fractions  of  the  electrode  materials  are  assumed  to  be  constant,  which
implies  that  their   ratio  is  also  a  constant.   The  electrode  thickness
ratio  is therefore obtained as
2
    l_ratio & = l_negl_pos                                                                                  &  & (by definition)                                          

                 & = _s,pos_s,neg                                                          &  & (rearranging eq:electrodeCapequalarea)           

                 & = 1-_pos -
_fi,pos1-_neg - _fi,neg
                   &  & (by definition, see eq:volumefraccalc)                                          

                 & = 1- 0.385 - 0.0251 - 0.485 - 0.033                                                                         &  & (substituting values from tbl:lcoSimParamsSPMp2d) 

    l_ratio & = 1.22


Computation of electrode thicknesses per layer

In  this section,  a deterministic  way to  compute the  thickness of  electrode
materials is  present. In  the views  of this thesis  author, this  represents a
departure from  the norm wherein electrode  thicknesses are designed on  a trial
and  error basis .  Following  the  assumptions listed  in
subsec:layeroptassumptions,  the exterior  dimensions  of  the pouch  are
held  constant. Furthermore,  as explained  in sec:surfareaperlayer,  the
thickness of  the electrochemical stack within  the pouch cell ,
is also considered to be constant.  Therefore, when the number of layers forming
the stack is varied,  this implies that the only quantities  that may be allowed
to change are the thicknesses of the two electrodes within each layer  higher
the  layer  count, lower  the  electrode  thicknesses  and vice-versa.  In  this
section, this  relationship between the  number of layers  and  the electrode
thicknesses  is quantified  with the help
of the key  parameter obtained in sec:electroderatio.

Figure 2 of Northrop    (suitably adapted and reproduced
in fig:topologies)  considers two possible configurations  of stacking up
layers within a pouch cell. In the first topology shown in fig:topology1,
the outermost current collectors are of copper. In the alternative configuration
shown in  fig:topology2, a copper  current collector occupies one  end of
the  stack while  an aluminium  current collector  occupies its  other end.  The
formulae derived  here is equally applicable  to both these cases.  Although the
use of aluminium current collectors at both extrema of the stack is not studied,
the approach presented here may be easily extended to this case.





























The stack height  may be obtained by  the sum of thicknesses  of the constituent
regions.

    L_stack &= _jL_j(n) + L_Al(n) + L_Cu(n)  n N, j pos, sep, neg 

    where
    L_j(n) &= n l_ja

    L_Al(n) &=
    
        (n2)   l_Al,& if  is even 

        (n+12)   l_Al,& if  is odd
    b

    L_Cu(n) &= 
        (n+22)  l_ Cu,& if  is even

        (n+12)  l_ Cu,& if  is odd

    c


The combined thickness of the  two electrode regions in each layer 
can be then obtained by rearranging eq:stackThickness




The    individual     electrode    thicknesses    can    then     be    obtained
from   eq:combinedElectrodeThickness   by    suitably   substituting   in
 and performing simple algebraic manipulations.

    l_pos &= l_cel_ratio+1

    l_neg &= l_ce - l_pos


The   values   of   the   two  electrode   thicknesses   thus   obtained   using
eq:lposeq:lneg  are used  as computational  domain lengths  in the
p2d simulations. Therefore,  these thicknesses have to  be recomputed each
time the trialled number of layers  is updated by the search algorithm.

Computation of layer-dependent cell mass

The mass of the cell varies as a  function of number of layers. This is because,
the thicknesses  of the  two electrodes  within each layer  changes each  time a
different layer choice is simulated. For a given layer choice , the cell mass
is computed as per eq:cellmass.


     m_cell &= _jm_j + m_Al + m_Cu + m_LiPF_6 + m_pouch,  j pos, sep, neg

     m_j &=   A_elec  L_j _j_j

      m_Al &=   A_elec  L_Al _Al

      m_Cu &=   A_elec  L_Cu _Cu

      m_LiPF_6 &=   A_elec (_j L_j (1-
      _fi_j-_j))_LiPF_6 

      m_pouch &= 2H_pouch L_pouch W_pouch
      _pouch
 



eq:cellmass   consists   of  both   constant   components   as  well   as
components   that  vary   with  the   number  of   layers.  For   instance,  the
mass  of  the  electrolyte   as   well  as  that  of  the  pouch
material  are constants and are computed only once.

Computation of layer-dependent cell specific heat

A lumped  thermal model of the  cell given by eq:thermalmodel  is used to
model  the  thermal  dynamics  of  the  cell.  This  thermal  model  is  coupled
with  the  electrochemical  model  equations  of the  p2d  model  for  the
simulations  used to  determine  the optimal  layer  configurations. The  cell's
temperature  is also obtained from this lumped thermal model.

	m_cell c_avg dT_celldt &= -h A_tabs ( T_cell(t) - T_sink ) + Q_pol & 

	Q_pol &= A_cell iU - V & a

	U &= U_pos(_pos)_x = x_pos/Alcc - U_neg(_neg)_x = x_neg/Cucc & b

	V &= _s_x = x_pos/Alcc - _s_x = x_neg/Cucc & c


The   average   specific   heat   of    the   cell    used   in
eq:thermalmodel is  a function of  the number of  layers and is  given by
eq:spheat.




The first  three terms in  eq:spheat are evaluated  as a function  of the
number of layers  by substituting the appropriate layer-dependent mass values
computed  in  eq:mjeq:cumass.  The  latter  two  terms   the
specific heats of the electrolyte material and the pouch are held constant since
their corresponding mass values do not vary with the number of layers used.

 
Results and Discussion



At the outset, it  is worth mentioning that the focus of this  chapter is on the
layer optimisation methodology  itself. The results as such  do not stand
alone  outside of  the  modelling  universe with  all  its inherent  assumptions
discussed  thus far.  Presently,  the value  added  by this  work  is its  ready
adaptability to industry through its  modular design. A numerical implementation
in the form of a toolbox
 

is  also  provided which  is  immediately  available  for  download and  use  by
relevant stakeholders. This author recommends  that until the tool matures, cell
manufacturers  substitute  their  own  parameters  and  adjust  other  numerical
coefficients suitably  so that  the toolbox  supplements, rather  than supplants
present empirical  layer designs. Hence,  the results presented in  this section
must be interpreted in the backdrop  of the context within which the methodology
was developed implying that the reader  must consciously strive to interpret all
numerical  values in  relative terms  of magnitude.  To aid  this thought
process, this  author chooses  to deliberately limit  the discussion  around the
absolute magnitude of numbers presented here.

Modelling Platform and Preconditioning































































































































 
The   complete   parameter   set   used   for   simulation   is   presented   in
tbl:lcoSimParamslayeropt.  All   cells  are   assumed  to  be   in  their
equilibrium  state prior  to  beginning of  simulations. The  thermally-coupled,
p2d  electrochemical  model  used  for simulating  each  layer  choice  is
implemented  in MATLAB   using  a heavily-modified  version of  the
LIONSIMBA toolbox .  The work reported in  this chapter helped
to advance the  toolbox from v1.0x to v2.0. The updated computer  codes to which
this author heavily contributed,
is available from the project's official repository 


.

The  rationale  behind  choosing  this  specific  software  to  implement  layer
optimisation  is  as  follows.  The LIONSIMBA v1.0x  toolbox  has  already  been
validated against  the results of the  DUALFOIL  codes (which
can be considered as the present benchmark standard). The toolbox is implemented
in the  MATLAB programming language.  Since this  chapter has a  strong industry
focus,  the  omnipresence  of  MATLAB  in industry,  its  mature  code-base  and
familiarity  was  a strong  motivator  in  the  adoption  of this  toolbox.  The
simulation  speeds using  LIONSIMBA  have been  shown to  be  comparable to  the
FORTRAN  implementation  of  DUALFOIL,  primarily  owing  to  the  sophisticated
computation  of  the  analytical  Jacobian   of  the  system  through  automatic
differentiation .  In  addition  to  fundamental  enhancements
to  the   modelling  platform  presented   in  sec:numericalenhancements,
numerous  bug fixes  and  other  minor enhancements  to  the original  LIONSIMBA
code-base  have  been  provided  by   this  thesis  author.  Interested  readers
may  peruse   these  from  the   README.md  file  from   the  project's
https://github.com/lionsimbatoolbox/LIONSIMBArepository.

xeV configurations










































 
Tables  and   show the
xeV  parameters used  in simulations.  The  power demands  on the  battery
pack  during  normal  operation  are   found  to  be  significantly  lower  than
that  experienced during  the  two  extreme cases  of  discharging and  charging
 acceleration and fast  charging respectively. For instance,
50.83 is the peak  discharge power while 14.20
is  the median  discharge power  for various  standard drive  cycles. Even  with
the  assumption that  100  of braking  energy  can be  recovered,
the  peak  and  median  charging  powers  are  only  43.13  and
26.03  respectively.

The   discharging  and   charging  powers   experienced  by   the  pack   during
acceleration and  fast charge  are significantly  higher than  those experienced
with  any  standard  drivecycle.  Considering  the  acceleration  parameters  in
tbl:CommonVehicleParams for  the bev  pack, 181.45
is   the  power   requirement  for   acceleration  of   a  fixed   vehicle  mass
on   a   flat  road   surface.   Four   distinct  fast-charging   power   levels
 50,   80,  110   and
130  are considered  in this  study.  This is  in adherence  to
the  minimum  and maximum  values  of  level 3  rating  as suggested  by  Yilmaz
and Krein . Furthermore, near-term fast charging goals laid out
in  literature  and  the  peak  power capability  of
charging infrastructure further justify these choices.






























 
For  the   acceleration  tests,  the   initial  cell  soc  has   been  set
to 40.  This is  in conformity  with the  test criterion 
   of  the  SAE J1666  standard .  By  choosing  the  worst
case  starting soc   40,  a conservative  design can  be
achieved.  The  chassis  mass  of  the  vehicle as  well  as  the  mass  of  two
passengers at  75.3 each   is considered  for both
xeV  platforms. The  pack mass  is  computed as  a function  of number  of
layers  as  described  in  sec:layeroptframework.  Vehicle  manufacturers
General  Motors Inc.  provide  the  mass  value of  the  GM Ecotec  series  of
engines  that can  be used for the  phev case which
consists of  a range-extending ice.  The mass  of the Bolt  bev pack
reported in  minus  the computed mass of  the overall cells
used in the pack  gives the overhead mass of the  bev pack. The phev
pack's  overhead  mass  is  determined  by suitably  scaling  the  mass  by  the
proportion of reduction in the number of cells used.


For the bev  platform, a fast-charging scheme operated on  a cp mode
with an initial  soc of 20 is employed. In  the case of the
phev, an initial soc  of 30 (10 higher
than that for bev) is used. This facilitates a smaller soc window by
taking  into account  the higher  number  of charge-discharge  cycles which  are
typical with phev  designs . Both xeV platforms
are fast  charged to a target  soc of 80 in  cp mode.
This soc value corresponds to the end-of-charge target in level 3 charging
standards .

Acceleration studies

For both vehicle platforms under study, the acceleration at a worst-case rate of
4.13 is assumed for simulation. This corresponds
to the  manufacturer's acceleration specifications  for the bev  listed in
tbl:CommonVehicleParams.  The  acceleration  rate  corresponding  to  the
SAE J1772 standards is lower than this  rate. Therefore, to obtain a robust cell
design, the higher of the two acceleration rates needs to be considered.

tbl:accResults  gives the  simulation  results  for various  combinations
of   for  both the  bev  and  phev
platforms. The following discussion is applicable for both vehicular platforms.




















 
The  specific combinations  of temperatures  for traversing  the thermal  design
space are  chosen following the  SAE J1772 guidelines. The high  power densities
resulting from  low numbers of layers  lead to large overpotentials  causing the
cell's terminal  voltage to  drop lower than , thereby  unable to
satisfy acceleration requirements. However,  at higher , owing to
the  reduction in  overpotentials, a  larger  voltage overhead  is available  to
accommodate the  internal polarisation  drop. For all  temperature combinations,
the largest deviation from   experienced by the bev cell is
a 0.48 increase.  Consequently, it can be  concluded that a
single isolated acceleration event does not heat the bev battery pack, and
therefore the cell  temperature remains close to that of  the initial value. The
phev cell  experiences higher  power levels  and although  its temperature
increases  much  higher  than  the corresponding  bev  cell,  the  maximum
temperature  during acceleration  remains  well below  the  upper cutoff  limit.
Furthermore, even  for the worst  case simulation  run, the cell's  soc is
depleted only by  a maximum value of 0.32 for  the bev cell
and by a slightly higher value for the phev cell.

The foregoing  discussion has revealed  that the lower cut-off  voltage strongly
influences  layer   configuration  for   acceleration  tests.   Therefore,  when
considering acceleration requirements,  and  represent the optimal
layer choices for the bev and phev platforms respectively .

Fast-charging studies





















Figures 
and  shows the results  produced by the layer
optimisation framework  for the bev and  phev platforms respectively
when  considering fast  charging requirements.  Each heat map  in these  figures
show  the optimal  number  of  layers  for  various
combinations of  initial and  ambient temperatures  for four  different charging
powers. In each case, the  values of  correspond to
the  temperature  combination 
  as  shown  in  fig:fig_generate_heatmap_BEV.  This
represents the  least number of  layers required to  fast charge the  pack under
cp conditions until  the target soc is reached.  The charging scheme
additionally considers the constraint that the cell temperature must stay
within . Furthermore,  its voltage  must
remain less than or equal  to . Finally,
the charging algorithm is plating-aware  the charging stops as soon as the
concentration at the particle surface reaches the maximum possible concentration
limit, thereby preventing  lithium plating at the surface  of negative electrode
particles.


Thus,   using    the   model-based    design   strategy   presented    in   this
chapter,   an   effective    cell   design   is   achieved    which   helps   to
maximise   energy   density  and   bev   range,   without  forgoing   fast
charging   power    targets.   From   figures 
and ,       it       is       seen       that
  increases with  increase in  the charging  power.
This is because,  as the charging power increases, the  minimum number of layers
required to maintain  the cell voltage below the maximum  permissible value also
increases.  This requires  higher interfacial  surface area  to accommodate  the
increased  power demand.  Furthermore, rapid  surface saturation  occurs due  to
steep  concentration  profiles in  the  negative  electrode particles  when  the
charging power is  high which causes plating. With higher  layers, the resulting
electrodes  are thinner,  thereby allowing  faster diffusion  of lithium  in the
solid  particles  and  avoiding  steep concentration  gradients  in  them.  This
suggests that the number of layers must be large enough to prevent plating.

fig:fig_CapacityQuadrants shows the nominal  capacity of cells and charge
passed versus  the number of  layers during fast  charging. In these  plots, the
theoretical  capacity  of  the cell  versus the  layer count   is
represented by the linear downward-sloping line.

























For any layer  choice,  therefore represents the upper  bound on the
charge  that can  be  passed  during charging.  For  both  constant current  and
constant power  charging, the loci of  actual charge passed  lie  much below
this theoretical nominal  capacity. For very low layer counts,  as the number of
layers decreases, the power density drops rapidly which implies that the rate of
heating is low. This allows for more  charge to be passed. However, at ultra-low
layer counts, the  overpotential due to the cell's internal  resistance is quite
high.  Therefore,  hitting the  upper  bound  on  the  terminal voltage  is  the
reason  for  the failure  of  these  layer choices.  This  is  indicated by  the
narrow -limited region in fig:fig_CapacityQuadrants. For an
intermediate range of  layer choices, the rate of power-density  drop with layer
count begins to flatten, thereby leading  to a plating-limited region. For these
layer choices, the  surface concentration starts to exceed  the saturation value
before any  thermal or voltage  limits are reached. Finally,  further increasing
the layer count beyond  an intermediate optimal value leads to  a linear drop in
the cell's  charge accepting  capability. During fast  charging with  the chosen
power levels, although these layer choices  do not reach the thermal, voltage or
concentration  limits,  they  are  unable  to attain  the  target  soc  of
80. This is simply due to the lower nominal capacity of the these
cells.  There is  no  benefit  whatsoever in  designing  cells  in this  region.
fig:fig_CapacityQuadrants provides  clues to  the design engineer  on the
degree  of optimisation  that can  be achieved  by careful  design choices.  For
instance, by tuning certain design parameters, such as using electrode materials
capable  of  operating at  higher  plating  voltage  or with  higher  saturation
concentration, the optimisation  point can be appropriately adjusted  as per the
application's demands.


From  the results  discussed thus  far, it  is evident  that it  is the  thermal
environment  that  governs   the  optimal  cell  layer   configuration  in  both
acceleration and fast charging studies and for both vehicular platforms. For all
charging powers simulated,  is the highest for the
coldest temperature  combination 
. This is due to  the slow rate of electrochemical reaction
and diffusion  at cold  temperatures. The thinner  electrodes from  using higher
layer count enable fast charging without saturating the surface of the electrode
particles. For the  fast charging scenarios considered here,  the optimal number
of layers to use  is 89 for the bev cell and  153 for the phev cell.
The globally optimal  layer choice to be  used for cell design  is therefore the
higher of the two values corresponding  to acceleration and fast charging cases.

Therefore, this model-based design framework recommends the use of 89 layers for
the cells to be  used in the bev platform and 153 layers  for the cells to
be used in the phev platform.  This concludes the discussion of results of
this chapter as well as all design-related aspects of this thesis.

 






xeV



 3


chapters/dra/figures/


[Computational Analysis and Numerical Reformulation of the dra
]Computational     Analysis     and     Numerical    Reformulation     of     the
dra 














[chapters]
[chapters]11



This  chapter  presents  an  analysis  and  critical  evaluation
of  a computational  bottleneck  present in  a  popular physics-based  rom
framework  of  lithium-ion  batteries  and  proposes  an  alternative  numerical
reformulation  to  mitigate   it.  From  the  literature   review  presented  in
ch:littreview,   it  may   be  recalled   that  transcendental   transfer
functions   of  the   cell's   electrochemical  field   variables  (except   for
ionic  concentration  and   potential  in  the  electrolyte)   was  obtained  by
Smith   through  linearisation of the  underlying p2d
model equations.  Lee   extended  the aforementioned
approach so as  to obtain these missing  electrolyte-specific transfer functions
through  a  multi-modal  EigenFunction  expansion  employing  a  Sturm-Liouville
approach .


In order to arrive at a  lti state-space representation of the system (see
eq:LTIstatespace)  for embedded  implementation, Lee   devised the
dra, a numerical procedure  to systematically transform all transcendental
transfer functions  to the time domain.  A special property of  the dra is
that it  retains the physical nature  of the original dfn  equations until
the very  last step  wherein the  matrices governing  the system's  dynamics are
generated. This  yields a  one-dimensional discrete-time  rom of  the cell
that is entirely based upon  fundamental physical principles. The rom thus
obtained could  then be used to  compute the time-evolution of  all the internal
electrochemical quantities of  the dfn model. Prima facie  it appears that
this model  could be directly  implemented for embedded  vehicular applications,
for  example,  as  the  plant  model for  state  estimation  tasks.  However,  a
comprehensive analysis  of the procedure reveals  a critical issue that  must be
first tackled before implementation aspects can be considered.

The  unresolved  issue in  Lee   is  the excessively  high  computational
requirements associated with the dra, which becomes a crippling bottleneck
since  the  procedure  needs  to   be  repeated  for  multiple  soc  and
temperatures.  This  computational  bottleneck   arises  from  forming  a  large
Block-Hankel  matrix  in memory  upon  which  a  svd is  performed.  Under
certain conditions  as discussed in  sec:size-of-the, owing to  the large
size  of  the  Block-Hankel  matrix,   the  dra  computation  is  rendered
intractable. This issue has been acknowledged by the original authors themselves
in .  In  this  chapter, this  computational  bottleneck
is  analysed  and an  improved  scheme  is proposed.  sec:Analysis-of-the
discusses an analytical evaluation of  the massive computing requirements of the
original  dra method.  Redundancies and  inefficiencies in  this step  are
enumerated  and the  high  computational  costs are  deemed  as unnecessary.  In
sec:Efficient-Computation-of, a fast  computational approach is presented
which  significantly reduces  both  the  memory and  computational  time of  the
rom  workflow. sec:Results  summarises  the  results obtained  from
applying the  new workflow presented in  sec:Efficient-Computation-of, by
comparing and contrasting the much smaller computational requirements of the new
method  with the  original  dra scheme.  The  improved modelling  accuracy
achieved  by  this  proposed  method when  deployed  under  resource-constrained
computing environments, is also highlighted.

Analysis of the Computational Bottlenecks of the dra

The rom  proposed by  Lee  aims  for the  simplified representation
of  the  p2d  volume-averaged  continuum  model  proposed  by  Doyle,
Fuller   and   Newman  

.


The   block   diagram   in  fig:traditional_ROM_Workflow   depicts   this
thesis  author's   summary  presentation  of  the   overall  modelling  workflow
in   Lee .   Firstly,  the   governing   pdae   equations  of   the
dfn   model    (see   tbl:dfneqns)   are   linearised    about   an
operating  point  of  soc   and  temperature.  Then,  closed-form  Laplace
domain  transcendental   transfer  functions   of  all  the   internal  physical
quantities    at  different   cell
locations, are derived using applied current  as the input. A detailed treatment
of  this analytical  derivation is  presented in  Lee  . The
authors  proposed  a novel  dra  scheme   in order  to
transform  these  transcendental  transfer  functions  to  standard  state-space
representation.  Sublevel-1   of  fig:traditional_ROM_Workflow   shows  a
breakout view of  the dra procedure and illustrates the  steps involved in
this  computation. At  the  heart  of this  numerical  method  is the  classical
subspace  identification approach  known as  Ho-Kalman algorithm ,
whose  computation steps  are  shown  via the  exploded  view  in sublevel-2  of
fig:traditional_ROM_Workflow.  Then,  the Markov  parameters  (unit-pulse
response) of  this simo  linear system of  battery transfer  functions are
computed 

.  They  form the  entries  of  a Block-Hankel  matrix ,
wherein each block  element is a column  vector of the set  of Markov parameters
at  a  given  time-step.  A  key  computation  in  the  Ho-Kalman  algorithm  is
the  svd  of this  Block-Hankel  matrix.  A  wide separation  in  the
magnitude  drop  between  successive  singular  values serves  as  a  guide  for
the  modeller in  choosing  a suitable  reduced order  to  represent the  entire
dynamics  of  the  system.  The   analyses  of  this  thesis  author,  presented
in subsec:Traditional-DRA--Memory  and subsec:Traditional-DRA--CPU
reveal major inefficiencies in both the Block-Hankel formation and the svd
computation steps which hinder the entire reduced-order modelling workflow.










Size of the Block-Hankel Matrix

Large Block-Hankel matrices can occur in dra computation due to the
following reasons.

    
        For  a  given   duration  of  Markov-parameter  recording,   if  a  high
        sample-rate   rom  is   desired,   the   emulation  frequency   in
        the   dra  scheme   has   to  be   proportionately  increased   to
        accurately  compute  the continuous-time  step  and  pulse responses  in
        fig:traditional_ROM_Workflow. This implies  that the total number
        of time-samples   for each  Markov parameter will  have to  be scaled
        linearly to  capture the  desired duration  of the  unit-pulse response.
        However,  the size  of the  Block-Hankel matrix  has a  quadratic
        dependence on the Markov parameter length.
    
        The  recorded sample  size  could  also  become large  if the  Markov
        parameters of just  one of the transfer functions decay  very slowly. In
        Li-ion batteries, diffusion  within the solid particle  is typically the
        slowest process.  For the cell  modelled in Lee ,  the unit-pulse
        response of surface concentration of Li adjacent to the positive current
        collector  requires approximately  16000 samples before  reducing to  an
        appreciably low value, as shown in fig:markov_cse_pos.
    
        For  a  battery  modelling   problem  consisting  of  multiple  transfer
        functions,  the  number  of  entries in  the  Block-Hankel  matrix  also
        scales linearly  with the  number of transfer  functions. Thus,  if more
        cell  variables ( concentrations and  potentials at  other spatial
        locations  within the  cell) are  to be  studied, then  the size  of the
        transfer function vector  and that of the  Block-Hankel matrix increases
        correspondingly.












Considering the combined  influence of these effects,  if  transfer functions
are  to be  modelled and   time-samples of  each Markov  parameter are  to be
captured, the corresponding size of the Block-Hankel matrix  is




This    has    a    significant     computational    impact    as    shown    in
subsec:Traditional-DRA--Memory and subsec:Traditional-DRA--CPU.

Classical dra --- Memory (ram) Requirements

Lee    modelled 28 transfer  functions representing  various
electrochemical  variables at  the current  collector and  separator interfaces.
Each Markov  parameter is  a 28 element  column vector.  16000 time-samples were
obtained at  a sample-rate of  1, allowing sufficient time  for the
Markov parameters  of the  slowest dynamics   solid surface  concentration to
settle  to an  acceptably low  magnitude.  The Block-Hankel  matrix thus  formed
has  8000 blocks, each  block  consisting of  28 elements   has 
 rows  and 8000 columns.  Hence,  the overall  number  of elements  in
the  Block-Hankel matrix  is .  Using
double-precision  arithmetic,  its  storage  requirement  can  be  estimated  to
be 27.

Computing the svd results in the formation of three more large matrices in
memory ---
*[label=*)]
    matrix   of   output  singular   vectors ,
    matrix of  input  singular vectors , and
    the diagonal singular-value  matrix .

With  8000 Hankel-blocks,  approximately  81  of  ram  is
required for holding these three output  matrices generated by a full svd.
However,  the  intermediate  operational   memory  usage  during  the  svd
computation is often much higher than the  combined size of all the matrices. As
these large  matrices must  be repeatedly  handled for  each operating  point of
soc and  temperature, the  high memory demand  of the  classical dra
remains a persistent issue.

Classical dra --- cpu Operation Count

The most widely  used numerical algorithm for computing the  full svd of a
generic dense matrix  is the
two-stage  Golub-Kahan-Reinsch  method .  In  the  first  stage,
 is  reduced to an upper bidiagonal  form. In the
second  stage, svd  of  this  upper bidiagonal  matrix 
  is   computed  using   an   iterative  procedure   such  as   the
Demmel-Kahan method . If  stage 1 of the svd
computation  employs -Bidiagonalisation ,  then  the
overall  process is  referred to  as -svd. This  is the
fastest known  full svd  computation method  that may  be applied  to this
battery modelling problem. The dgesvd algorithm, originally implemented
in  LAPACK ,  employs  this method.  This  has  been
ported to  many numerical computation  packages such  as MATLAB, GNU  Octave and
Scilab.  Several  numerical  libraries  such  as NAG  and  Intel  MKL  also  use
the  dgesvd  codes  due  to its  acclaimed  stability,  robustness  and
versatility.  The MATLAB  implementation `svd'  is also  based
upon dgesvd and  hence this can be considered as  the de-facto baseline
svd code.

The    operation    count    for    computing   the    singular    values    and
vectors    of    a    generic    dense    matrix 
    using   the   -svd   method
is  .   Markov   parameters   of
 transfer functions  and  time-samples  yields a Block-Hankel  matrix with
 rows and  columns. Hence,
2
    cpu Operation  Count & = & 4(xN)^2N+22N^3

                                              & = & 2N^3(11+2x^2)

Thus  the  cpu operation  count  scales  as  with  the
number of Markov time-samples  and as  with the number of
transfer  functions  being  modelled. The  rom computed  in Lee 
uses  28 transfer functions  wherein  the Markov  parameters  are collected  for
16000  with  a sampling  interval  of 1. Thus,  the
cpu  operation  count for  performing  this  computation is  approximately
 floating point operations.

Summary Effect of Computational Bottlenecks

The computational bottleneck in a  classical dra implementation arises due
to the  requirement of capturing a  large number of Markov  parameters, which in
turn leads  to growth in  Block-Hankel size. In  the case of  battery modelling,
this can arise in the following real-life scenarios:

	
        Electrochemical variables at additional locations of interest within the
        cell ( middle of electrode or  separator domain) might need  to be
        modelled. This increases the number  of transfer functions and hence the
        number of Markov parameters.
	
        High frequency load  cycles necessitate higher sample-rates  to obtain a
        high fidelity  model. This leads  to a correspondingly higher  number of
        Markov parameters.
	
        In cells with  large particle sizes and small  diffusion coefficients, a
        large set  of Markov  parameters is  needed to  capture the  full system
        dynamics.

Lack  of  specialised  computing infrastructure  necessitates  early  truncation
of  the  Markov parameters  in  the  rom  workflow. The  resulting  errors
in  the singular  value  computation  lead to  significant  modelling errors  in
the  physical  variables of  the  cell.  Thus,  in practice,  the  computational
bottlenecks of classical dra manifest as modelling errors when implemented
in  a  resource-constrained  computing environment.  Furthermore,  this  tedious
computation has to be repeated for multiple soc and temperatures.

The foregoing analysis  clearly demonstrates that the high  memory and cpu
demands in  a classical dra  implementation severely hamper the  scope and
applicability  of the  reduced order  modelling process.  This implies  that the
modelling  workflow is  not accessible  to research  groups without  specialised
computing infrastructure and its universal  appeal is rendered questionable. The
shaded  blocks in  fig:traditional_ROM_Workflow  depict the  hierarchical
propagation of the classical dra's computational bottleneck throughout the
rom workflow.

Improved dra for Battery Modelling

Collecting a  large Markov parameter  set is  inevitable due to  the fundamental
physics of the cell  dynamics as established in subsec:Summary-Effect-of.
Hence, in  order to circumvent the  high computational demands of  the classical
dra, the second step in the process  forming the Block-Hankel matrix,
is critically examined with the following scientific rationale.


	
        The unit-pulse responses of most  battery transfer functions (other than
        those of rate-limiting  steps such as solid  diffusion) decay relatively
        quickly. Hence it is inefficient to  record the Markov parameters of the
        full  system for  the  entire  duration needed  to  capture the  slowest
        dynamics.
	
        The Block-Hankel  matrix is essentially redundant  information since its
        entries are simply the Markov parameters arranged in a repeating special
        structure. Thus,  it is wasteful to  construct this huge matrix.  If the
        svd operation  can be  performed on a  virtual Hankel  matrix, the
        memory requirements can be drastically reduced.
	
        The matrix of singular values  is diagonal and hence, sparse. It
        is redundant to hold all the non-diagonal entries (zeros) in memory.
	
        It  is not  necessary to  perform a  full svd  operation in
        order  to  achieve order  reduction.  When  an  upper bound  on  desired
        system order  can be  decided a  priori, it is  sufficient to  compute a
        truncated  svd yielding  the  first  few dominant  triplets
        of .

Thus,  forming the  large Block-Hankel  matrix  and computing  its svd  is
identified as an avoidable bottleneck in the classical dra method. This can
be  tackled since  forming the  Block-Hankel matrix  is an  idiosyncrasy of  the
algorithm  used  and  does  not  arise from  any  fundamental  physical  limits.
Facilitated  by  an  efficient  svd  implementation,  this  thesis  author
proposes  an improved  dra that  serves  as a  drop-in  replacement in  the
rom workflow.

Candidate Schemes for Block-Hankel svd

Generic  svd  routines  such  as dgesvd  do  not  take  advantage
of  the  anti-diagonal  structural  symmetry  of  Block-Hankel  matrices.  Since
it  is sufficient  to  obtain  the first  few  leading  eigentriplets for  order
reduction,  iterative  algorithms  such  as   the  Jacobi  and  Lanczos  schemes
(see )  emerge  as  attractive candidates  for  computing  these
dominant singular  values and vectors. In  order to ensure accessibility  to the
large community of  battery researchers and to encourage  widespread adoption of
the fast reduced order modelling framework, the author of this thesis considered
only freely available  open-source numerical libraries that exist  in the public
domain, especially  those with permissive  licensing terms. Otherwise  the gains
achieved by  an efficient  svd computation  for implementing  dra on
non-specialised  computing  hardware would  be  offset  by commercial  licensing
terms,  usage restrictions  and  monetary considerations  associated with  using
proprietary  codes. Among  these  open-source candidate  algorithms, the  Jacobi
scheme  is  available through the  xGESVD routine in  the LAPACK
suite . FORTRAN 77 codes for the implicitly restarted Arnoldi
and Lanczos schemes (see nu-TrLan ) are  available as part of
the ARPACK  library.

The practical drawback  of most svd implementations,  both open-source and
proprietary, is  that they require  the entire  matrix as input  argument. Since
operating upon  the Block-Hankel  matrix requires constructing  it in  the first
place, the memory bottlenecks discussed in subsec:Traditional-DRA--Memory
are not  ameliorated. An  example is  the svds  routine ---  an economy
size  svd  implementation  in  MATLAB.   Albeit  this  is  a  commercial
implementation  of  the  Arnoldi  codes,  any potential  benefits  of  using  an
iterative scheme is nullified by the memory penalty. Owing to reasons enumerated
in sec:Efficient-Computation-of, the chosen  svd algorithm needs to
be able to handle the computation without actually forming the huge block-Hankel
matrix in memory.

svd Operation on a Virtual Block-Hankel Matrix

The  pioneering  work  by  Larsen, PROPACK ,  based  on  his
earlier work  implements a numerically stable Lanczos svd
computation designed specifically for large  and sparse matrices. In addition to
the ability  to operate on the  matrix as a  whole, the PROPACK codes  possess a
unique flexibility  of accepting  input arguments  in a  functional form.  A key
highlight of the  Lanczos svd scheme is that it  does not strictly require
the  matrix  itself, but  only  the  product of  the  matrix  and its  transpose
with  an  arbitrary vector.  This  feature  has  been effectively  exploited  in
the  PROPACK suite.  Therefore, these  multiplication routines  can be  supplied
as  input  arguments instead  of  forming  the  large Block-Hankel  matrices  in
memory.  Furthermore,  this  package  includes  sophisticated  schemes  such  as
Gram-Schmidt  partial re-orthogonalisation   to compensate  for
numerical round-off  errors in the  basic Lanczos bidiagonalisation  and ensures
orthogonality of  the input and  output singular  vectors. The PROPACK  suite is
available as both Fortran 77 and MATLAB codes distributed under a permissive BSD
license. Version 1.1 of the MATLAB implementation  of the PROPACK suite was used
by this thesis author.

For the rom workflow, in order  to use PROPACK's unique feature  its
flexibility to  accept functional form  inputs, the key  is to use  an algorithm
that  effectively  exploits the  affine  structure  of the  Block-Hankel  matrix
without  actually  forming  it  in  memory. Recent  research  in  a  specialised
time-series technique known as ssa  has yielded efficient
methods for  achieving this goal.  Korobeynikov  proposed
an  algorithm that  employs the  fft for  implementing this  matrix-vector
product  by  embedding the  Markov  parameters  into  the  column vectors  of  a
circulant  matrix.  This  is  suitable   for  applications  wherein  the  Hankel
matrix  is  composed  of scalar  entries  such  as  that  formed by  the  Markov
parameters  of   a  siso   transfer  function.  Golyandina,   Usevich  and
colleagues   extended  this  approach  to  a
generic  2D-case for  performing ssa  on images.  With this  modification,
this  algorithm is  rendered capable  of handling  the structure  of Multi-level
Block-Hankel matrices formed from the  Markov parameters of a generic mimo
system. While  the modified  scheme does not  construct the  Block-Hankel matrix
in  memory,  the operational  rubrics  of  the Golyandina-Usevich  algorithm  in
conjunction with  PROPACK is  such that  they iteratively  operate on  a virtual
Hankel matrix  of equivalent size.  The Golyandina-Usevich algorithm  is briefly
summarised in sec:Golyandina-Usevich-Algorithm.

Golyandina-Usevich Algorithm

The  Golyandina-Usevich  algorithm  is  used  for computing  the  product  of  a
Block-Hankel matrix with an arbitrary vector.  The steps involved in this scheme
are enumerated  in Algorithm 3 of  Golyandina  . These
steps are reproduced  here in the context of the  improved dra for reduced
order battery modelling.


	Compute a 2-D fft of Markov parameter matrix.
	Form an augmented vector by zero-padding the arbitrary vector input
	    from Lanczos iteration.
	Perform a column-wise reshaping of this augmented vector to obtain
	    a new matrix with the same dimensions of the Markov parameter matrix.
	Compute the element-wise product of this newly created matrix with
	    the 2-D fft of Markov parameter matrix.
	Reshape the resulting matrix back to a column vector.
	Extract the first  elements from this vector, wherein .
	     represents the desired block-Hankel size and  represents
	    the number of transfer functions being modelled.


At the end of  Step 6, the product of the Hankel matrix  and arbitrary vector is
obtained. This is  reused as an input  for the Lanczos scheme  which generates a
new arbitrary vector  in the subsequent iteration. Thus, the  steps 1--6 are run
in a loop within the main Lanczos scheme.  These same steps can also be used for
computing the  product of the transpose  of the Hankel matrix  and the arbitrary
vector.  The only  change is  to  account for  the different  dimensions of  the
arbitrary  vector input  from  the  Lanczos scheme  in  step 2.  As a  practical
implementation, software code representing steps 1--6 is written in a plain-text
file and used  as functional-form inputs by the PROPACK  scheme which implements
the Lanczos iteration.

Customisations for Battery Modelling

Specific considerations  are required  for incorporating  the Golyandina-Usevich
algorithm  in  the  rom  workflow  for  Li-ion  batteries.  The  classical
dra  architecture is  set up  to  handle simo  systems, wherein  all
transfer functions  are derived by  considering only  a single input   the
applied battery  current. Thus  the Markov parameters  form a  2D matrix wherein
each  row corresponds  to  individual battery  transfer  functions with  columns
representing  unit-pulse  response  samples  for  each  transfer  function.  The
2D moving-window  illustrated in   for Block-Hankel  matrix
formulation has to be suitably reshaped to account for this structure. Step 3 of
the  algorithm  deals  with  2-D fft  computation  of  the  mpm.  In
this  thesis author's  implementation,  this is  pre-computed  since it  remains
invariant between iterations of the Hankel-vector product computation loop. This
pre-allocation and a priori computation contributes to overall code efficiency.










fig:improved_ROM_workflow shows the rom  workflow with the improved
dra wherein all computational bottlenecks  highlighted by shaded blocks in
fig:traditional_ROM_Workflow  have been  eliminated. The  strategy is  to
first employ the (suitably modified) Golyandina-Usevich algorithm for describing
the matrix-vector  multiplication routines.  These two  functions are  then used
as  inputs  to  the  PROPACK  codes.  Eigentriplets  up  to  the  desired  upper
bound on  system order  is then  computed using  a Lanczos  svd iteration.
fig:svdcompare presents a comparison of  singular values computed by both
the  traditional and  new methodologies.  It  is evident  that the  two sets  of
singular values are identical. This proves  that the new scheme can indeed serve
as a drop-in replacement for the classical dra.











Simulation Results and Discussion

This section provides a quantitative  demonstration of the reduced computational
demand  of the  improved dra  scheme by  comparing it  with the  classical
dra implementation. The  physical parameters  of the cell  are the  same as
those published in  Fuller  . table:simparams lists
the  parameters used  in  the  rom workflow  (same  as  those employed  by
Lee  ).

















fig:memory  shows a  comparison  of  the memory  usage  of classical  and
improved dra methods.  It is evident that the svd  step in classical
dra  consumes  an  overwhelming  majority  of  the  total  memory  demand,
requiring 100 for a Hankel block size of 8000. This can
be a limiting factor  in modelling slow cell dynamics without  access to a large
memory workstation. The improved dra method eliminates this bottleneck and
the memory  usage of svd step  is negligible. Overall memory  usage of the
improved  dra is  dominated by  Markov parameter  computation. Considering
10 of usable ram, this means that 60000 Markov parameters
(Hankel Block-size of 30000) can be captured.











fig:cputime  shows   a  comparison  of  cpu   times  for  computing
the   rom  at   a  single   soc   and  temperature   for  both   the
classical  and  the improved  dra  methods 







.
Owing   to   the   high   operation  count   for   the   svd   computation
(see   eq:cpu_op_count),  the   classical   dra  requires   
40 for a Hankel block size of 8000. Clearly, the overall cpu
time for the  classical dra is almost exclusively spent  for computing the
svd. The improved dra method  reduces the overall computational time
by  two  orders of  magnitude,  taking  40 for  the  same
block-size.  In this  case,  the  cpu time  is  evenly  split between  the
svd and Markov parameter computations.








From  fig:memory,   it  is  evident   that  if  classical   dra  is
employed,  a  standard  laptop  with  a  nominal  10  ram
limit   (dedicated   for   rom   workflow)   cannot   capture   the   full
cell   dynamics  and   hence   is  restricted   to   2500 Hankel  blocks.   This
necessitates early  truncation of Markov parameters  at 5000. From
fig:markov_cse_pos, the truncation residue  at 5000 for the
unit-pulse response of solid surface concentration at positive current collector
is . The truncation errors in the mpm
directly translate  to errors in  computed singular values,  adversely affecting
accuracy of  simulated cell  variables. It  must be noted  that the  accuracy of
simulation results  reported here  does not  bear a  causal relationship  to the
particular  dra scheme  employed. In  principle,  when an  upper bound  on
computational usage has not been enforced,  the numerical operations of both the
existing and proposed dra schemes lead to similar error magnitudes for the
modelled quantities. Instead, the accuracy comparison illustrated here primarily
serves to demonstrate the practical  usefulness of the improved dra scheme
when implemented in a commonplace computing environment.

fig:truncated  shows a  comparison  of singular  values  obtained by  the
classical and improved svd methods  computed by imposing a ram limit
of 10. Owing to early truncation of the mpm, the dominant
singular values  computed by the  conventional method differ  significantly from
those computed by the improved svd operating on untruncated data. With the
same memory  constraints, the improved  dra can handle up  to 30000 Hankel
blocks, allowing for capture of 60000 of Markov parameter data.










For comparative analysis  of modelling accuracy under this  memory constraint, a
time-domain simulation  of the  rom obtained  by classical  and improved
dra  methods is  performed.  The input  current  profile corresponding  to
a  udds  drive  cycle  reported in  Lee    is  used.
fig:time_domain_sim  depicts  the  time-evolution of  the  solid  surface
concentration  at  the  positive  electrode/separator  boundary.  For  comparing
the  accuracy   of  the   two  ROMs,  a   COMSOL  Multiphysics 
simulation  of  the  full-order   pseudo-2D  porous-electrode  pdae  model
is  used  as   the  reference.  The  rom   employing  classical  dra
diverges  over   time,  and  after   1500  results  in   an  error
of 1120.   The  rom  incorporating   the  new
dra  workflow   accurately  tracks   the  COMSOL   simulation  trend-line.

















tbl:salientresults   provides   a   summary   of   the   key   simulation
results.  At  a  single  operating  point  of  soc  and  temperature,  for
a  Hankel  block   size  of 8000,  the  rom   workflow  incorporating  the
improved  dra  is  100 times   faster  than  that  employing  the
classical   dra.  Using   the  machine   with  specifications   listed  in
the  footnote,  for  100 operating  points
(combinations of  10 soc and temperature values),  computing the rom
requires  only  6 hours using  the  improved  dra, whereas  the  classical
dra consumes  666 hours (27 days).  Furthermore, for the  same block-size,
the  improved dra  is  demonstrated  to be  superior  in  terms of  memory
efficiency,  drastically reducing  the memory  requirement from  112 GB down  to
2 GB. Finally,  the improved dra demonstrates  superior modelling accuracy
when  implemented even  in moderately  equipped computing  environments such  as
laptops.






























This  chapter  concludes  with  the  view  that,  although  the  bottlenecks  in
Lee    revealed   by  this   in-depth  analysis   have  been
effectively tackled  in this chapter,  owing to the circular  dependency between
the linearisation point and model parameters, the underlying model itself is not
robust enough for immediate implementation. Furthermore, the model derivation is
convoluted  with the  derivation being  performed  in the  frequency domain  and
implementation in the  time-domain. This thesis author is of  the opinion that a
simple, yet  accurate model derived  and implemented entirely in  time-domain is
the  need  of  the  hour  for  encouraging  the  automotive  industry  to  adapt
physics-based battery models onto on-board  bms of electric vehicles. In
the quest to fulfil this need, an analysis of the simplest time-domain pbm
 the spm is presented next in ch:spmanalysis.
 4



chapters/spm_analysis/figures/



Performance Evaluation of State of the Art in Single Particle Modelling
[chapters]
[chapters]11







Taking into account the relative strengths and weaknesses of all
the physics-based reduced order modelling  families in the literature considered
(see ch:littreview), the overarching  simplicity of the spm coupled
with its immediate potential to bring  the power of physics-based predictions to
an embedded environment is a strong motivation to pursue an in-depth exploration
of its  horizons. This chapter  discusses the performance of  multiple spm
variants, ranging  from basic to  sophisticated. The governing equations  of the
conventional  spm are  first introduced  and its  baseline performance  is
evaluated.  Next, an  in-depth analysis  of the  basic spm's  drawbacks is
performed.  Various  published attempts  to  mitigate  their current  challenges
towards implementability is presented and their inadequacies discussed. Owing to
its  simplicity and  latent potential,  a  popular modelling  strategy from  the
existing art that aims to enhance the performance of the basic spm through
incorporation  of electrolyte  dynamics,  is chosen  for  further analysis.  The
chapter concludes  with the  author's critical comments  on its  relative merits
that  come  to  view  through  comparison  against  a  benchmark  model,  whilst
simultaneously  identifying its  critical  weakness whose  mitigation forms  the
focal point of the research discussed in ch:newelectrolytemodel.

 

The conventional spm




Reducing  the number  of  computational  dimensions in  a  physical model  helps
in  formulating  their  low  order  approximations,  thereby  facilitating  fast
evaluations  of  the modelled  quantities.  The  spm, originally  used  in
modelling  the Metal-Hydride  chemistry   and  later on  adapted
for  Li-ion  cells ,  represents  the canonical  apogee  of  such
dimension-reduction strategies.


During  the  initial years  following  its  inception,  the formulation  of  the
basic spm  was discussed extensively within  application-specific contexts
such  as  soc  evaluation ,
parameter    estimation ,   and    life   cycle/ageing
predictions .   There   have   also   been
detailed   stand-alone   publications   discussing   various   facets   of   the
basic   spm,   such   as    its   inherent   assumptions   and   governing
equations . The basic spm suffers
from  certain major  drawbacks which  are  discussed in  the simulation  results
presented  in subsec:simresultsbasicspm.  Since the  turn of  the decade,
researchers  have attempted  to  tackle  many of  these  issues  and a  holistic
discussion of such efforts is presented in sec:electrolyteinclusion.

A survey  of the  most recent  literature dealing with  the spm  family of
models reveals a diminishing rate of advancement in quantifiable improvements to
the underlying plant model itself. This nearly-static trend can be attributed to
the general  consensus within the  research community  that these models  may be
too  simplistic  and  not  of  suitable accuracy  to  warrant  further  studies.
Other  than a  small  minority  of papers  that  either  propose core  modelling
improvements  to tackle  their inaccuracies,  or  add new  enhancements such  as
mechanical-stress  physics , latest  work  in this  family
of  models predominantly  pertains  to  their application  in  areas like  state
estimation ,      optimal
charging ,    cycling    performance ,
conversion           to            equivalent           circuits ,
parametrisation , pack-balancing
studies   and   observer  design  for   joint  state-parameter
estimation . The spm approach  was also extended to the
case of  composite electrodes, leading to  a state estimator design  after basic
observablity  analysis .  Owing  to  their  simplicity,  this
author believes that spm hold the highest potential to bring a pbm
to embedded bms. With this goal  in view, this thesis seeks to resurrect
interest in this field by addressing the recent paucity in fundamental modelling
improvements. However, prior to doing  this, a complete analysis identifying the
strengths and  weaknesses of the salient  models within the spm  family is
warranted.



 
spm Model Development


In  order  to  establish  a  context  for the  author's  work  to  be  discussed
in  ch:newelectrolytemodel,  it  is  imperative  to  provide  a  holistic
presentation of the basic spm modelling art. The conventional spm is
the  simplest  of  all  time  domain  pbm.  The  rest  of  this  section
provides  this author's  digested summary  of its  modelling rubrics  based upon
the  keen  insights  gained  from  perusing  the  vanguard  literature  in  this
topic  as  well as
their relevant derivative works.

Geometry

A  description  of   the  working  principle  of  the  cell   was  presented  in
subsec:liionchemistry and  is not  repeated here.  The spm  aims to
capture the electrochemical phenomena along the thickness ,  of
each  porous electrode  by a  representative  spherical particle.  Thus the  two
distinct  solid  phase porous  regions  of  the  cell  the  negative  and
positive electrode regions, are idealised as two spheres of radii 
and  respectively.


fig:sandwichtospm   shows   the   geometrical  origins   of   the   basic
spm.  In  this   arrangement,  the  spatial  dimension   along  the  axial
thickness  of   each  electrode   degenerates  to  a   single  point   which  is
represented  by  a sphere.  Hence,  the  concentration  of lithium  within  each
electrode ,   is  only  a  function  of  the  radial
position ,   and  the  time .   The  surface  area  of  each
representative sphere is scaled appropriately,  such that they are equivalent to
the  active area  of the  corresponding  porous electrodes.  Thus the  spm
accounts  for  the  reduced  volume-fraction  arising  due  to  the  microporous
structure  of  the   solid  phase  and  hence,  the  storage   capacity  of  the
representative  particles  match  that  of  the  corresponding  electrodes.  The
overarching  assumption  of  the  spm modelling  philosophy  is  that  the
electrochemical performance of these representative electrodes are sufficient to
model the behaviour of the cell at its terminals. The spm thus employs the
coarsest possible spatial  discretisation of the cell's thickness  with the goal
of minimising computational burden.
















Scope and Assumptions

Having described the  geometrical representation of the model,  it is imperative
to establish its  aims and scope. This section discusses  the subset of physical
phenomena  that can  be  captured  by the  basic  spm  and enumerates  the
inherent assumptions in model derivation.  The validity of these assumptions and
their effects  on model accuracy shall  be examined in the  results presented in
subsec:simresultsbasicspm. As  a broad  outline of  its scope,  the model
attributes the cell polarisation to two dominant physics  reaction kinetics
and solid phase transport phenomena  diffusion dynamics.


The  spm  assumes that  charge  transfer  happens throughout  the  surface
of  each  representative  spherical  particle where  intercalation  occurs.  The
electronic  conductivity of  the solid  phase is  assumed to  be high  enough to
ignore the  spatial distribution  of charge  the local  volumetric current
density is assumed  to be uniform along the thickness  of each porous electrode.
This assumption is  motivated by the early calculations performed  by Newman and
Tobias  in their stand-alone  analysis of current distributions
in porous electrodes, wherein a volume-averaged molar flux was deemed sufficient
throughout  the  thickness  of  the  electrode.  This  uniform  current  density
assumption implies  that all of the  particles in the electrode  active material
are  in parallel.  Solid  phase  diffusion dynamics  within  each electrode  are
therefore solved by assuming this averaged electrochemical reaction rate. In the
simulation study  by Smith and Wang ,  it is reported  that soon
after  the beginning  of discharge,  solid  phase concentration  and ionic  flux
become nearly  independent of  spatial position, and  that lithium  diffusion in
solid particles may be driven by an averaged molar flux at the surface.


Based  on the  discussion thus  far, it  is clear  that the  spm does  not
attempt to  model all  physical processes  within the  cell. In  particular, the
model assumes  instantaneous charge  transport from one  electrode to  the other
through  the  solution  phase.  This  implies  that  electrolytic  diffusion  is
sufficiently  fast  (relative to  diffusion  in  the  solid phase).  Thus,  mass
transport  phenomena  in  the  electrolyte  have been  neglected  in  the  basic
spm.


During   the  operation   of  the   cell,   the  spm   assumes  that   the
electrolyte  concentration   remains  constant  at  its  equilibrium
initial value   throughout the cell thickness.  Neglecting local
concentration gradients in  the solution phase, together with  ignoring its mass
transport phenomena, implies  that the current in the electrolyte  does not vary
over  space  and  time.  Hence,  in  the  conventional  spm  there  is  no
contribution of the solution phase  to internal overpotentials  electrolyte
dynamics have  no influence on the  cell's terminal voltage. The  spm also
ignores any  variations in material  porosities in each  electrode. Furthermore,
all solid phase diffusivities and kinetic parameters are held constant. Finally,
all thermal effects are assumed to  be negligible and no degradation effects are
attempted to be modelled in the basic spm formulation.

These  simplifying  assumptions  are  made  so as  to  facilitate  the  ease  of
implementing a  pbm, without incurring  the heavy computational  cost that
typically accompanies it. The impact of these assumptions on the accuracy of the
model shall  be examined in subsec:simresultsbasicspm  and later sections
presents prior research that strives to  straddle the fine balance between model
sophistication and computational complexity.

Governing  Equations



As discussed  in subsec:basicspmassumptions,  the spm  captures the
cell's dynamics arising due to diffusion  and kinetics at the two representative
spherical electrodes. It also accounts for the contribution of their equilibrium
thermodynamics to the cell's ocp.

Solid Phase Diffusion

Conservation of Li^0 in the electrodes can be obtained by assuming that the
movement of neutral  atoms within the solid phase is  primarily due to diffusion
within particles.  This diffusion  phenomena is induced  due to  a concentration
gradient that  exists between the surface  and interior/core of the  solid phase
particles. Based on the geometrical assumptions of the spm as discussed in
subsec:basicspmgeometry  owing to the lack of spatial discretisation
in  the  axial  direction ,  the  concentrations  of  Li^0  in  the  two
electrodes , reduce  to a  function of the  radial co-ordinate 
and time , and is denoted by , . To keep the notation
tractable, this  explicit spatio-temporal radial dependence  is omitted, further
simplifying the representation  to . We start with the  derivation of the
solid-phase diffusion equation eq:dfnsoliddiff in tbl:dfneqns, and
then proceed  to the simplifications  of its boundary conditions  facilitated by
the spm assumptions.

Diffusion  in the  solid phase  can be  modelled by  applying classical  Fickian
dynamics  given by


The  divergence of  a vector  field  can  be expressed  in
spherical co-ordinates as





where   denotes the  radius,   the polar  angle,  and  the  azimuthal
angle.  and  denote  the corresponding components of the vector
field .

The  co-ordinate  origin  at  each  electrode is  aligned  with  the  centre  of
its  representative  spherical  particle.  Due  to symmetry  in  the  polar  and
azimuthal axes, the  divergence becomes a function of only  the radial position.
eq:fullsphericaldiv therefore reduces to



Applying     the     rhs     of     the     divergence     operator     of
eq:reducedsphericaldiv in eq:cartesiandiffusion yields



As   per  the   assumption  of   uniform   diffusivity  in   the  solid   phase,
eq:csdiffusioneqn becomes

    c_t &= D_r^2*(r^2 ∇ c_)r
    Applying the gradient operator of eq:csdiffusionconstdiffusivity along
    the radial direction ,
    c_t &= D_r^2*(r^2 c_r )r

eq:csdiffusionfinal represents  a mass-balance equation  describing solid
phase diffusion  in each electrode  and is  identical to the  governing equation
eq:dfnsoliddiff from tbl:dfneqns. The  potential at each electrode
depends  on   the  solid  phase  surface   concentration    the
Li^0 concentration   evaluated at ,  where
 represents  the  equivalent  radius  of  each  representative  spherical
particle.

Due to spherical symmetry,  flux at the centre of the  particle is considered to
be zero.




Diffusion in the solid phase is driven by concentration gradients induced due to
intercalation flux  density at the  particle surface   the surface  of each
particle experiences a pore-wall flux density driven by reaction kinetics. Based
on  the  spm  geometry discussed  in  subsec:basicspmgeometry,  the
spatial dependence of this molar  flux density  is eliminated and it
can  therefore  be  represented  as , . For  the  sake  of
brevity,  its  explicit temporal  dependence  is  also  omitted resulting  in  a
simplified notation . Hence, at the particle surface



The sign convention chosen here is such that pore-wall flux leaving the particle
surface is considered to be positive.

Charge   conservation   in   solid   phase    is   applied   to   evaluate   the
rhs  in eq:csfluxsurface,   a  detailed  derivation  of   which  is
presented  in  Domenico  .  In  summary,  by  assuming
a  uniform   charge  density   throughout  the   thickness  of   each  electrode
(see subsec:basicspmassumptions), we get

    j_(t)                       &= ± I(t)A  l_j a_F   
    Substituting eq:uniformcurrdensity in eq:csfluxsurface
    D_c_rr=R_ &= ∓ IA  l_j a_F 

wherein  the  load current   for discharge,  whose  explicit
time-dependence  has  been  omitted in  eq:csfluxsurfacefinal  for  being
consistent notation with the lhs. The positive and negative signs apply to
the negative  and positive  electrode respectively as  indicated by  the ordered
pair . It  should be noted that the term  involving the Faraday
constant in the rhs  of eq:uniformcurrdensity is , where  is
the number  of electrons  transferred during the  reaction. However,  since this
thesis only  discusses lithium-ion  chemistries where , this  is implicitly
conveyed and shall be omitted for all potential occurrences.

The soc of the cell can be obtained from the bulk concentration of lithium
in  either the  negative  or  positive electrode.  By  convention, the  negative
electrode is used.



Given an  initial cell  soc   at rest,  the equilibrium
concentration of Li^0 in the two individual electrodes can be computed as




eq:csdiffusionfinal,          its         corresponding          boundary
conditions eq:csfluxcentre and eq:csfluxsurfacefinal  along with
initial   condition eq:csfluxinitialcondition,   provide  the   complete
description of  time-domain evolution of  lithium in the  conventional spm
for  a  given  applied  current  profile .  Considerations  for  efficient
numerical simulation of this system is presented next.




Further Reduction in Dimensionality

A naive approach to numerically solving the solid phase diffusion equation is to
discretise each of the two representative particles in the radial direction .
Given the elaborate  simplifications made to remove spatial  resolution from the
axial  direction, the  efficacy of  using  a radial  discretisation is  rendered
questionable, particularly within the scope of  embedding the model in an online
simulation and  state-estimation environment. Since diffusion  in each spherical
particle is modelled by the well-known Fickian dynamics , several
attempts have  been made to  obtain an  approximate analytical solution  for the
solid phase concentration in both electrodes.
In a  dimensionless analysis study,  Zhang and White   provide a
comparative  evaluation of  the various  approximation methods  for solid  phase
diffusion, a summary of which is presented in tbl:solidphaseapprox.

















 
In the  aforementioned study, the computational  burden  storage requirements
and  cpu  times  of  Duhamel's   superposition  method  was  found  to  be
excessively  high to  warrant further  interest  in it.  The original  diffusion
length method proposed  by Wang  is valid only after  the diffusion layer
builds  up  to its  steady  state,  and hence  leads  to  significant errors  in
transient  conditions.  Although Wang  and  Srinivasan  introduced an  empirical
correction factor to  the diffusion length to extend its  validity to short-time
scale operations, this  affected the convergence of the method  for steady state
conditions.  The pseudo  steady state  solution proposed  by Liu  uses a  finite
integral  transform  technique  to  eliminate the  radial  dependence  of  solid
phase concentration.  However, this method uses  computations involving infinite
summations,  exponential  and trigonometric  quantities,  which  in this  thesis
author's view, makes it less attractive for online implementations.

The         literature         on          polynomial         methods         by
Subramanian   provide  detailed derivations  of the
2 and   4 order  polynomial   approximations.  The
2 order solution was found to have poor performance for transient
behaviour, similar  to that  of the original  diffusion length  method. However,
higher order polynomial  approximations were found to  provide acceptable levels
of  performance  for  both  transient  and steady  state  conditions  and  shall
therefore be examined further.

The  polynomial   approximation  method  describes  the   dynamic  evolution  of
the  volume  averaged concentration



as  a function  of the  applied load  current . Here,   represents the
volume  of  the spherical  particle.  For  notational brevity,   is
shortened to  whilst also dropping its explicit time dependence.

The 4 order polynomial approximation assumes that the solid phase
concentration  is a quartic function of the radial co-ordinate .




The    detailed   derivation    of   the    coefficients 
     is     provided    in     Subramanian  .
eq:csmeanevolution,eq:qmeanevolution,eq:csurffromcsavg    summarise   the
governing equations  obtained by applying the  4 order polynomial
approximation of eq:fourthorderpoly  to the system of  equations given by
eq:csdiffusionfinal,eq:csfluxcentre,eq:csfluxsurfacefinal.



    *c_t + 3j_R_                                                &=0  

    *q_jt + 30D_R_^2q_j + 452j_R_^2 &=0 

    35D_R_(c_- c_) - 8D_q_j                &= -j_

where  represents  the volume  averaged concentration  flux, that
defines  the  average  change  of  concentration  with  respect  to  the  radial
position .

As   per  eq:uniformcurrdensity,   the   interfacial   flux  density   is
proportional to  the applied current. Hence  eq:csmeanevolution implies a
simple linear relationship between the applied current and the rate of evolution
of average Li^0 concentration within  each spherical particle. This further
implies  that the  soc of  the cell  has a  linear rate-dependence  on the
externally  applied  current. Furthermore,  due  to  the elimination  of  radial
discretisation, the computation of soc, given by eq:socinitialdefn,
reduces to the task of first computing the ratio of bulk (average) concentration
to  surface concentration  and  then adjusting  it to  account  for the  useable
stoichiometry limits for the relevant electrode. Thus, the cell's soc
can be computed as



where  is obtained by  solving eq:csmeanevolution for the
negative electrode.

In   the  views   of   this  author,   this  4 order   polynomial
approximation   proposed  by   Subramanian    strikes
an  acceptable  balance  between   the  three  modelling  pivots ---
*[label=*)]
    computational complexity,
    mathematical  tractability, and
    numerical accuracy

and has therefore  been adopted for all spm simulations  presented in this
work.

At   the   end   of    this   dimension-reduction   step,   spatial   dependence
is   completely  eliminated,   yielding   a  zero-order   (in  space)   physical
model    whose    dynamics   are    described    by    the   dae    system
of eq:csmeanevolution,eq:qmeanevolution,eq:csurffromcsavg.



Equilibrium Thermodynamics

The equilibrium potential of a porous electrode is a thermodynamic property that
depends on the extent of lithiation in the outermost interstitial sites near the
sei layer. This surface stoichiometry   for an electrode is obtained
by  computing the  surface  concentration  (using eq:csurffromcsavg)  and
dividing by the maximum lithiation capacity of that electrode.




Although based upon the theoretical foundation  laid out by the Nernst equation,
owing  to a  multitude of  complex phase  transitions, the  potential of  porous
electrodes  (with respect  to metallic  lithium) is  usually given  as empirical
functions of its surface stoichiometry .



where  the  empirical  relationships  are  typically  high  order
polynomials  or rational  functions  that  are fitted  to  relaxation data  from
gitt experiments on half-cells .

In the spm,  the cell's ocp is obtained by  subtracting the negative
electrode  equilibrium  potential   from  its  positive  electrode
counterpart .



Even though the  concept of ocp is defined only  in equilibrium conditions
when no  current flows,  the individual electrode  potentials themselves  form a
significant component of the cell's terminal voltage .

Reaction Kinetics

In the spm, the reaction kinetics in each spherical electrode is modelled
using the Butler-Volmer expression (see eq:butlervolmer).

    j_&= j_0_j [ ( (1-α) F η_jR T) -  ( -α F η_jR T)]  

    where
    j_0_j &= k_c_e^1-α c_^α (c_- c_)^1-α


The equilibrium  rate of forward  and backward  reactions at both  electrodes is
assumed  to  be  equal.  With charge  transfer  coefficient ,
eq:bvwithalpha simplifies to




The  expression   for  overpotential    can  be   obtained  rearranging by
eq:BVwithalphahalf     whilst     substituting    for      from by
eq:uniformcurrdensity and is given                                     by




Cell Terminal Voltage

The terminal voltage  of the cell under applied load  is obtained by subtracting
the potential of the negative electrode from its positive counterpart.

Starting from the definition of the overpotential of each electrode

    η_pos &= ϕ_- 0ϕ_ - U_pos  

    η_neg &= ϕ_- 0ϕ_ - U_neg 

Within  each electrode  domain,  the contribution  of  electrolyte potential  is
neglected  (see subsec:basicspmgeometry,subsec:basicspmassumptions  for a
brief discussion on the exclusion of electrolyte dynamics).

Subtracting eq:negoverpotential   from eq:posoverpotential,

    η_pos - η_neg &= ϕ_- ϕ__V_cell - U_pos + U_neg

whose rearrangement yields
    V_cell               &= η_pos - η_neg + U_pos - U_neg

In the  basic spm,  eq:cellterminalvoltagebasic is used  to compute
the cell's terminal voltage under  load. Although their explicit time-dependence
notation  is omitted  in  the notation  here,  it is  worth  reminding that  all
quantities in eq:cellterminalvoltagebasic are indeed continuous functions
of time.

State Space Representation

For control  oriented applications, it is  imperative to have a  classical state
space representation  that collates  all intermediate equations  and definitions
presented  thus  far into  a  single  system  of  equations that  describes  the
evolution of solid concentration and terminal  voltage over time, expressed as a
response to the  external current input . However,  the non-linearities in
the equation for terminal voltage  eq:cellterminalvoltagebasic imply
that it is  not possible to represent  the spm in the form  of a classical
lti  system  of eq:LTIstatespace.  Instead,  the  spm can  be
summarised  by a  system  of linear  state equations  together  with the  single
non-linear output equation.

Rearranging  eq:qmeanevolution,eq:csurffromcsavg, the  state equation  is
obtained as









































which corresponds to the classical lti form



where 
  is
the  state  vector.  The  scalar system  input   is
the  applied  current .  The  system matrix 
  and  input  matrix   are  also  shown  in
eq:fourstatesmatrixvec.

For state estimation and controller design purposes, it is important to keep the
number  of elements  in the  state vector  as small  as possible  by eliminating
redundant  variables.  For  instance,  Di Dominico  
noted that with  output voltage as the only measured  quantity, the observablity
of   the  four-state   model  of   eq:fourstatesmatrixvec  is   adversely
affected.  To tackle  this issue,  a  state-reduction approach  was proposed  by
Di Domenico  ,  which  hinges  upon the  principle  of
material balance.

The total number of moles of lithium in the system is given by




Upon considering only the bulk concentration as per the dimensionality reduction
procedure    outlined   in subsec:basicspmfurtherdimensionalityreduction,
eq:totallithiummoles reduces to

    n_Li  &= ε_ l_pos A43 π R_^3c_∫_0^R_ 4 π r^2   dr
    + ε_ l_neg A43 π R_^3c_∫_0^R_ 4 π r^2   dr
                

                 &= ε_ l_pos A  c_+ ε_ l_neg A  c_

Assuming    no    loss   of    cycleable    lithium    or   other    degradation
mechanisms,  the   total  number  of   moles  of   lithium  in  the   system  is
conserved    .   Substituting   this   into
eq:totallithiumsimplified,

    0                          &= + *ε_ l_pos A  c_t + *ε_ l_neg A  c_t 

    *c_t  &= -*c_t 


As  per   eq:bulkconcrelationship,  the   time  evolution  of   the  bulk
concentration  of one  electrode can  be obtained  as a  function of  the other.
Furthermore, Di Domenico    show that  the diffusion
dynamics of the  bulk concentrations can be algebraically  related through their
stoichiometric factors as





Hence, it  is possible  to eliminate the  bulk concentration of  any one  of the
electrodes from the state-equation to arrive at a three-state description of the
model dynamics. In  extant lithium-ion chemistries, owing to  its proclivity for
lithium deposition during  charging, the negative electrode is  considered to be
the limiting electrode (See  Arora  ). Hence it is retained
in the state vector, thereby leading to  the final form of the state dynamics of
the conventional spm as



































The  measured   variable   is   the  cell's  terminal
voltage  and  is expressed as  a non-linear  scalar function of  the state
vector and the load current.



The output  equation given by eq:spmoutputeqn includes  a non-zero direct
feedthrough dependency  of the voltage  on the input current,  thereby modelling
the resistive component of the cell's  impedance. The full expression for output
voltage is given by expanding eq:cellterminalvoltagebasic as


    V_cell(t) = 2 R TF ^-1 ( - I(t)2 A
    l_pos a_F k_c_e c_(t)
    (c_- c_(t))) 

    - 2 R TF ^-1 ( I(t)2 A  l_neg a_F
    k_c_e c_(t) (c_- c_(t))) 

    + U_pos(c_(t)) -
    U_neg(c_(t))

wherein the solid  phase surface concentration at  each electrode  is
obtained  from its  corresponding bulk  concentration  by  rearranging
eq:csurffromcsavg and is given by

    c_&= c_+ 8R_35 q_pos
    +R_35 D_A  l_pos a_F I(t)
    

    c_&= c_+ 8R_35 q_neg -R_35 D_A  l_neg a_F I(t)

where  for discharge.

Given the initial  soc of the cell , the  initial bulk concentration
of   the  negative   electrode  at   equilibrium   is   obtained  by
eq:csfluxinitialcondition.  The   initial  value   of  the   mean  radial
concentration flux  in both  electrodes is zero   . Therefore,
the  initial  state  vector  is .  Thus,  the  system  of
equations given by eq:csposbulkfromcsnegbulkeq:csurfnegfromcavgneg
form a complete  state-space representation of the  conventional spm. This
state-space model  can be  simulated as  a standalone  ivp or  embedded as
the  plant model  in control-oriented  applications  such as  for dynamic  state
estimation.
 


Numerical Implementation


The  equations  presented   in  sec:spmmodeldevelopment  are  well-known,
self-sufficient and  fully descriptive so  as to implement the  basic spm.
Although discrete-time numerical implementation  of circuit-oriented cell models
has been  considered , there has
been  no such  treatment  of this  critical aspect  in  the spm  modelling
literature. Since  this thesis has  a strong focus  towards enabling the  use of
pbm  in an  embedded  environment,  at least  the  numerical aspects  of
implementing  these  equations need  to  be  discussed.  The finer  details  and
practical engineering considerations of real-time programming, in particular the
integration  of  the  cell  model  into  the  pack,  interaction  with  upstream
components and other such aspects  of a typical vehicular drivetrain controller,
are beyond  the scope of this  academic work. Nevertheless, the  discussion here
aims  to  lower  the  barrier  to  real-time  implementation  and  is  a  unique
contribution in the implementation context of cell models.

Continuous-time Implementation
Analytical solution

Although  not   explicitly  given  in  spm   literature,  using  lti
system  theory,  the  analytical  solution for  continuous-time  state  equation
(eq:LTIstatespace) with current input 



 is given by



    x(t) &= e^A (t-t_0)x(t_0) + _t_0^te^A (t-τ)B u(τ)dτ 
    

    With a standard ivp, 
    x(t) &= e^A tx(0) + _0^te^A (t-τ)B u(τ)dτ_convolution integral



The matrix exponential  is known as the state-transition matrix and is
defined as



although several methods exist for its efficient numeric
computation .

The analytical solution  given by eq:analyticalctssoln can  be applied to
obtain the  matrix-vector state  equation eq:threestatesmatrixvec  of the
spm. Once  the state variables  are obtained  at a given  time-step, after
evaluating the  surface concentrations as per  eq:csurfposfromcavgpos and
eq:csurfnegfromcavgneg, they may be  substituted into the output equation
of eq:spmbasicoutputvoltagefinal  to obtain  the cell's  terminal voltage
for that time-step.

Numerical considerations for continuous time implementation

The  procedure  described  thus  far  has  a  practical  limitation.  The  input
current  to the  cell has been defined as a  continuous quantity. Although
for the  purpose of characterising the  cell's behaviour, it is  possible to use
pre-determined continuous-functions  as load profiles  ( sinusoidal waveforms
for virtual eis testing), it is desirable to evaluate the model's response
to typical real-life conditions. In a vehicular application, only samples
of cell current  measured by sensors at discrete-time intervals  are reported to
the bms. A zoh operation is  used at the model's input  the level
of current is assumed to be held constant between two successive measurements.



It    is    tedious    to    hand-compute   the    convolution    integral    of
eq:analyticalctssoln.   However,  a   variety   of  state   of  the   art
adaptive-time  solvers  employing  numerical  schemes  such  as  Dormand-Prince,
Runge-Kutta,  Collocation and  Backward  Differentiation  Formula are  available
to  efficiently  handle  such  ode. Since  lithium  concentrations  vary
smoothly  over  time  without   abrupt  discontinuities,  a  standard  non-stiff
solver  of  moderate   order  shall  suffice.  A  single  line   of  code  using
MATLAB's  ode45  solver  can  implement this  time  integration   

matlab[ ,x_new] =  ode45(@(t,x) stateEqn(x,Ik,spm_params), t_span,
x_old); 

Since  the direction  of applied  current  is susceptible  to sudden  reversals,
( due  to  acceleration  and  braking events  in  a  vehicular  application),
the  solver   needs  to   be  stopped  and   re-started  every   sample  period.
alg:ctstimespm shows the sequence of  operations for a desktop simulation
of  the  continuous time  spm  on  a  digital  computer. The  source  code
listing  of  an  example  implementation   in  MATLAB  is  provided  in
sc:ctstimespm.



[!htbp]
    Continuous-time spm
    loa     [1]
        Load profile  a csv file of  vs. C-rate
        spm parameter set   stored in a struct params
        , , cell capacity , sample rate  
         within limits index 
        Simulatespm            


t_f,condition


 may terminate early due to cut-off violations
                    Flexible end time. Extrapolate last C-rate from profile until  if necessary.
             max iterations assuming no cut-offs
            Allocate storage of size  for each simulation variable
            Compute [1] as per eq:csfluxinitialcondition
               from profile
             from direct feedthrough
            
                 interpolate from profile using zoh
                Solve continuous-time equation eq:threestatesmatrixvec solver IC set to 
                 last time-entry  vector of soln.  matrix from an adaptive solver  MATLAB's ode45
                Compute  as per eq:soccomputation
                
                 exceeded cut-off limits
                     data from last  step is invalid
                    break;
                
            
        

        x, I, params
            Compute  as per eq:csurfnegfromcavgneg
            consider saturating  

            Compute  as per eq:csposbulkfromcsnegbulk
            Compute  as per eq:csurfposfromcavgpos
            Compute  as per eq:spmbasicoutputvoltagefinal
        

 
In  the author's  view,  the  continuous time  spm  algorithm has  limited
practical  use.  Computing  the  convolution  integral  or  deploying  ode
solver codes  onto a microcontroller  is challenging and  introduces substantial
computational burden. Although the continuous time model can be used for desktop
simulation, more sophisticated pbm are  already available for this task.
Therefore,  for online  deployment  in  state estimation  and  control tasks,  a
discrete-time  version of  the model  suitable for  real-time implementation  is
needed.



Conceptual Overview of Real-Time Processing

The   equations   in    subsec:basicspmgoverningeqns   are   derived   in
continuous   time   form.  In   particular,   the   state  equation   given   by
eq:threestatesmatrixvec describes  the continuous time  dynamic evolution
of  quantities such  as the  bulk concentration  and rate  of mean  radial flux.
However,  a  typical embedded  controller  such  as  that  used in  a  vehicular
bms  operates   in  discrete-time .  This   implies  that
samples of voltage, current and  temperature measurements are obtained at
a periodic time interval . The updating of solution variables are performed
between two successive data acquisition events from the sensors.




Execution of  control-oriented reduced-order  pbm such as  the spm
and  their  associated  computations  are   modular  sub-tasks  of  a  vehicular
bms.  A   single  bms   often  provides  a   whole  host   of  other
auxiliary  functionality such  as  cell balancing,  protection, diagnostics  and
data-logging . Although  thermal management tasks  are typically
delegated to dedicated controllers, the bms software routines often handle
data exchanged  between various subsystems  on the vehicular  communication bus.
While some of these tasks such  as book-keeping and diagnostics can be performed
at  a low  execution-rate, others  such as  cell measurements  and model-related
computations need to be performed with high priority.








































































fig:basicRTCsoftwarearch shows  an example of a  plausible implementation
of  a bms  software  in an  embedded microcontroller.  The  vast array  of
functionality  performed by  the bms  can be  grouped and  managed as  two
separate processes ---
*[label=*)]
    a background thread, and
    a foreground thread.

The  background  thread runs  continuously  within  the main  loop  sequentially
processing instructions. subfig:bgRTprocess shows an example illustration
of typical  background tasks that  a bms handles. All  high-priority tasks
are  triggered  by  an  interrupt  and the  supervisory  control  loop  suspends
the  presently executing  background  task  for later  resumption.  As shown  in
subfig:fgRTprocess, a typical example of such an interrupt driven process
is the  evaluation of the spm  model equations and computation  of control
outputs and is discussed next.

















fig:timingdiagramBig  depicts  an exploded  view  of  the timing  aspects
of  the  Interrupt  Service  Routine  that  was  briefly  presented  in
subfig:fgRTprocess.  Upon  the  expiry  of an  on-chip  timer  calibrated
against a  baseline precision-clock,  hardware interrupts are  raised by  one or
more adc associated  with voltage/current sensors mounted  on cells. The
isr  disables  the interrupt  and  reads  the  samples  of data  from  the
adc into software. At the end  of this process, the isr rearms the
interrupts  and  simultaneously sends  and  acknowledgement  to the  appropriate
sensor which reloads its timer. The spm model equations are then evaluated
in  software and  the  resulting  computational variables  such  as voltage  and
concentrations are  employed in  other pertinent tasks  such as  state estimator
subroutines. If  the bms  also performs  control tasks   regulating the
coolant's  flow rate  or  ice  state-toggling such  as  in the  hysteresis
control of a series hybrid drivetrain,  these control outputs are written to the
relevant dac.




Sample Delay Considerations

fig:timingdiagramSmall  shows   a  vertically  compressed  view   of  all
cpu activities across  a larger time horizon. The  cpu's load factor
is the ratio  of time spent in  foreground requests to its idling  time. While a
high load  factor is  beneficial in  terms of efficient  usage of  resources, it
adversely affects the power efficiency of the chip.















For  Li-ion  cell  modelling,  a  sampling  interval  of 
is   commonly  used,   thus  aiming   to   capture  the   cell  dynamics   below
500 
. The cpu's
clock  used is  of several  ,  a vast  majority  of which  is spent  in
background tasks or in sleep mode.  Furthermore, a low-latency isr code is
employed  in the  tasks of  reading the  adc value,  evaluating the  model
equations and writing  any control outputs to the dac.  Using a simplified
pbm such as the spm helps  in achieving a low-latency throughput for
the isr.

The overall implication of such a scheme  is that any delays owing to the
sample and  hold process  at the model  input and outputs  can be  neglected. In
conventional sampled-data systems, control delays may be analysed by considering
a multiplicative factor of  in the Laplace domain transfer function of
the system. Delay parameters of  or  are commonly
employed as conservative  estimates. However, owing to the  small cpu load
factors, in this thesis this delay term is omitted for discrete-time formulation
of the spm.

Discrete-Time spm Formulation



Due  to the  sampling and  zoh operations  at the  adc input  to the
system,  the input  to the  spm is  transformed from  a simple  continuous
time  signal to  discrete-time sequences    and  
,  where  is the sample  index corresponding
to  the  continuous time  instant .  The continuous  time  plant
model  represented by  the  ode  system of  eq:threestatesmatrixvec
is  therefore   replaced  by   a  discrete-time  process   and  modelled   by  a
difference equation which is to be determined.

Consider       the       general      continuous-time       solution       given
by eq:genanalyticctssoln. Let  and , where . Therefore,
2
    x(t_0) & = x(kT_s)     & & x[k] 

    x(t)   & = x((k+1)T_s) & & x[k+1]

Substituting these relationships into eq:genanalyticctssoln,



With  the  zoh scheme  discussed  here,   remains  constant  from   to ,  and  is  equal  to    .  Consider  a
change-of-variable definition  for the dummy  variable of integration   as . Thus,  .  Hence, 
. Substituting these into eq:intermediatediscrete,

    x[k+1] &= e^A T_sx[k] + [_T_s^0e^A B ] u[k]-d

    Reversing the order of integration leads to
    x[k+1] &= e^A T_sx[k] + [_0^T_se^A B d ] u[k] 


eq:disctimefulleqn represents a discrete-time state-space representation
of the dynamics of the system whose generic representation is given by the
difference equation



where  and 
.
If the continuous-time system matrix  is invertible, a closed form
expression for  is obtained as

    B_d &= A^-1(A_d - I_n)B && (if  exists)

For the continuous time system matrix  of the spm, its determinant is
zero.







and hence  is not invertible.  This necessitates  an explicit evaluation  of the
integral in eq:disctimefulleqn for computation of the discrete-time input
matrix .

Since  the only  non-zero entries  of  the matrix  lie along  its main  diagonal
 its modes are decoupled, the matrix exponential reduces to a diagonal matrix
whose elements are simply the scalar exponentials of the original entries. The
discrete-time input matrix  can be obtained by evaluating eq:B_dinit
as shown below.

    A_d = e^A T_s = (
        
            -30D_R_^2 & 0                            & 0 

            0                            & -30D_R_^2 & 0 

            0                            & 0                            & 0
     T_s )
    =
    
        e^-30D_R_^2 T_s & 0                                    & 0 

        0                                    & e^-30D_R_^2 T_s & 0 

        0                                    & 0                                    & 1
      

    B_d = _0^T_se^A B d
    =_0^T_s ( 
            e^-30D_R_^2  & 0                                    & 0 

            0                                    & e^-30D_R_^2  & 0 

            0                                    & 0                                    & 1
        
        
            452 -1R_^2 A  l_pos a_F 

            452 -1R_^2 A  l_neg a_F 

            452 -3R_A  l_neg a_F
     )  d 

    B_d = 
        -34 1 - (-30D_R_^2)T_sD_A  l_pos a_F 

        -34 1 -
        (-30D_R_^2)T_sD_A  l_neg a_F 

        -34 -3 T_sR_A  l_neg a_F
     


The  discrete-time  matrix-vector  system  presented  in  eq:A_dinit  and
eq:B_d have  not been presented in  existing literature, but is  vital to
understanding  the  implementation  of  the spm  in  digital  controllers.
Although,  simpler alternatives  such  as Forward  Euler  methods are  available
to  approximate  the time-derivative  of  the  state  vector, they  suffer  from
problems  such  as  a  growth  in   the  rate  of  local  truncation  error  per
time-step , necessitating  the use  of very high  sample rates,
which increases  the burden on  the embedded controller. The  matrix exponential
approach is superior in  terms of accuracy and stability across  a wide range of
sample rates.

For  a  pre-determined  sample-rate,  the   matrix  exponential  and  hence  the
  and     matrices  can   be  computed   offline  on  a   desktop  and
stored  into  the   non-volatile  memory  of  the  embedded   controller  to  be
loaded  onto  RAM  during  operation.   The  vectorised  implementation  of  the
state  dynamics  presented  here  is  highly  efficient  and  directly  amenable
for  use  in   classical  state-vector  algorithms.  For   the  cell's  terminal
voltage   computation,   the   basic   structure  and   form   of   the   output
equation  given  by  eq:spmoutputeqn  remains  intact,  except  that  the
continuous  time   variables   need   to  be
replaced  by  their discrete-time  counterparts  in  the corresponding  equation
set   eq:spmbasicoutputvoltagefinaleq:csurfnegfromcavgneg.  The
discrete-time output function  is evaluated after updating the state
vector (through eq:discgenericLTI).




The complete sequence of steps for implementing the discrete-time variant of the
spm is given in alg:disctimespm. In particular, it can be seen that
the  discrete-time system  and input  matrices,  and   can be  easily
pre-computed from  the parameter set  using the matrix exponential  approach. In
MATLAB, this  can be achieved  by passing  the arguments of  the matrix
exponential to the  `' command. The vectorised  implementation of the
discrete-time  state equation  given in  line 
of  alg:disctimespm  is a  set  of  efficient linear  algebra  operations
consisting of simple matrix-vector product and vector-addition routines.



[!htb]
    Discrete-time spm
    loa     [1]
        Load profile  a csv file of  vs. C-rate
        spm parameter set   stored in a struct params
        , , cell capacity , sample rate  
         within limits index 
        Simulatespm            


t_f,condition


 may terminate early due to cut-off violations
                    Flexible end time. Extrapolate last C-rate from profile until  if necessary.
             max iterations assuming no cut-offs
            Allocate storage of size  for each simulation variable
            Compute [1] as per eq:csfluxinitialcondition
               from profile
            Compute  and  as per eq:A_dinit and eq:B_d
             from direct feedthrough
            
                 interpolate from profile using zoh
                 eq:discgenericLTI
                Compute  as per eq:soccomputation
                
                 exceeded cut-off limits
                     data from last  step is invalid
                    break;
                
            
        

        x,I,params uses discrete-time variants of eqs  at index 
            Compute  as per eq:csurfnegfromcavgneg
            consider saturating  

            Compute  as per eq:csposbulkfromcsnegbulk
            Compute  as per eq:csurfposfromcavgpos
            Compute  as per eq:spmbasicoutputvoltagefinal
        

 
This thesis strives  for an inclusive approach by taking  into account that some
battery researchers whose  focus is on fundamental aspects of  lithium ion cells
 those  specialising in  electrochemistry,  might not  be  familiar with  the
nuances  of the  matrix exponential  and discrete-time  matrix computations  (in
line   of alg:disctimespm).  Therefore,
a  snippet   of  MATLAB   code  clarifying   the  computation   of  the
discrete-time   system   and   input   matrices,    and    is   given
in   codesnippet:computeAdBd.  A   full  code   listing  of   an  example
discrete-time  spm  implementation  in   MATLAB  is  provided  in
sc:disctimespm.

[!htbp]
[mathescape,autogobble,bgcolor=mintedbg,escapeinside=,texcomments=true]matlab
A_cts = [-30*Ds_pos/(R_pos^2),                    0, 0; ...
                            0, -30*Ds_neg/(R_neg^2), 0; ...
                            0,                    0, 0];
A_disc = expm(A_cts*Ts); 

B_cts = [ (45/2)/(R_pos^2*a_pos*L_pos*F*A); ...
         (-45/2)/(R_neg^2*a_neg*L_neg*F*A); ...
             (-3/(R_neg*a_neg*L_neg*F*A))];

B_disc = nan(size(B_cts));
B_disc(1) = B_cts(1)*(exp(A_cts(1,1)*Ts)-1)/A_cts(1,1);
B_disc(2) = B_cts(2)*(exp(A_cts(2,2)*Ts)-1)/A_cts(2,2);
B_disc(3) = B_cts(3)*Ts;

Computation of discrete-time matrices  and  in
MATLAB



Thus,  a  discrete-time model  of  the  basic  spm  is now  available  for
implementation  in  an embedded  bms.  Further  analysis of  discrete-time
issues  such  as  aliasing,  quantisation  noise,  signal  pre-conditioning  and
discrete Fourier analysis  lies in the specialised engineering  domain of signal
processing and falls outside  the scope of the thesis. The  results of the basic
spm are presented next in sec:basicspmsimresults.













 
Desktop Simulation


In this  section, the performance  of the  basic spm is  discussed through
desktop  simulation and  by comparison  against a  standard dfn  benchmark
model incorporating the full p2d dynamics.



[Cell   Parametrisation]Cell   ParametrisationSome
contents    in   this    section   overlap    with   sec:p2daugmentations
and      represents     a      joint     effort      with     Ian      D.
Campbell.
















































































































 
tbl:lcoSimParamsSPMp2d lists  the simulation  parameters of  an lco
cell  whose positive  and negative  electrodes are  LiCoO_2 and  LiC_6
respectively.  The  electrolyte in  this  system  consists of  LiPF_6 salt
in  a   solution  of   ec/dmc/emc  in   a  1:1:1 ratio.  The
standard  set  of  dfn  parameters have  been  extensively  described  and
documented  in  literature.  The   detailed  characterisation  of  the  physical
properties  of  lithium-ion  cells  falls  outside the  scope  of  this  thesis.
Here,  the vast  majority of  electrochemical parameters   the  geometric,
thermodynamic, kinetic  and transport properties  of the cell have  been sourced
from  Subramanian  . The  significance  of each  of
the  parameters  in  the  context  of the  modelling  assumptions  discussed  in
subsec:basicspmassumptions is examined.

The simulation parameters that are applicable exclusively to the p2d model
are shown as  highlighted text in tbl:lcoSimParamsSPMp2d. It  can be seen
that only a  subset of the isothermal dfn model's  parameters are required
for the spm. In particular, there is no requirement to estimate any of the
electrolyte-related  parameters  in  each  electrode  region.  Furthermore,  the
properties of the separator material which  are necessary in the dfn model
are also  not considered in the  spm computations. A brief  enumeration of
the additional  p2d-specific parameters in the  context of parametrisation
requirements is provided here.

[leftmargin=!,itemsep=1ex,labelwidth=abc
    ,partopsep=0pt
    ,topsep=0pt
    ]

    brugg_j3  The  empirical Bruggeman  coefficient  helps
    to   define   the  effective   values   of   conductivity  and   diffusivity
    of   the  electrolyte.   Although  an   identical  value (4)   is  used   in
    tbl:lcoSimParamsSPMp2d,  in  principle  all three  regions  can  have
    different values of brugg and need to be parametrised separately.

    D1  The  intrinsic  electrolyte   diffusivity  of  a  typical
    electrolyte  consisting  of  LiPF_6 salt in  an  organic  solvent  was
    experimentally  characterised   and  provided  as  a   table  of  polynomial
    coefficients  by  Valøen  and  Reimers .  Evaluating  this
    polynomial  at a  cell  temperature of  298.15  results in  an
    intrinsic  diffusivity  of 3.22e-10.  Since
    this is  a material property independent  of the region within  the cell, it
    needs to be parametrised only once.

    1   Like    the   diffusivity,   the
    intrinsic electrolyte conductivity is also a material property and its value
    is independent  of the region within  the cell. Unlike the  diffusivity, the
    electrolyte conductivity  is a strong  function of its  ionic concentration.
    Thus, the polynomial proposed by Valøen and Reimers  needs
    to  be evaluated  at   and  has to  be
    updated during the  simulation as salt concentration  within the electrolyte
    changes over time. A discussion on the choice of initial concentration is
    provided in subsec:basicspmsimsetup.

    _+^01  The  cationic transference  number
    measures the relative  mobility of the Li^+ ion in  the organic solvent
    and is  independent of  the region  within the  cell. Hence,  this intrinsic
    property is to be parametrised only once (per solvent).

    _j2  The  intrinsic conductivity  of
    the  solid phase  depends on  the material  used in  the porous  electrodes.
    Although a simplified  assumption of equal conductivity is used  for the two
    electrodes, in practice, this property needs to be characterised for each of
    the two electrodes.



detect-weight=true  Neglecting  Arrhenius-type temperature  dependence
of  physical  properties  and   their  corresponding  activation  energies,  the
basic  spm  facilitates  the  ability to  afford  physics-based  modelling
capabilities with  eight fewer parameters than  the equivalent isothermal
p2d model. With  the naive assumption of equal  parametrisation effort per
physical property, this  implies a 20 reduction
in  parametrisation  requirements  for  the basic  spm  when  compared  to
its  dfn counterpart.  However,  considering the  fact that  parametrising
the  electrolyte's transport  properties requires  apparatus and  infrastructure
typically  available only  in specialised  chemical/materials science labs,  the
reduction in parametrisation overhead  for system-level engineering stakeholders
is more pronounced.

Prima facie, it may seem that electrolyte porosities and filler volume fractions
do  not  influence the  spm  model.  However,  they  do have  an  indirect
bearing  on  arriving  at  a  critical parameter   the  solid  phase  volume
fraction . This  parameter is required to  compute the specific
interfacial surface  area of the electrodes    the effective electrode
area  exposed to  reaction and  is an  important entity  in the  spm model
equations  presented  in  subsec:basicspmgoverningeqns. The  solid  phase
volume fractions  are also required in  simulating the p2d model  owing to
the need for computing the effective electronic conductivities of the electrodes
(see eq:solidchargeconserve). They are calculated as



where   and   are the  electrolyte and
filler  volume-fraction  within  the  respective electrode  regions.  Using  the
values from tbl:lcoSimParamsSPMp2d results in 

and   for the  positive  and  negative  electrodes
respectively. The specific interfacial surface areas are then calculated as




As   discussed  in   the   assumptions  made   during   model  derivation   (see
subsec:basicspmassumptions)  and   consistent  with  the   assumed  model
geometry,  the  parameters  not  covered  by  the  spm  pertain  to  those
describing electrolyte dynamics and distribution  of electronic charge along the
axial  thickness  direction  of  the  cell. Properties  such  as  the  intrinsic
diffusivities and conductivities of the  electrolyte as well as the transference
number of  Li^+ in the  organic solvent  are thus completely  redundant for
spm  simulation.  The  assumption  of uniform  charge  density  along  the
through-thickness length of each electrode implies that the intrinsic electronic
conductivities of the two electrodes do not play any role in the model dynamics.
The porosities and Bruggeman coefficients in tbl:lcoSimParamsSPMp2d serve
as  modifying factors  of the  intrinsic conductivities  and diffusivities  (see
tbl:dfneqns)  leading to  an effective  value within  each region  of the
electrochemical  layer. Thus,  their relevance  is  also rendered  void for  the
basic  spm  simulation.  The  thickness of  the  separator  material  only
plays  a role  in  electrolyte behaviour.  By the  model  geometry presented  in
subsec:basicspmgeometry, this  parameter also falls outside  the scope of
the basic spm.

The  thicknesses  of the  electrodes  are  optimised  for equal  loading   to
achieve   a  balance   in   their  individual   capacities   to  store   Li atoms.  The  thickness  of  the  positive  electrode  is  chosen  as  the  value
from Subramanian  . The  thickness of  the negative
electrode region  is then  computed with  the goal of  equalising the  volume of
active material  in each electrode  for every  electrochemical layer in  a pouch
cell.




In a  lithium-ion pouch cell, the  electrodes are designed such  that the layers
can be  overlaid on  top of  one another  and finally  encapsulated in  a pouch.
Geometrical considerations  then imply  that the  cross-sectional area  (or face
area) of the two electrodes must be  the same. However, due to the consideration
of  avoiding  plating  at  the  edges  due  to  microscopic  malformations,  the
design  is done  such as  to have  a small  overhang of  the negative  electrode
layer   with  respect  to  the  positive  electrode
layer  (see fig:anodeoverhangpouchcell). Nevertheless, the
active surface area is just the  common overlap area between the two electrodes,
and hence  is  equal to the cross-sectional area  of the positive
electrode.

Thus, eq:basiccapacitybalance reduces to 
, yielding .

At  first,  it may  be  surprising  to note  that  the  values of  the  particle
radius   used  in both  the  p2d  and spm  remain  identical.
However, it is  important to note that the p2d  equations of the dfn
model  are cast  in a  normalised form   already set  up to  account for  the
overall capacity of  the cell under consideration implicitly through  usage of a
current density (per  unit area) for its simulation.  Furthermore, this explains
why increasing the number of discretisation nodes does not increase the modelled
capacity, but instead merely serves to improves the simulation accuracy owing to
the enhanced spatial resolution.

The  overall  active  surface  area   is  the  combined
cross-sectional area of  all layers ( is the number  of electrochemical (pos,
sep,  neg)  triplets)  stacked  into  the pouch  cell.  In  both  the  p2d
and  spm  models,  this  parameter  serves  to  scale  the  external  load
current  down  to  the  current  density  experienced  by  each  electrochemical
layer.  A   value  of  30   was  reported
in  the  results  section  of  Subramanian  .  When
considering a  60 pouch cell with  10 exterior
thickness   and  using   the   parameters  reported   in ,
this  results  in  a  cross-sectional area  of  2.053  (see
sec:p2daugmentations). Considering the  equalisation of capacity loading,
with the  newly chosen thickness  value of  the negative electrode,  the 1C-rate
capacity of the cell has been revised to 29.23.

On  simulating  the p2d  model  with  a  trickle bleeding  type  discharge
corresponding   to   a  current   of   C/500   and   logging  the   data   every
1, after reaching 2.7 

, the remnant concentrations
in  the two  electrodes  were noted.  The  corresponding residual  stoichiometry
values are reported in tbl:lcoSimParamsSPMp2d.



Since      only      isothermal      cell     behaviour      is      considered,
tbl:lcoSimParamsSPMp2d    omits     the    activation     energies    for
the    various   diffusivities    and   conductivities    of   materials    (see
subsec:basicspmsimsetup  for further  thermal  considerations). For  this
reason, tbl:lcoSimParamsSPMp2d does not include other material properties
such as specific heats, and thermal conductivities. No properties of the current
collectors appear in  the isothermal model equations for both  the p2d and
spm models  and hence are  omitted. All other  electrochemical properties,
 stoichiometries  at 100  soc, maximum  concentrations,
diffusivities, reaction  rate coefficients and  ocp of the  two electrodes
remain invariant between the p2d and spm models.

Simulation Setup

For  reproducibility of  results, it  is important  to discuss  the system-level
parameters influencing simulation setup.

The lower  cut-off voltage  of the  cell is chosen  to be 2.5. This
is  deliberately  kept  lower  than  the voltage  corresponding  to  the  cell's
0  2.7.  If set  above  2.7  even
at  infinitesimally small  discharge  currents, the  cell  would cut-off  before
achieving complete discharge. Choosing a value lower than 2.7V means that
the cell gets a chance to recover its terminal voltage, despite spikes in highly
dynamic  load  currents  that  might  bring the  voltage  below  this  threshold
momentarily. If a low-enough value is  not chosen, a system-level shutdown shall
be  initiated  despite possessing  the  ability  to  continue to  operate  after
recovery  of terminal  voltage.  In this  case, choosing  a  cut-off voltage  of
2.5 does  not damage the cell  since checks are in  place to monitor
the  soc  and trigger  cut-off  in  the  event  of charge  depletion  (see
alg:ctstimespm,alg:disctimespm).  Northrop    use
this value, although no specific explanation is given for this choice.

The  upper   cut-off  voltage   of  the  cell   is  chosen   at  4.3
 100 higher  than  the  equilibrium ocp  at 100 soc. There are several  reasons for this smaller margin
at the upper end of the voltage spectrum.
[leftmargin=!,labelwidth=low
    probabilities,itemsep=1ex]

[safety] li-ion  cells are less  tolerant to overcharging and  can pose
    fire hazards.

[degradation]  overcharging  li-ion  cells  can  lead  to  plating  and
    accelerate other degradation mechanisms.

[low  C-rates]  charging C-rates  are  typically  lower than  discharge
    C-rates.

[CCCV charging]  For on-board  chargers, taper charging  (such as  in a
    cccv profile) is activated, which  ensures that charging current drops
    off  rapidly, leading  to a  lower overvoltage  towards the  upper soc
    range.

[low probabilities] The only charging event when an electrified vehicle
    is in motion is during regenerative braking. The vehicular bms manages
    the operating window such that the starting soc is much lower than the
    overvoltage  that  could  be  caused due  to  braking.  Furthermore,  during
    operation, net discharge events  occur more frequently than regenerative
    braking events.



For  both the  p2d model  and the  spm model,  the cell  temperature
is   kept   constant   at   its   initial   value   of   25
(298.15). This might imply to the reader that the operation of the
lithium ion cell is assumed to be isothermal. While this is not true in general,
for  the C-rates  considered  here  (<5C), typical  in  a bev  application
particularly for the  short-duration transient loads studied, it  is certainly a
valid  zeroth  order  coarse  approximation of  the  cell's  thermal  condition.
Detailed modelling of  thermal dynamics is not within the  scope of this thesis,
as  the primary  goal is  to  obtain a  pbm incorporating  electrochemical
principles amenable for  embedded application. Hence, the  thermal dependence of
parameters through an Arrhenius-type relationship is also not considered. Future
work could  include performing  thermally coupled  simulations  incorporating
thermally dependent parameters and  simplified heat generation expressions  a
lumped thermal model could be employed  for both the spm and p2d and
their performances may be compared.

To  understand  the parametrisation  of  initial  concentration, the  expression
for   electrolyte  conductivity   needs  to   be  examined.   As  discussed   in
subsec:spmp2dparametrisation,  the intrinsic  conductivity of  a specific
type  of  electrolyte  is  a  material   property  that  depends  on  the  local
concentration of Li^+ ions and temperature.  In the characterisation of the
electrolyte by  Valøen and  Reimers , the best  fit expression
for electrolyte conductivity was obtained as

    _j(c_e,T)(x,t) =  10^-4 c_e(x,t) (-10.5 + 0.668e-3 c_e(x,t) + 0.494e-6  c_e(x,t)^2

    + (0.074 - 1.78e-5) c_e(x,t) - 8.86e-10 c_e(x,t)^2 )T(t)

	+ (-6.96e-5 + 2.8e-8 c_e(x,t))T(t)^2)^2










fig:kappavsCeandT   shows    a   surface   plot   of    the   electrolyte
conductivity  as a  function  of initial  concentration  and  cell
temperature . For the modelling task at hand, relevant aspects of
this  material property  can be  better understood  through the  simplifications
afforded by  the simulation conditions  applicable here. At  equilibrium initial
condition,   is uniform  over  the axial  space . Secondly,  only
isothermal  cell   behaviour  is   considered   
. Hence, eq:kappavsCeandT reduces to

    _j =  10^-4 c_e,0 (-10.5 + 0.668e-3 c_e,0 + 0.494e-6  c_e,0^2

        + (0.074 - 1.78e-5) c_e,0 - 8.86e-10
    c_e,0^2 )T_cell

	+ (-6.96e-5 + 2.8e-8 c_e,0)T_cell^2)^2


As inferred from fig:kappavsCeandT, the electrolyte conductivity 
is    a    smooth    function    of     and .    Thus
eq:kappavsCeinitandTcell   can  be   effectively  visualised   through  a
parametric  plot of   versus   with   as  the
variable parameter  as seen in fig:kappavsce.  From fig:kappavsce,
it  is  evident   that  at ,  the  maximum
value   of    electrolyte   conductivity    is   attained    at 
.  It  is  advantageous to  operate  the  cell
around  this   salt  concentration  so   as  to  minimise  the   cell's  overall
resistance.  Hence, the  initial  concentration  is  chosen to  be 1000. It should be  noted that while the electrolyte
concentration  in  the  p2d  model  exhibits  both  spatial  and  temporal
variations during  the simulation, in  the spm model, it  remains constant
throughout.












The     reduction    in     parametrisation     requirements    discussed     in
subsec:spmp2dparametrisation    is    only    one    of    the    factors
contributing  to  the  simplicity  and  ease  of  simulation.  As  discussed  in
subsec:basicspmgeometry, an  important computational requirement  that is
present in the p2d model, but  completely eliminated from the spm is
the requirement of discretisation. As reported in tbl:lcoSimParamsSPMp2d,
with  15 nodes per  region  along the  axial direction  and  with 10 shells  per
electrode in the radial direction, the p2d model under simulation achieves
mesh  independence  to  a  tolerance of 2  for  the  range
of  C-rates  considered.  For  higher  C-rates,  coupling  a  thermal  model  is
of  higher  importance  than  incorporating  further  meshing  refinements.  The
discretisation-related parameters  are specific to  the p2d model  and are
highlighted accordingly in tbl:lcoSimParamsSPMp2d.

Capacity Characterisation

First, it  must be  established that incorporating  the parameters  presented in
tbl:lcoSimParamsSPMp2d into  the spm  model equations results  in a
cell with  identical capacity as the  dfn model. This is  to ensure
the  validity  of  comparisons  in  further simulations.  Using  the  values  of
per-layer C-rate  as discussed  in subsec:spmp2dparametrisation,  and the
overall active  surface area from tbl:lcoSimParamsSPMp2d,  the cell under
simulation has a capacity of 60.

Present literature  in battery modelling, both  for the dfn model  and for
the  spm, do  not  discuss  any aspect  of  capacity characterisation.  In
particular,  parameters  such  as  the  geometric  surface  area  of  cells  and
even  their 1C-rate  are often  not listed  in publications.  This practice  can
be  attributed  to  the  fact  that  all  one-dimensional  and  p2d
models operate  on a per-layer  basis, using an applied  current density.
Many  a  time,  researchers assume  a  unit  surface  area  for the  cell.  This
implicit  normalisation  is amenable  to  those  studies  which strive  to  make
numerical comparisons  between models through  simulation. However, it  leads to
a  lack  of  clarity  on  the  actual capacity  of  the  cells  being  modelled.
Furthermore, when comparing with experimental data  from a real cell, such works
resort to  ad-hoc techniques such  as empirical curve-fitting for  obtaining the
surface  area. Often  the  source of  such parametrisation  is  not made  clear.
sec:p2daugmentations  documents  the  details of  obtaining  the  overall
surface area  of cells  and arriving  at the  C-rate per  layer of  the specific
cell  under  consideration.  Since  the  dfn  model  does  not  explicitly
model  the cell  capacity,  a brief  explanation  is provided  on  how a  simple
numerical  characterisation can  be  used for  determining cell  capacity
given a complete parameter list.



For experimental capacity characterisation of cells, the standard practice is to
apply a very small discharge  current beginning at 100 soc,
logging the charge passed using a  high-precision coulomb counter until the cell
hits the voltage corresponding to 0 soc as specified in the
manufacturer's datasheet. In order to decouple the effect of the cell's dynamics
from its  capacity, it is  required to  apply an infinitesimal  bleeding current
(tending towards, but not reaching 0).

Current sensors in battery cycler equipment use high-precision (typically 15--18
bit) adc  and are  able to  offer high  snr except  at ultra-low
currents. The main difficulty with using very low C-rates is that it drastically
slows down  the characterisation procedure.  Using a discharge  current of C/100
 0.6  in  this case,  results  in  a characterisation  time  of
100 or 4 days (excluding soak-times and
other set-up related activities).  Furthermore, for accurate coulomb-counting, a
high data logging  rate is needed, producing large file  sizes and corresponding
difficulties in post-processing them.  Considering moderate buffer-sizes used in
data logging modules of typical  cell-cycler software (shared between channels),
and  to  avoid  excessively  large wait-times  for  characterisation,  discharge
currents of C/20--C/25 are usually deemed sufficient.

In    order   to    validate    that   the    choice    of   model    parameters
result   in   an   intended   capacity  of   60,   an   analogous
procedure   is    carried   out   by    means   of   computer    simulation.   A
characterisation  simulation  beginning  at  100  soc  with
a   discharge   current    of   0.6   was   performed 




.  If the assumed  cell capacity  is indeed consistent  with the
model parameters,  then this corresponds to  a C-rate of 1/100.  Therefore, both
the p2d and spm should run  for exactly 100 hours before cut-off due
to charge depletion.


Capacity validation through computer simulation  is not bound by the limitations
of the experimental approach discussed earlier. Using 64-bit IEEE floating point
arithmetic,  quantities  as  low  as    can  be  safely
computed, nullifying  any snr issues.  tbl:charSimspmp2d summarises
the key data  from this simulation run. For accurate  coulomb counting, the data
logging  interval is  set to 50.  Both models  ran close  to
100 hours.  The small  deviations from  this  expected termination  time can  be
attributed  to the  fact that  the  current is  not arbitrarily  small with  the
pragmatic goal of obtaining results in a reasonable time.


























 
As seen in tbl:charSimspmp2d, even  the combined cpu time to
simulate both  the p2d  and spm  models is  two orders  of magnitude
lower than  real-time. The only  issue that remains to  be addressed is  that of
considerable memory and  storage requirements due to  high-rate data-logging for
accurate coulomb counting. For a standard computer workstation, this places only
a minor demand on its cpu. For comparable volume of data to be logged, the
reliability  and ruggedness  of  a  dedicated workstation  far  exceeds that  of
real-time cell cyclers, thereby establishing numerical simulation as an amenable
method for characterisation of cell capacity. A major disadvantage of simulation
based capacity validation  is its extreme sensitivity to parameters  such as the
maximum concentration  of the  electrodes and  their stoichiometries,  which are
generally difficult to characterise. In this context, the experimental procedure
of  high-precision  coulomb counting  assumes  a  practical significance  as  it
requires no  knowledge of  the cell's parameters  other than  the manufacturer's
datasheet.


fig:capcharspmp2d  shows  the  voltage  response  of  the  spm  and
p2d  models,  which   overlap almost entirely.  It  is  clear  that   both  the  p2d
and  spm  models   achieve  a  run-time  of   100 hours.  This  represents
the   first  visualisation   of  results   produced  by   the  spm   model
equations  discussed  in subsec:basicspmgoverningeqns and  its  numerical
implementation  from sec:numericalimplementation.













The voltage  error  is defined as



The absolute maximum  error is of ,
which  occurs  towards  the  end  of discharge.  Although  this  represents  the
worst  case upper  bound  on  the error,  this  is  not strictly  representative
of  the  overall  error  behaviour   as  evidenced  by  the  standard  deviation
of  the  error  vector.  The  mean   and  rms  error  values  indicate  an
accuracy of .  It should  be noted
that throughout  the simulation, the  voltage response of the  spm remains
slightly above  that of  p2d, thereby  leading  to a  negative value  for the  mean
voltage error. For continuous quantities  such as time-domain simulation outputs
of physical variables, the mae is a suitable error metric and is
defined as



Here, the numerical value of mae is consistent with the order of magnitude
of the rms and  mean error metrics as well as  with the standard deviation
of the error vector.

Thus,  a common  foundation  for  further simulations  has  been established  by
confirming  that  the  two  models  indeed  simulate  a  cell  with  a  capacity
of 60.  With  the   cell  parametrisation  discussed,  simulation
setup  presented and  capacities  validated, the  simulation  results are  fully
reproducible and are presented next in subsec:simresultsbasicspm.

Simulation Results

Constant current discharge

The  left  column  of fig:cnstdischgspmp2dvoltage shows  the  time-domain
voltage response of the basic spm for various constant discharge currents.
The voltage response of the p2d model  is also overlaid on these plots and
is used  as a  reference benchmark  for comparisons.  It is  difficult to  use a
common  time-scale for  the horizontal  axes of  the plots  since the  run-times
differ by two orders of magnitude for the C-rates considered.















Since these comparisons  have to be done across multiple  C-rates, each yielding
different magnitudes in voltage responses, it is helpful to use a relative error
metric such as the percentage error, defined as




It is to be noted that, in all cases, the p2d model terminates faster than
the spm either due to hitting lower cut-offs of either terminal voltage or
soc (see fig:cnstdischgspmp2dsoc).  Consequently, the  error vector
is defined only for the common time-region before cut-off.

In  fig:cnstdischgspmp2dvoltage,  the  column  on  the  right  shows  the
percentage error  in the voltage response  of the spm with  respect to the
p2d model.  At very  low C-rates  below 0.5C,  the voltage-response
performance of the spm is acceptable. However, the performance degradation
is rapid above this C-rate. It is clear that the error in the spm response
is monotonic and unidirectional. This indicates  that the source of the error is
due  to  unmodelled dynamics.  In  particular,  as  discussed in  the  modelling
assumptions  of  subsec:basicspmassumptions,  the spm  ignores  the
electrolyte  dynamics.  Thus,  the  overpotential  in  the  electrolyte  is  not
modelled, which  results in the terminal  voltage of the spm  being always
higher than its p2d counterpart.
















fig:cnstdischgspmp2dsoc  shows  the  time-evolution  of soc
computed by the  p2d and the spm  models for various
discharge  currents. Since  the  soc of  a cell  is  already a  normalised
quantity by  definition, the difference between  the two models can  be directly
used for comparison across C-rates. The soc error is defined as



and   like  the   error  in   the  terminal   voltage,  remains   unidirectional
over  time,   and  defined  only   until  one   of  the  models   hits  cut-off.
tbl:errorsummarycntcurrdischgspmp2d  shows  a  summary of  various  error
metrics used  to quantify  the performance  of the  basic spm  for various
discharge rates.


















 
A   quick   perusal  of tbl:errorsummarycntcurrdischgspmp2d   reveals   a
discrepancy that invokes surprise at first glance. Whilst the performance of the
spm is  quite poor in  terms of terminal  voltage prediction, it  is worth
noting that its soc prediction  capabilities remain quite accurate even at
moderate  discharge  currents  of  about 3C and  therefore,  warrants  a  brief
explanation.

Referring to eq:soccomputation, it is  seen that the soc of
the cell  is directly proportional  to the  bulk (average) concentration  in the
negative  electrode.  Hence  the plots  of  fig:cnstdischgspmp2dsoc  also
represent the solid  phase concentration with a constant scaling  factor. As per
the assumptions listed in  subsec:basicspmassumptions, the only transport
phenomena  modelled in  the spm  is  solid phase  diffusion. However,  for
computation of the terminal  voltage, the electrolyte overpotential contribution
has  been  omitted  (see  eq:posoverpotential,eq:negoverpotential).  This
explains  why  the  voltage  accuracy suffers,  while  the  open-loop  soc
computation  remains  accurate.  The  high accuracy  of  soc  (and  hence,
solid-phase  concentration)   computation  also  validates  the   usage  of  the
4 order polynomial  approximation in the place of  Fick's law for
modelling solid-phase diffusion.

However,  the  discrepancy  in  accuracies of  terminal  voltage  and  soc
computed  by the  basic spm  leads to  an important  implication. Even  at
moderate C-rates, the  basic spm cannot be effectively  used in the
design of soc  observers. This is because, the measured  voltage maps to a
vastly different  operating point when using  the spm as the  plant model,
leading to strong deviations of the estimated soc.


Constant current charge

The cccv charging  profile is a widely adopted  standard charging strategy
for charging lithium ion cells . In the constant current phase,
a charging rate of 1C is used  as an accepted baseline, although faster charging
strategies are presently being actively sought after.

















The top row of fig:cnstchgspmp2d  shows the evolution of terminal voltage
and soc  of the p2d and  spm models under an  applied charging
current of 1C   60. The constant-voltage charging  phase is not
shown. The bottom row shows the corresponding errors of the spm model with
respect to  the reference  p2d benchmark. The  corollary behaviour  of the
constant current discharge  behaviour is observed here. The  terminal voltage of
the spm  remains below  the p2d model  throughout. This  is expected
since, to  account for the  electrolyte voltage  drop modelled in  the p2d
dynamics, a  higher terminal voltage needs  to be applied. The  voltage error is
thus  unidirectional and  remains positive  (opposite to  that observed  for the
corresponding  discharge  case). Similarly,  the  soc  plots overlap  very
closely,  thereby validating  the underlying  polynomial approximation  of solid
phase diffusion.  It is  striking to  note that the  error in  soc remains
exactly  around  the  same  magnitude (0.1)  in  both  the
charging and discharging cases.

Dynamic input profile

For automotive applications, it is  important to characterise the performance of
the  cell  model  under  dynamic load  conditions.  Several  standard  vehicular
driveycles  have been  defined and  adopted  by regulatory  agencies across  the
world.  These drivecycles  describe  the profile  of the  vehicle's  speed as  a
function of time.  The profile of speed versus time  of drivecycles is typically
available in intervals of 1,  and is therefore consistent with the
sample interval used for the simulation (see tbl:lcoSimParamsSPMp2d).

The udds is  one such well-known drivecycle, originally  introduced by the
United  States  Environmental Protection  Agency  that  represents city  driving
conditions  which can  be  applied  to a  typical  mid-sized passenger  vehicle.
world. fig:uddsspeedvstimecycle  shows the udds  drivecycle wherein
the  vehicle's  speed  has  been  converted  to SI  units  for  use  in  further
computations.  One  complete  drivecycle runs  for 1369.  As  seen
in  fig:uddsspeedvstimecycle, the  udds profile  is highly  dynamic
consisting  of  many sets  of  rapid  acceleration  and braking  events.  Hence,
this  drivecycle is  chosen to  provide  representative results  of the  model's
performance to dynamic inputs.








In  an  all-electric  drivetrain  wherein  lithium  ion  batteries  provide  the
propulsion power, the speed profile can be suitably converted to a corresponding
current  profile  experienced by  the  cell  through  the application  of  basic
governing   equations  from   vehicle   dynamics  (see   sec:accpathway).
Therefore,  from  the  cell's  perspective, traversal  of  the  drivecycle  then
corresponds  to  the following  events.  During  acceleration phases,  the  cell
experiences  a  sharp  discharge  spike of  current.  Similarly,  assuming  that
regenerative  braking is  employed,  each deceleration  event  corresponds to  a
charging  current. Thus  a  current  versus time  dynamic  load  profile can  be
obtained. To  briefly summarise the  conversion process used here,  the computed
power profile of the cell is divided  by its nominal voltage and suitably scaled
so that the peak  of the current profile corresponds  to a discharge current
of 3C. Considering that all the braking energy cannot be recovered due to losses
at  the wheels,  brake discs  and  other mechanical  components, a  regenerative
braking  factor of  85  (the fraction  of  recoverable power)  is
assumed for  the charging scenario.













fig:uddssimp2dspmresults  shows   the  simulation  results   obtained  by
applying   the   udds   current   input  profile   (top   row)   to   both
the   p2d   and  spm   models.   The   simulation  is   started   at
50  cell soc. This  is representative  of the  median point
for  the  operating   window  of  soc  swing  for   both  bev  and
phev . Although  regenerative braking  is employed,
due  to  the  reduced  occurrence  of braking  events  as  well  as  considering
efficiencies of  the drivetrain, as  with any driveycle, the  udds profile
also results in a net-discharge. The  cell's soc at the termination of the
udds run is 6 lower than its starting value.



The  voltage  output   from  the  models  is  plotted  in   the  middle  row  of
fig:uddssimp2dspmresults.  The  bottom row  shows  the  evolution of  the
cell's soc  over time. Consistent  with the  error trends observed  in the
constant current discharge and charge simulations, the error in terminal voltage
is  high whereas  that in  soc is  low. In  this work,  the voltage  error
metrics  are reported  directly in  units  of   for the  dynamic
simulation run. Furthermore,  it is a standard practice to  report the rms
error for such dynamic load profiles and is therefore included in the summary of
error metrics reported in tbl:errorsummaryuddsdischgspmp2d.















 


 


Towards Enhancing the Conventional spm


As  evidenced by  the  results of  the constant  current  charge, discharge  and
dynamic  simulation runs,  the basic  spm suffers  from a  critical
drawback. The lack of electrolyte dynamics in the conventional spm results
in poor  voltage accuracy  even at  moderate C-rates.  This renders  the model
unsuitable for  observer design in  soc estimation applications  since the
output voltage from the model maps  to a radically different soc operating
point. A  number of candidate  solutions have  been proposed in  literature that
strive to mitigate  this drawback. Merits and drawbacks of  the salient attempts
are briefly evaluated here.

Even  the  earliest   works  which  attempt  to   include  electrolyte  dynamics
into  the  conventional  spm  were   published  only  within  the  present
decade. Schmidt   proposed an infinite-sum eigenfunction
modal  expansion  paradigm  to  solve  for  the  electrolyte  concentration.  It
was  claimed  that by  accounting  for  contribution  from  only the  first  two
terms, sufficient  accuracies may be  achieved. Furthermore, a  simple ode
was  proposed  for  the rate  of  evolution  of  the  first temporal  mode.  The
solved  electrolyte  concentration  is  then  substituted  into  an  approximate
analytical solution for the dfn model's charge conservation pde (see
eq:dfnliquidpotential) to obtain the  electrolyte potential. However, the
presentation lacks depth  in the explanation which  hinders reproducibility. For
instance,  the  origin  and  explanation  of  the  approximation  terms  in  the
electrolyte  potential solution  is omitted.  Derivations are  performed from  a
rigorous mathematical perspective without providing contextual reference to cell
parameters or  electrochemical quantities. Introducing numerical  examples would
have been a redeeming factor to help keeping the mathematical aspects tractable.
This method has not seen further uptake for spm modelling.

Guo    presented an  empirical approach  to account  for the
solution-phase dynamics.  Using standard curve-fitting techniques,  a non-linear
resistance as  a function of current  and temperature was introduced.  Thus, the
equation for cell terminal voltage presented
in eq:cellterminalvoltagebasic is modified as



where   is  the  equivalent  resistance newly  introduced.  In  the
opinion of  this thesis  author, this  approach is too  simplistic and  does not
generalise well. Even if giving up  physics-based model origins can be tolerated
for one  or two subsystems  within the model,  the equivalent resistance  is not
just a minor correction term since it  needs to account for a large polarisation
voltage of  the order  of tens of  millivolts. Secondly,  the current-dependence
introduced  to account  for the  complex mass  and charge  transport within  the
electrolyte  places a  disproportionately large  weight on  the accuracy  of the
curve-fitting process. Non-linear fits as proposed in Guo  are inherently
problematic  as  the optimisation  routine may  simply converge  to a  local
minimum.  The  specific  form  and  nature  the  convexity  of  the  proposed
hypothesis  function is  not  discussed.  It is  also  not  guaranteed that  the
same  fitting function  is  applicable  to a  different  cell  with another  set
of  parameters.  Finally, the  correction  term  being  resistive in  nature  is
zeroth order   cannot account  for the frequency  dependent behaviour  of the
electrolyte's  dynamics. This  approach is  more suited  for small-scale  static
corrections that do not  depend on the current  to account for  a few tens of
microvolts due to a constant contact resistance of the current collectors.



Di Domenico    were   the  first   to  present   a
step-by-step  derivation   of  the   approximate  analytical  solution   to  the
electrolyte overpotential. The potential drop in the electrolyte is given by



and   can   be   substituted    into   the   subtraction   operation   involving
eq:posoverpotential  and  eq:negoverpotential   in  computing  the
overall  overpotential   of  eq:overpotentialdifference  and   hence  the
terminal  voltage. The  effective conductivity  of  the electrolyte  in a  given
region    within  the cell,  is  defined  as 
.    As    discussed    in
subsec:basicspmsimsetup,   the   intrinsic,   and  hence   the   effective
electrolyte conductivity is a function of the concentration of Li^+ ions in
the  electrolyte.  Di Domenico   did  not, however discuss  the  spatio-temporal
calculation  of  electrolyte  concentration.  It   is  likely  that  a  constant
electrolyte  concentration  at  its  initial  equilibrium  value  was  used.  As
seen  in fig:ce1cdischgwithzoom,  significant  spatial  gradients in  the
electrolyte are established even at low  to moderate C-rates during the cell's
operation.  Sustained application  of  a unidirectional  current  even leads  to
starvation of ions in the electrolyte, particularly near the current collectors.
This  phenomenon  is  visualised in  fig:ce1cdischgwithzoom  wherein  the
electrolyte  at the  positive current  collector is  virtually depleted  of ions
at  the  end  of  discharge.  This  ion-starvation  process  occurs  earlier  at
higher C-rates  and spreads throughout  the thickness of the  electrode. Thus,
the  assumption  of constant  ionic  concentration  in  the electrolyte  is  not
true.  Neglecting mass  transport due  to diffusion  implies that  the terms  in
eq:electrolytepd constitute only  a part of the  expression for computing
the electrolyte  overpotential. Furthermore, Di Domenico   do not present
any results of  applying dynamic current profiles. Since the  critical aspect of
mass transport contribution to electrolyte  overpotential is omitted, this model
cannot be viewed as a sufficient enhancement to the basic spm.

















Although  not presented  in the  context  of incorporating  into the  spm,
Guduru     derived   an   analytical   solution   of   the
spatio-temporal  evolution  of  electrolyte concentration  using  the  sov
method.  The sov  method was  first applied  to modelling  of lithium  ion
cells  by Subramanian    to  solve  for solid  phase
concentration  profiles in  spherical  electrode particles.  Although the  ionic
concentration  in  the electrolyte  computed  by  the analytical  expression  in
Guduru  seems like a feasible choice for inclusion into the spm, it
is only  applicable for galvanostatic  boundary conditions  when  the applied
current  is held  constant over  time. By  natural extension,  researchers could
hypothesise  that this  restriction  may  be removed  by  considering the  input
current as  piecewise constant  over small sample  intervals. Such  a hypothesis
could  be  reinforced  by  the  fact that  standard  drivecycles  are  specified
as  discrete  samples and  the  discrete-time  spm processes  these  input
samples assuming zoh behaviour. However, the analytical solution presented
in  Guduru   assumes a  qss  concentration  profile. These  authors
consider  a near-instantaneous  establishment of  this qss  and suggest  a
parameter-independent analysis  through use of dimensionless  concentrations and
time-constants instead of absolute time.

In  the  studies  conducted  by  this  thesis  author,  significantly  different
transient  behaviour  is exhibited  by  the  electrolyte concentration  profile.
In  particular,  the time  taken  to  establish  the  qss profile  is  not
negligible. This  difference in behaviour  could be attributed to  the different
parameter  set used.  fig:ce1cdischgwithzoom  shows  the spatial  profile
of  ionic  concentration at  various  snapshots  of  time during  a  1C constant
current  discharge.  Starting  at 100  soc,  the  discharge
lasts 3571.  It  is seen  that  it  takes nearly  60
to  establish  the approximately  parabolic  shape  assumed by  the  electrolyte
concentration. After the initial transient has elapsed, the underlying structure
of the mathematical equations can be assumed  to be static. This is evidenced by
the  fact  that  at  1785   after  half  of  the  discharge  is
completed, the shape of the curve is  nearly identical to the one towards end of
discharge. These  qss curves  have their sole  inflection points  at their
separator  interfaces and  remains monotonic  within their  respective electrode
regions.  The  difference in  height  for  various  times  can be  accounted  by
the  coefficients  solved  using  the  analytical  modal  solution  proposed  in
Guduru .

The  axes  in  the  inset of  fig:ce1cdischgwithzoom  shows  a  zoomed-in
view  of  the electrolyte  concentration  during  the transient  phase,  wherein
the  qss  has  not  yet  been  established.  In  particular,  there  exist
additional inflection points,  one within the interior of  each electrode, which
render the transient concentration  profile mathematically incompatible with the
monotonicity  exhibited  by  the  qss profile.  Thus,  in  highly  dynamic
operating  conditions with  frequent reversals  in  the direct  of current,  the
qss assumption for the galvanostatic analytical solution becomes harder to
uphold without introducing significant  errors. Finally, the analytical solution
profile in Guduru   is not amenable to embedded  implementation, since it
consists of a set of non-trivial trigonometric computations at each time-step.

Prada   were  the first to provide  a simplified expression
for potential drop in the electrolyte  by including the terms representing ionic
concentration gradient within the cell thickness. Thus, eq:electrolytepd
gets modified as



Although the complete expression for  electrolyte overpotential was provided, it
was  presented in  a cursory  manner  without  detailing the  spatio-temporal
computation   of   ionic  concentration   values   at   the  current   collector
interfaces.  Nevertheless,  it  is  important   to  note  this  contribution  as
eq:electrolytepdwithce is widely relied upon by subsequent literature and
shall be used in subsec:electrolyteopcalc.




The  pioneering  work by  Rahimian    provided
approximate  expressions for  both  charge transport  and mass  transport
properties of the electrolyte specifically with the focus on improving the basic
spm. These  authors discuss  the usage of  a polynomial  approximation for
electrolyte concentration and potentials. In  particular, a cubic polynomial was
chosen  for  approximating  the  electrolyte  concentration  within  the  porous
electrodes.  This  necessitates  the  need   to  solve  for  eight  coefficients
for  uniquely  describing  the  electrolyte  concentration  profile  within  the
electrode  regions. However,  in the  standard  dfn model,  the number  of
electrolyte-specific  pde and  their  corresponding boundary  conditions
describing charge and  mass transport is insufficient to uniquely  solve for all
unknown coefficients of this polynomial approximation. A detailed explanation of
this equation deficiency shall be discussed in subsec:symbolicreg.


To overcome the issue of  equation deficiency, Rahimian  adopted a scheme
wherein one  additional spatial location in  the interior of each  electrode was
also needed. The coefficients of the polynomial approximation were then obtained
by iteratively solving a large  coupled system of algebraic equations, embedding
within  them  the additional  equations  evaluated  at  the interior  points.  A
complicating issue  that arises  is regarding the  optimal positioning  of these
additional interior  points. An online  numerical optimisation was  performed to
obtain  the optimal  placement of  this interior  node. In  the opinion  of this
thesis author, these optimisation results could be sensitive to the thickness of
the electrodes  among other  parameters. A  discussion of  the stability  of the
proposed  routine and  its  robustness  to parameter  variations  shall help  in
lending confidence in  the proposed method. Although sufficient  accuracy of the
improved spm was demonstrated for currents up to 5C, a notable omission is
the  discussion  of  the  model's  performance to  dynamic  input  profiles.  In
conclusion, the author  of this thesis opines that, although  this method serves
as  a  proof  of  concept towards  implementing  polynomial  approximations  for
electrolyte dynamics, until the aforementioned  gaps are addressed with clarity,
it is not convincing for uptake by relevant stakeholders.

Kemper  and  Kum  presented  an  approach  wherein the  spatial
gradients  of the  electrolyte concentration  are neglected.  The time-evolution
of  average  ionic  concentration  in  each of  the  three  cell  regions
 positive electrode,  separator and  negative electrode  are described  by a
set  of three  ode.  As  established by  the  discussion  thus far,  the
concentration gradients  along the axial  thickness of the cell  is significant,
even at  moderate C-rates.  Lending strength  to doubts  on the  model's wider
applicability  is the  fact that  results  from constant  current inputs  (which
induce large concentration  gradients in electrolyte) have not  been reported in
this work. Thus,  this approach is deemed as not  satisfactory enough to warrant
further engagement.

Luo   derived  a parabolic  approximation of  the electrolyte
concentration  distribution along  the  thickness of  the  cell. The  derivation
is  obtained  for  the case  of  steady-state  wherein  the  rate of  change  of
concentration  is  zero.  However,  the  author  of  this  thesis  is  sceptical
about  this  since  in  the  set of  independent  simulations  conducted,  there
was  no  situation  other  than  prior  to  application  of  current  that  this
exact  steady-state condition  is satisfied.  In the  qss profile  concept
discussion based  on fig:ce1cdischgwithzoom,  it is  clear that  only the
spatial profile  reaches a shape that  can be potentially described  by a
mathematically  invariant family  of  curves. The  electrolyte concentration  is
still  time-varying  and  therefore violates  the  static  time-evolution
assumption.  Although  Luo    do not  explicitly  acknowledge
this,  they  do  provide  an  extension  for  general  operating  conditions  by
introducing  two  exponential   scaling  functions   and   while
retaining  the assumption  of parabolic  spatial behaviour.  The computation  of
certain time-constants in these scaling functions are not elucidated nor are the
procedural  steps  for determination  of  the  aforementioned scaling  functions
provided.


In a  subsequent paper  by the  same authors   Luo  , the
electrolyte concentration  model together  with a  similarly-derived electrolyte
potential model  was incorporated into  the conventional spm to  arrive at
what the  authors term  as extended spm. In  the aforementioned  work, the
electrolyte potential is set to account for contribution from two terms ---
*[label=*)]
    ohmic drop due to bulk solution resistance, and
    polarisation potential due to concentration gradients

Although it  seeks to correctly account  for the two causes  of overpotential in
the  electrolyte,  there  is  no  detailed explanation  on  the  computation  of
quantities such as time-constants involved in the polarisation potential term.

A modified version of the electrolyte model proposed in Luo  
was  used  in Zou    for  observer  design in  an  soc
estimation application. The modification  essentially consists of truncating the
complex expression  in Luo  ,  which originally  consisted of
six  coefficients   through   to  just two,  and  elimination  of  the
aforementioned time-constants. However,  to the disappointment of  the author of
this thesis, the claim that truncation  to  terms is sufficient to describe
the dynamics  proved to be  optimistic for the  parameter set considered.  In my
attempts  to reproduce  this work,  an arbitrary  scaling factor  was needed  to
correct for the electrolyte potential  drop and match the p2d simulations.
The requirement for such scaling factors  whose physical origins are not clearly
identifiable lends to scepticism on  the model's robustness. Furthermore, it was
found that  this value  needed to  be hand-tuned  for each  parameter-set. Until
these gaps are addressed clearly, it  is worth seeking other viable alternatives
to model the electrolyte dynamics of the cell.

After  completing  the  simulations  with  the  aforementioned  scaling  factors
and  continuing  in  the  quest  for other  alternatives,  the  author  of  this
thesis  made  an observation  that  other  researchers  have  had to  resort  to
similar techniques  for describing the electrolyte  overpotential. For instance,
Han   use  a similar  scaling factor  for  the entire
expression   of  eq:electrolytepdwithce   representing  the   electrolyte
overpotential   using  the   polynomial  approximation   approach  proposed   by
Rahimian  .  However, these  unexplained scaling
factors lower the confidence regarding the model's general applicability.


Tanim    accounted  for  electrolyte dynamics  by  deriving
reduced  order  transfer  functions  for ionic  concentration  distribution  and
electrolyte   overpotential  using   the  ima   technique.  However,   the
coefficients  of these  transfer functions  are excessively  long and  comprised
of  chained algebraic  operations  expressed in  a high-entropy  sum-of-products
form   in  the   appendix  of   the   aforesaid  article.   For  instance,   ten
coefficients  are  needed  to  describe  the  concentration  profile  while  six
coefficients  are required  for  the electrolyte  potential.  The median  length
of  each  atomic  sub-expression  of these  coefficients  is  sufficiently  high
to  obfuscate   their  physical  significance.   A  low-entropy  form   for  the
coefficients  of  these   transfer  functions  similar  to   that  pioneered  by
Middlebrook  and  exemplified in the  design-oriented analysis
of  electric   circuits   could   have  been
helpful to aid the readers' understanding.  The author of this thesis recognises
that  mathematical complexity  should  not be  the sole  basis  to evaluate  the
merits of  such proposed improvements.  Although the presentation of  these long
coefficients  have been  judiciously moved  to the  appendix, their  derivations
---  essential to  prove  the model's  validity ---  is  curiously omitted.  The
unwieldiness  of the  mathematical expressions  presented therein  increases the
probabilities of introducing human errors during implementation.

It  is worth  noting that  Marcicki   had  independently
proposed  a similar  approach  deriving  a transcendental  transfer function
from  electrolyte  concentration  to  applied  current, albeit  for  a  cell  of
lfp chemistry. This transfer function  consisted of a series of hyperbolic
trigonometric functions which  were later truncated by  Padé approximation (see
subsec:freqdomainroms  for  a  brief  introduction  to  frequency  domain
rom).  However,  upon the  trial  of  this  approach for  the  lco
parameter  set (see  tbl:lcoSimParamsSPMp2d) by  this thesis'  author, in
order to obtain sufficient accuracy, the truncation order had to be raised to at
least seven, similar in complexity  to that of Tanim  . In
both  Marcicki   and  Tanim  , the
electrolyte-specific enhancements to the spm  are in the frequency domain,
placing  further burden,  particularly  on industry  stakeholders to  accurately
interpret and  transform the  coefficients to  a time-domain  implementation for
deployment  in an  embedded  bms.  Owing to  this,  as  already stated  in
subsec:freqdomainroms,  these  models  fall  outside the  scope  of  this
thesis.



Fan     proposed   an   Extended  spm   that   includes
electrolyte dynamics using  the gpm which achieves  an acceptable accuracy
in terminal voltage performance. Although these authors claim that the gpm
is computationally  cheaper than  other model order  reduction techniques
such as proper orthogonal decomposition  and balanced truncation, this claim has
not been substantiated. The sole comparison of cpu times presented in this
work  only compares  the  gpm against  the  classical fdm.  Although
an  impressive  computational speed  is  achieved,  it  is unclear  whether  the
model equations,  particularly those involving solutions  of non-linear integral
expressions  resulting from  applying the  Galerkin's  method can  be solved  in
real-time for  embedded implementation.  It appears that  the gpm  is more
suitable for desktop simulations. In  congruence with my scepticism, the authors
of Fan   have  not claimed the suitability of  their work for
online/embedded  application  in a  bms.  Therefore,  as per  this  thesis
authors' stance  explained in sec:classificationscheme,  models employing
such methods are deemed to be not in alignment with the goals of this thesis.

Moura   proposed an improved spm by simply augmenting
the  conventional  spm  with  a simplified  form  of  electrolyte-specific
equations of  the original  dfn model. The  resulting model  therefore has
pde in it and therefore not easily amenable for embedded implementation.
Lotfi    presented  an   algebraic  approximation  for  the
spatial  distribution   of  electrolyte  concentration  by   modifying  standard
parabolic expressions with leading exponential  coefficients. There are two main
issues with this approach. It is  not explained why that particular mathematical
formulation was chosen. For instance, its superiority over other feasible family
of  curves is  not discussed.  Secondly, the  aforesaid coefficients  are to  be
determined through  solution of  equations obtained  by applying  continuity and
flux boundary conditions from the dfn model for electrolyte concentrations
at  the  electrode-separator   interfaces.  Since  exponential-type  expressions
are  assumed  in the  aforesaid  mathematical  formulations, the  resulting  set
of  equations  are  non-linear,  the  solving  of which  in  the  context  of  a
resource-constrained environment is problematic.



From  my experience  in  trying to  replicate the  results  from the  literature
presented in this section, the  questionable elements in all such approximations
can be  attributed to  inaccuracies in  computing the  spatio-temporal evolution
of  electrolyte   concentration.  Upon   obtaining  a   good  estimate   of  the
electrolyte concentration profile, eq:electrolytepdwithce is deemed to be
satisfactory  for the  electrolyte overpotential  computation. Thus,  it can  be
concluded that research efforts must be  focused on solving for the electrolyte
concentration profile.

From the discussion of literature, it is clear that the proposed enhancements to
the  computing the  ionic concentration  in electrolyte  falls into  one of  the
following two categories
[topsep=0pt,partopsep=0pt,itemsep=0pt]
    model description through physical principles followed by mathematical
        simplification
    fitting of pre-assumed simplified mathematical structures to some
        physical phenomena


In   the  author's   view,   it   appears  that   using   the  former   approach
yields  technically  correct,  yet  mathematically  convoluted  expressions  for
overpotentials that  are fraught with implementation  difficulties. Although the
latter  approach looks  promising  in  terms of  ease  of implementation,  their
sub-optimal  performance  and lack  of  wider-applicability  leaves much  to  be
desired.  Among  the latter  class  of  models,  owing  to its  simplicity,  the
quadratic (parabolic)  approximation method for electrolyte  concentration is an
attractive option. It is therefore important  to perform an in-depth analysis of
this sub-class  of models and  understand their source of  potential weaknesses.
Such  an analysis  has  yet  not been  performed  in  literature and is
therefore presented next in sec:quadraticapprox.








 
Quadratic Approximation of Ionic Spatial Concentration


In this section, the quadratic approximation of ionic spatial concentration that
underpins the electrolyte  model in many of the  improved spm formulations
from  sec:electrolyteinclusion   is  presented 

.
The  steps  involved  in  deriving   the  quadratic  approximation  is  detailed
in  subsec:quadraticmodelderiv.  Based  on   the  results  from  applying
this   quadratic   approximation   scheme,   an   analysis   of   the   weakness
of  this   model  is  performed   in  subsec:quadraticsimresultsanalysis.


Model derivation

The  schematic  in  fig:coordsquadapprox  shows  the  definition  of  the
co-ordinate  systems  used  in  deriving the  polynomial  approximation  of  the
electrolyte  concentration   profile.  The  three   regions 
  are  abbreviated  to  respectively  in  all  mathematical
expressions. The globally defined  co-ordinate starts at the negative current
collector interface ()  and terminates at the  positive current collector
interface  (
). Three local co-ordinate systems  valid only within
their respective regions are also defined.  In particular, it must be noted that
the direction of  the local  co-ordinate axis is  opposite to that
of the other two local co-ordinate axes as well as the global co-ordinate axis.



























A  standard  quadratic  expression  is chosen  a priori  for  approximating  the
electrolyte  concentration  profile  within each  region.
2     c_(z,t) & = a_2(t) z^2  + a_1(t) z + a_0(t) &  & 0 z l_n 

   c_(z,t) & = a_5(t) z^2 + a_4(t) z + a_3(t) &  & 0 z l_s 

   c_(z,t) & =  a_8(t) z^2  + a_7(t)  z  + a_6(t)  &  & 0  z  l_p

The time-dependent coefficient  vector 
 is to be determined.
Hereafter, the  explicit  time-dependence  of  the
coefficients  is  omitted.  Similarly,  the  spatio-temporal
dependence of the electrolyte  concentration  is also dropped
from the notation.
Applying     boundary     conditions     of    the     electrolyte     diffusion
equation   from   the   dfn   model (refer   eq:dfnliquiddiff)   to
eq:cenqquadstarteq:cepqquadstart,  it is  clear that  
and . Thus, eq:cenqquadstarteq:cepqquadstart become
2
    c_& = a_2 z^2 + a_0         &  & 0 z l_n 

    c_& = a_5 z^2 + a_4 z + a_3 &  & 0 z l_s 

    c_& = a_8 z^2 + a_6         &  & 0 z l_p

with  the  coefficient  vector being  modified  to .


tbl:dfnelectrolyteeqnsinsep lists  the equations and  boundary conditions
for phenomena  describing electrolyte  diffusion and  charge balance  within the
separator domain.














































 
eq:liquiddiffnsep  and   eq:liquidpotentialsep  are   obtained  by
applying   the  pertinent   electrolyte   equations  of   the  dfn   model
(eq:dfnliquiddiff and  eq:dfnliquidpotential respectively)  to the
separator  region. Applying  the continuity  and flux  boundary conditions  from
eq:liquiddiffnsep at both separator interfaces,
2
    
    
    a_2 l^2_n + a_0                      & = -a_3 &  & (continuity at neg/sep interface)  

    a_5 l^2_s + a_4 l_s + a_3     & = -a_8 l^2_p + a_6 &  & (continuity at sep/pos interface)                               

    2 a_2 l_n D_& = -a_4 D_&  & (flux b.c. at neg/sep interface)                               

    (2 a_5 l_s + a_4) D_& = -2 a_8 l_p D_&  & (flux b.c. at sep/pos interface)

The negative sign in eq:quadcefluxseppos is due to the specific
choice of  the co-ordinate system  used for  the positive electrode  region (see
fig:coordsquadapprox).  Due to  this,  fluxes  at the  separator/positive
electrode interface have opposing directions.
Let    denote  the  number  of moles  of  Li^+ ions  in  the
electrolyte per  unit cross-sectional  area within each  region .
This is  computed as  the product  of
*[label=*)]
    the porosity and
    spatial integral of the concentration function

 .
Applying this to eq:cenquadreducedeq:cepquadreduced

    Q_e,n &= _n ( 13 a_2 l^3_n + a_0 l_n)

    Q_e,s &= _s ( 13 a_5 l^3_s + 12 a_4 l^2_s + a_3 l_s)

    Q_e,p &= _p ( 13 a_8 l^3_p + a_6 l_p) 


At this stage,   are unknown. Since  these are time-dependent
functions,  the  derivation  naturally  progresses  towards  seeking  a  set  of
ode that describe a relationship  for their time evolution. Transforming
the  2   order  ode  of eq:dfnliquiddiff   (for  electrodes)
and eq:liquiddiffnsep   (for  separator)   to   their  respective   local
co-ordinates and integrate  once along the thickness of  each region. Performing
this sequence of steps for the negative electrode region


















[draw=black][aspect=0.26]StartBraceAEndBraceA Performing     the     identical     sequence     of     operations     starting
from (eq:liquiddiffnsep) for  the separator and (eq:dfnliquiddiff)
for the positive electrode yields

    *Q_e,s(t)t &= D_c_zz=l_s 

    *Q_e,p(t)t &= D_c_zz=l_p + (1 - t^0_+) a__0^l_p j_p dz


In    order    to   evaluate    the    integral    term   in    the    rhs
of eq:negliionmolestoreduce    and eq:posliionmolestoreduce,   the
solid  phase  charge  conservation  equation (eq:solidchargeconserve)  is
integrated  along the  local  co-ordinate  axis of  the  negative electrode  and
positive electrode respectively.

    _0^l_n j_n dz & =  Ia_A F 

    _0^l_p j_p dz & =  -Ia_A F


Substituting       eq:negfluxintegraleq:posfluxintegral       into
eq:negliionmolestoreduceeq:posliionmolestoreduce respectively,

    
    *Q_e,st &= D_c_zz=l_n - (1 - t^0_+) a_ Ia_ A F 

    *Q_e,pt &= D_c_zz=l_p - (1 - t^0_+) a_ -Ia_ A F

which leads to the general expressions  for the cross-sectional molar density of
Li^+ ions in each of the three regions as

    *Q_e,nt & = D_c_zz=l_n + (1 - t^0_+) IA F  

    *Q_e,st & = D_c_zz=l_s                                              

    *Q_e,pt & = D_c_zz=l_p - (1 - t^0_+) IA F
    Substituting the assumed quadratic expressions for electrolyte concentrations in
        each of the three regions eq:cenquadreducedeq:cepquadreduced
    in the above system  eq:negliionmolesgeneq:posliionmolesgen
    *Q_e,nt & = 2 a_2 l_n D_+ (1 - t^0_+) IA F                                 

    *Q_e,st & = 2 a_5 l_s D_eq:sepliionmolesquadratic                                                                                                     

    *Q_e,pt & = 2 a_8 l_p D_- (1 - t^0_+) IA F 

The  initial   ionic  concentration   in  the   electrolyte  is   identical  in
all  three  regions  of  the  cell,  assuming  equilibrium  starting  conditions
 .  Hence the  initial number  of
moles of Li^+ per unit area in each of the three regions is given by

    Q_e,n(0) & = _n c_e,0 l_n 

    Q_e,s(0) & = _s c_e,0 l_s

    Q_e,p(0) & = _p c_e,0 l_p 

    and the initial coefficient vector which satisfies the system
    equations is obtained as
    
        a_0 

        a_2 

        a_3 

        a_4 

        a_5 

        a_6 

        a_8
         & = 
        c_e,0 

        0 

        c_e,0 

        0 

        0 

        c_e,0 

        0
     


The             system             of             three             ode,
eq:negliionmolesquadratic--eq:posliionmolesquadratic    together
with  eq:Qeniniteq:Qepinit  representing the  initial  conditions,
form   an    ivp.   eq:cecontinuitynegsepeq:Qepbyintegration
represent a square system of seven linear algebraic equations with seven unknown
coefficients which must be solved at each time-step. These algebraic constraints
coupled with the aforementioned ivp form a dae system.

There are now two choices for proceeding  with solution of the system. The naive
approach  would be  to  solve  the dae  using  advanced dae  solvers
specially designed to handle index-1  semi-explicit systems such as
DASSL 
and  DASPK . For  start-stop  type  of input  currents  with discontinuities,  the
consistent initialisation of algebraic conditions and derivatives is numerically
challenging.  All   dae  solvers  typically  use   adaptive  time-stepping
algorithms.  The  feasibility of  using  such  a  complex scheme  for  real-time
computation is questionable. On the other hand, the overall system can be viewed
as composed of two numerical subsystems ---
*[label=*)]
    an independent ode system, and
    an independent algebraic system.

Each system  is executed  back to  back in succession  using solutions  from the
other system from the previous time-step.

To  clarify  the sequence  of  operations,  in  order  to bootstrap  the  model,
it  is  required  to  compute   in  all  three  regions.  The
ode system is  integrated for one time-step by  retaining the coefficients
at  their initial  value.  The   thus  solved is  substituted
into  the  algebraic system  to  yield  the  updated  value of  the  coefficient
vector . This new value of the coefficient vector is substituted
back  into  the  ode  system  and  the  process  continues.  Although  the
continuous simulation of  the overall dae is not accomplished,  this scheme is
pragmatic from an engineering viewpoint. This is because,  the periodic pauses needed to update
the intertwined  sub-systems translate  naturally into  fixed time-steps  and is
well-suited for a bms controller operating at a fixed sample rate. This is
also an effective workaround to mitigate the complexities of having to implement
and solve dae in real time.

The   simulation   results   of   the   quadratic   approximation   scheme   and
the   analysis   of   its   strengths   and   weaknesses   is   presented   next
in subsec:quadraticsimresultsanalysis.

Numerical implementation, simulation results and analysis

Numerical implementation
From an analysis point of view,  the quadratic approximation model for computing
the  spatio-temporal evolution  of  electrolyte concentration  can be  simulated
as  an  independent subsystem,  and  hence  can  be implemented  numerically  as
a  standalone  module as  shown  in  alg:quadraticce. In  practice,  this
modular code  is embedded as  a subroutine within  the main spm  loop (see
alg:disctimespm).



[!htbp]
    Quadratic approximation model for spatio-temporal electrolyte concentration
    loa     [1]
        Load profile  a csv file of  vs. C-rate
        Electrolyte model parameter set   stored in a struct ceparams
        ,  sample rate 
        QuadraticElectrolyteModel
        Set  as per eq:Qeniniteq:Qepinit
         values from eq:coeffinit
         from direct feedthrough
        
         interpolate from profile using zoh
        Solve continuous-time state equations--eq:negliionmolesquadraticeq:posliionmolesquadratic Using 
         last time-entry  vector of soln.  matrix if using an adaptive solver
         solution of linear system of equations--eq:cecontinuitynegsepeq:Qepbyintegration Using 
        Compute  as per eq:cenquadreducedeq:cepquadreduced Quadratic polynomial expressions for concentration
        
        
    

 













Simulation results

fig:spatialionicconc1C shows  the spatial distribution of  Li^+ ions
in electrolyte  along the  thickness of  the cell at  various snapshots  of time
obtained by simulation  of the p2d and the  quadratic approximation models
using a  1C discharge current. The  p2d model's response is  considered as
the reference benchmark.  During the initial transient  phase, the concentration
profile within each electrode region exhibits a characteristic inflection point.
During this phase,  the concentration profile computed by  the parabolic profile
exhibits  a  large deviation  in  terms  of  percentage  error at  each  spatial
location. However, with the passage of time, as a qss is established, this
inflection point flattens out, and the quadratic approximation becomes closer to
the  true  concentration value  at  each  spatial  location. Similar  trends  in
behaviour is  exhibited for discharge and  charging at higher C-rates  and these
results are  therefore omitted here  in the  interest of keeping  the discussion
succinct.

It  is important  to  note that  while having  a  spatial concentration  profile
is  useful,  as  seen  in eq:electrolytepdwithce, it  is  the  values  of
concentration  at   the  current  collector  interfaces   that  are  most
influential in  computation of the  electrolyte overpotential and hence,  in the
voltage accuracy of the enhanced spm. Thus, it is important to obtain this
alternative perspective  of time-evolution  of the electrolyte  concentration at
the two current collectors.












fig:temporalcequadratic shows  the time evolution of  ionic concentration
in  the electrolyte  at the  two current  collector interfaces  computed by  the
p2d and  quadratic approximation  models for a  1C discharge  current. The
concentration  values computed  by  the  p2d model  is  considered as  the
reference benchmark. At the negative electrode--current collector interface, the
ionic  concentration  exhibits  a  few oscillations  of  small  amplitude  owing
to  the complex  interactions  of  the ionic  phase  with  the porous  electrode
and  the charge  transfer process  at the  electrode-electrolyte boundary.  The
concentration  evolution  predicted  by  the quadratic  approximation  model  is
rather  simplistic  and  is  unable to  capture  this  intricate  time-evolution
pattern.  This  is because  the  governing  equation predicting  time  evolution
of  concentration  in  the  quadratic  approximation  model  is  that  given  by
the  first-order  ode of eq:negliionmolesquadratic  (with  a
proportional mapping from  to ). Following system
theory, the step response  of a first order ode is  that of an exponential
rise to a final settling value, which  is exactly the shape seen in the top-left
plot of fig:temporalcequadratic.

The ionic  concentration evolution  at the positive  current collector  does not
exhibit major oscillations  and even has a subtle monotonicity  to its response.
However,  the  classical  first  order  response  predicated  by  the  quadratic
approximation model falls short of representing its complete dynamics. Errors of
similar  magnitude  are present  in  the  ionic  concentration at  both  current
collector  interfaces, with  a maximum  absolute error  of 250
.


This  chapter concludes  with a  view that,  while the  spatial accuracy  of the
quadratic  approximation  model  is  acceptable,  its  temporal  performance  is
lacklustre. The causal factors for this  mediocre performance is analysed in the
context of  the author's  own attempts  in arriving  at an  enhanced electrolyte
model and is presented next in ch:newelectrolytemodel.

 
 5


chapters/sys_id/figures/



Implementing a New Electrolyte Model for Augmentation of the Basic spm
[chapters]
[chapters]11





Based  upon  the insights  gained  from  the extensive  analyses
performed in  ch:spmanalysis, this  chapter presents the  thesis author's
attempts to  surpass the performance  of the  current pinnacle in  modelling art
through the development of a new  electrolyte model. In particular, this chapter
describes  the attempts  towards  arriving  at an  accurate  description of  the
spatio-temporal  evolution of  the electrolyte  concentration in  a lithium  ion
cell. The performance of the  quadratic approximation model which was introduced
in ch:spmanalysis is analysed through the novel application of a symbolic
regression framework. This  helps to expose the issue of  equation deficiency in
the underlying dfn model and questions  its suitability for the purpose of
reduced  order  modelling  of  the electrolyte  concentration  dynamics  with  a
pre-assumed equation structure. Although this framework did not ultimately yield
the desired outcomes, it did nevertheless facilitate a comprehensive analysis of
the  strengths  and  weaknesses  of  the  quadratic  approximation  model  which
has  not  been performed  in  existing  literature.  Next, the  author's  unique
contribution to the art of single particle modelling  a novel time-evolution
model of  electrolyte concentration evolutions  through the technique  of system
identification  is  presented. The  results  of  the  new approach  is  compared
against  the baseline  quadratic approximation  model as  well as  the benchmark
p2d  model. Finally,  the new  model  equations are  incorporated into  an
electrolyte-enhanced  spm  and  the  improved  performance  of  the  newly
developed composite model is quantified.

 
Performance Analysis: Quadratic Approximation Model



In the  author's analysis of the  quadratic approximation model, the  origin and
nature of  its sub-optimal  performance can  be explained  as per  the following
rationale. The quadratic  approximation model uses a  bottom-up approach wherein
the final  simplified model structure  is pre-assumed  and then the  physics are
made  to  fit  within  this  framework. Given  that  the  top-down  approach  to
electrolyte  modelling  accounting for  all physical  phenomena and  then
simplifying  them yields  mathematically intractable  and overly  complex models
(see sec:electrolyteinclusion for  a detailed discussion),  this approach
seems to be a pragmatic alternative  to enhancing the spm with electrolyte
dynamics. However, a detailed look at  this model from an alternate viewpoint is
necessary for further analysis.


Symbolic regression using mggp

The  question boils  down to  whether a  quadratic approximation  is indeed  the
best  model structure  that  can  be assumed  a priori  for the  spatial
profile  of  ionic  concentration  in  the  electrolyte.  This  author  embarked
on  a journey  to  find  suitable alternate  model  structures  a  single
family of  curves that can  capture both  the transient and  qss behaviour
exhibited by  the ionic  concentration. The open-source  MATLAB toolbox
GPTIPS2   uses the  state-of-the-art  mggp approach  for
symbolic data  mining and is ideally  suited for such symbolic  regression tasks
(fitting a  mathematical equation structure,  and not merely  obtaining best-fit
coefficients to a  pre-assumed curve as in classical numerical  regression, to a
given data).

In employing the mggp approach, it  is important to recognise that the key
criteria that restricts
*[label=*)]
    the choice of  gene-sequence depth, as well as
    the choice in number of parent mutations,

is  the   total  number  of   unknown  symbolic  coefficients  required   to  be
solved  in the  assumed  model  structure. There  are  a  total of  seven
linear   equations  available   from  the   physics  of   the  dfn   model
(see eq:cecontinuitynegsepeq:Qepbyintegration). Hence, in order to
guarantee  a solution  the  assumed  family of  curves  cannot  consist of  more
than  seven coefficients.  Furthermore, for  a  unique solution,  the number  of
coefficients must be exactly seven. Yet another restriction on the choice
of locus of feasible  curves arises due to the fact that  the behaviour of ionic
concentration  in the  negative and  positive electrode  regions are  similar in
complexity 



,  and hence need  to be
mathematically described by an identical family of curves.

Upon a close inspection of the  spatial concentration profile from the p2d
simulation  results shown  in fig:spatialionicconc1C,  it is  evident the
electrolyte approximation  functions within the  electrode regions is  of higher
complexity than  the approximation function
suitable  for  use  in  the  separator  region. Based  on  the  results  of  the
quadratic  model, it  is  clear  that at  least  two  coefficients are  required
within the  electrode regions  . There  exists an
inhibiting  factor that  prevents  the  use of  a  lower  order function  within
the  separator. As  per  the  simulation results  of  the  p2d model,  the
time-domain  change  of number  of  moles  per  square  meter in  the  separator
is  non-zero.  Since  the  time-derivative   of  a  linear  approximation  applied
to  eq:sepliionmolesquadratic is  zero,  this  straight-line equation  is
immediately ruled out. Among the  non-polynomial mathematical curves tried (such
as trigonometric, hyperbolic, power series  among others), none could obtain the
relatively simple shape of the separator function without being forced to reduce
the  contribution from  one  of  the coefficients  to  below machine  precision.
This necessitates  the retention  of the  quadratic approximation  function used
thus  far  (with  no  missing  terms)   .  Thus,  the
overall number of  coefficients in the best possible  approximation shall be 
, which is the total number
of electrolyte-specific physical constraints available from the dfn model.
Hence it  can be concluded  that the  quadratic approximation model  does indeed
make the best  use of all of the available  physical equations. The final
question remains to  answer is, with these coefficient  limitations, whether the
quadratic  equation structure  indeed  the optimal  one.  This was  investigated
through the mggp approach described next.

The GPTIPS2  toolbox uses a variety  of heuristic algorithms from  the theory of
mggp  to hypothesise  a suitable  equation structure  for the  data to  be
fitted.  The dataset  consisted of  the  simulation results  from the  p2d
model,  in particular  the  values  of electrolyte  concentration  at the  three
different cell  regions captured  at various snapshots  of time.  Both transient
and  qss data  were  fed into  this  symbolic data  mining  process and  a
single all-encompassing  family of curves  capable of capturing  the electrolyte
concentration behaviour was  sought for. However, the constraints  in the number
of coefficients that  can be employed results  in a restriction of  the depth of
gene  mutations as  well  as the  number of  parent/seed  populations. The  best
equation set  (without strictly  enforcing the aforementioned  hard constraints,
yet  minimising  the  distance  to  the constraint  vector)  that  the  symbolic
regression approach yielded was
2
    c_(z,t) & = a_2(t) z^2 + a_1(t) z + a_0(t) &  & 0 z l_n  

    c_(z,t) & = a_5(t) z^2 + a_4(t) z + a_3(t) &  & 0 z l_s                         

    c_(z,t) & = a_8(t) z^2 + a_7(t) z + a_6(t) &  & 0 z l_p


Although eq:cnstrviolnegeq:cnstrviolpos  fit   the  transient  and
qss  profiles  well,  they  violate   the  constraint  on  the  number  of
coefficients  available resulting  in  an under-determined  system of  equations.
Both  the least-squares  and  least-norm  solution of  this  system were  tried.
However, the  results were inferior to  that produced by the  baseline quadratic
approximation method.

Next, an  attempt was made to  obtain different mathematical structures  for the
transient phase  and qss  phase both  of which  respect the  constraint on
number  of  coefficients  allowed.  The symbolic  regression  outputs  for  this
approach are shown in tbl:symbreg.




































 
Although  the equations  from tbl:symbreg  produced  a markedly  improved
response during the transient phase,  the performance during the qss phase
was merely at par to the baseline quadratic approximation model. This raised the
prospect of  employing a  blended approach, wherein  a model  changeover between
the  transient  and qss  was  contemplated.  However,  since there  is  no
precise definition  of what constitutes  the transient phase of  the electrolyte
concentration response, this  approach required some ad-hoc  timing criteria for
correctly  transitioning  between  the  two mggp  equation  sets.  Further
complications arise  during dynamic input conditions,  wherein the concentration
profiles are mostly in a state of  flux and could linger for longer durations at
the contiguous  boundary between  transient-like and  qss-like behaviours.
In  the  interest  of  reproducibility  across  different  cell-chemistries  and
corresponding parameter sets, the proposed blended model transition approach was
not further pursued.

Overall,  the  long  and  arduous  process of  symbolic  regression  was  not  a
definitive  success in  this  case  mainly due  to  the  limitation of  equation
deficiency  of physical  constraints. Perhaps  if yet  another pbm   an
alternative  to  the widely  prevalent  dfn  model,  can  be used  as  the
baseline,  a  few more  physical  governing  equations  could possibly  be  made
available.  This  can  perhaps  result   in  a  less  restrictive  gene-set  for
coefficient  determination  and  consequently  pave the  way  for  a  successful
implementation  through  this  hitherto  unexplored  route  of  mggp-based
equation synthesis.

In conclusion,  the quadratic model for  electrolyte concentration approximation
makes the  best use of the  available physical equations. Given  the constraints
with  respect to  physical equations  discussed here,  it is  also deemed  to be
the  optimum  family  of  a priori  chosen  curves  capable  of  modelling  the
spatial  profile of  ionic concentration.  Notwithstanding these  merits,
the  temporal  performance of  the  quadratic  approximation approach  is
sub-optimal as seen in fig:temporalcequadratic. The author of this thesis
addresses this specific issue with a completely different approach that shall be
discussed next in sec:newelectrolytemodel.

 
A New Electrolyte Model through System Identification


Having performed a  comprehensive analysis of the state of  the art in spm
modelling with electrolyte  dynamics, this section presents  the author's unique
contribution to the field. Firstly, the scope of the contribution is identified.
The methodology adopted and corresponding results are presented thereafter.

Scope and motivation

This subsection is intended as a capstone summary helping to briefly recount the
discussion so far  and to provide a  context for the author's work  in the wider
realm  of the  spm  modelling art.  In  the same  vein  as the  discussion
in sec:electrolyteinclusion, the scope of the proposed enhancement to the
spm  concerns  entirely with  improving  the  electrolyte subsystem  since
it  has already  been established  in subsec:simresultsbasicspm that  the
simplified representation  of the solid-phase  subsystem through a  fourth order
polynomial approximation method for diffusion of Li^0 in the solid particle
is of sufficiently high accuracy.

Inspecting the electrolyte domain, the contribution of electrolyte overpotential
to  terminal  voltage   consists  of
*[label=*)]
    diffusion   overpotential
    time-dependent   ohmic  losses   that  originates   from  differential concentration  gradients  (that  is   indirectly  dependent  upon
concentration).

Once       electrolyte        concentration       at        each       time-step
is         available, eq:electrolytepdwithce          proposed         by
Prada    may  be  used for  the  electrolyte  overpotential
computation.  Hence, the  accurate  determination of  spatio-temporal values  of
electrolyte concentration merits focus.

There exists a  subtle detail in the  use of eq:electrolytepdwithce which
is discussed here upfront before proceeding  ahead to the refined context of the
author's work. The intrinsic conductivity of electrolyte  is a function
of the ionic concentration  (refer subsec:basicspmsimsetup). If the ionic
concentration at  the corresponding current  collectors are used  for evaluating
  and  , this  would  lead  to a  lopsided
computation of the overpotential in electrolyte. Furthermore, under this scheme,
the computation of electrolyte conductivity shall be rendered ambiguous since it
is unclear which  separator interface shall be chosen for  the separator's ionic
concentration. Although this  has not been discussed clearly  in literature, the
author  of this  thesis chose  to use  the mean  concentration within  each cell
region, defined as



though other  measures of central  tendency might  be equally valid.  Hence, the
results of this section have the associated variability in them depending on how
the electrolyte concentration computations are  used in evaluating the intrinsic
conductivity of electrolyte.

As  the  ionic  concentration  has  both  a  direct  and  indirect  contribution
in eq:electrolytepdwithce, its spatio-temporal  computation is a critical
aspect. As discussed  in sec:quadraticapprox, the quadratic approximation
is a widely used spatio-temporal model for electrolyte concentration which makes
the best  use of available physical  constraints. As established in  the results
of subsec:quadraticsimresultsanalysis, while  the spatial  performance of
the quadratic approximation approach is acceptable, its time-domain performance,
particularly at  the crucial  locations of the  current collector  interfaces is
mediocre at best.

The  scope  of  the  author's   work  is  to  obtain  suitable  alternate
expressions  for  improving  the   computation  of  time  evolution  of
the  electrolyte  concentration  whilst retaining  the  quadratic  approximation
approach   for   describing  its   spatial   profile.   Such  an   approach   is
motivated   by    the   keen    observation   that   the    baseline   quadratic
approximation  model  has  a  natural  `pause'  in  its  model  description.  To
clarify, eq:cecontinuitynegsepeq:Qepbyintegration  form a  tightly
coupled  square  system   a  set   of  seven  linear  equations  in  seven
unknowns.   In   this   system,   the   time   evolution   of 
are   described  through   a  separate   system  of   first  order   ode
given by eq:negliionmolesquadraticeq:posliionmolesquadratic.  In a
practical  implementation,  these  ode  are solved  independently  in  a
decoupled  manner  by  using  the coefficients  obtained  from the  linear
system of eq:cecontinuitynegsepeq:Qepbyintegration in the previous
time-step. The  author's hypothesis is that  by taking advantage of  the natural
break  in the  operational  sequence which  involves  two separate  computations
between  two nearly  independent  subsystems,  it must  be  possible to  replace
the  under-performing  time-evolution  ode from  the  baseline  quadratic
approximation with a superior alternate model.

Selection of Methodology --- Background and Rationale



This  section presents  the  background and  thought  process in  systematically
arriving  at  the  choice of  the  methodology  that  was  adopted for  the  new
time-evolution model of the electrolyte concentration dynamics.

Based  upon the  experience  gained  in dealing  with  the literature  presented
in sec:electrolyteinclusion, it is  the author's view that,  owing to the
complex behaviour of electrolyte, a  naive top-down approach  including all
the physics upfront followed by a  systematic simplification, might only yield a
model that is  mathematically intractable for adoption in  an embedded bms
environment.  The baseline  quadratic  approximation method  has  proven that  a
bottom-up approach  pre-assuming a simplified structure for the final model
and adapting its coefficients to  physical constraints yields a viable candidate
for describing electrolyte dynamics and  for later inclusion in the conventional
spm.

Upon  a   closer  examination   of  the  rubrics   of  the   baseline  quadratic
approximation  model, it  comes  to  light that  the  natural `pause'  discussed
towards  the  end  of subsec:scopenewelectrolyte  permeates  to  a  level
more  than  merely  having  to  operate  sequentially  on  two  pseudo-decoupled
subsystems  --- it  goes to  the extent  of rendering  the operating  philosophy
of  fitting  physical  equations  semi-void.   To  clarify  this  statement  and
to  substantiate   the  claim,  while  there   is  no  doubt  that   the  linear
algebraic   equations  of eq:cecontinuitynegsepeq:Qepbyintegration
do    incorporate    physical    principles   from    the    dfn    model,
the     same     does     not      hold     true     for     the     ode
of eq:negliionmolesquadraticeq:posliionmolesquadratic.   In  fact,
all   the   boundary   conditions   from   the   dfn   model   have   been
exhausted   by  this   stage  (refer subsec:quadraticsimresultsanalysis).
Although eq:negliionmolesgeneq:posliionmolesgen     are    derived
from     the      dfn     model,      the     coefficients      of     the
diffusivities   in    the   rhs   of    the   next   set    of   equations
 eq:negliionmolesquadraticeq:posliionmolesquadratic,   merely
involve  substitutions  of the  spatial  derivatives  of the  assumed  quadratic
expression.

Herein lies the weakness of the  baseline quadratic approach. Unlike the spatial
algebraic equations, which are tightly bound by the continuity and flux boundary
conditions at the  separator interfaces, there is no equality  constraint on the
spatial  derivative, which  is free  to grow  or shrink  without any  explicitly
imposed  bounds.  The  onus  of  being accurate  is  therefore  on  the  spatial
derivative evaluation which in-turn depends  on the correctness of the quadratic
functions (eq:cenquadreducedeq:cepquadreduced)  themselves. It  is
not feasible to quantify the magnitude of error introduced in the time-evolution
of concentration  given a small-signal  perturbation in the coefficients  of the
quadratic spatial  computation  the  implicit coupling between them  is not
transparent. Since the quadratic approximation  itself is not perfect  does
not capture the  spatial gradient exactly as the p2d  model as seen
in fig:spatialionicconc1C, the internal coupling of coefficients leads to
errors in time-evolution computation.

The author's  approach is to  therefore break this detrimental  coupling between
spatial  derivative of  concentration  and its  temporal evolution  counterpart.
Inspired by the fact that the  quadratic approximation model had almost achieved
the desired goals with
[label=*)]
    a bottoms-up approach  assuming some model structure a priori, and
    not bound by any physical considerations due to the exhaustion of governing equations

led  the author  to  broach a  suitable modelling  concept  that exhibits  these
common  traits, yet  of a  completely different  nature and  hitherto unexplored
in  physics-based battery  modelling  in general  and  electrolyte modelling  in
particular --- black-box system identification.

 
Brief Introduction to System Identification



An in-depth  coverage of the topic  of system identification is  well beyond the
scope of  this thesis.  However, keeping  in mind the  interests of  the battery
modelling community  who might not be  familiar with this subject  area, a brief
overview of the core ideas that  are essential for tackling the specific problem
at hand is  presented. For readers further interested in  this topic, the author
suggests the textbook by  Ljung  for a comprehensive theoretical
treatment of the foundation topics in system identification.

System identification aims  to provide a mathematical model  of the input-output
mapping  of the  system 



under consideration. The three categories of system identification are:


[leftmargin=!,itemsep=1ex,labelwidth=abc
    ,partopsep=0pt
    ,topsep=0pt
    ]

[White  box] wherein  underlying physical  equations are  completely known.
The  numerical value  of  coefficients of  governing equations  are  then to  be
parametrised from input-output data.

[Black box]  wherein no  governing equations are  available for  the system
under  consideration. The  model formulation  is facilitated  by a  rich set  of
system theory  which proceeds by exciting  the system with input  waveforms with
certain desirable  properties and correlating characteristics  from the response
to draw  conclusions about viable  mathematical structures capable  of emulating
the terminal behaviour of the system  under generalised inputs. Black box system
identification was employed for the specific problem under consideration in this
thesis and hence all future descriptions will pertain to this class.

[Grey box] is a hybrid of the  two approaches wherein a part of the model's
governing  physics is  known  a priori   the  structure  of a  well-defined
subsystem  that is  part  of a  large,  complex  system may  be  known ahead  of
time,  where the  task  is  to characterise  the  full  system. Grey box  system
identification tasks can  often be reduced to a single  sub-problem of black box
system  identification  by  removal  of  the known  physics  and  tackling  them
separately.



 
Overview of Black Box System Identification


Black-box system identification techniques are composed of the following ---
*[label=*)]
     non-parametric methods, and
     parametric methods.
 

Non-parametric methods
Non-parametric methods do not seek  a pre-assumed mathematical structure for the
system. They  aim to  directly estimate  the very  kernel of  what characterises
every system  the Markov parameters in the time-domain  and the frf
in the frequency domain, thereby requiring infinite number of data points
for  their representation.  Major non-parametric  system identification  methods
include:
[topsep=0pt]
    Identification in time domain
        

            Direct  estimation of the system's  Markov parameters through
                statistical correlation of its response to an unit-pulse input.

        
    Identification in frequency domain  of the frf
        

            Direct   estimation    through   input-output   statistical
                cross-correlation.

            etfe using dft of input and output sequences.

            Smoothed periodogram estimates using Welch's method.

            Blackman-Tukey  Estimate   using  standard  filter
                windows  in digital  signal processing  (such as  Hamming, Hanning,
                Bartlett, Boxcar etc.).

        


Parametric methods
Parametric  methods aim  to fit  specific input-output  data to  some family  of
well-known mathematical  constructs that  are and widely  applicable to  a large
variety of inputs.  It is important to recognise that,  in contrast to white-box
system identification, the salient coefficients/properties of these mathematical
structures do  not, in any way  correspond to physical properties  of the
system under consideration. Major parametric system identification methods use:

    Transfer-function based frequency domain model structures
        
            oe model
            arx model
            armax model
            Box-Jenkins (BJ) model
        
    State-space time-domain model structures
        
            Ho-Kalman realisation
            era realisation
            Deterministic and stochastic subspace structures
        


Investigation of suitable system identification methodology
Among   the   various   system    identification   techniques   mentioned,   the
non-parametric   methods    have   some    serious   drawbacks.    As   outlined
in subsec:sysidbackground, the author is inspired  by the trait of having
a pre-assumed model structure that  brought the baseline quadratic approximation
closer to a successful realisation. The non-parametric methods do not conform to
this philosophy. Furthermore, the requirement of infinite number of data samples
in order to fully quantify the system dampens its feasibility for implementation
in  resource  constrained  environments.  The  author is  of  the  opinion  that
resorting  to truncation  of  the  characteristic sequence  shall  only yield  a
sub-optimal solution. Hence non-parametric methods are ruled out for applying to
the task at hand.

While  parametric state-space  identification is  a feasible  alternative, these
methodologies are tedious and error-prone.  For instance, applying the Ho-Kalman
algorithm requires construction of large-sized Block-Hankel matrices followed by
a  svd operation.  The  era  uses the  identical  set of  operations
of  the  Ho-Kalman   procedure,  except  that  certain  blocks   in  the  Hankel
matrices  are chosen  at  random  for deletion  for  obtaining better  estimates
in  low  snr environments  and  for  capturing slowly  decaying  phenomena
with  long time  constants. The  subspace methods  are mathematically  involved,
requiring  a  profound  understanding  of  concepts  from  linear  algebra  such
as  projections  to orthogonal  subspaces.  The  system under  consideration  is
presented in sec:introtoplant and after linearity considerations, refined
in subsec:linearityanalysis. It is composed of two independent siso
subsystems.  However,   the  inflection  point  in   the  complexity-performance
trade-off  in state-space  identification  is achieved  only  when dealing  with
mimo systems that suggest strong  cross-coupling among its internal states
or  at least  some degree  of  coupling among  the various  inputs and  outputs.
Furthermore, the impulse  responses of the system(s) under  consideration do not
have long tails since they are characterised by relatively short time constants.
Owing to these  reasons, it was decided that state  space identification methods
shall not be adopted here.

Owing to a  cornucopia of well-established technical  know-how readily available
in the systems  engineers toolkit, transfer function based  model structures are
naturally amenable  for control-oriented applications. However,  there exists an
apparent discrepancy to  its usage for this case, that  must be addressed first.
Transfer  function methods  are  a  frequency domain  technique  and hence,  the
resulting model  descriptions have  mathematical structures  radically different
from the time-domain model equations  of the conventional spm within which
they are  to be embedded. This  conundrum is resolved by  closely inspecting the
model's scope  and its tractability for  conversion to time domain  as explained
next.

It  is  worth remembering  that,  as  per subsec:freqdomainroms, for  the
reduced order  modelling of the  entire cell, all frequency  domain model
groups were considered  as out of scope  of this thesis specifically  due to the
overhead  of conversion  from frequency  to time  domain for  implementation and
other associated difficulties. The blanket exclusion nature of this statement is
to be revisited considering the specific scope  of the problem at hand. The body
of literature  on frequency  domain rom discuss  obtaining physics-based
transcendental   transfer   functions  for   all   electrochemical
quantities  of the  coupled  pdae system  of tbl:dfneqns through  a
top-down approach.  However, the frequency domain  system identification methods
are concerned with  obtaining standard rational transfer  functions for a
much narrower  scope  the time-evolution  subsystem, through  a bottom-up
approach.  Such  rational transfer  functions  are  to obtained  for  siso
systems for which an approximation-free  effortless conversion already exists in
classical control  theory and is  presented in subsec:sysidnumericalimpl.
In view of  their overwhelming simplicity and familiarity  to control engineers,
after considering these arguments that circumvent their only apparent impediment
to adoption, transfer function based system identification was chosen for
tackling the problem at hand. The  steps leading to the identification procedure
is presented next.




 
Introduction to Electrolyte Time-Evolution Subsystems


The                  first                 order ode                  of
eq:negliionmolesquadraticeq:posliionmolesquadratic in the baseline
quadratic  approximation  model  for   electrolyte  concentration  describe  the
time-evolution of the overall number of moles  of Li^+ in each of the three
regions of the cell .  Through system identification, the author
seeks  to  obtain  the  two  rational  transfer  functions  of 
and    to  the  applied  current   in  the  frequency  domain
  and . Based on
the  dfn  model,  the total  moles  of  Li^+  per  unit area  in  the
separator   is not a  function of the exogenous  applied current.
Therefore,  the  baseline  quadratic  approximation ode  is  retained  for
computing its time-evolution.

 
Design of Persistent Excitations


In order  to successfully apply  any system identification technique,  the input
signal must be carefully  designed to be persistently exciting .
Narendra and Annaswamy   were among the earliest
researchers  to provide  a detailed  treatment  of the  desirable properties  of
persistent excitation and their implication to the quality of the identification
output. A  practical method to achieve  persistent excitation is to  subject the
system under  consideration to  a sequence  of well-characterised  input signals
that  are  capable of  exciting  its  hypothesised  modes.  For this  task,  the
author  of this  thesis  chose  to use  the  data-quality  guidance provided  by
The Mathworks Inc.  and performed  an iterative refinement
until the identification procedure resulted in a generalisable model.

Before discussing the shape characteristics of the input sequence, its magnitude
must be established.  The various specially prepared input  sequence families do
not  share a  common definition  for their  magnitudes. A  guiding principle  in
system  identification is  that  it  is important  to  have  the input  signal's
magnitude  to  be  representative  of standard  operating  conditions.  Although
standardised  drive  cycle  profiles  are  available,  from  which  a  speed  to
current mapping  can be  performed, it  is impossible  to predict  a priori, the
specific  amplitudes of  currents  that  the cell  may  undergo under  real-life
load  conditions.  Without  further  deterministic information,  the  author  of
this  thesis  chose to  interpret  magnitude  as  being  the peak  amplitude  of
the  input  current profile.  As  seen  in fig:uddssimp2dspmresults,  the
representative  udds  drivecycle  input  profile  corresponds  to  a  peak
of 3C  180.  Following   the  standard  principles   of  system
identification, it is desirable  for the inputs to the system  to lie along some
measure  of  central tendency.  This  is  to  enable  the identified  system  to
generalise well   not deviate too far  from the truth when  subject to inputs
that are far away from the central  measure. Yet another consideration is not to
saturate the identified model by choosing input magnitude to be too close to the
peak of  the expected  operating range. Taking  into account  all aforementioned
considerations,  the  peak amplitude  of  the  input  current  was fixed  at  2C
 23 of the udds profile's peak current amplitude.

Training current profile

Since not much prior  information is available about the poles  and zeros of the
electrolyte subsystem(s)  in question, a wide  variety of special waveforms  with a
sampling interval of 1 were used for the current perturbation used
in this system identification task. The specific input sequence consisted of

    rbs(0--199)
    `Chirp'  a swept cosine signal from 0--100(200--799)
    Periodic rbs with a period of 200 and 2 such periods(800--1199)

thereby  helping  to  obtain  a  wide-sense  persistent  excitation.  The  swept
cosine  signal  is designed  to  excite  the low  frequency  (DC)  modes of  the
electrolyte subsystem and helps to capture the system's response to constant and
other systematically  varying input profiles.  The two rbs  are intended
to  target  the  poles  and  zeros  of  the  electrolyte  subsystem  that  would
typically be  excited by highly dynamic  input profiles. The periodicity  in one
of  the  rbs was  introduced  to  draw out  any  repeated  real pole  or
complex  conjugate  poles  in  the system  that  might  otherwise  appear
to  be  a  single real  pole.  The  presence  of  both low  and  high  frequency
spectra in  the  combined  training set  presents  a  high degree  of
confidence to  capture the relevant  dynamics of the electrolyte  subsystem. The
input  current profile  used  for  this system  identification  task is  plotted
in fig:sysidtrainingcurrent.















Validation current profile

For the  purposes of identification,  the p2d  model is considered  as the
true system. First, the current profile from  the training set is applied to the
p2d model.  Its simulation results,  in particular the  numerically solved
concentration values  at each spatially  discretised node  in each of  the three
regions per time-step is integrated over the thickness of the respective regions
and multiplied with their respective porosities to obtain the number of moles of
Li^+ per unit area in each  of the three regions . Only the
quantities   and    are chosen  as  the outputs  for
system  identification and  a  transfer  function model  is  fitted  as per  the
evaluation procedure discussed in sec:actualsysid.

As with  any classical  curve fitting  (numerical regression)  procedure, system
identification is also  prone to overfitting the training data.  In general, the
`best' transfer  function that identifies the  given system is the  lowest order
model that not  only minimises the training error, but  also minimises the error
on a  previously unseen  validation dataset.  In the  absence of  an independent
validation  dataset,  the  training  error  can be  made  arbitrarily  small  by
increasing the number of poles and zeros of the transfer function models without
any bounds. However,  such a model shall not have  truly identified the dynamics
of the system  and shall not generalise well to  real-world datasets outside the
training realm. Hence, having an  independent validation current profile for the
task at hand is of paramount importance.

For the system identification task at  hand, the characteristic waveforms of the
validation profile were deliberately conjured to be differ vastly from that used
in training the model. The  validation profile consists of the following
sequence

    Periodic rgs with 4 periods of 200 each(0--799)
    prbs for emulating white noise  with a flat power spectra
        across the frequency spectrum(800--999)
    Multi-sine signal  a signal consisting of sinusoids at
        various fundamental frequencies added together(1000--1199)


Overall,  the validation  profile has  been designed  to cover  a wide  range of
frequencies  akin to  the  training  profile, but  differing  completely in  its
time-domain appearance.  The specific  validation current  profile used  in this
system identification is shown in fig:sysidvalidationcurrent.
























MATLAB code  that can be used  to generate the training  and validation
input profiles is shown in codesnippet:trainvalidsysidinput.

[!htbp]
[mathescape,autogobble,bgcolor=mintedbg,escapeinside=,texcomments=true]matlab
clear; close all; clc; format short g;
warning('off','Ident:dataprocess:idinput7'); I_1C  = 60; range = 2*[-I_1C I_1C]; NumCh = 1; Ts    = 1; 

N  = 200; u1 = idinput(N,'rbs',[],range); t_chirp_start = 0;
t_chirp_end   = 3*N*Ts; t             = linspace(t_chirp_start,t_chirp_end,3*N);
f0            = 0;
f1            = 1e-1; u2            = max(range)*chirp(t,f0,t(end),f1)';
bin_seq_Period   = N; bin_seq_Period_N = ceil(bin_seq_Period/Ts); bin_NumPeriod    = 2;
u3 = idinput([bin_seq_Period_N,NumCh,bin_NumPeriod],'rbs',[],range);
rgs_Period         = N; rgs_Period_samples = ceil(rgs_Period/Ts);
rgs_NumPeriod      = 4;
u4 = idinput([rgs_Period_samples,NumCh,rgs_NumPeriod],'rgs',[],range/2);
prbs_Period         = N; prbs_Period_samples = ceil(prbs_Period/Ts);
u5                  = idinput(N,'prbs',[],range);
samples_per_Period = 2*N;
NumPeriod          = 3;
[u6,freq] = idinput([samples_per_Period 1 NumPeriod],'sine',[],range);

I_load_train    = [u1;u2;u3];
I_load_validate = [u4;u5;u6];

Generation of training and validation input current profiles in
MATLAB


 
Investigation of Linearity and Time Invariance



The      transfer     function      identification     techniques      mentioned
in sec:introblackboxsysid are  applicable only for lti  systems. At
first glance,  this seems to  be overly restrictive  for the system(s)  at hand.
When  considered  as  a  single  macroscopic  entity,  a  lithium  ion  battery,
exhibits  overall non-linear  characteristics,  particularly due  to the  strong
non-linearities in
*[label=*)]
    the Butler-Volmer reaction kinetics (see eq:butlervolmer), and
    the ocp of the two electrodes (see eq:lcoUocpPos and eq:lcoUocpPos).

However,  we are  dealing with  a much  narrower scope   the  systems under
consideration  are just  the two  sub-system entities  (one per  electrode) that
transform the  applied current at  a particular  time-step to the  overall moles
per  unit area  of  Li^+ ions in  the  corresponding  electrode region  of
the  electrolyte at  that  same  instant. Therefore,  it  is  the linearity  and
time-invariance of these subsystems that must be investigated.

Time-invariance of the electrolyte time-evolution subsystems
A  test  for time-invariance  is  prescribed  in  the  lecture notes  on  system
identification by  Plett . The steps involved  therein are
reproduced here after  being suitably adapted to the notation  of the subsystems
at hand.

    Apply input  to the system and measure the outputs  and .
    Apply a delayed version of the input by  seconds   to the system and measure the outputs  and .
    If  and
         for all possible
        delays , as well as for all choice of input signals , then the systems are time-invariant.


For the systems at hand, it is  not strictly required to apply this prescriptive
test. Unless a fundamental change in the underlying reaction phenomena/chemistry
occur that  alter the  performance over  time, these systems  can be  treated as
time-invariant. Factors  that induce  time-dependent shift  in the  behaviour of
lithium ion batteries are degradation  phenomena such as thickening of sei
layer, dendrite growth or mechanical  fatigue in electrodes which in-turn affect
electrolytic  diffusion and  conductivity. Yet  another cause  of time-dependent
behavioural change  is the drift  in parameter values. However,  these phenomena
are  typically  one or  mode  orders  of  magnitude  slower than  the  p2d
dynamics.
This separation  of time-scales imply that, in
practice they can be decoupled. Therefore, separate models can be identified for
the faster and slower processes. A  suitable model-blending approach can then be
considered  to cover  all processes  across time-scales.  Although the  concepts
developed here for the fast electrolyte dynamics can be suitably adapted to such
slow phenomena, their study  falls outside the scope of this  thesis and is left
as an exercise for  future work. Thus, the overall battery  system, and hence by
extension,  the  two subsystems  considered  are  deemed to  be  time-invariant.
However, in the interest of completeness, this author systematically applied the
aforementioned test procedure with every  combination arising from the choice of
ten time-delay values and the following six current profiles ---
*[label=*)]
    constant current 1C discharge,
    constant current 3C discharge,
    constant current 1C charge,
    udds input profile with peak amplitude of 3C,
    training profile used in system identification (see fig:sysidtrainingcurrent), and
    validation profile used in system identification (see fig:sysidvalidationcurrent).

Finally,  these tests  were  repeated for  a choice  of  five different  initial
soc   ---   90,   70,   50,
30  and 10 






.
























fig:timeinvariance  demonstrates the  time-invariance  of the  subsystems
considered  at  an  initial  soc of  50  for  a  time-delay
of   130   using   the  highly   dynamic   system   identification
training    sequence   that    was   synthesised    by   this    thesis   author
(see fig:sysidtrainingcurrent).  The  applied  current  profile 
(top row  of the  central column)  produces the  outputs 
and    shown  in  the   top  left  and  top  right  plots
respectively.  When  the delayed  version  of  this  input sequence  
 (middle row, middle column) is  applied, it results in the outputs   and    to  its  left  and  right
respectively.  Following the  steps  of the  test  procedure, subtracting  these
outputs from the correspondingly delayed versions of their original counterparts
result in  zero residuals, thereby  proving time-invariance of  these subsystems
under these representative test conditions. The residual sequences in the bottom
row of plots are of  and arise due to numerical roundoffs
that occur  when operating close  to the noise  floor of the  machine's floating
point units.

Similar to  the case demonstrated  here, all  tests for time-invariance  for all
permutations of  the chosen operating  conditions passed successfully   the
delayed  version of  the original  output  signals accurately  matched with  the
responses  to  the corresponding  delayed  input  (down to  machine  precision),
thereby confirming the time-variance of  the subsystems considered in the system
identification problem, which enables us to proceed further.


Linearity analysis of the electrolyte time-evolution subsystems

De-biasing of  input signals

In the analyses of linearity of systems, it is a recommended practice to de-bias
the output and input quantities about their mean operating conditions. The input
signal  in this  case is  the  applied load  current , which  can be  both
positive  (during discharge)  and  negative  (during charge).  The  mean of  the
training  profile is  -1.167 and  that of  the validation  profile
is -0.3273. Clearly, the mean values are dependent upon the actual
current profile used. The appropriately de-biased signal  
  is to be used  for training and validation data  sets in the
system identification procedure. For the purpose  of linearity analysis, it is a
standard practice to simply apply a step change in input (from zero) and measure
the output responses, thereby bypassing the de-biasing requirements.



For the output signals, bias  values can be pre-computed analytically and
accounted for.  The overall number  of moles of Li^+  per unit area  in any
region within  the cell cannot  be physically  negative. Even though  under high
C-rates,  ion depletion  at localised  spatial  locations (such  as the  current
collectors) is  certainly possible,  the entire thickness  of any  region cannot
become devoid of ions at any point  in time since the cell shall instantaneously
cease  to work.  Thus, for  a typical  well-designed cell  operating within  the
manufacturer prescribed  C-rate limits,  the output signals  under consideration
operate  in  a  small  window  about  their  initial  values.  In  the  author's
simulations, even  at 5C, the overall  number of moles of  Li^+ in any
cell region exhibited  a maximum change of less than  15 from its
initial value. Thus,  the de-biased output variables  for system identification  can be obtained  by subtracting their respective
initial values  (see eq:Qeninit and eq:Qepinit)
from .

    Q_e,n(t) & = Q_e,n(t) - Q_e,n(0) 

    Q_e,p(t) & = Q_e,p(t) - Q_e,p(0)

which  implies   that  the   transfer  functions  to   be  identified   have  to
be   modified   to   be      and
  respectively.  This  does  not
affect  the  time-invariance  proved in subsec:timeinvariance  since  the
initial  values   are   merely  constants  and   hence  not
time-dependent.

Test for linearity
Similar     to      the     test      for     time      invariance     described
in subsec:timeinvariance, a  test for linearity is  also prescribed in
the lecture notes on  system identification by Plett . The
steps involved therein  are reproduced here after being suitably  adapted to the
notation of the subsystems at hand. This is essentially a recipe for testing the
superposition principle.

    Apply input profile  to the system and obtain outputs  and .
    Apply a different profile  to the system and obtain outputs  and .
    Now apply an input profile  and obtain a corresponding set of outputs  and .
    If 

 and
            

 for all possible  as well as for choice of input signals , then the systems are linear.


As   in   the  time-invariance   test,   the   same   set  of   five   different
initial  soc  ---  90,
70,  50, 30  and 10,
was  retained for  these linearity  tests. For  each test  run, a  pseudo-random
number generator  was used to select  the values of   from the
set  of  real numbers   (not  restricted  to  the set  of  integers ) in  the closed  interval spanning .  Negative values
are acceptable for  both the scaling coefficients since  the resulting composite
input  can be either positive or negative. The composite signal 
was obtained by taking a random combination  of any two of the following current
profiles ---
*[label=*)]
    step input with a constant current 1C discharge,
    step input with a constant current discharge at C/5,
    step input with a constant current 1C charge,
    step input with a constant current charge at C/5,


The   scaling   factors    and       were   restricted   to   the
range  in  consideration of limiting  the peak applied  current to
within a 3C window --- the operating condition for most bev, so that
the isothermal  assumption for the model  shall remain valid. This  peak current
corner case occurs when the pseudo-random generator chooses both scaling factors
at the selected range's limits for the 1C constant current discharge or charging
cases. The limited range  of the scaling factors are also  motivated by the fact
that  most real-world  systems remain  linear  only within  a certain  operating
window. In  particular, care must be  taken to ensure that  the cell's soc
during the  linearity test remains  within its  physical limits for  any initial
soc. Furthermore, localised  saturation or depletion of  ions for extended
durations must be avoided. Hence it can be concluded that, with the chosen range
for the scaling factors, if the two subsystems under consideration remain linear
everywhere  below a  peak current  of 3C  in the  isothermal case,  then the
linearity  tests are  considered as  passed.  Future extensions  to undertake  a
temperature-dependent  system  identification  exercise can  potentially  use  a
first-order Taylor  expansion about this  operating window. The  discussion thus
far  has fully  established  all  the conditions  for  conducting  the test  for
linearity.

























fig:linearity  illustrates  one  instance  of a  linearity  test  wherein
constant  currents  and  integer  scaling  factors are  used  for  the  sake  of
illustration.  The  plots   in  the  left  column  deal   with  the  electrolyte
time-evolution  subsystem  in  the  negative electrode  region.  Similarly,  the
plots  in  the  right  column  deal with  the  corresponding  subsystem  in  the
positive electrode region.  A discharge current of 1C   60 is
first  applied  and  the  corresponding  outputs 
and     are   obtained.   Secondly,  a   discharge
current   of   C/5    is    applied   and   the   corresponding   outputs  and   are obtained.
These set of responses are plotted  in the top row of fig:linearity. Now,
a  third  value  of  input  current ,  computed  as  a  linear  combination
of  the  previous  input  currents   
is  applied.  For  illustrative  purposes, the  integer  set  
  was  chosen  for  the   scaling  coefficients,  which  implies  
. The corresponding  outputs  and
 are  plotted in the  middle row. As per  the test
for linearity,  if these signals are  equal to the signal  generated by manually
computing the linear  combination of the preceding two outputs,  then the system
is linear.

The   plots   in  the   third   row   show     and
 overlaid with their respective linear combination
signals. In  the case  of the  subsystem in the  negative electrode  region, the
transient performance matches  precisely until 450, whereas
that in the positive electrode region exhibits a good matching for approximately
the  first 250.  However,  for  the  horizon  considered  the  two
overlaid plots do not overlap exactly.  Hence, the systems are not truly linear.
However,  the  exhibited  behaviour  is  quite  close  to  linearity,  with  the
maximum  absolute error  in each  region,  even outside  the initial  transient,
being  --- an order of magnitude lower than its individual
components.  This behaviour  was exhibited  for all  test instances  considered.
Considering  that for  dynamic  simulation runs,  the  transient performance  is
paramount  to  the good  performance  of  the  model,  in conjunction  with  the
aforementioned  low error  metric,  these  subsystems can  be  considered to  be
approximately linear.

Based  on  the  analysis  presented   here,  lti  behaviour  for  the  two
subsystems is  assumed, which facilitates  in proceeding with the  actual system
identification procedure.


 
[Transfer Function Identification Procedure]Transfer Function Identification Procedure 


The transfer operator and its model form
In a classical system identification  task, the discrete-time transfer functions
for the systems  under consideration need to be  determined. These discrete-time
transfer functions are  based on Z-transforms in the  frequency domain. However,
for the purpose of working in time-domain, an analogous linear operator  that
performs a  forward shift on  its input  .
Similarly, applying the  backward shift operator   on the input yields
its value at the previous time-step  .


In a generic  lti system wherein measurements are corrupted  by noise, The
system  dynamics are  represented by  the transfer  operator  


  that  acts  on the  applied  input ,
whereas the  noise dynamics are  represented by the  disturbance operator 
that acts to filter (or shape) an assumed white noise input .

Assuming linearity and time-invariance throughout, the overall output can be
written as the linear combination



where  and  are the transfer
operators describing the dynamics of the system and disturbance respectively.

 are rational polynomials in . The two transfer
operators  and  can be represented by

    G(q) &= q^-n_kb_1q^-1 + + b_n_bq^-n_b1 + a_1q^-1 + + a_n_aq^-n_a 

    H(q) &= q^-n_lc_1q^-1 + + c_n_cq^-n_c1 + d_1q^-1 + + d_n_dq^-n_d

where  represent  the number of transport  delay samples, 
the number  of feedforward coefficients  and , the number  of feedback
coefficients in  and  respectively.


In  this  system  identification  task  at hand,  the  output  measurements  are
collected from a  noise-free simulation of the p2d  model  the
disturbance transfer operator in eq:outputwithsysandnoise is zero

    y[k] &= G(q)u[k] + 0H(q)e[k]
Hence, the time-domain output  reduces  to
y[k] &= G(q)u[k] 


Thus, the system identification task becomes one that of estimating

    The number of transport delay samples .
    The number of feedforward coefficients (zeros) .
    The zeros themselves .
    The number of feedback coefficients (poles) .
    The pole locations .

for  each  of  the  two  transfer operators   and     the
electrolyte  time-evolution subsystems  in the  negative and  positive electrode
region respectively.

Estimation of transport delay

The transport delay  can be estimated visually by inspecting the step
response of the systems under consideration.

In fig:linearity,   step  inputs   of   
   and       were    applied
to    the   two    subsystems.    Inspecting   closely    all   the    responses
    and
    in    the     negative    electrode    region,
and        and
  in the  positive electrode  region, it  is clear
that all these outputs start exactly at  zero. Therefore, there is no delay term
to be considered for the transfer operators   for both subsystems.

Choice of model structure

Among      the      transfer-function       model      structures      mentioned
in subsec:parametric, the arx model  structure is too simplistic to
consider. Despite  the fact that  its numerical computation involves  only basic
linear algebra operations,  that can be efficiently handled  on modern computing
systems, it  is considered to produce  poor estimates of the  system's poles and
zeros. In the absence of contributions from the noise-term, the all-encompassing
model structure used by the Box-Jenkins approach is deemed to be unnecessary for
the  problem  at hand.  Therefore,  the  two  model structures  considered  were
armax and oe for the coefficient determination.

Starting guesses for coefficient orders

At first, the training profile of fig:sysidtrainingcurrent is
de-biased (through mean removal) and applied as the input current profile in a p2d
simulation. The outputs of this simulation are suitably post-processed as per
the following sequence of steps.

    The concentrations solved at various node locations within each
        electrode are numerically integrated over the corresponding electrode
        thicknesses using trapezoidal rule.
    The resulting integral value is multiplied with the porosity of the
        corresponding electrode region to obtain  and .
    These quantities are then de-biased by subtracting their initial
        values to obtain  and .


The        same        procedure        is        repeated        for        the
validation       current      profile       of fig:sysidvalidationcurrent
to         obtain                  and .  These data  sets are  used for  all
subsequent sub-tasks involved in this system identification exercise.

In  order to  reduce  the search  window for  the  coefficient determination  in
the  parametric transfer  function methods,  the hand-estimation  of coefficient
order  through non-parametric  methods may  be performed.  This coarse  estimate
can  act as  a  feeder to  help  in  the faster  convergence  of the  non-linear
optimisation algorithms  used in the parametric  methods. In this case,  a basic
spectral analysis  using a Hanning  window implemented using the  MATLAB command
spa.m is applied to the time-domain data to transform it into frequency
response data.












fig:initialbodemag  shows  the  Bode  magnitude  plot  of  the  frequency
response for
*[label=*)]
    the training set in the negative electrode region, and
    the validation set in the positive electrode region.

In the  plots, a broad  combination of  the two data  sets in the  two electrode
region  is  depicted  to  achieve  a  compact  representation  of  all  possible
permutations and to avoid redundancies by plotting visually similar information.
It is important to note that these Bode diagrams obtained by such non-parametric
methods only represent  a crude approximation of the  physical dynamics intended
to help in initial estimates of the system behaviour.

Some preliminary understanding of the  various characteristics of the system can
be gleaned from these Bode diagrams.  The first visually striking feature is the
similarity  in the  approximate frequency  characteristics in  the negative  and
positive electrode  regions, even when  excited by completely different  data in
the time domain. This confirms the author's assumptions of equal `complexity' in
the symbolic  regression search discussed in subsec:symbolicreg.  This is
also  congruent with  the physical  behaviour of  the electrolyte  in these  two
regions.

Finite DC gain
By visual  extension of  the frequency responses  towards lower  frequencies, it
is  clear  that  the  DC  gains  of  both  the  systems  are  finite  and  below
unity.  This  behaviour  can  clearly  be  seen  in  the  time-domain  responses
of fig:linearity.  For  the plotted  time-horizon,  this  effect is  most
visible for the case of the 12 constant current input, wherein the
responses of both regions settle to a finite value after an initial transient.

There is 10 variability in  the low frequency gain between
the two Bode  plots in fig:initialbodemag. This can be  attributed to the
following  factors. A  compromise with  the spectral  estimation method  is that
using a higher number of frequency bins  results in lower resolution per bin and
vice-versa. By  varying the number  of frequency bins  and focusing on  the low
frequency range, the resolution of the DC  gain can be improved. The rest of the
variability can  be attributed to the  fact that the training  and test profiles
behave differently and do not excite the same dynamics. In particular, the swept
frequency cosine (chirp) signal in the training set was specifically designed to
draw out  the low frequency  dynamics with a  high fidelity. Finally,  the small
range of variation in the DC gain could also be due to the intrinsic small-scale
variations of  the electrolyte  behaviour in  these two  regions. Although  on a
macroscopic frequency scale the two regions behave similarly, the differences in
electrode thicknesses and porosities could contribute to the small difference in
the  DC gain.  This  helps  to confirm  that  two non-identical  transfer
functions are being sought for --- one for each electrode region.

Finally, the finiteness  of the DC gain  helps to narrow down  the search window
for the parametric model structures. In particular, this fact indicates that the
model structures to be trialled must not  have any integrator terms (or poles at
the origin of the complex plane).

Resonance and model order

First  order  transfer   functions  do  not  exhibit   characteristic  peaks  or
resonances  in  their  frequency  responses.  However,  for  the  Bode  plot  on
the   left   of fig:initialbodemag,   a   pronounced   resonance   around
0.15 is observable. This has  an enormous impact --- it
presents  an important  clue  that the  first  order time-evolution  ode
of eq:negliionmolesquadratic   and eq:posliionmolesquadratic   are
inadequate to represent the system dynamics.

An apparent  contradiction to  the first-order inadequacy  claim stems  from the
Bode plot  on the  right hand side  in fig:initialbodemag. In  this case,
there are no resonances in the  magnitude response indicating that a first order
model description is sufficient. However, a vital aspect to be noted here is the
nature of the  validation current profile when compared to  that of the training
current profile.  The coarse  frequency response data  obtained by  the spectral
method is sensitive to the actual  input sequence employed. From systems theory,
the  resonances at  a frequency  occur  due to  the presence  of lightly  damped
complex conjugate poles at that frequency. The periodic rgs was explicitly
designed in the  training set and is  however absent in the  validation set. The
unique characteristics  of the validation  set and its influence  on coefficient
order is discussed next.

As per  the arguments presented  in the  preceding discussions, there  exists an
implicit constraint that  the behaviour of the time-evolution  subsystems in the
two electrode  regions are  expected to be  of similar  `complexity'. Therefore,
based  on the  presence of  the resonance  in the  Bode magnitude  plot for  the
response to  training profile  in the  negative electrode region,  it has  to be
concluded that the two subsystems are at-least of second order.

Estimation of number of poles and zeros

The  high-frequency  roll-off  in  the   slopes  of  the  Bode  magnitude  plots
in  fig:initialbodemag  provide clues  on  the  number  of poles  in  the
system.  The  corner frequency   in  both  cases appear  to  be
around 0.15. The  high-frequency slope of  both systems
is 20  per decade, which  implies that they  have at-least
one more  pole than  the number  of zeros  if using  a continuous  time transfer
function. For  the corresponding z-domain  transfer function, this  implies that
.

In the  aspect of estimating the  number and locations of  zeros, the validation
profile outshines  the training profile. While  the Bode plot obtained  with the
training profile  does not indicate  the presence of  zeros in the  systems, the
plateau in 0.30.4 range for  the Bode plot of the validation
profile clearly contradicts this. Once again, hypothesising that the two systems
(in the two electrode regions)  have fundamentally identical behaviour with only
small differences owing  to differences in their parameter  values, there exists
at-least one zero in these  continuous-time systems around this frequency range.
The discrete-time discretisation process adds an additional zero to the system.

Based on this preliminary  analysis, the estimates are 
.  Only asymptotic approximations  to corner frequencies can  be estimated
from the  Bode plots. Furthermore, the  estimated locations are not  used in the
parametric system identification algorithms and  is of much less importance than
the  model order  estimates.  With this  initial  understanding, the  parametric
system identification procedure is carried out.

Refinement of coefficient orders using deterministic criteria

The initial estimate  of coefficient orders in subsec:initguesscoefforder
was performed  based only on  a visual inspection  of the Bode  magnitude plots.
Owing to  the fact that  the frequency  response data is  the result of  a crude
ratio of  spectra, there is a  high probability of missing  vital information on
the number and locations of poles and zeros. Hence only a lower bound on the
coefficient orders are available until this point. Next, a set of deterministic
criteria is used to widen and refine the coefficient order range.


Although   the   arx   structure   is  deemed   to   be   too   simplistic
(see subsec:modelstrucchoice), owing to the fact that only linear algebra
operations are involved, as opposed  to numerical optimisation routines employed
in the  oe, armax and Box-Jenkins  structures, certain deterministic
criteria for  coefficient order  selection can  be incorporated  for coefficient
order selection.
This  can serve  as  a  refinement  of  the
initial number of  coefficients guessed from the Bode  magnitude plots discussed
in.

For any model structure used, its error can be defined as

    [k]      & = y[k] - y_m[k] 

    where  are true measurements and
    y_m[k] & = G(q)u[k] eq:outputwithsysonly revisited

are the model outputs obtained by the assumed transfer operator  (which is
to be determined).

The  number of  numerator  and denominator  coefficients in    as well  as
their  values are  to  be determined.  This  set of  unknowns  can be  collected
into a  parameter vector .  Thus, as per  eq:sysiderroronlyk, the
error  sequence  is  parametrised  by  , and  its  notation  is  amended
to .

For  an  input-output  data  set  consisting of   samples,  a  generic  cost
function that may  be applied for all the four  model structures arx,
armax, oe and Box-Jenkins is

    V_N()  & = _k=1^N L([k;])
where  is a postive-valued scalar loss function.
In a typical system identification task, the sum of squares of the error sequence is  used as the typical loss function, thereby yielding
    V_N()  & = _k=1^N ^2[k;]
    The vector  that minimises this cost function is desired
     & = argmin V_N()


For  the arx  model structure, eq:nonlincostfcnsysid  reduces to  a
standard quadratic optimisation  problem which may be  solved analytically using
least  squares  linear  algebra.  However,  for  robustness  against  estimation
bias,  instead of  the  standard ols  estimates,  the iv  estimation
method  was used  for this model order  selection task. Applying
this to  the arx model  structure, two deterministic model  order criteria
have been defined ---
*[label=*)]
    aic, and
    mdl .


In  the aic,  the  optimal  number of  parameters  in  
is  obtained   by  minimising   the  modified   log  likelihood   cost  function



In the mdl criterion, this cost function is modified to




For the two subsystems at hand, both  criteria converged to the same choices for
the coefficient orders,  yielding  and . Therefore,
these values  were used as the  starting points for the  non-linear optimisation
algorithms  used in  determining  the  exact pole  and  zero  locations for  the
discrete-time transfer functions which is described next.

Final transfer function coefficients --- Nonlinear optimisation

For         the         armax        and         Box-Jenkins         model
structures, eq:nonlincostfcnsysid results  in a non-linear  cost function
which  is  minimised iteratively  using  quasi-Newton  approaches. The  theoretical
foundation  of  standard non-linear  optimisation  methods  such as  L-BFGS  and
Levenberg-Marquardt are  well established whose  detailed explanation is  out of
the scope of this thesis. Although state of the art methods are not covered, the
interested reader  may consult the  textbook by Scales   for an
introductory overview of this topic.

The  final  model structures  (for  both  the  positive electrode  and  negative
electrode time-evolution subsystems) in the z-domain are given by



wherein the coefficients in the numerator and denominator are to be determined.

The  number of  coefficients obtained  from subsec:refinementofcoefforder
was  used as  the initial  guess for  the coefficient  orders in  the non-linear
optimisation.  For  the  initial  guesses   for  the  numerical  values  of  the
coefficients  and , a
randomised  multi-start  algorithm was  used.  For  the two  transfer  functions
identified, no distinction is made  between whether the armax structure or
Box-Jenkins structure was  used to arrive at the coefficients.  Since the output
magnitudes of   and  are
of ,  a  constant  scaling   factor  of   is
used  to  bring the  order  of  magnitude of  output  data  values to  unity.  A
well-chosen  scaling factor  is often  vital  to the  convergence of  non-linear
optimisation algorithms.  Since the system  is linear, this constant  gain shall
not fundamentally change the dynamics of the  system and can be accounted for by
using the reciprocal  scaling factor of 0.001 in  numerical implementations. The
identification procedure  was carried  out using MATLAB's  System Identification
Toolbox .























 
tbl:sysidnegcases   shows   the   results  obtained   by   applying   the
aforementioned   non-linear  identification   routines  to   the  time-evolution
subsystems in the negative electrode region. The coefficient orders tried in the
system identification  procedure were informed  by the inferences from  the bode
magnitude plots as well as that obtained by applying the deterministic aic
and mdl  criteria. Only those  models that yielded similar  errors (within
0.5) across both input datasets were retained.

As  discussed  in subsec:initguesscoefforder,   a  first  order  transfer
function cannot capture all the  dynamics of the subsystems under consideration.
Therefore, the lowest order tried in  the identification procedure was two (case
A in tbl:sysidnegcases).  As higher order  models were tried,  the system
accuracy improves steadily as  seen in cases B and C. However  in order to avoid
overfitting, the  lowest order  model that  produces the  highest matched
accuracy across both training and validation profiles must be chosen.

Case D illustrates  the importance of the initial values  used in the non-linear
optimisation algorithms.  Despite using an  identical number of  coefficients as
case C,  the optimisation algorithm  converges to  a radically different  set of
zeros  and  poles  resulting  in  a  percentage  error  comparable  to  that  of
the  simple second  order  case. The  fourth  order model  from  case C  (shaded
grey  in tbl:sysidnegcases) performs  the best  across both  training and
validation profiles and  is chosen as the final model.  The number of numerators
and  denominators match  exactly that  predicted by  the deterministic  criteria
given in subsec:refinementofcoefforder. A similar selection procedure was
applied  for  the  identification  of the  transfer  function  corresponding  to
 in the positive electrode region.

The final identified transfer functions (for the scaled output) are

    Q_e,n(z)I(z) & = 0.002842 z^-1 - 0.00753 z^-2 + 0.006595 z^-3 - 0.001906 z^-41 - 3.577 z^-1 + 4.767 z^-2 - 2.801 z^-3 + 0.6118 z^-4 

    Q_e,p(z)I(z) & = -0.002809 z^-1 + 0.007139 z^-2 - 0.005944 z^-3 + 0.001614 z^-41 - 3.464 z^-1 + 4.444 z^-2 - 2.495 z^-3 + 0.515 z^-4






















fig:tfpredQentrain shows a comparison of the 
output for
*[label=*)]
    the p2d model, and
    the identified transfer function of eq:finaldisctfneg

using  the  training  current  profile  of fig:sysidtrainingcurrent.  The
transfer function of eq:finaldisctfneg was obtained by scaling the output
of the  training profile to  be of order   by a factor  of 1000.
Therefore,  for final  implementation and  comparison purposes,  the raw  output
produced  by applying  the transfer  function  needs to  be scaled  back by  its
reciprocal. If  the system  is linear,  then this scaling  factor shall  have no
impact  on  the  frequency-dependent  dynamics  of  the  subsystem.  The  output
predicted  by the  identified transfer  function is  virtually indistinguishable
from  the `true'  output computed  by post-processing  the p2d  model with
an  rms  error   of  5.70e-6  and  a
mae of 19.19e-6.  This high accuracy
of the transfer  function prediction justifies the linearity  assumption for the
subsystem.  fig:tfpredQepval  presents  the  same  comparison  using  the
validation input profile for the subsystem in the positive electrode region. The
accuracy of  the identified transfer function  for this independent data  set is
clearly illustrated.





















The  poles of eq:finaldisctfneg  lie  very close  to their  corresponding
counterparts of eq:finaldisctfpos  in the  stable region of  the Z-domain
 within   the  unit  circle.   This  confirms  the  hypothesis   that  the
time-evolution subsystems  in these  two regions  exhibit similar  dynamics. The
slight differences in  the pole locations could be attributed  to the variations
in  the  physical  parameters  pertaining  to the  two  electrode  regions.  The
numerator coefficients  of eq:finaldisctfneg and eq:finaldisctfpos
are  also  close  to  each  other  except  that  their  signs  are  opposite  to
each   other.  This   is  to   be   expected,  since   as  seen   in  the   step
response   plots   of fig:linearity,      and
 evolve in time in opposite directions. This is also
explained by  the fact  that, for  a given  applied current,  a decrease  in the
number of ions in the negative electrode has to be accompanied by an increase in
the positive electrode and vice-versa (the values of the changes are not exactly
equal owing to the presence of the separator). The identified transfer functions
are thus consistent  and deemed to be suitable for  representing the electrolyte
time-evolution in these regions.

Numerical implementation of identified transfer functions

The concept  of deploying a Z-domain  transfer function may seem  incongruous to
the  one of  the  major  goals of  this  thesis  time-domain  implementation
of  rom in  an  embedded  environment such  as  a  bms. While  the
majority  of the  models is  derived  and implemented  entirely in  time-domain,
only  the two  time-evolution subsystems  of  the electrolyte  seems to  deviate
from  this  trajectory.  However,  an   explanation  for  this  is  provided  in
subsec:suitablesysid.   In  particular,   it   was   mentioned  that   an
approximation-free  conversion   to  time-domain  from  Z-domain   exists,  that
mitigates this perceived drawback for  these two sub-systems. This conversion is
amenable for discrete-time implementation without any other modifications.

Starting from the generic structure of the identified transfer functions (see eq:outputwithsysonly),

[fleqn,mathindent=0cm,jot=2ex,    ,xoffset=-4mm
    ]
    G(z) &= b_1z^-1 + + b_n_bz^-n_b1 + a_1z^-1 + + a_n_az^-n_a Replace with analogous 
 transfer operator  
 in time domain 

    G(q) &= b_1q^-1 + + b_n_bq^-n_b1 + a_1q^-1 + + a_n_aq^-n_a Apply the definition
 of  on the lhs

    y[k]u[k] &= b_1q^-1 + + b_n_bq^-n_b1 + a_1q^-1 + + a_n_aq^-n_a Cross-multiply

    (1 + a_1q^-1 + + a_n_aq^-n_a)y[k] &= (b_1q^-1 + + b_n_bq^-n_b)u[k] Expand on both sides 

    y[k] + a_1q^-1y[k] + + a_n_aq^-n_ay[k] &= b_1q^-1u[k] + + b_n_bq^-n_bu[k] Apply the definition
 

    y[k] + a_1y[k-1] + + a_n_ay[k-n_a] &= b_1u[k-1] + + b_n_bu[k-n_b] Rearrange to obtain
 the final expression

    y[k] &= -a_1y[k-1] - - a_n_ay[k-n_a] 

         &+ b_1u[k-1] + + b_n_bu[k-n_b] 

We  thus obtain  a  simple  algebraic expression  (a  difference equation)  that
computes the output  at the given time-step given past  inputs and outputs. This
is a highly memory-efficient implementation  since, at any given time-step, only
the previous  (four) output samples  and  (four) input samples need to
be  `remembered'  (stored).  This  concludes all  the  aspects  (derivation  and
implementation) of  this author's new  model for the  electrolyte time-evolution
subsystem.  The  performance  of  this  model  for  computation  of  electrolyte
concentration needs to be evaluated, which is performed next.

 
Performance Analysis of New Model: Ionic Concentration


To demonstrate that a suitable advancement of the field has indeed been achieved
through  this system  identification exercise,  a comparison  with the  existing
state of the art in reduced  order electrolyte modelling is warranted. Secondly,
to  comprehend its  extent of  validity  and performance  boundaries, the  newly
developed rom must also be  pitted against the full-order p2d model.
This section  aims to  provide such  a comparative discussion  for two  types of
inputs ---
*[label=*)]
    constant current inputs
    dynamic load profiles


Constant current inputs

fig:tfquadp2dspatialionicconc1C shows  the spatial distribution  of ionic
concentration  in  the electrolyte  along  cell  thickness  for a  1C discharge
beginning at 100 soc. The spatial concentration computed by
each of the three approaches ---
*[label=*)]
    the p2d model,
    the quadratic approximation model and
    the newly developed system identification model(s).

















During  the  initial  phase  of   discharge,  the  p2d  model  exhibits  a
characteristic inflection point near the  separator interfaces that diffuses out
over time  until a  qss. This  is due to  the fact  the reaction  front is
initially established  close to the  separator, and as surface  concentration of
lithium  in particles  near separator  is  depleted, the  reaction starts  moves
further  into the  electrode thickness.  Neither  of the  two rom  under
consideration here  could successfully  capture this  characteristic inflection.
This is  explained by  the fact  that both  of them  use the  standard quadratic
approximation profile for the spatial  profile, which means that only one
apex  point is  possible  per  electrode, which  is  pinned  to their  separator
interfaces by design.

During the transient portion of discharge (approximately up to 357
as   shown   in fig:tfquadp2dspatialionicconc1C),   the  locus   of   the
concentration  profile computed  by  the newly  developed system  identification
model(s) clearly lies  much closer to the p2d model  than that computed by
the  quadratic  approximation model.  After  the  initial transition  phase,  it
appears  that  the  concentration  profile predicted  by  both  the  rom
converge to the p2d model's concentration profile.


To obtain  a quantifiable  perspective on  the accuracy  of the  newly developed
model, it  is desirable  to plot  the temporal  evolution of  the concentration,
particularly  at  the  two  current   collector  interfaces.  The  behaviour  of
the  baseline  quadratic approximation  model  in  this regard  was  established
in subsubsec:simresultsbaselinequad.   Therefore  it   is  important   to
ascertain whether a noteworthy improvement  was achieved using the model arrived
at using the system identification procedure.























fig:temporalcetfquadratic   shows  the   time-evolution   of  the   ionic
concentrations at the current collector  interfaces of the negative and positive
electrodes for a 1C discharge. The  concentration profiles computed
by the three approaches ---
*[label=*)]
    p2d model,
    quadratic approximation model and the
    newly developed system identification model(s)

are overlaid in the top row of  plots, wherein the left hand side corresponds to
the  current collector  interface  at  the negative  electrode  while the  right
hand  side  corresponds  to  that  at  the  positive  electrode.  The  plots  in
the bottom  row of fig:temporalcetfquadratic  show the  time-evolution of
the  absolute  value  of  their  errors. The  concentration  error  of  each  of
the  two  rom  is  defined  with  respect  to  the  benchmark  p2d
model   
. The  absolute value  of the  error is  plotted so
that  the magnitude  of the  error can  be visualised  better, aiding  immediate
comparisons based on the plots.

For both  current collectors,  the newly  developed system  identification model
outperforms  the  quadratic  approximation  model during  the  transient  phase.
At  the  negative  electrode/current  collector  interface,  the  error  of  the
system  identification  model  remains  strictly below  that  of  the  quadratic
approximation model until 650 and remains comparable to it
until 1600. Beyond  this time, the  quadratic approximation
model has a  slightly better accuracy, although the  system identification model
still remains at a comparable distance from it. After 2000,
both models  yield the same  response shape. For the  positive electrode/current
collector interface, the error of  the system identification model remains below
that of the quadratic approximation model until 3300.



















fig:zoomedcetfquadtemporal shows  a zoomed version of  the time-evolution
of the  ionic concentration  at the  two current  collectors, wherein  the first
300  after  application  of  the  load  current  is  plotted.  The
significant  improvement in  accuracy  achieved by  the  newly developed  system
identification model(s) is clearly demonstrated. At both the current collectors,
the concentration computed  by the system identification  model(s) closely track
that of the benchmark p2d model.

The  loss  of fidelity  exhibited  past  the  initial transient  phase  warrants
an  explanation. It  should  be  recalled that  the  natural  decoupling of  the
temporal and  spatial systems were taken  advantage of in developing  the system
identification technique. This  means that, for the spatial  profile, the system
identification  model reverts  to the  same  quadratic profile  as the  baseline
quadratic approximation  model. This  explains why the  two models  have similar
shape past the initial transient. During  the transient phase when the qss
behaviour is yet to be established, it is reasonable to assume that the temporal
dynamics  are of  paramount importance  in governing  the concentration  profile
evolution.  After a  qss  has  been established  with  the reaction  front
diffusing out  and a steady  stream of ion-electron  separation/recombination in
place,  it is  hypothesised  that the  temporal dynamics  have  settled and  the
spatial configuration assumes importance.

With a  sustained application  of constant current  past the  initial transient,
strong spatial gradients  in the ionic concentration are  established within the
cell  the  concentrations are far from the initial  equilibrium value. This
precisely  exposes the  realm  where the  system  identification model  exhibits
its  natural  weakness.  By  following  the  theory  of  system  identification,
which  necessitates   bias  removal,   the  training  and   validation  profiles
of fig:sysidtrainingcurrent   and fig:sysidvalidationcurrent   had
nearly  zero mean.  This means  that the  currents were  as equally  positive as
negative leading to a small-signal  perturbation around the equilibrium value of
the electrolyte  concentration. While this  profile is ideally suited  to excite
the system's  dynamics, it  fails to  capture the large  signal behaviour.  As a
topic  of future  research,  perhaps a  spatially-coupled system  identification
could be attempted to handle this issue.

The  main  implication of  these  results  is  that  the identified  models  are
primarily suitable for  transient  dynamic load profiles,  which is typical
of a real-life scenario in an electric/hybrid electric vehicular operation. Such
a  model is  less  suitable  for sustained  constant  current application.  This
implies that  a bms in a  vehicle undergoing a cccv  charging cannot
rely on  these identified electrolyte  models. However, this exclusion  does not
seriously hamper the model's wider applicability since a simple coulomb-counting
approach with  a high-precision adc is  much more accurate than  any other
pbm in this particular scenario.

Although constant  current discharge is  not a practical use-case  for vehicular
batteries, performing this benchmark evaluation  has helped in understanding the
limits of the newly  developed model. This study has also  helped in providing a
glimpse of its  potential strength  significantly  improved accuracy under
dynamic load conditions, which is presented next.

Dynamic current inputs

To characterise  the performance  of the  newly developed  system identification
electrolyte   concentration  model(s)   under  dynamic   load  conditions,   the
udds  drivecycle  was  used.  The  details  of  this  drivecycle  such  as
its  speed  versus  time  data  and its  highly  dynamic  nature  was  discussed
in subsubsec:dynamicspmp2dsim. The peak of  the applied load current used
corresponds to a discharge current of 180  3C. A plot of this
current  profile was  shown in  the top  row of fig:uddssimp2dspmresults.
This  load  profile  was  applied   to  the  three  models  under  consideration
---
*[label=*)] p2d
model,  quadratic  approximation   model,  and  newly  developed
system identification  model(s)  ---
and the spatio-temporal evolution of ionic concentration in electrolyte computed
by each of them was studied.

Since  the  load   current  is  highly  dynamic   and  continuously  alternating
between  charging   and  discharging   at  various  magnitudes   throughout  the
profile   duration,   it   is   difficult  to   discern   a   specific   pattern
or   trend  within   the  spatial   thickness   of  the   cell.  Hence,   unlike
the   case   of  prolonged   unidirectional   current   application  wherein   a
clear   reaction  front   that  diffuses   gradually  out   can  be   visualised
(see fig:tfquadp2dspatialionicconc1C), little  information can  be gained
from  visualisation   of  spatial   concentration  profiles.  Since   the  ionic
concentrations at  the two  current collectors have  a direct  (and two-pronged)
influence on the  electrolyte overpotential (see eq:electrolytepdwithce),
it is particularly important to characterise  the accuracy at these two critical
spatial locations.

Since a  direct correspondence between  the time-dependent dynamics of  the load
profile and that of the electrolyte concentration can be intuitively visualised,
its values  at the two current  collector interfaces are examined.  The plots in
the top row of fig:uddsTfQuadCeatCC shows the time evolution of the ionic
concentration at the two current  collector locations for the udds current
profile computed by  each of the three models under  consideration. The plots to
the left  pertain to the negative  current collector location while  that to the
right correspond to  the positive current collector location. The  bottom row of
plots show the absolute value of concentration error of the quadratic and system
identification models relative to the  p2d reference benchmark. As seen in
fig:uddsTfQuadCeatCC, the  absolute error  of the newly  developed system
identification models remain below that  of the baseline quadratic approximation
model throughout the drivecycle.


























Based   on   the   conclusions   from   the   constant   current   input   study
of subsec:tfquadceconstcurrinput,  it   is  to   be  expected   that  the
system  identification  model(s)  exhibit  a  superior  performance  during  the
transient  phase   of  the   simulation.  As  seen   in  the   initial  duration
of fig:uddsTfQuadCeatCC, the absolute error  of the system identification
model is indeed  lower than that of the baseline  quadratic approximation model.
Particular, when a sudden current spike is applied at 200,
the  quadratic approximation  model is  unable to  cope and  its absolute  error
deviates  far  away   from  its  mean  value.  The  absolute   error  of  system
identification model  remains well controlled  and even with  this instantaneous
load demand, its standard deviation is remarkably close to its median value as
shown in tbl:errormetricsquadtfce.





















 
While the  superior accuracy of the  newly developed model during  the transient
phase  was not  surprising, the  fact  that its  performance remains  consistent
throughout  the  entire  time  horizon  is  noteworthy.  Despite  being  subject
to  incessant  changes   in  load  demands,  the   system  identification  model
responds better  than the  quadratic approximation model  well past  the initial
transient.  fig:zoomedcetfquadtemporaludds shows  a  zoomed  view of  the
ionic concentration in the electrolyte  at the two current collector interfaces.
To prove the improved performance of the developed model well into the operation
of the cell, a 50 window beginning at 60 of
the overall  profile duration is examined  in detail. Although it  exhibits some
oscillations,  the system  identification model(s)  reasonably track  the `true'
concentrations computed by the p2d  model. However, the baseline quadratic
approximation  model seems  to suffer  from  a large  bias with  respect to  the
p2d model.  It should also  be noted that nearly  every `kink' in  the two
rom  is identical.  This could  be attributed  to the  fact the  spatial
profile  used  in  both of  them  is  identical.  Hence,  it must  be  concluded
that  the difference  in their  amplitude arises  from the  improved calculation
of coefficients  in eq:cenqquadstart and eq:cepqquadstart
through  the  usage  of  more  accurate    and  
in  the  lhs of eq:Qenbyintegration  and eq:Qepbyintegration
respectively.  Detailed   error  metrics  of   the  two  rom   is  shown
in tbl:errormetricsquadtfce.

























Based  on  the  evidence presented  thus  far,  it  can  be concluded  that  the
time-evolution subsystem model(s) developed here using the system identification
technique  indeed  represent  an  advancement  of the  field  of  reduced  order
electrolyte  modelling. With  this  aspect  thus tackled,  it  is imperative  to
explore the potential benefits of  incorporating the discrete-time model(s) thus
obtained into the conventional spm and is discussed next.
 
Composite SPM Model with Electrolyte Dynamics


At this  stage, it must  be recalled that the  purpose of developing  the system
identification electrolyte  model was  to mitigate the  poor performance  of the
basic  spm at  C-rates above 0.5C (see subsec:simresultsbasicspm).
This sub-optimal performance was attributed  to the lack of electrolyte dynamics
in  the  basic  spm.  The   performance  of  the  newly  developed  system
identification model has been proved to be  superior to the current state of the
art. The next step  is to embed this electrolyte model  into the basic spm
so as to  obtain a composite spm. The performance  of this composite model
is evaluated to ascertain its suitability towards online implementation.

Computation of electrolyte overpotential

The missing component in the terminal voltage computation of the basic spm
is  the  contribution from  the  electrolyte  overpotential  term. This  is  the
potential difference in  the entire electrolyte  the electrolyte potential
at the positive current collector interface with respect to that at the negative
current collector interface.


As discussed in sec:electrolyteinclusion, using  the equation proposed by
Prada  , the  overpotential in the electrolyte  is computed
as

    _- _&= (1-t_+^0) 2RTFc_e,pos/ccc_e,neg/cc

     &-I2 A(l_neg_eff,neg + 2 l_sep_eff,sep + l_pos_eff,pos) eq:electrolytepdwithce revisited


eq:electrolytepdwithce consists of two distinct terms ---
*[label=*)]
    a diffusion overpotential due to concentration gradient in the electrolyte, and
    an ohmic resistance term that is dependent upon
        *[label=*)]
            the instantaneous value of applied current,
            the thicknesses of the three cell regions, and
            the effective ionic conductivity in each of the three regions.         


The ohmic  loss term  of eq:electrolytepdwithce needs  to be  examined in
closer detail.  The dependence of  this term  on instantaneous load  current and
cell thicknesses  can be accounted  in a straightforward manner.  However, there
are ambiguities  in computing the  effective ionic  conductivity in each  of the
three cell regions. The effective value of ionic conductivity in the electrolyte
depends on its intrinsic conductivity, the Bruggeman constants and porosities of
each  of  the three  regions.  The  intrinsic electrolyte  conductivity  in-turn
depends on the electrolyte concentration.

Ambiguities   arise   in  interpreting   the   value   of  ionic   concentration
to   be    used   for   computation   of    electrolyte   concentration.   Since
eq:electrolytepdwithce  deals  with  overall potential  drop  across  the
entire  length of  the cell,  the concentration  used for  computing electrolyte
conductivity could,  for example be  that at the respective  current collectors.
This concept however  introduces inconsistencies with the  separator term. Using
the  separator concentration  from one  of the  electrode interfaces  introduces
unequal  weighting  in this  computation.  If  the  ionic concentration  at  the
midpoint of the separator is used, this scheme becomes inconsistent with that at
the  two current  collectors. Another  possibility for  computing the  effective
conductivity in a  cell region is to  use the mean of the  concentration in that
region. However, since the mean is nothing but a simple statistical first moment
is  equally influenced  by the  entire  concentration profile  within each  cell
region. This is questionable given that the electrolyte overpotential across the
entire cell thickness  is most likely governed by the  conductivities at the two
current  collector interfaces.  Some form  of weighted  mean could  be conjured,
wherein the  current collector locations  are given  the highest weight  and the
separator locations the  least weight. However, finding the  weights becomes yet
another  exercise and  from the  engineering perspective  of computing  these in
real-time, seems to be in the realm of diminishing returns.

In  published  literature,  only  a  cursory  treatment  has  been  accorded  to
the  aforementioned  ambiguities.  In  Prada  ,  the  usage
of  initial concentrations  is  used  to only  introduce  the  concept of  ohmic
resistance  in that  article.  However,  the author  of  this  thesis wishes  to
extend  this  concept further.  In  the  simulations  conducted by  this  thesis
author, it  became clear  that the  dependence on  applied current  was required
in  order to  obtain  reasonable accuracies.  Computing  mean of  concentrations
in  cell  regions for  calculation  of  ionic  conductivities  led to  a  biased
computation of overpotentials.  Therefore, this author decided to  use the value
of  initial concentration  for the  computation of  ionic conductivities  in the
current-dependent  contribution  to  electrolyte  overpotential  throughout  the
entire time horizon considered.

Hence, as per the adopted scheme eq:electrolytepdwithce gets modified as

    _(t) - _(t) & = (1-t_+^0) 2RTFc_e,pos/cc(t)c_e,neg/cc(t)

                                 &-I2 A(l_neg_eff,neg(c_e(0)) + 2
    l_sep_eff,sep(c_e(0)) +
l_pos_eff,pos(c_e(0)))

wherein  the time-dependent terms are explicitly shown in the notation.

Using eq:electrolytepdwithcenew for electrolyte overpotential computation
has an  important implication. The  two-pronged influence of  the time-dependent
electrolyte concentration on the electrolyte overpotential 
*[label=*)]
    a direct influence in the form of concentration dependent diffusion polarisation, and
    an indirect influence through its use in ionic conductivity calculations

has  now  been  reduced  to  just   one.  This  implies  the  results  from  the
system  identification   model  are  now   required  only  in  the   first  term
of eq:electrolytepdwithcenew.

In the light of the decision of use the (constant) initial concentration for the
ohmic term, it is natural to question the gains from the circuitous route of the
system  identification  exercise that  was  undertaken  to obtain  the  improved
electrolyte model. Therefore,  it is imperative to quantify  the relative weight
of  the  concentration  dependent  diffusion resistance  compared  to  the  bulk
solution resistance.


















fig:contributiontophiefromtwoterms shows the  contribution to the overall
potential drop  and  in  the electrolyte
from  each  of  the  two  terms  in eq:electrolytepdwithcenew  for  a  1C discharge. The bulk  solution resistance is constant owing to  the fact that the
initial  electrolyte concentration  is  used in  computing  the effective  ionic
conductivities in the three regions of  the cell. The gradient induced diffusion
polarisation term, however has a stronger contribution in both the transient and
steady  state. The  entire dynamics  of the  overall potential  drop during  the
transient  phase is  governed by  this concentration-dependent  term, while  its
steady state contribution  is in-fact higher than the  bulk solution resistance.
The  constant  ohmic resistance  term  merely  provides  a non-zero  offset  for
the  electrolyte  solution  overpotential.  In questioning  whether  the  system
identification exercise was indeed worthwhile,  if the concentrations in the two
current collectors had not been computed  at each time-step, then this diffusion
polarisation  term  would  become  zero.  This is  because,  the  numerator  and
denominator in eq:electrolytepdwithcenew would have to be retained at the
initial concentration, leading to a unit  ratio whose natural logarithm is zero.
Therefore, it  is clear  that computing  the concentrations  at the  two current
collectors  through system  identification has  indeed helped  in improving  the
modelling accuracy.

Having established the relative  importance of computing the diffusion-dependent
polarisation   overpotential,  the   next  question   that  arises   is  whether
the   constant    approximation   for   the   bulk    solution   resistance   is
indeed   appropriate.   It  also   remains   to   be   seen  if   the   accurate
computation   of  the   ionic   concentration   through  system   identification
(see sec:perfanalysisnewmodel) has  translated into a  similarly accurate
computation of  electrolyte overpotential. This  is answered by a  comparing the
electrolyte overpotential computed by the  system identification model with that
obtained from the p2d model.





















fig:phiedeltacnst1C shows  a comparison of the  electrolyte overpotential
computed  by   the  p2d  and   system  identification  models  for   a  1C discharge. There  is a discrepancy  in the  initial offset of  the overpotential
value.  However,  this  cannot  be  attributed   to  the  use  of  the  constant
concentration  approximation   in  the   computation  of   ionic  conductivities
in eq:electrolytepdwithcenew.  This   is  because,  at   equilibrium  the
concentration used  is exactly  the initial  concentration. Furthermore,  at the
instant of applying the current, diffusion gradients in the electrolyte have not
yet been established.  Hence, the contribution from  the diffusion overpotential
is zero,  which can  also be  seen in fig:contributiontophiefromtwoterms.
Thus, it can be  concluded that this initial mismatch is due  to the presence of
some  other unmodelled  phenomena  that  affects the  DC  offset of  electrolyte
overpotential, and is not arising due to the approximations used by this author.

In fig:phiedeltacnst1C,   the  shape   of   the   transient  profile   of
overpotential  computed  by  the  system identification  model  closely  matches
that  of the  p2d model.  This validates  that the  newly developed  model
does  indeed  capture the  electrolyte  dynamics  sufficiently well  during  the
initial transient.  However, past  the initial  transient, the  model's accuracy
degrades and  the resulting  profile does  not track  the p2d  model. This
behaviour in overpotential is analogous to that exhibited in the spatio-temporal
concentration   study   discussed  in subsec:tfquadceconstcurrinput   for
constant current inputs,  wherein it was deemed that this  newly developed model
is  more  suitable  for  dynamic  loads. The  same  conclusion  for  electrolyte
overpotential   accuracy  is   reached   from  this   constant  current   study.
Nevertheless, even for  constant current loads, using the  newly developed model
is better than having no electrolyte model whatsoever as in the basic spm.
















fig:phiedeltacnstudds shows a comparison of the electrolyte overpotential
computed by the p2d and system identification models for a udds load
profile. The  input current corresponding to  this load profile is  shown in the
top row  of fig:uddssimp2dspmresults. The system  identification model is
able to  reasonably track  the overpotential profile  computed by  the p2d
model. Unlike the  case of sustained unidirectional current input,  the error in
this case  remains well-contained. The  mae obtained for this  profile was
15.88  with  an  rms  error  of 24.11.
This  corresponds to  8.19 and  12.44 of  the peak
magnitude of the overpotential (193.86).

Hence, it can be concluded  that the electrolyte overpotential computation using
the system identification  model provides an acceptable  performance for dynamic
load profiles.  The next step  is to incorporate this  electrolyte overpotential
calculation into the basic spm and to quantify the voltage accuracy of the
resulting composite spm.

Terminal voltage computation of composite spm

In subsec:simresultsbasicspm, it  was shown that in  the basic spm,
the computation of the cell's soc  is of sufficient accuracy. However, its
terminal  voltage  strongly deviates  from  the  true  value  as computed  by  a
p2d model.  This mismatch between  soc and terminal  voltage hinders
the  suitability of  the basic  spm  as the  plant model  in online  state
estimation applications. The discrepancy in terminal  voltage is due to the lack
of electrolyte overpotential contribution in  its computation. Having obtained a
suitable methodology  to compute this  (see subsec:electrolyteopcalc), it
is now possible to refine the computation of the cell's terminal voltage.

Referring   to eq:posoverpotential  and eq:negoverpotential,   the
reaction overpotential in each of the two porous electrode regions is given by

    η_pos &= ϕ_- ϕ_- U_pos  

    η_neg &= ϕ_- ϕ_- U_neg  
wherein  the  contribution  from   the  electrolyte  potential  terms 
and  are no longer to be neglected.

Subtracting eq:negoverpotentialoverall
from eq:posoverpotentialoverall

 η_pos - η_neg &= ϕ_- ϕ__V_cell - ϕ_+ ϕ_- U_pos + U_neg

whose rearrangement yields
V_cell &= η_pos - η_neg + ϕ_-
ϕ___e + U_pos -
U_neg


Substituting for  from eq:electrolytepdwithcenew in
into eq:intermediatevoltagewithphie,  and  expanding  each of  its  terms
(see derivation of eq:spmbasicoutputvoltagefinal  for details), the final
expression for the cell's terminal voltage is obtained as

    V_cell(t) = 2 R TF ^-1 ( - I(t)2 A l_pos a_F k_c_e c_(t) (c_- c_(t))) 

    - 2 R TF ^-1 ( I(t)2 A  l_neg a_F k_c_e c_(t) (c_- c_(t))) 

    hello worl+ (1-t_+^0) 2RTFc_e,pos/cc(t)c_e,neg/cc(t) -I2 A(l_neg_eff,neg(c_e(0)) + 2 l_sep_eff,sep(c_e(0)) +
l_pos_eff,pos(c_e(0)))

    + U_pos(c_(t)) - U_neg(c_(t))


All  other   expressions  and  computations   of  the  basic   spm  remain
unchanged (see sec:spmmodeldevelopment for the  complete set of equations
constituting the model). The final step  is to show that the composite spm
thus obtained has an improved performance especially in those scenarios that the
basic spm performed poorly.

Validation of composite spm: Terminal voltage accuracy

The final  step in  this model  development effort is  the validation  phase. In
particular, the voltage accuracy of  the composite spm is compared against
the  p2d model  for standard  input conditions.  In order  to compare  and
contrast the  gains achieved  by the composite  spm, the  terminal voltage
output of the basic spm is also considered here.

Constant Current Inputs

The  voltage  accuracy of  the  newly  developed  composite spm  is  first
evaluated for  the standard test  case of 1C discharge current starting  from a
cell soc of 100.






















fig:voltageoutputcompareallSPMs1C  shows the  terminal voltage  output of
various spm for a 1C discharge beginning at 100 soc
(top  plot). Since  it  does  not account  for  electrolyte overpotentials,  the
voltage profile computed by the basic spm lies above that of the benchmark
p2d  model. On  the  other hand,  the composite  spm  tends to  over
correct  for the  electrolyte overpotential  so that  its terminal  voltage lies
below  the p2d  output. Since  the output  of the  two rom  lie on
either side of the p2d model, it  is appropriate to use the absolute value
of their errors with respect to the  p2d benchmark to compare them. In the
bottom  plot,  the  percentage  deviation  of the  absolute  error  of  the  two
rom is shown. The statistics of this deviation is quantified
in tbl:errorsummarycntcurrdischgallspms.




















 
In  each of  the error  statistic considered,  the composite  spm performs
significantly better than the basic spm for the 1C discharge case.

One   of   the   biggest   drawbacks   of   the   conventional   spm   was
its    poor    voltage    accuracy    at    moderate    C-rates    above 0.5C
(see tbl:errorsummarycntcurrdischgspmp2d). The high accuracy achieved for
the 1C rate  seems to indicate that  the composite spm is  indeed a viable
solution for all  high C-rates, especially given the backdrop  of its methodical
derivation steeped in systems theory.

However,  there exists  a  fundamental  flaw in  all  models  that use  a priori
assumptions  of  simplified spatial  profiles  for  ionic concentration  in  the
electrolyte.  In  the  case  of  both the  baseline  quadratic  and  the  system
identification models, a parabolic profile spanning the entire thickness of each
region within the cell was chosen a priori. However, no attempt to modify the
profile upon encountering an ion starvation event at any spatial location.

This  critical flaw  is  exposed  by the  sustained  application  of any  higher
current  that  induces  an  ion  starvation at  one  of  the  electrodes  during
operation.fig:2Cionstarvation  depicts  the  ionic concentration  in  the
electrolyte  over  time at  both  current  collectors  for a  2C discharge.  The
profiles  computed  by  both  the p2d  and  system  identification  models
are  plotted.  For  the  system  identification  model,  the  current  collector
interface  at  the  positive  electrode  experiences  an  ion  starvation  event
at 150. The  quadratic spatial  profile used by  this model
does not account for such a  reduction in the effective electrode thickness. All
the  boundary conditions  and coefficients  were formulated  using the  original
electrode  thickness.  Therefore,  beyond 150,  the  concentration
becomes negative which  is not physically meaningful. The author  of this thesis
has implemented a saturation mechanism in the code that detects an ion depletion
event and prevents the concentrations from becoming negative.

Implementing  this  hard   lower  bound  of  zero  for   the  ion  concentration
does    not   mitigate    the   problems    associated   with    computing   the
electrolyte   overpotential.   Specifically,  computational   difficulties   are
encountered    when   computing    the    concentration   dependent    diffusion
overpotential eq:electrolytepdwithcenew. In the case  of ion depletion at
the positive  current collector,  the argument of  the logarithmic  term becomes
zero which leads to a non-feasible computation (). Ion depletion at the
negative current collector  is equally detrimental to  the computation. However,
this scenario has  a lower probability owing to the  low C-rates during charging
operation (see subsec:basicspmsimsetup).  Furthermore, in the  absence of
the lower  bound of zero  for the  concentrations, complex numbers  are obtained
from  the logarithmic  term, which  lead to  physically erroneous  overpotential
calculations. An  alternative is  to simply omit  the diffusion  impedance term.
However, since  this term is  responsible for  the large-signal dynamics  of the
overpotential (see fig:contributiontophiefromtwoterms), omitting this and
reverting to  a simple ohmic  resistance contribution shall lead  to significant
errors  in  the electrolyte  overpotential,  and  consequently in  the  terminal
voltage.  Finally, setting  the diffusion  impedance to  zero at  the transition
boundary of ion starvation is also not a feasible solution. This is because, the
sudden inflection in  the trajectory of the terminal voltage  shall induce large
errors in any state estimation algorithms that depend on the composite spm
as the plant model.

The  difficulties  encountered  in electrolyte  overpotential  computations  for
ion  depletion scenarios  have  not  yet been  discussed  in  the literature  by
the  research  community that  use  such  quadratic approximation  models.  This
thesis author  therefore assumes that  such a  scenario had not  been previously
encountered  for  the  parameter  set  and C-rate  combinations  used  by  those
researchers. Despite the  fact that this phenomenon might be  an artefact of the
idiosyncrasies of the  parameter set used here, it  is nevertheless questionable
to not  have mathematically adapted  the parabolic  profile to such  events. The
aspect  of rendering  the model  robust to  such vagaries  is currently  an open
problem in the field and can be the subject of future research. It can therefore
be concluded that  this composite spm is unsuitable  in its present
form for  sustained constant current  discharge at higher C-rates.  Despite this
setback due  to deficiencies in  the mathematical formulation of  the underlying
spatial profile, the superior performance  of the system identification model in
the computation  of ionic  concentrations and overpotentials  for dynamic
conditions warrant such a study for the composite spm.


























Dynamic Load Conditions

In  order to  evaluate the  performance of  the composite  spm to  dynamic
inputs, the  input profile  corresponding to  the udds  drivecycle profile
in fig:uddssimp2dspmresults  with  a  peak current  of  180
 3C was used.

fig:voltageoutputcompareallSPMsudds  shows  the  voltage  output  of  the
composite  spm  for a  udds  input  profile  with a  peak  magnitude
of   180   3C  (see fig:uddssimp2dspmresults).   The
voltage   profiles  computed   by  the   basic  spm   and  the   benchmark
p2d  model   is  also  overlaid   (top  plot).  The   percentage  absolute
error  of  the  two  rom  relative  to  the  p2d  model  is  shown
in  the  bottom  plot.  Clearly,  it  is  seen  that  the  terminal  voltage  of
the  composite  spm   is  significantly  more  accurate   than  the  basic
spm  (see tbl:errorsummaryuddsdischgallspms).   For  instance,  the
voltage  profile  computed by  composite  spm  matches the  complex  shape
characteristics  of the  p2d model  while remaining  very close  to it  in
magnitude.






































 
In  summary, while  the newly  developed composite  spm is  not considered
robust for use in  sustained discharge at high C-rates, it  is indeed a suitable
option for  dynamic load profiles, even  for those with high  peak magnitudes of
instantaneous charge or discharge. Such  load profiles are typically encountered
in vehicular  applications, particularly  in hybrid  electric vehicles.  Thus, a
suitable time-domain rom that can be directly implemented in discrete-time
has  been  developed  through  system   identification  and  its  strengths  and
weaknesses have been quantified. The applicability of this model has been proven
for real-life  scenarios using a  highly dynamic  load cycle. Thus,  this author
concludes that the  composite spm developed here does  indeed represent an
advancement to  the present  modelling art. This  model may now  be used  as the
plant  model  in  state  estimation  and control  applications  in  a  vehicular
bms. This concludes the chapter as  well as all the implementation aspects
of physics-based battery modelling discussed in this thesis.




 
 6


chapters/litt_review/figures/



Conclusions
[chapters]
[chapters]11



In this  thesis, the  deployment of  physics-based computational
modelling  of lithium  ion  cells  for electric  vehicle  applications has  been
rigorously examined  with a three-pronged strategy   through their analysis,
design and implementation.  The p2d implementation of  the dfn model
was  used  as  the  backbone  of  all  modelling  efforts.  Salient  conclusions
drawn  from each  of these  aspects are  presented in  this chapter.  Based upon
the  invaluable  experience gained  during  the  course  of this  research,  and
particularly  from the  findings presented  herein, key  areas in  physics-based
modelling that can benefit from further study in the future are also identified.



pbm as a Design Tool

Conclusions from the model-based design study

ch:modelbaseddesign presented  a computational framework to  optimise the
number  of electrochemical  layers within  a pouch  cell so  as to  maximise its
usable energy while  meeting specific power demands. In  particular, this helped
to construct a model-based deterministic approach to optimally design cells that
can  be subjected  to  fast-charging without  the concerns  of  plating. In  the
context of electric vehicle applications,  using this approach has the potential
to alleviate  the two immediate concerns  of consumers  range  anxiety and
long charging times.

To  facilitate  immediate  adoption   by  relevant  stakeholders,  the  concepts
developed  in  the  optimisation  framework  of  ch:modelbaseddesign  was
realised in  computer code and  presented in the  form of an  open-source design
toolbox, bold. This toolbox was applied  to the optimal layer design of an
example cell from literature to obtain two sets of power-dependent optimal layer
configurations for two drivetrains --- a bev and a phev. By suitably
adapting the  numerical values of  parameters to a real-world  cell, model-based
cell  designs can  be  obtained, which  can potentially  help  to eliminate  the
current trend  of over-engineering of  cells using conservative  empirical layer
choices.

From a  perspective of technical  advancements to the underlying  pbm, the
standard form  of the p2d model  has been suitably modified  to facilitate
a  direct  application of  input  power  densities.  This was  achieved  through
reformulation of the boundary conditions on the solid-phase potential pde.
Although  this innate  power input  capability has  been claimed  as purportedly
developed  in  extant  literature,  its independent  derivation  and  accessible
documentation  provided herein  shall help  other researchers  to apply  this in
a  straight-forward  manner  for  vehicle drivecycles,  acceleration  tests  and
power-based charging protocols.

This investigation also  revealed that the fast charging  process determines the
optimal layer  configuration instead of  either acceleration runs  or drivecycle
requirements. This may  help to counter the current trend  in publications which
often rely  primarily upon a  drivecycle-based dynamic input current  profile to
evaluate various  aspects of cell  modelling such as predicting  degradation and
for advanced control and estimation  algorithms. While validation against such a
dynamic input profile  is certainly vital, for future  advancements dealing with
aspects  of  cell  design  or plating-related  degradation,  validation  against
fast-charging power profiles is deemed to be absolutely essential.

The  study  also  provided  important  guidelines  about  the  role  of  thermal
environment on cell performance. It became  clear that at very low temperatures,
a high  number of layers was  required for satisfying a  specific charging power
level relative  to that  needed at  moderate thermal  environments such  as room
temperatures. A practical  takeaway from this conclusion is that  it suffices to
use a low number of layers in  vehicles to be sold in territories with perennial
moderate temperature conditions.

Finally, this design study revealed that the speed at which lithium intercalates
into the negative  electrode during charging limits the  charge-addition rate to
the cell. Lowering  the charging times of electric vehicles  requires the use of
higher charging  powers. However, this necessitates  a high number of  layers to
absorb the overpotentials  and to provide adequate number  of thermal conduction
pathways (owing  to the higher  number of  current collectors) to  dissipate the
additional heat  generated. Consequently, this  has a detrimental effect  on the
capacity and hence, the aer of the vehicle.

Future work informed by  the optimal layer design framework

As     a     direct     inference     of     the     final     conclusion     in
sec:modelbasedconclusion, assuming that  the electric grid infrastructure
is  adequately equipped  to cope  with  the surge  in future  power demands  for
charging  of  electric vehicles,  the  solid  state  diffusion at  the  negative
electrode becomes the bottleneck. It  is therefore important for future research
to  focus  on the  development  of  new  materials  for the  negative  electrode
possessing much higher  solid phase diffusion coefficients,  particularly at low
temperatures.

From a perspective of improving the framework itself, at the outset, it is clear
that the plating threshold assessment can be made more accurate by incorporating
the solid phase diffusion coefficient as  function of soc. In the interest
of simplicity and  to lay the foundation for such  model-based cell designs, the
scope of this  work was intentionally narrowed down to  solely focus on changing
the layer  configurations within  cells. In doing  so, certain  assumptions were
made  that  might have  to  be  revisited  and  potentially relaxed  before  its
application to real-world cell designs.

For instance, adherence  to the specific type of cooling  phenomena used  tab
cooling, is one of the stronger assumptions used in this work. In this work, the
benefits of  employing this  cooling mechanism  has been  enumerated, and  it is
desirable that future  pack designs adopt it. However, the  vast majority of the
current generation of battery packs  use surface-cooled designs. This means that
temperature for all layers within the pouch shall not be the same, which further
implies that it longer suffices to  simulate just a single layer. Therefore, the
framework  needs  to be  suitably  modified  to  handle multiple  layer  choices
concurrently.

Furthermore,  using surface  cooling shall  invalidate the  assumption of  small
thermal gradients along the planar axis of  the cell. This means that the lumped
thermal model  shall no longer  be accurate  to model the  temperature evolution
of  the cell.  Furthermore,  the differential  temperature  evolution along  the
cross-sectional direction  shall influence the transport  and kinetic properties
of the  cell. This electrochemical-thermal  coupling along the  planar direction
shall necessitate adding another spatial  dimension to the underlying pbm,
thereby rendering the  presently used p2d model ineffective.  With the aim
of minimising  the optimising  run-times, future  research may  focus on  how to
suitably adapt the computational infrastructure that was proposed in this thesis
to account for these considerations.

For  real-world cell  designs, it  is prudent  to examine  the examine  the role
of  variable  porosities  to  achieve  the balancing  of  active  materials  per
layer.  Since  the computational  framework  developed  in  this thesis  uses  a
modular  approach, in  the  future  the constant  volume-fractions  used in  the
methodology  could simply  be replaced  by values  informed by  optimal porosity
computations. For this purpose, researchers could investigate the feasibility of
adapting  a suitable  scheme from  the available  pool of  literature that  have
focussed  on  using  model-based  porosity  optimisation 
. Finally, experimental prototyping is  an important step in any
cell  design and  it  is  no exception  here  either. Therefore,  experimentally
applying the desired power levels to confirm the optimal layer choices predicted
by the  framework is an important  step to be undertaken  before its large-scale
deployment.


Analysis of Salient Physics-based rom

Chapters  and  of  this thesis primarily
focussed on performing an in-depth analysis of two distinct rom from two
distinct perspectives.  In ch:improveddra, the hybrid  rom obtained
by  using the  dra  is analysed  to  investigate its  computational
bottlenecks. In ch:spmanalysis, an in-depth analysis of a niche selection
of  candidate models  from  the  family of  spm  is  presented from  the
perspective of modelling accuracy  their ability to faithfully compute
the  system-level quantities  of the  cell such  as its  soc and  terminal
voltage. Finally, the early portions of ch:newelectrolytemodel provides a
thorough analysis  of the bottlenecks  of the quadratic approximation  model for
computing the  spatial profile  of ionic concentration  in the  electrolyte. The
conclusions drawn  from all aforementioned  analyses are presented  next. Topics
that may  be of interest to  future researchers engaging with  these rom
are also proposed.

Conclusions from analysis of the dra-based state-space rom

In ch:improveddra, svd of a large Block-Hankel matrix is identified
as a key computational bottleneck  in applying the classical dra procedure
for the hybrid rom discussed therein. It is concluded that this bottleneck
arises due  to the  slow dynamics of  solid phase diffusion  which leads  to the
aforesaid large sized Block-Hankel matrices.

To mitigate this  bottleneck, an improved dra scheme  was presented, whose
centrepiece is an iterative svd  algorithm. This algorithm was obtained as
a  combination of  the Golyandina-Usevich  and Lanczos  algorithms discussed  in
ch:improveddra.  The results  of applying  the improved  dra scheme
demonstrate  a significant  performance improvement  achieved by  using the  new
method  without trading-off  model  fidelity.  At a  single  operating point  of
soc  and temperature,  for  a  Hankel block  size  of 8000, the  rom
workflow incorporating the improved  dra is approximately 100 times faster
than that employing the classical  dra. On a standard computer workstation
whose  specifications  are  given in  ch:improveddra,  for  100 operating
points  (combinations of  10 soc  and temperature  values), obtaining  the
rom  required  only 6 hours  using  the  improved dra,  whereas  the
classical dra  consumed 666 hours (27 days). Furthermore,  for the
same block-size, the improved dra is  demonstrated to be superior in terms
of memory efficiency,  drastically reducing the memory  requirements from 112 GB
down to  2 GB. Finally, the  improved dra demonstrates  improved modelling
accuracy even  in moderately  equipped computing  environments such  as standard
consumer-grade laptops.

Future outlook for the dra-based hybrid state-space rom

The improved  dra method  proposed in  ch:improveddra opens  up the
possibility of  applying the  hybrid rom  modelling procedure  to physical
quantities in  other locations within the  cell's geometry  in the  middle of
the electrode region,  without being hindered by  computational limitations that
would  have otherwise  rendered  it intractable.  Furthermore, high  sample-rate
rom capable of handling highly dynamic  load profiles can be deployed in
future bms applications.  The proposed scheme also  empowers the rom
framework to tackle other cell chemistries with slower diffusion coefficients or
even  those with  completely different  rate-limiting mechanisms,  and therefore
prima facie, appears to be promising.



Despite   the  aforementioned   euphoric   possibilities   facilitated  by   the
streamlining  of  the reduced  order  modelling  workflow through  the  improved
dra,  there  exists a  fundamental  deficiency  in this  hybrid  modelling
approach  that impede  its near-term  adoption in  state estimation  tasks. This
aspect was already discussed in ch:littreview and is reiterated here. The
entries  in  the  matrices  of  the  final  state  space  model  depend  on  the
linearisation point of soc and temperature. This linearisation requirement
adversely affects the usability of the model for state estimation tasks, wherein
the soc is in fact an unknown quantity and is to be estimated. This cyclic
dependency  between  the linearisation  point  and  the state-estimation  entity
renders this  model questionable for use  in a demanding application  such as in
embedded bms on-board electric vehicles. Therefore, the immediate future
step is to analyse  the stability of this internal feedback  loop. Once this has
been performed,  researchers may consider to  engage in the process  of adapting
the derivation of this hybrid  state-space rom approach to higher C-rates,
in conjunction  with the numerical  benefits afforded by the  improved dra
developed here.

Conclusions from analysis of the spm family of models

Based    upon   the    holistic   evaluation    of   various    rom   in
ch:littreview,  owing   to  its  simplicity,  the   spm  family  of
models  was  identified  as  the  most promising  modelling  candidate  from  an
implementation  perspective. ch:spmanalysis  provided an  in-depth
analysis of the strengths and drawbacks of this modelling family.

Results from  simulation of  the basic spm  revealed that  two contrasting
aspects. Firstly, the  soc computation of the spm  was of acceptable
accuracy even at moderate C-rates thereby validating the fourth order polynomial
approximation approach  for capturing  solid phase diffusion  dynamics. However,
the basic  spm suffers  from severe inaccuracies  in computing  the cell's
terminal voltage  at currents above  0.5C. This dichotomous  behaviour, revealed
through  this  analysis, has  not  been  explicitly  commented upon  in  present
literature.  In  particular,  despite  its overarching  simplicity,  it  can  be
concluded that it is this contrasting  aspect that renders the model unusable as
the  plant model  for  state  estimation tasks.  This  is  because, the  voltage
measured  from the  model  in a  feedback  estimator shall  map  to a  radically
distant soc operating point requiring  excessively strong gain factors for
correcting it adversely affecting the stability of estimators.



Several  research efforts  from literature  that  have attempted  to tackle  the
voltage inaccuracies  of the  basic spm  through inclusion  of electrolyte
dynamics were also presented in  ch:spmanalysis. A critical evaluation of
each  of  the  salient  efforts  revealed that  a  suitable  approach  that  can
successfully handle all possible operational scenarios  is yet to be devised. In
particular, the  existing modelling approaches for  electrolyte inclusion either
made  far-fetched assumptions  that  were easily  violated  or presented  nearly
intractable  mathematical  expressions  that  pushed  the  spm  closer  in
computational complexity  to the  p2d dynamics.  My analysis  of pertinent
literature  also  revealed  the  possibility of  re-using  certain  portions  of
existing work  the electrolyte  overpotential expression, whilst also arguing
the need  for a fresh  approach to model  other aspects of  electrolyte dynamics
such as the ionic concentration profile within the cell's thickness.

The  final  section  of  ch:spmanalysis  presented  the  assumptions  and
governing equations of the popular quadratic approximation model for the spatial
profile of  ionic concentration. The  results obtained by simulating  this model
reveal that while its spatial  profile computation for a galvanostatic operation
is of  acceptable accuracy, the temporal  performance of the model  is mediocre.
Particularly, the time evolution of ionic concentration at the current collector
interfaces computed by the model fail to capture the intricacies in the temporal
evolution exhibited by  the p2d model's profile.  Furthermore, the spatial
profile uses  the qss approximation  which is violated during  the initial
transient. Hence, the  most impactful conclusion from the  foregoing analysis is
that the  basic quadratic approximation  model is unsuitable for  dynamic loads,
thereby ruling it out for deployment in vehicular applications.

The initial portions of ch:newelectrolytemodel analysed the causal factor
contributing to the mediocre performance of the quadratic approximation model.
For this analysis, a genetic programming approach was employed to synthesise
suitable alternative reduced order equations for modelling the spatial profile
of the electrolyte concentration. The foregoing analysis helped to reveal that
given the constraints and interior-point boundary conditions of the underlying
dfn model at the separator interfaces, the number of coefficients used in
the quadratic spatial profile does indeed make the best use of all available
equations. The genetic programming approach being able to synthesise suitable
mathematical structures that can potentially capture the spatial profile
accurately during both transient and steady state conditions. However, there is
a shortfall in the number of equations in order to uniquely solve for these
extra coefficients. The final conclusion that stems from this fact is that, by decoupling
the spatial and temporal profiles of the electrolyte concentration dynamics, the
performance of the present state of the art can indeed be improved upon.


Proposed analysis routes for the spm modelling family

Albeit extensive, the analyses of spm  performed in this thesis is by no
means complete. It is more appropriate to  say that this author chose to analyse
spm from  their implementation  perspective, particularly  their voltage
and soc  accuracies in  an open-loop  implementation. However,  a holistic
evaluation covering  other aspects  are necessary before  their deployment  in a
vehicular bms can be considered. For instance, the observability of models
must be  proven before  they can  be employed in  the feedback  path of  a state
estimator. Even  within the  broad stream of  observability analysis,  there are
several details that  need to be meticulously handled of  which some avenues for
future exploration are identified.

In the  simplification of the  state-vector of  the basic spm  proposed by
Di Domenico , the bulk concentration  in the two electrodes
was assumed to be equal  (see subsec:basicspmstatespace). This allowed to
eliminate the bulk concentrations of one of the two electrodes, thereby reducing
the state  vector to . This  assumption hinges  on the
assumption  that  there is  no  loss  of  cycleable  lithium. However,  such  an
assumption  is valid  only for  a brand  new cell.  As the  cell ages,  owing to
various  phenomena such  as parasitic  side reactions  and decomposition  of the
solid conductive matrix,  this assumption shall no longer  hold true. Therefore,
analysis  of models  obtained by  augmenting the  basic or  electrolyte-enhanced
spm  with equations  describing degradation  shall become  critical. Not
only does this force to retain both bulk concentrations in the state vector, the
states from the  degradation rate-equations appear in it,  thereby enlarging it.
In  future  studies, the  effect  of  these  augmented  state variables  on  the
observability of the system needs to be quantified.

In this thesis,  only an isothermal analysis of  various spm have
been performed. While this is an important initial step to analyse the strengths
and weaknesses of  the state of the art incumbent  spm models by isolating
the  purely  electrochemical  aspects,  the  effect  of  temperature  cannot  be
underplayed. It  is well-known that the  thermal conditions of the  cell affects
its  electrochemical  and  vice-versa.  Therefore, future  works  shall  benefit
from  performing  comprehensive   analyses  of  coupled  electrochemical-thermal
spm. Considering the simplicity of spm, the lumped thermal model
might be a suitable candidate for it be paired with. Finally, in addition to its
influence  on the  accuracy of  open-loop  terminal voltage  and soc,  the
effect of  temperature on the  observability of the  holistic model needs  to be
evaluated. Since the cell temperature is available as an additional measurement,
it is likely to improve the model's observability. However, there is a trade-off
since this comes at  the cost of increased size of the state  vector. It is also
worthwhile  to explore  the  inflection point  of this  trade-off  to limit  the
model's fidelity at  a sufficient level whilst reaping the  maximum gains out of
the additional temperature measurement.

Based upon the conclusion that the performance of any reduced order spatial
profile model is hamstrung by the equation deficiencies in the underlying
dfn model, it is worthwhile to reproduce the mggp approach with a
different pbm. For this future task, it is imperative to choose a model
that provides additional interior-point conditions  not just at the
separator, but perhaps a second order condition within an interior location at
each electrode. Once such a suitable pbm has been identified, this thesis
author is confident that the genetic programming approach shall indeed
synthesise an accurate description of the electrolyte's spatio-temporal
dynamics.

Implementation Aspects of Basic and Composite spm

A driving impetus behind this thesis is to deliver rom amenable  to
embedded implementation. Large portions of ch:spmanalysis and
nearly the entirety of ch:newelectrolytemodel were devoted to this study.
The conclusions that emerged from these implementation efforts are summarised
here. Future areas of research are also identified in-line.

In ch:spmanalysis, the aspects of discrete-time implementation in a
microcontroller were discussed. In particular, the computation of the
discrete-time system and input matrices through  the  matrix exponential
approach is presented. A straightforward conclusion from the discrete-time
implementation is that they run orders of magnitude faster than their
continuous-time counterparts. This is owing to the fact that adaptive
time-stepping integrators are not required and can be replaced by a simple
matrix-vector multiplication scheme. This implementation detail provides
necessary starting point for battery researchers to start coding the rom
discussed herein. Future work in this direction shall benefit from including
various real-world issues such as accounting for sample delays as well as
implementing a progressive update scheme for the matrix entries to account for
degradation effects. Important aspects of numerical implementation arise during
the design of state estimators. Having a robust open-loop implementation of a
discrete-time plant model shall facilitate easy implementation of such feedback
algorithms.

ch:newelectrolytemodel discussed the implementation aspects of rom
from a different perspective --- that of formulating a new electrolyte enhanced
composite spm for embedded implementation. The temporal evolution of
electrolyte dynamics in the two electrode regions were characterised through
system identification techniques that have never been tried before in
literature. The identified model structures are presented in the final form as
discrete-time difference equations that can be readily incorporated into the
discrete-time equations developed in ch:spmanalysis for the basic
spm. The salient conclusion from this modelling effort is that, system
identification is indeed a viable candidate for the derivation of rom of
lithium ion batteries. The improved accuracy of electrolyte concentration
dynamics relative to the state of the art quadratic approximation model
corroborates the success of this strategy. Nevertheless, before widespread
adoption of this technique can be advocated, certain aspects of this approach
must be examined carefully. For instance, the assumptions of linearity and
time-invariance must be revisited for higher magnitudes of charge and discharge
currents. Thermal effects must also be incorporated into the overall system
identification approach. Machine learning and system identification are two
complementary approaches to the same task  identification of internal
dynamics from terminal measurements. Future research could also explore this
possibility and perhaps a combined system identification/machine learning
strategy might metamorphose into the approach that powers future generation of
surrogate rom for electric vehicle applications.

Closing Remarks

The feasibility of bringing pbm of lithium batteries into electrified
transportation has been studied in this thesis from a multi-dimensional
perspective. Yet, there exists a common underpinning that connects these
seemingly different routes to enhancement of our extant knowledge --- that of
parametrising the underlying pbm. The number of parameters in any
pbm is excessively large to the point of detracting potential adopters.
Even without considering degradation effects, obtaining the physical, geometric,
transport and kinetic parameters of a cell shall require access to specialised
laboratory equipment that are sometimes exclusive to large scale research
organisations. The studies discussed here shall assume real-world significance
only upon a successful demonstration of a cost-effective parametrisation
strategy. The author's contributions to an optimal `Design of Experiments (DoE)'
numerical procedure for identifying the parameters of an spm is detailed
in . However, the broader task of parametrising a
full-order pbm is well beyond the scope of this thesis or indeed any
single researcher, and needs the concerted effort of the community as a whole to
tackle it.

The next task in the journey to real-world implementation of the advancements
brought about by this thesis is to  experimentally validate them. However, this
is contingent upon obtaining a successful parametrisation strategy, and should
be embarked upon as soon as a robust procedure to identify the physical
parameters is made available. Nevertheless, this author hopes that through the
three-pronged approach to cell modelling presented in this thesis, the goal of
bringing physics-based battery models to electrified transportation has been
brought a step closer to realisation.

 



          
    
    tocchapter
    








1.348361657291667      chapterappchap
    

Full Listing of Program Codes
[chapters]
[chapters]11


MATLAB codes for continuous-time SPM


[MATLAB code for simulation of continuous time SPM]chapters/Appendices/matlab_codes/cts_time_spm_simulation.msc:ctstimespm


MATLAB codes for discrete-time SPM
[MATLAB code for simulation of discrete time SPM]chapters/Appendices/matlab_codes/disc_time_spm_simulation_massive.msc:disctimespm




    

Permissions Summary
[chapters]
[chapters]11

Permissions Table



    
    
        
        
        [c]@ l  l p7.5cm l c c p1.6cm @
            Summary of permissions for reuse of third-party copyrighted material  


            
        1cPage 
 no. & Usage in 
 thesis & Source 
 of work & Copyright holder  
 Contact (organisations only) & Permission 
 requested on & Have 
 permission? & [lt]Permission 
 remarks 

        
        

        7c          --- continued from previous page 

        
        1cPage 
 no. & Usage in 
 thesis & Source 
 of work & Copyright holder  
 Contact (organisations only) & Permission 
 requested on & Have 
 permission? & Permission 
 remarks 

        
        

        
        7 r @Continued on next page 

        
        

        
       

           fig:energyvspowercell         & fig:energyvspowercell          & VonSrbik2015     & *VonSrbik2015          & N/A                                                                & Yes                            & CC-BY-NC-ND                                           

           fig:fig_CC_discharge_curves   & fig:fig_CC_discharge_curves    & Unpublished work            & Ian D. Campbell                    & 2018-09-30                                               & Yes                            & Written agreement                                     

           fig:1d_fv_mesh                & fig:1d_fv_mesh                 & Torchio2016      & Torchio2016            & 2018-09-28                                               & Yes                            & `Rightslink' service agreement attached               

           fig:anodeoverhangpouchcell    & fig:anodeoverhangpouchcell     & Bond2017         & Bond2017               & N/A                                                                & Yes                            & CC-BY                                                 

           fig:topologies                & fig:topologies                 & Northrop2011     & Northrop2011           & 2018-09-27                                               & Yes                            & `Rightslink' service agreement attached               

           fig:fig_generate_heatmap_BEV  & fig:fig_generate_heatmap_BEV   & Unpublished work            & Ian D. Campbell                    & 2018-09-30                                               & Yes                            & Written agreement                                     

           fig:fig_generate_heatmap_PHEV & fig:fig_generate_heatmap_PHEV  & Unpublished work            & Ian D. Campbell                    & 2018-09-30                                               & Yes                            & Written agreement                                     

           fig:fig_CapacityQuadrants     & fig:fig_CapacityQuadrants      & Unpublished work            & Ian D. Campbell                    & 2018-09-30                                               & Yes                            & Written agreement                                     

           ch:improveddra                & [lt]All figures,           
 tables and                 
 captions of                        
 ch:improveddra                                             & Gopalakrishnan2017  & [lt]The American Society                    
 of Mechanical Engineers   
 (ASME)  
 mailto:copyright@asme.comcopyright@asme.com  & 2016-04-19 & Yes & [lt]Copyright 
 agreement 

           fig:sandwichtospm             & fig:sandwichtospm              & Moura2012        & [lt]The American Society 
 of Mechanical Engineers                                           
 (ASME)                        
 mailto:copyright@asme.comcopyright@asme.com  & 2018-09-25       & Yes  & `Rightslink' service agreement attached                          
 fig:timingdiagramBig          & fig:timingdiagramBig           & Southward2011    & *Southward2011         & 2018-09-26                                               & Pending                        & Email request sent                                    

           fig:timingdiagramSmall        & fig:timingdiagramSmall         & PlettECE5540_02  & *PlettECE5540_02       & 2018-09-28                                               & Yes                            & By email                                              

           fig:coordsquadapprox          & fig:coordsquadapprox           & Deng2018         & [lt]Elsevier             
 mailto:permissions@elsevier.compermissions@elsevier.com  & 2018-09-27           & Yes                                                    & Elsevier license attached 


        
   
    

 


Copyright Permissions for Torchio 
[pages=-,scale=0.85,pagecommand=]chapters/Appendices/redacted_JES_Torchio_permission_pdf.pdf
Copyright Permissions for Northrop 
[pages=-,scale=0.85,pagecommand=]chapters/Appendices/redacted_Northrop_permission_pdf.pdf
Copyright Permissions for Moura 
[pages=-,scale=0.925,pagecommand=]chapters/Appendices/redacted_Moura_etal_permissions.pdf
Copyright Permissions for Gopalakrishnan 
[pages=-,scale=0.925,pagecommand=]chapters/Appendices/asme_copyright.pdf
Copyright Permissions for Deng 
[pages=-,scale=0.85,pagecommand=]chapters/Appendices/redacted_Deng_copyright.pdf
Copyright Agreement --- Krishnakumar Gopalakrishnan and Ian D. Campbell
[pages=-,scale=0.85,pagecommand=]chapters/Appendices/campbell_krishna_agreement.pdf









