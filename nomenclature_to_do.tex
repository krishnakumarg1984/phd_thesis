Let  $Q_\text{e,j}$  denote  the  number  of moles  of  \ch{Li^+}~ions  in  the
electrolyte per  unit cross-sectional  area within each  region~$\jinnegseppos$.
This is  computed as  the product  of
\begin{enumerate*}[label=\emph{\alph*})]
    \item the porosity and
    \item spatial integral of the concentration function
\end{enumerate*}
\ie~${ Q_\text{e,j}  =  \varepsilon_j \int_0^{l_j}  c_{\text{e},j}(z) \,dz  }$.
Applying this to \crefrange{eq:cenquadreduced}{eq:cepquadreduced}
\begin{align}
    Q_\text{e,n} &= \varepsilon_\text{n} \left( \frac{1}{3} a_2 l^3_\text{n} + a_0 l_\text{n}\right)\label{eq:Qenbyintegration}\\
    Q_\text{e,s} &= \varepsilon_\text{s} \left( \frac{1}{3} a_5 l^3_\text{s} + \frac{1}{2} a_4 l^2_\text{s} + a_3 l_\text{s}\right)\\
    Q_\text{e,p} &= \varepsilon_\text{p} \left( \frac{1}{3} a_8 l^3_\text{p} + a_6 l_\text{p}\right) \label{eq:Qepbyintegration}
\end{align}

At this stage,  $Q_{\text{e},j}(t)$~are unknown. Since  these are time-dependent
functions,  the  derivation  naturally  progresses  towards  seeking  a  set  of
\glspl{ode} that describe a relationship  for their time evolution. Transforming
the  \engordnumber{2}   order  \glspl{ode}  of \cref{eq:dfnliquiddiff}   (for  electrodes)
and \cref{eq:liquiddiffnsep}   (for  separator)   to   their  respective   local
co-ordinates and integrate  once along the thickness of  each region. Performing
this sequence of steps for the negative electrode region
\mathleft
\begin{equation}
    \begin{WithArrows}[b]
        \varepsilon_\text{n} \int_0^{l_\text{n}} \left(\diffp*{c_\ensub(z,t)}{t}\right)\, dz &= \int_0^{l_\text{n}} \left(\diffp{}{z}\left(D_\effn \diffp{c_\ensub}{z} \right) + (1 - t^0_\text{+}) a_\snsub j_\text{n}\right)\, dz \Arrow[tikz={text width=3.4cm}]{transposing integration \& differentiation operations in the \glsfmtshort{lhs}} \\
        \varepsilon_\text{n} \diffp*{\int_0^{l_\text{n}} c_\ensub(z,t)}{t}\, dz &=
        \int_0^{l_\text{n}} \left(\diffp{}{z}\left(D_\effn \diffp{c_\ensub}{z}
        \right) + (1 - t^0_\text{+}) a_\snsub j_\text{n}\right)\, dz
        \Arrow[tikz={text width=3.4cm}]{apply time-derivative operator to the whole \glsfmtshort{lhs}}\\
        \diffp*{\left(\tikzmark{StartBraceA}\varepsilon_\text{n} \int_0^{l_\text{n}}
c_\ensub(z,t)\, dz\tikzmark{EndBraceA}\right)}{t} &=  \int_0^{l_\text{n}}
\left(\diffp{}{z}\left(D_\effn \diffp{c_\ensub}{z} \right) + (1 -
    t^0_\text{+}) a_\snsub j_\text{n}\right)\, dz \Arrow[tikz={text
width=3.4cm}]{apply integral to the \glsfmtshort{rhs}}\\
        \diff*{Q_\text{e,n}(t)}{t} &= D_\effn \diffp{c_\ensub}{z}{\mathrlap{z=l_\text{n}}} + (1 - t^0_\text{+}) a_\snsub \int_0^{l_\text{n}} j_\text{n}\, dz
    \end{WithArrows}
    \label{eq:negliionmolestoreduce}
\end{equation}
\mathcenter
\InsertUnderBrace[draw=black][aspect=0.26]{StartBraceA}{EndBraceA}{} % https://tex.stackexchange.com/questions/68526/asymmetric-overbrace
Performing     the     identical     sequence     of     operations     starting
from~(\cref{eq:liquiddiffnsep}) for  the separator and~(\cref{eq:dfnliquiddiff})
for the positive electrode yields
\begin{align}
    \diff*{Q_\text{e,s}(t)}{t} &= D_\effs \diffp{c_\essub}{z}{\mathrlap{z=l_\text{s}}} \label{eq:sepliionmolestoreduce}\\
    \diff*{Q_\text{e,p}(t)}{t} &= D_\effp \diffp{c_\epsub}{z}{\mathrlap{z=l_\text{p}}} + (1 - t^0_\text{+}) a_\spsub \int_0^{l_\text{p}} j_\text{p}\, dz\label{eq:posliionmolestoreduce}
\end{align}

In    order    to   evaluate    the    integral    term   in    the    \gls{rhs}
of \cref{eq:negliionmolestoreduce}    and \cref{eq:posliionmolestoreduce},   the
solid  phase  charge  conservation  equation~(\cref{eq:solidchargeconserve})  is
integrated  along the  local  co-ordinate  axis of  the  negative electrode  and
positive electrode respectively.
\begin{align}
    \int_0^{l_\text{n}} j_\text{n}\, dz & =  \frac{I}{a_\snsub A F} \label{eq:negfluxintegral}\\
    \int_0^{l_\text{p}} j_\text{p}\, dz & =  \frac{-I}{a_\spsub A F}\label{eq:posfluxintegral}
\end{align}

Substituting       \crefrange{eq:negfluxintegral}{eq:posfluxintegral}       into
\crefrange{eq:negliionmolestoreduce}{eq:posliionmolestoreduce} respectively,
\begin{align}
    \allowdisplaybreaks
    \diff*{Q_\text{e,s}}{t} &= D_\effn \diffp{c_\ensub}{z}{\mathrlap{z=l_\text{n}}} - (1 - t^0_\text{+}) \cancel{a_\snsub} \frac{I}{\cancel{a_\snsub} A F} \\
    \diff*{Q_\text{e,p}}{t} &= D_\effp \diffp{c_\epsub}{z}{\mathrlap{z=l_\text{p}}} - (1 - t^0_\text{+}) \cancel{a_\spsub} \frac{-I}{\cancel{a_\spsub} A F}
\end{align}
which leads to the general expressions  for the cross-sectional molar density of
\ch{Li^+}~ions in each of the three regions as
\begin{align}
    \diff*{Q_\text{e,n}}{t} & = D_\effn \diffp{c_\ensub}{z}{\mathrlap{z=l_\text{n}}} + (1 - t^0_\text{+}) \frac{I}{A F} \label{eq:negliionmolesgen} \\
    \diff*{Q_\text{e,s}}{t} & = D_\effs \diffp{c_\essub}{z}{\mathrlap{z=l_\text{s}}} \label{eq:sepliionmolesgen}                                             \\
    \diff*{Q_\text{e,p}}{t} & = D_\effp \diffp{c_\epsub}{z}{\mathrlap{z=l_\text{p}}} - (1 - t^0_\text{+}) \frac{I}{A F}\label{eq:posliionmolesgen}
    \intertext{Substituting the assumed quadratic expressions for electrolyte concentrations in
        each of the three regions \crefrange{eq:cenquadreduced}{eq:cepquadreduced}
    in the above system \ie~\crefrange{eq:negliionmolesgen}{eq:posliionmolesgen}}
    \diff*{Q_\text{e,n}}{t} & = 2 a_2 l_\text{n} D_\effn + (1 - t^0_\text{+}) \frac{I}{A F} \label{eq:negliionmolesquadratic}                                \\
    \diff*{Q_\text{e,s}}{t} & = 2 a_5 l_\text{s} D_\effs\label{eq:sepliionmolesquadratic}                                                                                                     \\
    \diff*{Q_\text{e,p}}{t} & = 2 a_8 l_\text{p} D_\effp - (1 - t^0_\text{+}) \frac{I}{A F} \label{eq:posliionmolesquadratic}
\end{align}
The  initial   ionic  concentration   in  the   electrolyte  is   identical  in
all  three  regions  of  the  cell,  assuming  equilibrium  starting  conditions
\ie~${c_{\text{e,0}_j}  = c_\text{e,0},  \jinnsp}$.  Hence the  initial number  of
moles of \ch{Li^+} per unit area in each of the three regions is given by
\begin{align}
    Q_\text{e,n}(0) & = \varepsilon_\text{n} c_\text{e,0} l_\text{n} \label{eq:Qeninit}\\
    Q_\text{e,s}(0) & = \varepsilon_\text{s} c_\text{e,0} l_\text{s}\\
    Q_\text{e,p}(0) & = \varepsilon_\text{p} c_\text{e,0} l_\text{p} \label{eq:Qepinit}\\
    \shortintertext{and the initial coefficient vector which satisfies the system
    equations is obtained as}
    \begin{bmatrix}
        a_0 \\
        a_2 \\
        a_3 \\
        a_4 \\
        a_5 \\
        a_6 \\
        a_8
        \end{bmatrix} & = \begin{bmatrix}
        c_\text{e,0} \\
        0 \\
        c_\text{e,0} \\
        0 \\
        0 \\
        c_\text{e,0} \\
        0
    \end{bmatrix} \label{eq:coeffinit}
\end{align}

The             system             of             three             \glspl{ode},
\eqref{eq:negliionmolesquadratic}--\eqref{eq:posliionmolesquadratic}    together
with  \crefrange{eq:Qeninit}{eq:Qepinit}  representing the  initial  conditions,
form   an    \gls{ivp}.   \Crefrange{eq:cecontinuitynegsep}{eq:Qepbyintegration}
represent a square system of seven linear algebraic equations with seven unknown
coefficients which must be solved at each time-step. These algebraic constraints
coupled with the aforementioned \gls{ivp} form a \gls{dae} system.

There are now two choices for proceeding  with solution of the system. The naive
approach  would be  to  solve  the \gls{dae}  using  advanced \gls{dae}  solvers
specially designed to handle \mbox{index-1}  semi-explicit systems such as
DASSL~\cite{Petzolddassl}
and  DASPK~\cite{VanKeken1995}. For  start-stop  type  of input  currents  with discontinuities,  the
consistent initialisation of algebraic conditions and derivatives is numerically
challenging.  All   \gls{dae}  solvers  typically  use   adaptive  time-stepping
algorithms.  The  feasibility of  using  such  a  complex scheme  for  real-time
computation is questionable. On the other hand, the overall system can be viewed
as composed of two numerical subsystems ---
\begin{enumerate*}[label=\emph{\alph*})]
    \item an independent \gls{ode} system, and
    \item an independent algebraic system.
\end{enumerate*}
Each system  is executed  back to  back in succession  using solutions  from the
other system from the previous time-step.

To  clarify  the sequence  of  operations,  in  order  to bootstrap  the  model,
it  is  required  to  compute  $Q_{\text{e},j}(t)$ in  all  three  regions.  The
\gls{ode} system is  integrated for one time-step by  retaining the coefficients
at  their initial  value.  The $Q_{\text{e},j}(t)$  thus  solved is  substituted
into  the  algebraic system  to  yield  the  updated  value of  the  coefficient
vector~$\vec{a}(t=t_k)$. This new value of the coefficient vector is substituted
back  into  the  \gls{ode}  system  and  the  process  continues.  Although  the
continuous simulation of  the overall \gls{dae} is not accomplished,  this scheme is
pragmatic from an engineering viewpoint. This is because,  the periodic pauses needed to update
the intertwined  sub-systems translate  naturally into  fixed time-steps  and is
well-suited for a \gls{bms} controller operating at a fixed sample rate. This is
also an effective workaround to mitigate the complexities of having to implement
and solve \glspl{dae} in real time.

The   simulation   results   of   the   quadratic   approximation   scheme   and
the   analysis   of   its   strengths   and   weaknesses   is   presented   next
in \cref{subsec:quadraticsimresultsanalysis}.

\subsection{Numerical implementation, simulation results and analysis}\label{subsec:quadraticsimresultsanalysis}

\subsubsection*{Numerical implementation}
From an analysis point of view,  the quadratic approximation model for computing
the  spatio-temporal evolution  of  electrolyte concentration  can be  simulated
as  an  independent subsystem,  and  hence  can  be implemented  numerically  as
a  standalone  module as  shown  in  \cref{alg:quadraticce}. In  practice,  this
modular code  is embedded as  a subroutine within  the main \gls{spm}  loop (see
\cref{alg:disctimespm}).

\begin{algorithm}[!htbp]
    \caption{Quadratic approximation model for spatio-temporal electrolyte concentration}\label{alg:quadraticce}
    \addtocontents{loa}{\vskip 9pt} % https://latex.org/forum/viewtopic.php?t=6218
    \begin{algorithmic}[1]
        \Require Load profile \Comment{\eg~a \texttt{csv} file of $t$ vs.\ C-rate}
        \Require Electrolyte model parameter set  \Comment{\eg~stored in a struct \texttt{ceparams}}
        \Userdata $ t_\text{f}$,  sample rate $T_s, c_\text{e,init}$
        \Function{QuadraticElectrolyteModel}{}
        \State Set $Q_{\text{e,init}_j}$ as per \crefrange{eq:Qeninit}{eq:Qepinit}
        \State $\vec{a}[1]$ \gets values from \cref{eq:coeffinit}
        \State $V_\text{cell}[1] \gets \textsc{ComputeCellVoltage}(\textbf{x}[1],I[1],\texttt{params})$ \Comment{from direct feedthrough}
        \For{$k \gets 2 : N_\text{max}$}
        \State $I[k] \gets $ interpolate from profile using \gls{zoh}
        \State Solve continuous-time state equations--\crefrange{eq:negliionmolesquadratic}{eq:posliionmolesquadratic} \Comment{Using $\vec{a}[k-1]$}
        \State $Q_{\text{e}_j}[k]$ \gets last time-entry  vector of soln.\  matrix \Comment{if using an adaptive solver}
        \State $\vec{a}[k]$ \gets solution of \emph{linear} system of equations--\crefrange{eq:cecontinuitynegsep}{eq:Qepbyintegration} \Comment{Using $Q_{\text{e}_j}[k-1]$}
        \State Compute $c_{\text{e}_j}$ as per \crefrange{eq:cenquadreduced}{eq:cepquadreduced} \Comment{Quadratic polynomial expressions for concentration}
        \EndFor
        \EndFunction
    \end{algorithmic}
\end{algorithm}

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\textwidth]{quadratic_ce_approx_spatial_1C.pdf}
    \caption[Spatial distribution of electrolyte concentration for 1C~discharge]{Spatial distribution of ionic concentration in electrolyte along
        cell thickness at various snapshots of time for a 1C~discharge. The
        concentration profile obtained from simulating the \glsfmtshort{p2d}
        model is used as the reference. The performance of the quadratic model
        is quite poor during the initial transient duration, but improves over
    time as a quasi-steady state is reached.}
    \label{fig:spatialionicconc1C}
\end{figure}

\subsubsection*{Simulation results}\label{subsubsec:simresultsbaselinequad}

\Cref{fig:spatialionicconc1C} shows  the spatial distribution of  \ch{Li^+}~ions
in electrolyte  along the  thickness of  the cell at  various snapshots  of time
obtained by simulation  of the \gls{p2d} and the  quadratic approximation models
using a  1C~discharge current. The  \gls{p2d} model's response is  considered as
the reference benchmark.  During the initial transient  phase, the concentration
profile within each electrode region exhibits a characteristic inflection point.
During this phase,  the concentration profile computed by  the parabolic profile
exhibits  a  large deviation  in  terms  of  percentage  error at  each  spatial
location. However, with the passage of time, as a \gls{qss}~is established, this
inflection point flattens out, and the quadratic approximation becomes closer to
the  true  concentration value  at  each  spatial  location. Similar  trends  in
behaviour is  exhibited for discharge and  charging at higher C-rates  and these
results are  therefore omitted here  in the  interest of keeping  the discussion
succinct.

It  is important  to  note that  while having  a  spatial concentration  profile
is  useful,  as  seen  in \cref{eq:electrolytepdwithce}, it  is  the  values  of
concentration  at   the  \emph{current  collector  interfaces}   that  are  most
influential in  computation of the  electrolyte overpotential and hence,  in the
voltage accuracy of the enhanced \gls{spm}. Thus, it is important to obtain this
alternative perspective  of time-evolution  of the electrolyte  concentration at
the two current collectors.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{ce_at_cc_1Cdischg.pdf}
    \caption[Ionic concentrations at current collector
    interfaces over time for 1C~discharge]{Evolution of ionic concentration over
        time at the two current collector interfaces for a 1C~discharge (top
        row). The time evolution of the corresponding error variables is also
    shown (bottom row).}
    \label{fig:temporalcequadratic}
\end{figure}

\Cref{fig:temporalcequadratic} shows  the time evolution of  ionic concentration
in  the electrolyte  at the  two current  collector interfaces  computed by  the
\gls{p2d} and  quadratic approximation  models for a  1C~discharge  current. The
concentration  values computed  by  the  \gls{p2d} model  is  considered as  the
reference benchmark. At the negative electrode--current collector interface, the
ionic  concentration  exhibits  a  few oscillations  of  small  amplitude  owing
to  the complex  interactions  of  the ionic  phase  with  the porous  electrode
and  the charge  transfer process  at the  electrode-electrolyte boundary.  The
concentration  evolution  predicted  by  the quadratic  approximation  model  is
rather  simplistic  and  is  unable to  capture  this  intricate  time-evolution
pattern.  This  is because  the  governing  equation predicting  time  evolution
of  concentration  in  the  quadratic  approximation  model  is  that  given  by
the  \emph{first-order}  \gls{ode} of \cref{eq:negliionmolesquadratic}  (with  a
proportional mapping from~$Q_\text{e,n}$ to~$c_\text{e}(0,t)$). Following system
theory, the step response  of a first order \gls{ode} is  that of an exponential
rise to a final settling value, which  is exactly the shape seen in the top-left
plot of \cref{fig:temporalcequadratic}.

The ionic  concentration evolution  at the positive  current collector  does not
exhibit major oscillations  and even has a subtle monotonicity  to its response.
However,  the  classical  first  order  response  predicated  by  the  quadratic
approximation model falls short of representing its complete dynamics. Errors of
similar  magnitude  are present  in  the  ionic  concentration at  both  current
collector  interfaces, with  a maximum  absolute error  of \approx\SI{250}{\mole
\per \meter  \cubed}.

This  chapter concludes  with a  view that,  while the  spatial accuracy  of the
quadratic  approximation  model  is  acceptable,  its  temporal  performance  is
lacklustre. The causal factors for this  mediocre performance is analysed in the
context of  the author's  own attempts  in arriving  at an  enhanced electrolyte
model and is presented next in \cref{ch:newelectrolytemodel}.

\setcounter{chapter}{5}

\clearpage
\chapter{Implementing a New Electrolyte Model for Augmentation of the Basic \glsfmtshort{spm}}\label{ch:newelectrolytemodel}
\startcontents[chapters]
\printcontents[chapters]{}{1}{\setcounter{tocdepth}{1}}

\bigskip

\capolettera{B}{ased}  upon  the insights  gained  from  the extensive  analyses
performed in  \cref{ch:spmanalysis}, this  chapter presents the  thesis author's
attempts to  surpass the performance  of the  current pinnacle in  modelling art
through the development of a new  electrolyte model. In particular, this chapter
describes  the attempts  towards  arriving  at an  accurate  description of  the
spatio-temporal  evolution of  the electrolyte  concentration in  a lithium  ion
cell. The performance of the  quadratic approximation model which was introduced
in \cref{ch:spmanalysis} is analysed through the novel application of a symbolic
regression framework. This  helps to expose the issue of  equation deficiency in
the underlying \gls{dfn} model and questions  its suitability for the purpose of
reduced  order  modelling  of  the electrolyte  concentration  dynamics  with  a
pre-assumed equation structure. Although this framework did not ultimately yield
the desired outcomes, it did nevertheless facilitate a comprehensive analysis of
the  strengths  and  weaknesses  of  the  quadratic  approximation  model  which
has  not  been performed  in  existing  literature.  Next, the  author's  unique
contribution to the art of single particle modelling \viz~a novel time-evolution
model of  electrolyte concentration evolutions  through the technique  of system
identification  is  presented. The  results  of  the  new approach  is  compared
against  the baseline  quadratic approximation  model as  well as  the benchmark
\gls{p2d}  model. Finally,  the new  model  equations are  incorporated into  an
electrolyte-enhanced  \gls{spm}  and  the  improved  performance  of  the  newly
developed composite model is quantified.

\section{Performance Analysis: Quadratic Approximation Model}\label{sec:symbolicregression}

In the  author's analysis of the  quadratic approximation model, the  origin and
nature of  its sub-optimal  performance can  be explained  as per  the following
rationale. The quadratic  approximation model uses a  bottom-up approach wherein
the final  simplified model structure  is pre-assumed  and then the  physics are
made  to  fit  within  this  framework. Given  that  the  top-down  approach  to
electrolyte  modelling \ie~accounting for  all physical  phenomena and  then
simplifying  them yields  mathematically intractable  and overly  complex models
(see \cref{sec:electrolyteinclusion} for  a detailed discussion),  this approach
seems to be a pragmatic alternative  to enhancing the \gls{spm} with electrolyte
dynamics. However, a detailed look at  this model from an alternate viewpoint is
necessary for further analysis.

\subsection{Symbolic regression using \glsfmtlong{mggp}}\label{subsec:symbolicreg}

The  question boils  down to  whether a  quadratic approximation  is indeed  the
\emph{best}  model structure  that  can  be assumed  a~priori  for the  spatial
profile  of  ionic  concentration  in  the  electrolyte.  This  author  embarked
on  a journey  to  find  suitable alternate  model  structures \ie~a  single
family of  curves that can  capture both  the transient and  \gls{qss} behaviour
exhibited by  the ionic  concentration. The open-source  \textsc{MATLAB} toolbox
GPTIPS2~\cite{Searson2015}  uses the  state-of-the-art  \gls{mggp} approach  for
symbolic data  mining and is ideally  suited for such symbolic  regression tasks
(fitting a  mathematical equation structure,  and not merely  obtaining best-fit
coefficients to a  pre-assumed curve as in classical numerical  regression, to a
given data).

In employing the \gls{mggp} approach, it  is important to recognise that the key
criteria that restricts
\begin{enumerate*}[label=\emph{\alph*})]
    \item the choice of  gene-sequence depth, as well as
    \item the choice in number of parent mutations,
\end{enumerate*}
is  the   total  number  of   unknown  symbolic  coefficients  required   to  be
solved  in the  assumed  model  structure. There  are  a  total of  \emph{seven}
linear   equations  available   from  the   physics  of   the  \gls{dfn}   model
(see \crefrange{eq:cecontinuitynegsep}{eq:Qepbyintegration}). Hence, in order to
guarantee  a solution  the  assumed  family of  curves  cannot  consist of  more
than  seven coefficients.  Furthermore, for  a  unique solution,  the number  of
coefficients must be \emph{exactly} seven. Yet another restriction on the choice
of locus of feasible  curves arises due to the fact that  the behaviour of ionic
concentration  in the  negative and  positive electrode  regions are  similar in
complexity\footnote{\label{fn:complexity}The  concept  of complexity  of  curves
used  here is  not  based on  a  precise mathematical  definition  such as  that
employed by Neumann-Coto and Arenas~\cite{Neumann-Coto2017}, but is loosely used
to simply  convey an empirical sense  of their curvature. However,  the analysis
here applies  to the more  rigorous definition as well.},  and hence need  to be
mathematically described by an identical family of curves.

Upon a close inspection of the  spatial concentration profile from the \gls{p2d}
simulation  results shown  in \cref{fig:spatialionicconc1C},  it is  evident the
electrolyte approximation  functions within the  electrode regions is  of higher
complexity\textsuperscript{\ref{fn:complexity}} than  the approximation function
suitable  for  use  in  the  separator  region. Based  on  the  results  of  the
quadratic  model, it  is  clear  that at  least  two  coefficients are  required
within the  electrode regions \ie~${n_{\text{c,elec}}  \ge 2}$. There  exists an
inhibiting  factor that  prevents  the  use of  a  lower  order function  within
the  separator. As  per  the  simulation results  of  the  \gls{p2d} model,  the
time-domain  change  of number  of  moles  per  square  meter in  the  separator
is  non-zero.  Since  the  time-derivative   of  a  linear  approximation  applied
to  \cref{eq:sepliionmolesquadratic} is  zero,  this  straight-line equation  is
immediately ruled out. Among the  non-polynomial mathematical curves tried (such
as trigonometric, hyperbolic, power series  among others), none could obtain the
relatively simple shape of the separator function without being forced to reduce
the  contribution from  one  of  the coefficients  to  below machine  precision.
This necessitates  the retention  of the  quadratic approximation  function used
thus  far  (with  no  missing  terms)  \ie~${n_\text{c,sep}  =  3}$.  Thus,  the
overall number of  coefficients in the best possible  approximation shall be~${2
n_\text{c,elec} + n_\text{c,sep} = 2\cdot2 + 3  = 7}$, which is the total number
of electrolyte-specific physical constraints available from the \gls{dfn} model.
Hence it  can be concluded  that the  quadratic approximation model  does indeed
make the \emph{best}  use of all of the available  physical equations. The final
question remains to  answer is, with these coefficient  limitations, whether the
quadratic  equation structure  indeed  the optimal  one.  This was  investigated
through the \gls{mggp} approach described next.

The GPTIPS2  toolbox uses a variety  of heuristic algorithms from  the theory of
\gls{mggp}  to hypothesise  a suitable  equation structure  for the  data to  be
fitted.  The dataset  consisted of  the  simulation results  from the  \gls{p2d}
model,  in particular  the  values  of electrolyte  concentration  at the  three
different cell  regions captured  at various snapshots  of time.  Both transient
and  \gls{qss} data  were  fed into  this  symbolic data  mining  process and  a
single all-encompassing  family of curves  capable of capturing  the electrolyte
concentration behaviour was  sought for. However, the constraints  in the number
of coefficients that  can be employed results  in a restriction of  the depth of
gene  mutations as  well  as the  number of  parent/seed  populations. The  best
equation set  (without strictly  enforcing the aforementioned  hard constraints,
yet  minimising  the  distance  to  the constraint  vector)  that  the  symbolic
regression approach yielded was
\begin{alignat}{2}
    c_\ensub(z,t) & = a_2(t) \cosh z^2 + a_1(t) \sinh z + a_0(t) \qquad &  & 0 \le z \le l_\text{n} \label{eq:cnstrviolneg} \\
    c_\essub(z,t) & = a_5(t) z^2 + a_4(t) z + a_3(t) \qquad             &  & 0 \le z \le l_\text{s}                         \\
    c_\epsub(z,t) & = a_8(t) \cosh z^2 + a_7(t) \sinh z + a_6(t) \qquad &  & 0 \le z \le l_\text{p}\label{eq:cnstrviolpos}
\end{alignat}

Although \crefrange{eq:cnstrviolneg}{eq:cnstrviolpos}  fit   the  transient  and
\gls{qss}  profiles  well,  they  violate   the  constraint  on  the  number  of
coefficients  available resulting  in  an under-determined  system of  equations.
Both  the least-squares  and  least-norm  solution of  this  system were  tried.
However, the  results were inferior to  that produced by the  baseline quadratic
approximation method.

Next, an  attempt was made to  obtain different mathematical structures  for the
transient phase  and \gls{qss}  phase both  of which  respect the  constraint on
number  of  coefficients  allowed.  The symbolic  regression  outputs  for  this
approach are shown in \cref{tbl:symbreg}.

\begin{table}[!htbp]
    \centering
    \caption[Transient \& \glsfmtshort{qss} expressions for electrolyte
    concentration obtained by \glsfmtshort{mggp}]{Best fit expressions for the
        transient and \glsfmtlong{qss} approximaton functions for the
    electrolyte functions obtained by the \gls{mggp} approach.}
    \label{tbl:symbreg}
    \begingroup
    \addtolength{\jot}{0.25em}
    \begin{tabular}{@{} c c r @{}}
        \toprule
        \multicolumn{1}{l}{Transient Function} & \multicolumn{1}{c}{\glsfmtlong{qss} Function} & \multicolumn{1}{c}{Region} \\
        \midrule
        $\begin{aligned}
            c_{\text{e,n}_\text{trans}} &= a_1 z^6 \ln z^6 + a_0 \\
            c_{\text{e,s}_\text{trans}} &= a_4 z^2 + a_3 z + a_2 \\
            c_{\text{e,p}_\text{trans}} &= a_6 z^6 \ln z^6 + a_5 \\
        \end{aligned}$ &
        $\begin{aligned}
            c_{\text{e,n}_\text{QSS}} &= a_1 \sinh z^2 + a_0 \\
            c_{\text{e,s}_\text{QSS}} &= a_4 z^2 + a_3 z + a_2 \\
            c_{\text{e,p}_\text{QSS}} &= a_6 \sinh z^2 + a_5
        \end{aligned}$ &
        $\begin{aligned}
            &0 \le z \le l_\text{n} \\
            &0 \le z \le l_\text{s} \\
            &0 \le z \le l_\text{p}
        \end{aligned}$
        \\
        \bottomrule
    \end{tabular}
    \endgroup
\end{table}

Although  the equations  from \cref{tbl:symbreg}  produced  a markedly  improved
response during the transient phase,  the performance during the \gls{qss} phase
was merely at par to the baseline quadratic approximation model. This raised the
prospect of  employing a  blended approach, wherein  a model  changeover between
the  transient  and \gls{qss}  was  contemplated.  However,  since there  is  no
precise definition  of what constitutes  the transient phase of  the electrolyte
concentration response, this  approach required some ad-hoc  timing criteria for
correctly  transitioning  between  the  two \gls{mggp}  equation  sets.  Further
complications arise  during dynamic input conditions,  wherein the concentration
profiles are mostly in a state of  flux and could linger for longer durations at
the contiguous  boundary between  transient-like and  \gls{qss}-like behaviours.
In  the  interest  of  reproducibility  across  different  cell-chemistries  and
corresponding parameter sets, the proposed blended model transition approach was
not further pursued.

Overall,  the  long  and  arduous  process of  symbolic  regression  was  not  a
definitive  success in  this  case  mainly due  to  the  limitation of  equation
deficiency  of physical  constraints. Perhaps  if yet  another \gls{pbm}  \ie~an
alternative  to  the widely  prevalent  \gls{dfn}  model,  can  be used  as  the
baseline,  a  few more  physical  governing  equations  could possibly  be  made
available.  This  can  perhaps  result   in  a  less  restrictive  gene-set  for
coefficient  determination  and  consequently  pave the  way  for  a  successful
implementation  through  this  hitherto  unexplored  route  of  \gls{mggp}-based
equation synthesis.

In conclusion,  the quadratic model for  electrolyte concentration approximation
makes the  best use of the  available physical equations. Given  the constraints
with  respect to  physical equations  discussed here,  it is  also deemed  to be
the  optimum  family  of  a~priori  chosen  curves  capable  of  modelling  the
\emph{spatial}  profile of  ionic concentration.  Notwithstanding these  merits,
the  \emph{temporal}  performance of  the  quadratic  approximation approach  is
sub-optimal as seen in \cref{fig:temporalcequadratic}. The author of this thesis
addresses this specific issue with a completely different approach that shall be
discussed next in \cref{sec:newelectrolytemodel}.

\section{A New Electrolyte Model through System Identification}\label{sec:newelectrolytemodel}

Having performed a  comprehensive analysis of the state of  the art in \gls{spm}
modelling with electrolyte  dynamics, this section presents  the author's unique
contribution to the field. Firstly, the scope of the contribution is identified.
The methodology adopted and corresponding results are presented thereafter.

\subsection{Scope and motivation}\label{subsec:scopenewelectrolyte}

This subsection is intended as a capstone summary helping to briefly recount the
discussion so far  and to provide a  context for the author's work  in the wider
realm  of the  \gls{spm}  modelling art.  In  the same  vein  as the  discussion
in \cref{sec:electrolyteinclusion}, the scope of the proposed enhancement to the
\gls{spm}  concerns  entirely with  improving  the  electrolyte subsystem  since
it  has already  been established  in \cref{subsec:simresultsbasicspm} that  the
simplified representation  of the solid-phase  subsystem through a  fourth order
polynomial approximation method for diffusion of \ch{Li^0} in the solid particle
is of sufficiently high accuracy.

Inspecting the electrolyte domain, the contribution of electrolyte overpotential
to  terminal  voltage   consists  of
\begin{enumerate*}[label=\emph{\alph*})]
    \item diffusion   overpotential
    \item time-dependent   ohmic  losses   that  originates   from  differential concentration  gradients  (that  is   indirectly  dependent  upon
concentration).
\end{enumerate*}
Once       electrolyte        concentration       at        each       time-step
is         available, \cref{eq:electrolytepdwithce}          proposed         by
Prada~\etal~\cite{Prada2012}  may  be  used for  the  electrolyte  overpotential
computation.  Hence, the  accurate  determination of  spatio-temporal values  of
electrolyte concentration merits focus.

There exists a  subtle detail in the  use of \cref{eq:electrolytepdwithce} which
is discussed here upfront before proceeding  ahead to the refined context of the
author's work. The intrinsic conductivity of electrolyte~$\kappa$ is a function
of the ionic concentration  (refer \cref{subsec:basicspmsimsetup}). If the ionic
concentration at  the corresponding current  collectors are used  for evaluating
$\kappa_\text{neg}$  and  $\kappa_\text{pos}$, this  would  lead  to a  lopsided
computation of the overpotential in electrolyte. Furthermore, under this scheme,
the computation of electrolyte conductivity shall be rendered ambiguous since it
is unclear which  separator interface shall be chosen for  the separator's ionic
concentration. Although this  has not been discussed clearly  in literature, the
author  of this  thesis chose  to use  the mean  concentration within  each cell
region, defined as
\begin{equation}
    \mean{c}_{\text{e},j}(t) = \frac{1}{l_j}\int_0^{l_j} c_{\text{e}_j}(z,t)\, dz = \frac{Q_{\text{e,}j}(t)}{\varepsilon_j l_j}
\end{equation}
though other  measures of central  tendency might  be equally valid.  Hence, the
results of this section have the associated variability in them depending on how
the electrolyte concentration computations are  used in evaluating the intrinsic
conductivity of electrolyte.

As  the  ionic  concentration  has  both  a  direct  and  indirect  contribution
in \cref{eq:electrolytepdwithce}, its spatio-temporal  computation is a critical
aspect. As discussed  in \cref{sec:quadraticapprox}, the quadratic approximation
is a widely used spatio-temporal model for electrolyte concentration which makes
the best  use of available physical  constraints. As established in  the results
of \cref{subsec:quadraticsimresultsanalysis}, while  the spatial  performance of
the quadratic approximation approach is acceptable, its time-domain performance,
particularly at  the crucial  locations of the  current collector  interfaces is
mediocre at best.

The  \emph{scope}  of  the  author's   work  is  to  obtain  suitable  alternate
expressions  for  improving  the   computation  of  \textbf{time  evolution}  of
the  electrolyte  concentration  whilst retaining  the  quadratic  approximation
approach   for   describing  its   spatial   profile.   Such  an   approach   is
motivated   by    the   keen    observation   that   the    baseline   quadratic
approximation  model  has  a  natural  `pause'  in  its  model  description.  To
clarify, \crefrange{eq:cecontinuitynegsep}{eq:Qepbyintegration}  form a  tightly
coupled  square  system  \ie~a  set   of  seven  linear  equations  in  seven
unknowns.   In   this   system,   the   time   evolution   of~$Q_{\text{e,}j}$
are   described  through   a  separate   system  of   first  order   \glspl{ode}
given by \crefrange{eq:negliionmolesquadratic}{eq:posliionmolesquadratic}.  In a
practical  implementation,  these  \glspl{ode}  are solved  independently  in  a
decoupled  manner \ie~by  using  the coefficients  obtained  from the  linear
system of \crefrange{eq:cecontinuitynegsep}{eq:Qepbyintegration} in the previous
time-step. The  author's hypothesis is that  by taking advantage of  the natural
break  in the  operational  sequence which  involves  two separate  computations
between  two nearly  independent  subsystems,  it must  be  possible to  replace
the  under-performing  time-evolution  \glspl{ode} from  the  baseline  quadratic
approximation with a superior alternate model.

\subsection{Selection of Methodology --- Background and Rationale}\label{subsec:sysidbackground}

This  section presents  the  background and  thought  process in  systematically
arriving  at  the  choice of  the  methodology  that  was  adopted for  the  new
time-evolution model of the electrolyte concentration dynamics.

Based  upon the  experience  gained  in dealing  with  the literature  presented
in \cref{sec:electrolyteinclusion}, it is  the author's view that,  owing to the
complex behaviour of electrolyte, a  naive top-down approach \ie~including all
the physics upfront followed by a  systematic simplification, might only yield a
model that is  mathematically intractable for adoption in  an embedded \gls{bms}
environment.  The baseline  quadratic  approximation method  has  proven that  a
bottom-up approach \ie~pre-assuming a simplified structure for the final model
and adapting its coefficients to  physical constraints yields a viable candidate
for describing electrolyte dynamics and  for later inclusion in the conventional
\gls{spm}.

Upon  a   closer  examination   of  the  rubrics   of  the   baseline  quadratic
approximation  model, it  comes  to  light that  the  natural `pause'  discussed
towards  the  end  of \cref{subsec:scopenewelectrolyte}  permeates  to  a  level
more  than  merely  having  to  operate  sequentially  on  two  pseudo-decoupled
subsystems  --- it  goes to  the extent  of rendering  the operating  philosophy
of  fitting  physical  equations  semi-void.   To  clarify  this  statement  and
to  substantiate   the  claim,  while  there   is  no  doubt  that   the  linear
algebraic   equations  of \crefrange{eq:cecontinuitynegsep}{eq:Qepbyintegration}
do    incorporate    physical    principles   from    the    \gls{dfn}    model,
the     same     does     not      hold     true     for     the     \glspl{ode}
of \crefrange{eq:negliionmolesquadratic}{eq:posliionmolesquadratic}.   In  fact,
all   the   boundary   conditions   from   the   \gls{dfn}   model   have   been
exhausted   by  this   stage  (refer \cref{subsec:quadraticsimresultsanalysis}).
Although \crefrange{eq:negliionmolesgen}{eq:posliionmolesgen}     are    derived
from     the      \gls{dfn}     model,      the     coefficients      of     the
diffusivities   in    the   \gls{rhs}   of    the   next   set    of   equations
\ie~\crefrange{eq:negliionmolesquadratic}{eq:posliionmolesquadratic},   merely
involve  substitutions  of the  spatial  derivatives  of the  assumed  quadratic
expression.

Herein lies the weakness of the  baseline quadratic approach. Unlike the spatial
algebraic equations, which are tightly bound by the continuity and flux boundary
conditions at the  separator interfaces, there is no equality  constraint on the
spatial  derivative, which  is free  to grow  or shrink  without any  explicitly
imposed  bounds.  The  onus  of  being accurate  is  therefore  on  the  spatial
derivative evaluation which in-turn depends  on the correctness of the quadratic
functions~(\crefrange{eq:cenquadreduced}{eq:cepquadreduced})  themselves. It  is
not feasible to quantify the magnitude of error introduced in the time-evolution
of concentration  given a small-signal  perturbation in the coefficients  of the
quadratic spatial  computation \ie~the  implicit coupling between them  is not
transparent. Since the quadratic approximation  itself is not perfect \ie~does
not capture the  spatial gradient \emph{exactly} as the \gls{p2d}  model as seen
in \cref{fig:spatialionicconc1C}, the internal coupling of coefficients leads to
errors in time-evolution computation.

The author's  approach is to  therefore break this detrimental  coupling between
spatial  derivative of  concentration  and its  temporal evolution  counterpart.
Inspired by the fact that the  quadratic approximation model had almost achieved
the desired goals with
\begin{enumerate}[label=\emph{\alph*})]
    \item a bottoms-up approach \ie~assuming some model structure a~priori, and
    \item not bound by any physical considerations due to the exhaustion of governing equations
\end{enumerate}
led  the author  to  broach a  suitable modelling  concept  that exhibits  these
common  traits, yet  of a  completely different  nature and  hitherto unexplored
in  physics-based battery  modelling  in general  and  electrolyte modelling  in
particular --- \emph{black-box system identification}.

\section{Brief Introduction to System Identification}\label{subsec:introsysid}

An in-depth  coverage of the topic  of system identification is  well beyond the
scope of  this thesis.  However, keeping  in mind the  interests of  the battery
modelling community  who might not be  familiar with this subject  area, a brief
overview of the core ideas that  are essential for tackling the specific problem
at hand is  presented. For readers further interested in  this topic, the author
suggests the textbook by  Ljung~\cite{Ljung1999} for a comprehensive theoretical
treatment of the foundation topics in system identification.

System identification aims  to provide a mathematical model  of the input-output
mapping  of the  system\footnote{The precise  definition of  what constitutes  a
`system' is detailed  in Ljung's textbook. However, for  all practical purposes,
in this  thesis the word `system'  stands for any unknown  entity whose terminal
behavioural model  is being  sought for ---  primarily from  input-output data.}
under consideration. The three categories of system identification are:

\begin{enumdescriptnum}[leftmargin=!,itemsep=1ex,labelwidth=\widthof{$\symbf{\text{brugg}_j}\ \scriptstyle (\times 3)$abc}
    ,partopsep=0pt
    ,topsep=0pt
    ]

\item[White  box] wherein  underlying physical  equations are  completely known.
The  numerical value  of  coefficients of  governing equations  are  then to  be
parametrised from input-output data.

\item[Black box]  wherein no  governing equations are  available for  the system
under  consideration. The  model formulation  is facilitated  by a  rich set  of
system theory  which proceeds by exciting  the system with input  waveforms with
certain desirable  properties and correlating characteristics  from the response
to draw  conclusions about viable  mathematical structures capable  of emulating
the terminal behaviour of the system  under generalised inputs. Black box system
identification was employed for the specific problem under consideration in this
thesis and hence all future descriptions will pertain to this class.

\item[Grey box] is a hybrid of the  two approaches wherein a part of the model's
governing  physics is  known  a~priori  \eg~the  structure  of a  well-defined
subsystem  that is  part  of a  large,  complex  system may  be  known ahead  of
time,  where the  task  is  to characterise  the  full  system. Grey box  system
identification tasks can  often be reduced to a single  sub-problem of black box
system  identification  by  removal  of  the known  physics  and  tackling  them
separately.

\end{enumdescriptnum}

\section{Overview of Black Box System Identification}\label{sec:introblackboxsysid}

Black-box system identification techniques are composed of the following ---
\begin{enumerate*}[label=\emph{\alph*})]
     \item non-parametric methods, and
     \item parametric methods.
\end{enumerate*}

\subsection{Non-parametric methods}
Non-parametric methods do not seek  a pre-assumed mathematical structure for the
system. They  aim to  directly estimate  the very  kernel of  what characterises
every system \viz~the Markov parameters in the time-domain  and the \gls{frf}
in the frequency domain, thereby requiring \emph{infinite} number of data points
for  their representation.  Major non-parametric  system identification  methods
include:
\begin{itemize}[topsep=0pt]
    \item Identification in time domain
        \begin{itemize}

            \item Direct  estimation of the system's  Markov parameters through
                statistical correlation of its response to an unit-pulse input.

        \end{itemize}
    \item Identification in frequency domain \ie~of the \gls{frf}
        \begin{enumerate}

            \item   Direct   estimation    through   input-output   statistical
                cross-correlation.

            \item  \gls{etfe} using \glspl{dft} of input and output sequences.

            \item  Smoothed periodogram estimates using Welch's method.

            \item  Blackman-Tukey  Estimate   using  standard  filter
                windows  in digital  signal processing  (such as  Hamming, Hanning,
                Bartlett, Boxcar etc.).

        \end{enumerate}
\end{itemize}

\subsection{Parametric methods}\label{subsec:parametric}
Parametric  methods aim  to fit  specific input-output  data to  some family  of
well-known mathematical  constructs that  are and widely  applicable to  a large
variety of inputs.  It is important to recognise that,  in contrast to white-box
system identification, the salient coefficients/properties of these mathematical
structures \emph{do  not,} in any way  correspond to physical properties  of the
system under consideration. Major parametric system identification methods use:
\begin{itemize}
    \item Transfer-function based frequency domain model structures
        \begin{enumerate}
            \item \gls{oe} model
            \item \gls{arx} model
            \item \gls{armax} model
            \item Box-Jenkins (BJ) model
        \end{enumerate}
    \item State-space time-domain model structures
        \begin{enumerate}
            \item Ho-Kalman realisation
            \item \gls{era} realisation
            \item Deterministic and stochastic \emph{subspace} structures
        \end{enumerate}
\end{itemize}

\subsection{Investigation of suitable system identification methodology}\label{subsec:suitablesysid}
Among   the   various   system    identification   techniques   mentioned,   the
non-parametric   methods    have   some    serious   drawbacks.    As   outlined
in \cref{subsec:sysidbackground}, the author is inspired  by the trait of having
a pre-assumed model structure that  brought the baseline quadratic approximation
closer to a successful realisation. The non-parametric methods do not conform to
this philosophy. Furthermore, the requirement of infinite number of data samples
in order to fully quantify the system dampens its feasibility for implementation
in  resource  constrained  environments.  The  author is  of  the  opinion  that
resorting  to truncation  of  the  characteristic sequence  shall  only yield  a
sub-optimal solution. Hence non-parametric methods are ruled out for applying to
the task at hand.

While  parametric state-space  identification is  a feasible  alternative, these
methodologies are tedious and error-prone.  For instance, applying the Ho-Kalman
algorithm requires construction of large-sized Block-Hankel matrices followed by
a  \gls{svd} operation.  The  \gls{era}  uses the  identical  set of  operations
of  the  Ho-Kalman   procedure,  except  that  certain  blocks   in  the  Hankel
matrices  are chosen  at  random  for deletion  for  obtaining better  estimates
in  low  \gls{snr} environments  and  for  capturing slowly  decaying  phenomena
with  long time  constants. The  subspace methods  are mathematically  involved,
requiring  a  profound  understanding  of  concepts  from  linear  algebra  such
as  projections  to orthogonal  subspaces.  The  system under  consideration  is
presented in \cref{sec:introtoplant} and after linearity considerations, refined
in \cref{subsec:linearityanalysis}. It is composed of two independent \gls{siso}
subsystems.  However,   the  inflection  point  in   the  complexity-performance
trade-off  in state-space  identification  is achieved  only  when dealing  with
\gls{mimo} systems that suggest strong  cross-coupling among its internal states
or  at least  some degree  of  coupling among  the various  inputs and  outputs.
Furthermore, the impulse  responses of the system(s) under  consideration do not
have long tails since they are characterised by relatively short time constants.
Owing to these  reasons, it was decided that state  space identification methods
shall not be adopted here.

Owing to a  cornucopia of well-established technical  know-how readily available
in the systems  engineers toolkit, transfer function based  model structures are
naturally amenable  for control-oriented applications. However,  there exists an
apparent discrepancy to  its usage for this case, that  must be addressed first.
Transfer  function methods  are  a  frequency domain  technique  and hence,  the
resulting model  descriptions have  mathematical structures  radically different
from the time-domain model equations  of the conventional \gls{spm} within which
they are  to be embedded. This  conundrum is resolved by  closely inspecting the
model's scope  and its tractability for  conversion to time domain  as explained
next.

It  is  worth remembering  that,  as  per \cref{subsec:freqdomainroms}, for  the
reduced order  modelling of the  \emph{entire cell}, all frequency  domain model
groups were considered  as out of scope  of this thesis specifically  due to the
overhead  of conversion  from frequency  to time  domain for  implementation and
other associated difficulties. The blanket exclusion nature of this statement is
to be revisited considering the specific scope  of the problem at hand. The body
of literature  on frequency  domain \glspl{rom} discuss  obtaining physics-based
\emph{transcendental}   transfer   functions  for   \emph{all}   electrochemical
quantities  of the  coupled  \gls{pdae} system  of \cref{tbl:dfneqns} through  a
top-down approach.  However, the frequency domain  system identification methods
are concerned with  obtaining standard \emph{rational} transfer  functions for a
much narrower  scope \viz~the time-evolution  subsystem, through  a bottom-up
approach.  Such  rational transfer  functions  are  to obtained  for  \gls{siso}
systems for which an approximation-free  effortless conversion already exists in
classical control  theory and is  presented in \cref{subsec:sysidnumericalimpl}.
In view of  their overwhelming simplicity and familiarity  to control engineers,
after considering these arguments that circumvent their only apparent impediment
to adoption, \emph{transfer function} based system identification was chosen for
tackling the problem at hand. The  steps leading to the identification procedure
is presented next.

\section{Introduction to Electrolyte Time-Evolution Subsystems}\label{sec:introtoplant}

The                  first                 order~\glspl{ode}                  of
\crefrange{eq:negliionmolesquadratic}{eq:posliionmolesquadratic} in the baseline
quadratic  approximation  model  for   electrolyte  concentration  describe  the
time-evolution of the overall number of moles  of \ch{Li^+} in each of the three
regions of the cell~$Q_{\text{e,}j}$.  Through system identification, the author
seeks  to  obtain  the  two  rational  transfer  functions  of~$Q_\text{e,neg}$
and  $Q_\text{e,pos}$  to  the  applied  current $I$  in  the  frequency  domain
\ie~$\frac{Q_\text{e,n}(s)}{I(s)}$ and~$\frac{Q_\text{e,p}(s)}{I(s)}$. Based on
the  \gls{dfn}  model,  the total  moles  of  \ch{Li^+}  per  unit area  in  the
separator~$Q_\text{e,s}$  is not a  function of the exogenous  applied current.
Therefore,  the  baseline  quadratic  approximation \gls{ode}  is  retained  for
computing its time-evolution.

\section{Design of Persistent Excitations}\label{sec:persistentexcitation}

In order  to successfully apply  any system identification technique,  the input
signal must be carefully  designed to be persistently exciting~\cite{Ljung1999}.
Narendra and Annaswamy~\cite{Narendra1984,Narendra1987}  were among the earliest
researchers  to provide  a detailed  treatment  of the  desirable properties  of
persistent excitation and their implication to the quality of the identification
output. A  practical method to achieve  persistent excitation is to  subject the
system under  consideration to  a sequence  of well-characterised  input signals
that  are  capable of  exciting  its  hypothesised  modes.  For this  task,  the
author  of this  thesis  chose  to use  the  data-quality  guidance provided  by
The~Mathworks~Inc.~\cite{mathworkssysid}\ and performed  an iterative refinement
until the identification procedure resulted in a generalisable model.

Before discussing the shape characteristics of the input sequence, its magnitude
must be established.  The various specially prepared input  sequence families do
not  share a  common definition  for their  magnitudes. A  guiding principle  in
system  identification is  that  it  is important  to  have  the input  signal's
magnitude  to  be  representative  of standard  operating  conditions.  Although
standardised  drive  cycle  profiles  are  available,  from  which  a  speed  to
current mapping  can be  performed, it  is impossible  to predict  a~priori, the
specific  amplitudes of  currents  that  the cell  may  undergo under  real-life
load  conditions.  Without  further  deterministic information,  the  author  of
this  thesis  chose to  interpret  magnitude  as  being  the peak  amplitude  of
the  input  current profile.  As  seen  in \cref{fig:uddssimp2dspmresults},  the
representative  \gls{udds}  drivecycle  input  profile  corresponds  to  a  peak
of~3C~\ie~\SI{180}{\ampere}.  Following   the  standard  principles   of  system
identification, it is desirable  for the inputs to the system  to lie along some
measure  of  central tendency.  This  is  to  enable  the identified  system  to
generalise well  \ie~not deviate too far  from the truth when  subject to inputs
that are far away from the central  measure. Yet another consideration is not to
saturate the identified model by choosing input magnitude to be too close to the
peak of  the expected  operating range. Taking  into account  all aforementioned
considerations,  the  peak amplitude  of  the  input  current  was fixed  at  2C
\ie~\ordfrac{2}{3} of the \gls{udds} profile's peak current amplitude.

\subsection{Training current profile}\label{subsec:trainingprofile}

Since not much prior  information is available about the poles  and zeros of the
electrolyte subsystem(s)  in question, a wide  variety of special waveforms  with a
sampling interval of \SI{1}{\second} were used for the current perturbation used
in this system identification task. The specific input sequence consisted of
\begin{enumerate}
    \item \gls{rbs}\quad (0--\SI{199}{\second})
    \item `Chirp' \ie~a swept cosine signal from 0--\SI{100}{\milli\hertz}\quad (200--\SI{799}{\second})
    \item Periodic \glsfmtlong{rbs} with a period of~\SI{200}{\second} and 2~such periods\quad (800--\SI{1199}{\second})
\end{enumerate}
thereby  helping  to  obtain  a  wide-sense  persistent  excitation.  The  swept
cosine  signal  is designed  to  excite  the low  frequency  (DC)  modes of  the
electrolyte subsystem and helps to capture the system's response to constant and
other systematically  varying input profiles.  The two \glspl{rbs}  are intended
to  target  the  poles  and  zeros  of  the  electrolyte  subsystem  that  would
typically be  excited by highly dynamic  input profiles. The periodicity  in one
of  the  \glspl{rbs} was  introduced  to  draw out  any  repeated  real pole  or
complex  conjugate  poles  in  the system  that  might  otherwise  appear
to  be  a  single real  pole.  The  presence  of  both low  and  high  frequency
spectra in  the  combined  training set  presents  a  high degree  of
confidence to  capture the relevant  dynamics of the electrolyte  subsystem. The
input  current profile  used  for  this system  identification  task is  plotted
in \cref{fig:sysidtrainingcurrent}.

\begin{figure}[!htbp]
    \centering
    \includegraphics{sysid_train_input.pdf}
    \captionsetup{singlelinecheck=off}
    \caption[Input current profile used as the training set for system
    identification]{Input current profile used as the training set for system
    identification. The sequence consists of
    \begin{enumerate*}[label=\emph{\alph*})] \item a \glsfmtlong{rbs}, \item a
        chirp or swept cosine signal (0--\SI{100}{\milli\hertz}), and \item a periodic \glsfmtlong{rbs} \end{enumerate*} thereby
covering both low and high frequency spectra while incorporating the potential
to excite any periodic modes in the system to be identified.}
    \label{fig:sysidtrainingcurrent}
\end{figure}

\subsection{Validation current profile}

For the  purposes of identification,  the \gls{p2d}  model is considered  as the
true system. First, the current profile from  the training set is applied to the
\gls{p2d} model.  Its simulation results,  in particular the  numerically solved
concentration values  at each spatially  discretised node  in each of  the three
regions per time-step is integrated over the thickness of the respective regions
and multiplied with their respective porosities to obtain the number of moles of
\ch{Li^+} per unit area in each  of the three regions~$Q_{\text{e,}j}$. Only the
quantities  $Q_\text{e,n}$ and  $Q_\text{e,p}$  are chosen  as  the outputs  for
system  identification and  a  transfer  function model  is  fitted  as per  the
evaluation procedure discussed in \cref{sec:actualsysid}.

As with  any classical  curve fitting  (numerical regression)  procedure, system
identification is also  prone to overfitting the training data.  In general, the
`best' transfer  function that identifies the  given system is the  lowest order
model that not  only minimises the training error, but  also minimises the error
on a  previously unseen  validation dataset.  In the  absence of  an independent
validation  dataset,  the  training  error  can be  made  arbitrarily  small  by
increasing the number of poles and zeros of the transfer function models without
any bounds. However,  such a model shall not have  truly identified the dynamics
of the system  and shall not generalise well to  real-world datasets outside the
training realm. Hence, having an  independent validation current profile for the
task at hand is of paramount importance.

For the system identification task at  hand, the characteristic waveforms of the
validation profile were deliberately conjured to be differ vastly from that used
in training the model. The  validation profile consists of the following
sequence
\begin{enumerate}
    \item Periodic \gls{rgs} with 4~periods of \SI{200}{\second} each\quad (0--\SI{799}{\second})
    \item \gls{prbs} for emulating white noise \ie~with a flat power spectra
        across the frequency spectrum\quad (800--\SI{999}{\second})
    \item Multi-sine signal \ie~a signal consisting of sinusoids at
        various fundamental frequencies added together\quad (1000--\SI{1199}{\second})
\end{enumerate}

Overall,  the validation  profile has  been designed  to cover  a wide  range of
frequencies  akin to  the  training  profile, but  differing  completely in  its
time-domain appearance.  The specific  validation current  profile used  in this
system identification is shown in \cref{fig:sysidvalidationcurrent}.

\begin{figure}[!htbp]
    \centering
    \includegraphics{sysid_validation_input.pdf}
    \captionsetup{singlelinecheck=off}
    \caption[Input current profile used as the validation set for system
    identification]{Input current profile used as the validation set for system
        identification. The sequence consists of
        \begin{enumerate*}[label=\emph{\alph*})]
            \item a \glsfmtlong{rgs},
            \item a \glsfmtlong{prbs}, and
            \item a multisine waveform
        \end{enumerate*}.
        The overall sequence  is intended to emulate the flat  power spectrum of
        white noise (with the \glsfmtshort{prbs}) and excite any poles and zeros
        within~\mbox{3$\sigma$} spread  of the  \glsfmtshort{rgs} mean.  The multisine
        signal is  swept is composed  of sinusoids with  fundamental frequencies
        from \SI{100}{\milli\hertz}  up to the Nyquist  frequency. Its amplitude
        variation  across the  frequency spectrum  increases the  probability to
        capture the  system's modes that  were possibly missed by  the preceding
        two waveforms.
    }%
    \label{fig:sysidvalidationcurrent}
\end{figure}

\textsc{MATLAB} code  that can be used  to generate the training  and validation
input profiles is shown in \cref{codesnippet:trainvalidsysidinput}.

\begin{listing}[!htbp]
\begin{minted}[mathescape,autogobble,bgcolor=mintedbg,escapeinside=||,texcomments=true]{matlab}
clear; close all; clc; format short g;
warning('off','Ident:dataprocess:idinput7'); % suppress sysid warnings
I_1C  = 60; % Amps
range = 2*[-I_1C I_1C]; % peak-peak swing is $\pm 2\text{C}=\SI{40}{\ampere}$
NumCh = 1; % no of channels (used by sysid toolbox for multichannel id)
Ts    = 1; % sampling interval

N  = 200; % samples per quantum of each waveform
u1 = idinput(N,'rbs',[],range); % 'idinput' from sysid toolbox
t_chirp_start = 0;
t_chirp_end   = 3*N*Ts; %
t             = linspace(t_chirp_start,t_chirp_end,3*N);
f0            = 0;
f1            = 1e-1; % $f_1 = \SI{100}{\milli\hertz}$ is the max chirp frequency
u2            = max(range)*chirp(t,f0,t(end),f1)';
bin_seq_Period   = N; % seconds
bin_seq_Period_N = ceil(bin_seq_Period/Ts); % samples
bin_NumPeriod    = 2;
u3 = idinput([bin_seq_Period_N,NumCh,bin_NumPeriod],'rbs',[],range);
rgs_Period         = N; % seconds
rgs_Period_samples = ceil(rgs_Period/Ts);
rgs_NumPeriod      = 4;
u4 = idinput([rgs_Period_samples,NumCh,rgs_NumPeriod],'rgs',[],range/2);
prbs_Period         = N; % seconds
prbs_Period_samples = ceil(prbs_Period/Ts);
u5                  = idinput(N,'prbs',[],range);
samples_per_Period = 2*N;
NumPeriod          = 3;
[u6,freq] = idinput([samples_per_Period 1 NumPeriod],'sine',[],range);

I_load_train    = [u1;u2;u3];
I_load_validate = [u4;u5;u6];
\end{minted}
\caption{Generation of training and validation input current profiles in
\textsc{MATLAB}}
\label{codesnippet:trainvalidsysidinput}
\end{listing}

\section{Investigation of Linearity and Time Invariance}\label{sec:lticheck}

The      transfer     function      identification     techniques      mentioned
in \cref{sec:introblackboxsysid} are  applicable only for \gls{lti}  systems. At
first glance,  this seems to  be overly restrictive  for the system(s)  at hand.
When  considered  as  a  single  macroscopic  entity,  a  lithium  ion  battery,
exhibits  overall non-linear  characteristics,  particularly due  to the  strong
non-linearities in
\begin{enumerate*}[label=\emph{\alph*})]
    \item the Butler-Volmer reaction kinetics (see \cref{eq:butlervolmer}), and
    \item the \glspl{ocp} of the two electrodes (see \cref{eq:lcoUocpPos} and \cref{eq:lcoUocpPos}).
\end{enumerate*}
However,  we are  dealing with  a much  narrower scope  \ie~the  systems under
consideration  are just  the two  sub-system entities  (one per  electrode) that
transform the  applied current at  a particular  time-step to the  overall moles
per  unit area  of  \ch{Li^+}~ions in  the  corresponding  electrode region  of
the  electrolyte at  that  same  instant. Therefore,  it  is  the linearity  and
time-invariance of these \emph{subsystems} that must be investigated.

\subsection{Time-invariance of the electrolyte time-evolution subsystems}\label{subsec:timeinvariance}
A  test  for time-invariance  is  prescribed  in  the  lecture notes  on  system
identification by  Plett~\cite{PlettECE5560_02}. The steps involved  therein are
reproduced here after  being suitably adapted to the notation  of the subsystems
at hand.
\begin{enumerate}
    \item Apply input~${u_1(t) = I(t)}$ to the system and measure the outputs~$Q_{\text{e,n}_1}\!(t)$ and~$Q_{\text{e,p}_1}\!(t)$.
    \item Apply a delayed version of the input by $\tau$~seconds \ie~${u_2(t) = I(t-\tau)}$ to the system and measure the outputs~$Q_{\text{e,n}_2}\!(t)$ and $Q_{\text{e,n}_2}\!(t)$.
    \item If ${Q_{\text{e,n}_2}\!(t) = Q_{\text{e,n}_1}\!(t-\tau)}$ and
        ${Q_{\text{e,p}_2}\!(t) = Q_{\text{e,p}_1}\!(t-\tau)}$ for all possible
        delays~$\tau$, as well as for all choice of input signals~$I(t)$, then the systems are time-invariant.
\end{enumerate}

For the systems at hand, it is  not strictly required to apply this prescriptive
test. Unless a fundamental change in the underlying reaction phenomena/chemistry
occur that  alter the  performance over  time, these systems  can be  treated as
time-invariant. Factors  that induce  time-dependent shift  in the  behaviour of
lithium ion batteries are degradation  phenomena such as thickening of \gls{sei}
layer, dendrite growth or mechanical  fatigue in electrodes which in-turn affect
electrolytic  diffusion and  conductivity. Yet  another cause  of time-dependent
behavioural change  is the drift  in parameter values. However,  these phenomena
are  typically  one or  mode  orders  of  magnitude  slower than  the  \gls{p2d}
dynamics.
This separation  of time-scales imply that, in
practice they can be decoupled. Therefore, separate models can be identified for
the faster and slower processes. A  suitable model-blending approach can then be
considered  to cover  all processes  across time-scales.  Although the  concepts
developed here for the fast electrolyte dynamics can be suitably adapted to such
slow phenomena, their study  falls outside the scope of this  thesis and is left
as an exercise for  future work. Thus, the overall battery  system, and hence by
extension,  the  two subsystems  considered  are  deemed to  be  time-invariant.
However, in the interest of completeness, this author systematically applied the
aforementioned test procedure with every  combination arising from the choice of
ten time-delay values and the following six current profiles ---
\begin{enumerate*}[label=\emph{\alph*})]
    \item constant current 1C~discharge,
    \item constant current 3C~discharge,
    \item constant current 1C~charge,
    \item \gls{udds} input profile with peak amplitude of~3C,
    \item training profile used in system identification (see \cref{fig:sysidtrainingcurrent}), and
    \item validation profile used in system identification (see \cref{fig:sysidvalidationcurrent}).
\end{enumerate*}
Finally,  these tests  were  repeated for  a choice  of  five different  initial
\glspl{soc}   ---   \SI{90}{\percent},   \SI{70}{\percent},   \SI{50}{\percent},
\SI{30}{\percent}  and \SI{10}{\percent}\footnote{\label{fn:socstart}The  number
of  moles  of  \ch{Li^+} per  unit  area  in  the  electrolyte does  not  depend
on  the  electrode's \glsfmtshort{soc}.  However,  different  starting point  of
\glsfmtshort{soc}s were considered  to have a wide variety in  the length of the
recorded  data until  cut-offs  were hit.  \eg~starting at  \SI{90}{\percent}
\glsfmtshort{soc} could  mean that  for a  current spike  early in  the profile,
upper  cut-off voltage  shall be  hit  sooner leaving  a smaller  set of  logged
simulation data.}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{time_invariance.pdf}
    \caption[Demonstration of time-invariance of~$Q_\text{e,n}(t)$ and
    $Q_\text{e,p}(t)$ subsystems]{Demonstration of time-invariance of the
        subsystems considered. The applied current profile~$u_1(t)$ is the
        system identification training sequence
        from \cref{fig:sysidtrainingcurrent} (top row of the central column).
        The top left plot shows the response $Q_{\text{e,n}_1}\!(t)$, while that
        on the top right shows~$Q_{\text{e,p}_1}\!(t)$. The second row of the
        middle column shows the same input sequence delayed by ${\tau =
        \SI{130}{\second}}$. Application of this current profile $u_2(t) =
        u_1(t-\tau)$ results in the outputs~$Q_{\text{e,n}_2}\!(t)$ and
        $Q_{\text{e,p}_2}\!(t)$ to its left and right respectively. Subtracting
        these from the correspondingly delayed versions of the original outputs
        result in zero residuals, thereby proving time-invariance of these
        subsystems. The jitter shown in the bottom row of plots is
        $\mathcal{O}(10^{-15})$ in magnitude and are due to the numerical
        roundoffs that occur when operating close to the noise floor of the
    machine's floating point units.}%
\label{fig:timeinvariance}
\end{figure}

\Cref{fig:timeinvariance}  demonstrates the  time-invariance  of the  subsystems
considered  at  an  initial  \gls{soc} of  \SI{50}{\percent}  for  a  time-delay
of   \SI{130}{\second}   using   the  highly   dynamic   system   identification
training    sequence   that    was   synthesised    by   this    thesis   author
(see \cref{fig:sysidtrainingcurrent}).  The  applied  current  profile~$u_1(t)$
(top row  of the  central column)  produces the  outputs~$Q_{\text{e,n}_1}\!(t)$
and  $Q_{\text{e,p}_1}\!(t)$  shown  in  the   top  left  and  top  right  plots
respectively.  When  the delayed  version  of  this  input sequence  ${u_2(t)  =
u_1(t-\tau)}$ (middle row, middle column) is  applied, it results in the outputs~$Q_{\text{e,n}_2}\!(t)$  and  $Q_{\text{e,p}_2}\!(t)$  to  its  left  and  right
respectively.  Following the  steps  of the  test  procedure, subtracting  these
outputs from the correspondingly delayed versions of their original counterparts
result in  zero residuals, thereby  proving time-invariance of  these subsystems
under these representative test conditions. The residual sequences in the bottom
row of plots are of~$\mathcal{O}(10^{-15})$ and arise due to numerical roundoffs
that occur  when operating close  to the noise  floor of the  machine's floating
point units.

Similar to  the case demonstrated  here, all  tests for time-invariance  for all
permutations of  the chosen operating  conditions passed successfully  \ie~the
delayed  version of  the original  output  signals accurately  matched with  the
responses  to  the corresponding  delayed  input  (down to  machine  precision),
thereby confirming the time-variance of  the subsystems considered in the system
identification problem, which enables us to proceed further.

\subsection{Linearity analysis of the electrolyte time-evolution subsystems}\label{subsec:linearityanalysis}

\subsubsection*{De-biasing of  input signals}

In the analyses of linearity of systems, it is a recommended practice to de-bias
the output and input quantities about their mean operating conditions. The input
signal  in this  case is  the  applied load  current~$I(t)$, which  can be  both
positive  (during discharge)  and  negative  (during charge).  The  mean of  the
training  profile is  \SI{-1.167}{\ampere} and  that of  the validation  profile
is~\SI{-0.3273}{\ampere}. Clearly, the mean values are dependent upon the actual
current profile used. The appropriately de-biased signal \ie~$\widetilde{I}(t) =
I(t) - \bar{I}(t)$  is to be used  for training and validation data  sets in the
system identification procedure. For the purpose  of linearity analysis, it is a
standard practice to simply apply a step change in input (from zero) and measure
the output responses, thereby bypassing the de-biasing requirements.

For the output signals, bias  values can be pre-computed analytically and
accounted for.  The overall number  of moles of \ch{Li^+}  per unit area  in any
region within  the cell cannot  be physically  negative. Even though  under high
C-rates,  ion depletion  at localised  spatial  locations (such  as the  current
collectors) is  certainly possible,  the entire thickness  of any  region cannot
become devoid of ions at any point  in time since the cell shall instantaneously
cease  to work.  Thus, for  a typical  well-designed cell  operating within  the
manufacturer prescribed  C-rate limits,  the output signals  under consideration
operate  in  a  small  window  about  their  initial  values.  In  the  author's
simulations, even  at~$\pm$5C, the overall  number of moles of  \ch{Li^+} in any
cell region exhibited  a maximum change of less than  \SI{15}{\percent} from its
initial value. Thus,  the de-biased output variables  for system identification~$\widetilde{Q}_{\text{e,}j}(t)$ can be obtained  by subtracting their respective
initial values~$Q_{\text{e,}j}(0)$ (see \cref{eq:Qeninit} and \cref{eq:Qepinit})
from~$Q_{\text{e,}j}(t)$.
\begin{align}
    \widetilde{Q}_\text{e,n}(t) & = {Q}_\text{e,n}(t) - {Q}_\text{e,n}(0) \\
    \widetilde{Q}_\text{e,p}(t) & = {Q}_\text{e,p}(t) - {Q}_\text{e,p}(0)
\end{align}
which  implies   that  the   transfer  functions  to   be  identified   have  to
be   modified   to   be   $\frac{\widetilde{Q}_\text{e,n}(s)}{\bar{I}(s)}$   and
$\frac{\widetilde{Q}_\text{e,p}(s)}{\bar{I}(s)}$  respectively.  This  does  not
affect  the  time-invariance  proved in \cref{subsec:timeinvariance}  since  the
initial  values~$Q_{\text{e,}j}(0)$  are   merely  constants  and   hence  not
time-dependent.

\subsubsection*{Test for linearity}
Similar     to      the     test      for     time      invariance     described
in \cref{subsec:timeinvariance}, a  test for linearity is  also prescribed in
the lecture notes on  system identification by Plett~\cite{PlettECE5560_02}. The
steps involved therein  are reproduced here after being suitably  adapted to the
notation of the subsystems at hand. This is essentially a recipe for testing the
superposition principle.
\begin{enumerate}
    \item Apply input profile~$I_1(t)$ to the system and obtain outputs~$\widetilde{Q}_{\text{e,n}_1}\!(t)$ and~$\widetilde{Q}_{\text{e,p}_1}\!(t)$.
    \item Apply a different profile~$I_2(t)$ to the system and obtain outputs~$\widetilde{Q}_{\text{e,n}_2}\!(t)$ and~$\widetilde{Q}_{\text{e,n}_2}\!(t)$.
    \item Now apply an input profile~$I_3(t) = \alpha I_1(t) + \beta I_2(t)$ and obtain a corresponding set of outputs~$\widetilde{Q}_{\text{e,n}_3}\!(t)$ and $\widetilde{Q}_{\text{e,n}_3}\!(t)$.
    \item If ${\widetilde{Q}_{\text{e,n}_3}\!(t) = \alpha\,
            \widetilde{Q}_{\text{e,n}_1}\!(t) + \beta \,
            \widetilde{Q}_{\text{e,n}_2}\!(t)}$ and
            ${\widetilde{Q}_{\text{e,p}_3}\!(t) = \alpha\,
                \widetilde{Q}_{\text{e,p}_1}\!(t) + \beta \,
            \widetilde{Q}_{\text{e,p}_2}\!(t)}$ for all possible~$\{\alpha,\beta\}$ as well as for choice of input signals~$\{I_1(t),I_2(t)\}$, then the systems are linear.
\end{enumerate}

As   in   the  time-invariance   test,   the   same   set  of   five   different
initial  \glspl{soc}\textsuperscript{\ref{fn:socstart}}  ---  \SI{90}{\percent},
\SI{70}{\percent},  \SI{50}{\percent}, \SI{30}{\percent}  and \SI{10}{\percent},
was  retained for  these linearity  tests. For  each test  run, a  pseudo-random
number generator  was used to select  the values of~$\{\alpha,\beta\}$  from the
set  of  real numbers~$\mathbb{R}$  (not  restricted  to  the set  of  integers~$\mathbb{Z}$) in  the closed  interval spanning~$[-1.25,1.25]$.  Negative values
are acceptable for  both the scaling coefficients since  the resulting composite
input~$I_3(t)$ can be either positive or negative. The composite signal $I_3(t)$
was obtained by taking a random combination  of any two of the following current
profiles ---
\begin{enumerate*}[label=\emph{\alph*})]
    \item step input with a constant current 1C~discharge,
    \item step input with a constant current discharge at~C/5,
    \item step input with a constant current 1C~charge,
    \item step input with a constant current charge at~C/5,
\end{enumerate*}

The   scaling   factors~$\alpha$   and    $\beta$   were   restricted   to   the
range~$[-1.25,1.25]$ in  consideration of limiting  the peak applied  current to
within a~\pm 3C window --- the operating condition for most \glspl{bev}, so that
the isothermal  assumption for the model  shall remain valid. This  peak current
corner case occurs when the pseudo-random generator chooses both scaling factors
at the selected range's limits for the 1C~constant current discharge or charging
cases. The limited range  of the scaling factors are also  motivated by the fact
that  most real-world  systems remain  linear  only within  a certain  operating
window. In  particular, care must be  taken to ensure that  the cell's \gls{soc}
during the  linearity test remains  within its  physical limits for  any initial
\gls{soc}. Furthermore, localised  saturation or depletion of  ions for extended
durations must be avoided. Hence it can be concluded that, with the chosen range
for the scaling factors, if the two subsystems under consideration remain linear
everywhere  below a  peak current  of~\pm 3C  in the  isothermal case,  then the
linearity  tests are  considered as  passed.  Future extensions  to undertake  a
temperature-dependent  system  identification  exercise can  potentially  use  a
first-order Taylor  expansion about this  operating window. The  discussion thus
far  has fully  established  all  the conditions  for  conducting  the test  for
linearity.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{linearity_proof}
    \caption[Illustration of linearity test for the
    \protect{$\widetilde{Q}_{\text{e,n}}$} and
    \protect{$\widetilde{Q}_{\text{e,p}}$} subsystems]{Illustration of one
        instance of linearity tests for the subsystems under consideration. For
        this visualisation, constant current inputs are used throughout. The top
        row of plots shows $\widetilde{Q}_{\text{e,n}}$ and
        $\widetilde{Q}_{\text{e,p}}$ for two step inputs~${I_1(t) =
        \SI{60}{\ampere}}$ and $I_2(t) = \SI{12}{\ampere}$ \ie~discharge with~1C and C/5~currents respectively. The second row of plots shows
        $\widetilde{Q}_{\text{e,n}_3}$ and $\widetilde{Q}_{\text{e,p}_3}$  for
        ${I_3 = \SI{36}{\ampere}}$, where $I_3 = \alpha I_1 + \beta I_2$ with~${(\alpha,\beta) = (1,-2)}$. The last row of plots overlays these
        quantities with the manually computed linear combination of their two
        preceding responses. Had these sequences overlapped exactly, the systems
        would have been exactly linear. Despite exhibiting deviations over the
        considered horizon, the transient responses in both electrode regions do
        follow the superposition principle. Even past the transient, maximum
        error in both cases is an order of magnitude lower than the individual
        outputs. Hence, the two systems are deemed to be \emph{approximately}
        linear.
    }%
    \label{fig:linearity}
\end{figure}

\Cref{fig:linearity}  illustrates  one  instance  of a  linearity  test  wherein
constant  currents  and  integer  scaling  factors are  used  for  the  sake  of
illustration.  The  plots   in  the  left  column  deal   with  the  electrolyte
time-evolution  subsystem  in  the  negative electrode  region.  Similarly,  the
plots  in  the  right  column  deal with  the  corresponding  subsystem  in  the
positive electrode region.  A discharge current of~1C  \ie~\SI{60}{\ampere} is
first  applied  and  the  corresponding  outputs~$\widetilde{Q}_{\text{e,n}_1}$
and   $\widetilde{Q}_{\text{e,p}_1}$  are   obtained.   Secondly,  a   discharge
current   of   C/5   \ie~is    applied   and   the   corresponding   outputs~$\widetilde{Q}_{\text{e,n}_2}$ and  $\widetilde{Q}_{\text{e,p}_2}$ are obtained.
These set of responses are plotted  in the top row of \cref{fig:linearity}. Now,
a  third  value  of  input  current~$I_3$,  computed  as  a  linear  combination
of  the  previous  input  currents  \ie~${I_3 =  \alpha  I_1  +  \beta  I_2  }$
is  applied.  For  illustrative  purposes, the  integer  set  ${(\alpha,\beta)  =
    (1,-2)}$  was  chosen  for  the   scaling  coefficients,  which  implies  ${I_3  =
\SI{12}{\ampere}}$. The corresponding  outputs~$\widetilde{Q}_{\text{e,n}_3}$ and
$\widetilde{Q}_{\text{e,p}_3}$ are  plotted in the  middle row. As per  the test
for linearity,  if these signals are  equal to the signal  generated by manually
computing the linear  combination of the preceding two outputs,  then the system
is linear.

The   plots   in  the   third   row   show  $\widetilde{Q}_{\text{e,n}_3}$   and
$\widetilde{Q}_{\text{e,p}_3}$ overlaid with their respective linear combination
signals. In  the case  of the  subsystem in the  negative electrode  region, the
transient performance matches  precisely until \approx\SI{450}{\second}, whereas
that in the positive electrode region exhibits a good matching for approximately
the  first~\SI{250}{\second}.  However,  for  the  horizon  considered  the  two
overlaid plots do not overlap exactly.  Hence, the systems are not truly linear.
However,  the  exhibited  behaviour  is  quite  close  to  linearity,  with  the
maximum  absolute error  in each  region,  even outside  the initial  transient,
being~$\mathcal{O}(10^{-4})$ --- an order of magnitude lower than its individual
components.  This behaviour  was exhibited  for all  test instances  considered.
Considering  that for  dynamic  simulation runs,  the  transient performance  is
paramount  to  the good  performance  of  the  model,  in conjunction  with  the
aforementioned  low error  metric,  these  subsystems can  be  considered to  be
\emph{approximately} linear.

Based  on  the  analysis  presented   here,  \gls{lti}  behaviour  for  the  two
subsystems is  assumed, which facilitates  in proceeding with the  actual system
identification procedure.

\section[Transfer Function Identification Procedure]{Transfer Function Identification Procedure\footnote{The early stages of this section presents this author's digested summary of the theoretical framework adapted from a subset of content from the lecture notes on system identification by Plett~\cite{PlettECE5560_02,PlettECE5560_03,PlettECE5560_04}.}}\label{sec:actualsysid}

\subsection{The transfer operator and its model form}
In a classical system identification  task, the discrete-time transfer functions
for the systems  under consideration need to be  determined. These discrete-time
transfer functions are  based on Z-transforms in the  frequency domain. However,
for the purpose of working in time-domain, an analogous linear operator~$q$ that
performs a  forward shift on  its input \ie~$  {q u[k] \longmapsto  u[k+1]} $.
Similarly, applying the  backward shift operator~$ q^{-1} $  on the input yields
its value at the previous time-step \ie~$ {q^{-1} u[k] \longmapsto u[k-1]}$.

In a generic  \gls{lti} system wherein measurements are corrupted  by noise, The
system  dynamics are  represented by  the transfer  operator~$G(q)$\footnote{The
term  transfer operator  in the  time domain  mathematically corresponds  to the
term  transfer  function  in  the  frequency  domain.  Mathematically,~${G(q)  =
G(z)\bigr\rvert_{\mathrlap{z=q}}}$.}  that  acts  on the  applied  input~$u[k]$,
whereas the  noise dynamics are  represented by the  disturbance operator~$H(q)$
that acts to filter (or shape) an assumed white noise input~$e[k]$.

Assuming linearity and time-invariance throughout, the overall output can be
written as the linear combination
\begin{equation}\label{eq:outputwithsysandnoise}
    y[k] = G(q)u[k] + H(q)e[k]
\end{equation}
where ${G(q) = \frac{B(q)}{A(q)}}$ and ${H(q) = \frac{C(q)}{D(q)}}$ are the transfer
operators describing the dynamics of the system and disturbance respectively.

${A(q), B(q), C(q) \text{ and } D(q)}$ are rational polynomials in~$q$. The two transfer
operators~$G(q)$ and $H(q)$ can be represented by
\begin{align}
    G(q) &= q^{-n_k}\frac{b_1q^{-1} + \dots  + b_{n_b}q^{-{n_b}}}{1 + a_1q^{-1} + \dots  + a_{n_a}q^{-{n_a}}} \\
    H(q) &= q^{-n_l}\frac{c_1q^{-1} + \dots  + c_{n_c}q^{-{n_c}}}{1 + d_1q^{-1} + \dots  + d_{n_d}q^{-{n_d}}}
\end{align}
where ${(n_k,n_l)}$ represent  the number of transport  delay samples, $(n_b,n_c)$
the number  of feedforward coefficients  and ${(n_a,n_d)}$, the number  of feedback
coefficients in $G(q)$ and $H(q)$ respectively.

In  this  system  identification  task  at hand,  the  output  measurements  are
collected from a  \emph{noise-free} simulation of the \gls{p2d}  model \ie~the
disturbance transfer operator in \cref{eq:outputwithsysandnoise} is zero
\begin{align}
    y[k] &= G(q)u[k] + \cancelto{0}{H(q)}e[k]
\shortintertext{Hence, the time-domain output  reduces  to}
y[k] &= G(q)u[k] \label{eq:outputwithsysonly}
\end{align}

Thus, the system identification task becomes one that of estimating
\begin{enumerate}
    \item The number of transport delay samples~$n_k$.
    \item The number of feedforward coefficients (zeros)~$n_b$.
    \item The zeros themselves~${b_1, b_2, \dots b_{n_b}}$.
    \item The number of feedback coefficients (poles)~$n_a$.
    \item The pole locations~${a_1, a_2 \dots a_{n_a}}$.
\end{enumerate}
for  each  of  the  two  transfer operators~$G_1(q)$  and  $G_2(q)$  \ie~the
electrolyte  time-evolution subsystems  in the  negative and  positive electrode
region respectively.

\subsection{Estimation of transport delay}

The transport delay~$n_k$ can be estimated visually by inspecting the step
response of the systems under consideration.

In \cref{fig:linearity},   step  inputs   of   ${I_1   =  \SI{60}{\ampere},   I_2
=    \SI{12}{\ampere},}$   and    ${I_3   =    \SI{36}{\ampere}}$   were    applied
to    the   two    subsystems.    Inspecting   closely    all   the    responses
\ie~$\widetilde{Q}_{\text{e,n}_1},    \widetilde{Q}_{\text{e,n}_2}   $   and
$\widetilde{Q}_{\text{e,n}_3}$    in    the     negative    electrode    region,
and    $\widetilde{Q}_{\text{e,p}_1},    \widetilde{Q}_{\text{e,p}_2}   $    and
$\widetilde{Q}_{\text{e,p}_3}$  in the  positive electrode  region, it  is clear
that all these outputs start exactly at  zero. Therefore, there is no delay term
to be considered for the transfer operators \ie~${n_k = 0}$ for both subsystems.

\subsection{Choice of model structure}\label{subsec:modelstrucchoice}

Among      the      transfer-function       model      structures      mentioned
in \cref{subsec:parametric}, the \gls{arx} model  structure is too simplistic to
consider. Despite  the fact that  its numerical computation involves  only basic
linear algebra operations,  that can be efficiently handled  on modern computing
systems, it  is considered to produce  poor estimates of the  system's poles and
zeros. In the absence of contributions from the noise-term, the all-encompassing
model structure used by the Box-Jenkins approach is deemed to be unnecessary for
the  problem  at hand.  Therefore,  the  two  model structures  considered  were
\gls{armax} and \gls{oe} for the coefficient determination.

\subsection{Starting guesses for coefficient orders}\label{subsec:initguesscoefforder}

At first, the training profile of \cref{fig:sysidtrainingcurrent} is
de-biased (through mean removal) and applied as the input current profile in a \gls{p2d}
simulation. The outputs of this simulation are suitably post-processed as per
the following sequence of steps.
\begin{enumerate}
    \item The concentrations solved at various node locations within each
        electrode are numerically integrated over the corresponding electrode
        thicknesses using trapezoidal rule.
    \item The resulting integral value is multiplied with the porosity of the
        corresponding electrode region to obtain $Q_{\text{e,n}_\text{train}}(t)$ and~$Q_{\text{e,p}_\text{train}}(t)$.
    \item These quantities are then de-biased by subtracting their initial
        values to obtain $\widetilde{Q}_{\text{e,n}_\text{train}}(t)$ and~$\widetilde{Q}_{\text{e,p}_\text{train}}(t)$.
\end{enumerate}

The        same        procedure        is        repeated        for        the
validation       current      profile       of \cref{fig:sysidvalidationcurrent}
to         obtain         $\widetilde{Q}_{\text{e,n}_\text{val}}(t)$         and~$\widetilde{Q}_{\text{e,n}_\text{val}}(t)$.  These data  sets are  used for  all
subsequent sub-tasks involved in this system identification exercise.

In  order to  reduce  the search  window for  the  coefficient determination  in
the  parametric transfer  function methods,  the hand-estimation  of coefficient
order  through non-parametric  methods may  be performed.  This coarse  estimate
can  act as  a  feeder to  help  in  the faster  convergence  of the  non-linear
optimisation algorithms  used in the parametric  methods. In this case,  a basic
spectral analysis  using a Hanning  window implemented using the  MATLAB command
\texttt{spa.m} is applied to the time-domain data to transform it into frequency
response data.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{bode_mag.pdf}
    \caption[Bode magnitude plots of the electrolyte time-evolution sub-systems]{%
        Bode magnitude  plots showing the  estimated frequency response  for the
        two  subsystems under  consideration.  The frequency  response data  was
        obtained  through a spectral  analysis \ie~by computing  the ratios  of
        spectra of the de-biased input  and output sequences. The sequences were
        smoothed using a Hanning window before computing the ratio.
    }%
    \label{fig:initialbodemag}
\end{figure}

\Cref{fig:initialbodemag}  shows  the  Bode  magnitude  plot  of  the  frequency
response for
\begin{enumerate*}[label=\emph{\alph*})]
    \item the training set in the negative electrode region, and
    \item the validation set in the positive electrode region.
\end{enumerate*}
In the  plots, a broad  combination of  the two data  sets in the  two electrode
region  is  depicted  to  achieve  a  compact  representation  of  all  possible
permutations and to avoid redundancies by plotting visually similar information.
It is important to note that these Bode diagrams obtained by such non-parametric
methods only represent  a crude approximation of the  physical dynamics intended
to help in initial estimates of the system behaviour.

Some preliminary understanding of the  various characteristics of the system can
be gleaned from these Bode diagrams.  The first visually striking feature is the
similarity  in the  approximate frequency  characteristics in  the negative  and
positive electrode  regions, even when  excited by completely different  data in
the time domain. This confirms the author's assumptions of equal `complexity' in
the symbolic  regression search discussed in \cref{subsec:symbolicreg}.  This is
also  congruent with  the physical  behaviour of  the electrolyte  in these  two
regions.

\subsubsection*{Finite DC gain}
By visual  extension of  the frequency responses  towards lower  frequencies, it
is  clear  that  the  DC  gains  of  both  the  systems  are  finite  and  below
unity.  This  behaviour  can  clearly  be  seen  in  the  time-domain  responses
of \cref{fig:linearity}.  For  the plotted  time-horizon,  this  effect is  most
visible for the case of the \SI{12}{\ampere} constant current input, wherein the
responses of both regions settle to a finite value after an initial transient.

There is \approx\SI{10}{\decibel} variability in  the low frequency gain between
the two Bode  plots in \cref{fig:initialbodemag}. This can be  attributed to the
following  factors. A  compromise with  the spectral  estimation method  is that
using a higher number of frequency bins  results in lower resolution per bin and
vice-versa. By  varying the number  of frequency bins  and focusing on  the low
frequency range, the resolution of the DC  gain can be improved. The rest of the
variability can  be attributed to the  fact that the training  and test profiles
behave differently and do not excite the same dynamics. In particular, the swept
frequency cosine (chirp) signal in the training set was specifically designed to
draw out  the low frequency  dynamics with a  high fidelity. Finally,  the small
range of variation in the DC gain could also be due to the intrinsic small-scale
variations of  the electrolyte  behaviour in  these two  regions. Although  on a
macroscopic frequency scale the two regions behave similarly, the differences in
electrode thicknesses and porosities could contribute to the small difference in
the  DC gain.  This  helps  to confirm  that  two \emph{non-identical}  transfer
functions are being sought for --- one for each electrode region.

Finally, the finiteness  of the DC gain  helps to narrow down  the search window
for the parametric model structures. In particular, this fact indicates that the
model structures to be trialled must not  have any integrator terms (or poles at
the origin of the complex plane).

\subsubsection*{Resonance and model order}

First  order  transfer   functions  do  not  exhibit   characteristic  peaks  or
resonances  in  their  frequency  responses.  However,  for  the  Bode  plot  on
the   left   of \cref{fig:initialbodemag},   a   pronounced   resonance   around
\SI{0.15}{\radian\per\second} is observable. This has  an enormous impact --- it
presents  an important  clue  that the  first  order time-evolution  \glspl{ode}
of \cref{eq:negliionmolesquadratic}   and \cref{eq:posliionmolesquadratic}   are
inadequate to represent the system dynamics.

An apparent  contradiction to  the first-order inadequacy  claim stems  from the
Bode plot  on the  right hand side  in \cref{fig:initialbodemag}. In  this case,
there are no resonances in the  magnitude response indicating that a first order
model description is sufficient. However, a vital aspect to be noted here is the
nature of the  validation current profile when compared to  that of the training
current profile.  The coarse  frequency response data  obtained by  the spectral
method is sensitive to the actual  input sequence employed. From systems theory,
the  resonances at  a frequency  occur  due to  the presence  of lightly  damped
complex conjugate poles at that frequency. The periodic \gls{rgs} was explicitly
designed in the  training set and is  however absent in the  validation set. The
unique characteristics  of the validation  set and its influence  on coefficient
order is discussed next.

As per  the arguments presented  in the  preceding discussions, there  exists an
implicit constraint that  the behaviour of the time-evolution  subsystems in the
two electrode  regions are  expected to be  of similar  `complexity'. Therefore,
based  on the  presence of  the resonance  in the  Bode magnitude  plot for  the
response to  training profile  in the  negative electrode region,  it has  to be
concluded that the two subsystems are \emph{at-least} of second order.

\subsubsection*{Estimation of number of poles and zeros}

The  high-frequency  roll-off  in  the   slopes  of  the  Bode  magnitude  plots
in  \cref{fig:initialbodemag}  provide clues  on  the  number  of poles  in  the
system.  The  corner frequency~$\omega_\text{c}$  in  both  cases appear  to  be
around~\SI{0.15}{\radian\per\second}. The  high-frequency slope of  both systems
is \approx\SI{20}{\decibel}  per decade, which  implies that they  have at-least
one more  pole than  the number  of zeros  if using  a continuous  time transfer
function. For  the corresponding z-domain  transfer function, this  implies that
$n_a \ge n_b$.

In the  aspect of estimating the  number and locations of  zeros, the validation
profile outshines  the training profile. While  the Bode plot obtained  with the
training profile  does not indicate  the presence of  zeros in the  systems, the
plateau in \SIrange{0.3}{0.4}{\hertz} range for  the Bode plot of the validation
profile clearly contradicts this. Once again, hypothesising that the two systems
(in the two electrode regions)  have fundamentally identical behaviour with only
small differences owing  to differences in their parameter  values, there exists
at-least one zero in these  continuous-time systems around this frequency range.
The discrete-time discretisation process adds an additional zero to the system.

Based on this preliminary  analysis, the estimates are $n_k = 0,  n_b \ge 2, n_a
\ge 3$.  Only asymptotic approximations  to corner frequencies can  be estimated
from the  Bode plots. Furthermore, the  estimated locations are not  used in the
parametric system identification algorithms and  is of much less importance than
the  model order  estimates.  With this  initial  understanding, the  parametric
system identification procedure is carried out.

\subsection{Refinement of coefficient orders using deterministic criteria}\label{subsec:refinementofcoefforder}

The initial estimate  of coefficient orders in \cref{subsec:initguesscoefforder}
was performed  based only on  a visual inspection  of the Bode  magnitude plots.
Owing to  the fact that  the frequency  response data is  the result of  a crude
ratio of  spectra, there is a  high probability of missing  vital information on
the number and locations of poles and zeros. Hence only a lower bound on the
coefficient orders are available until this point. Next, a set of deterministic
criteria is used to widen and refine the coefficient order range.

Although   the   \gls{arx}   structure   is  deemed   to   be   too   simplistic
(see \cref{subsec:modelstrucchoice}), owing to the fact that only linear algebra
operations are involved, as opposed  to numerical optimisation routines employed
in the  \gls{oe}, \gls{armax} and Box-Jenkins  structures, certain deterministic
criteria for  coefficient order  selection can  be incorporated  for coefficient
order selection.
This  can serve  as  a  refinement  of  the
initial number of  coefficients guessed from the Bode  magnitude plots discussed
in.

For any model structure used, its error can be defined as
\begin{align}
    \varepsilon[k]      & = y[k] - \hat{y}_\text{m}[k] \label{eq:sysiderroronlyk}\\
    \shortintertext{where $y[k]$ are true measurements and}
    \hat{y}_\text{m}[k] & = G(q)u[k] \tag{\cref{eq:outputwithsysonly} revisited}
\end{align}
are the model outputs obtained by the assumed transfer operator~$G(q)$ (which is
to be determined).

The  number of  numerator  and denominator  coefficients in  $G(q)$  as well  as
their  values are  to  be determined.  This  set of  unknowns  can be  collected
into a  parameter vector~$\theta$.  Thus, as per  \cref{eq:sysiderroronlyk}, the
error  sequence  is  parametrised  by  $\theta$, and  its  notation  is  amended
to~$\varepsilon[k;\theta]$.

For  an  input-output  data  set  consisting of  $N$~samples,  a  generic  cost
function that may  be applied for all the four  model structures \viz{\gls{arx},
\gls{armax}, \gls{oe} and Box-Jenkins} is
\begin{align}
    V_N(\theta)  & = \sum_{k=1}^N L\left(\varepsilon\left[k;\theta\right]\right)
\shortintertext{where $L(\cdot)$ is a postive-valued scalar loss function.}
\intertext{In a typical system identification task, the sum of squares of the error sequence is  used as the typical loss function, thereby yielding}
    V_N(\theta)  & = \sum_{k=1}^N \varepsilon^2[k;\theta]\label{eq:nonlincostfcnsysid}
    \shortintertext{The vector~$\hat{\theta}$ that minimises this cost function is desired}
    \hat{\theta} & = \text{arg}\,\underset{\theta}{\text{min}} V_N(\theta)
\end{align}

For  the \gls{arx}  model structure, \cref{eq:nonlincostfcnsysid}  reduces to  a
standard quadratic optimisation  problem which may be  solved analytically using
least  squares  linear  algebra.  However,  for  robustness  against  estimation
bias,  instead of  the  standard \gls{ols}  estimates,  the \gls{iv}  estimation
method~\cite{Ljung1999} was used  for this model order  selection task. Applying
this to  the \gls{arx} model  structure, two deterministic model  order criteria
have been defined ---
\begin{enumerate*}[label=\emph{\alph*})]
    \item \gls{aic}, and
    \item \gls{mdl}~\cite{Ljung1999}.
\end{enumerate*}

In  the \gls{aic},  the  optimal  number of  parameters~$\hat{d}$ in  $\theta$
is  obtained   by  minimising   the  modified   log  likelihood   cost  function
\begin{equation}
    V_{N,\text{mod}}(\theta) =  \ln V_N(\theta)  + \frac{2  d}{N}, \quad N \gg d
\end{equation}
In the \gls{mdl} criterion, this cost function is modified to
\begin{equation}
    V_{N,\text{mod}}(\theta) =  V_N(\theta)\left(1 + \frac{d\, \ln N}{N}  \right)
\end{equation}

For the two subsystems at hand, both  criteria converged to the same choices for
the coefficient orders,  yielding ${n_a = 4,  n_b = 4}$ and~${n_k  = 0}$. Therefore,
these values  were used as the  starting points for the  non-linear optimisation
algorithms  used in  determining  the  exact pole  and  zero  locations for  the
discrete-time transfer functions which is described next.

\subsection{Final transfer function coefficients --- Nonlinear optimisation}

For         the         \gls{armax}        and         Box-Jenkins         model
structures, \cref{eq:nonlincostfcnsysid} results  in a non-linear  cost function
which  is  minimised iteratively  using  quasi-Newton  approaches. The  theoretical
foundation  of  standard non-linear  optimisation  methods  such as  L-BFGS  and
Levenberg-Marquardt are  well established whose  detailed explanation is  out of
the scope of this thesis. Although state of the art methods are not covered, the
interested reader  may consult the  textbook by Scales~\cite{Scales1985}  for an
introductory overview of this topic.

The  final  model structures  (for  both  the  positive electrode  and  negative
electrode time-evolution subsystems) in the z-domain are given by
\begin{equation}
    G(z) = \frac{b_1z^{-1} + \dots + b_{n_b}z^{-{n_b}}}{1 + a_1z^{-1} + \dots + a_{n_a}z^{-{n_a}}}\label{eq:genericZtf}
\end{equation}
wherein the coefficients in the numerator and denominator are to be determined.

The  number of  coefficients obtained  from \cref{subsec:refinementofcoefforder}
was  used as  the initial  guess for  the coefficient  orders in  the non-linear
optimisation.  For  the  initial  guesses   for  the  numerical  values  of  the
coefficients~$(a_1, a_2,  \dots a_{n_a})$ and ${(b_1, b_2, \dots  , b_{n_b} )}$, a
randomised  multi-start  algorithm was  used.  For  the two  transfer  functions
identified, no distinction is made  between whether the \gls{armax} structure or
Box-Jenkins structure was  used to arrive at the coefficients.  Since the output
magnitudes of~$\widetilde{Q}_{\text{e,n}}$  and $\widetilde{Q}_{\text{e,p}}$ are
of~$\mathcal{O}{10^{-3}}$,  a  constant  scaling   factor  of~${k  =  1000}$  is
used  to  bring the  order  of  magnitude of  output  data  values to  unity.  A
well-chosen  scaling factor  is often  vital  to the  convergence of  non-linear
optimisation algorithms.  Since the system  is linear, this constant  gain shall
not fundamentally change the dynamics of the  system and can be accounted for by
using the reciprocal  scaling factor of~0.001 in  numerical implementations. The
identification procedure  was carried  out using MATLAB's  System Identification
Toolbox~\cite{matlabsysidtool}.

\begin{table}[!htbp]
    \begingroup
    \sisetup{group-digits=false}
    \centering
    \caption[A sample of system identification results for $\widetilde{Q}_\text{e,n}$]{A sample of results showing four discrete-time transfer functions identified for the electrolyte time-evolution subsystem in the negative electrode region. Only those models that yielded similar errors (within \SI{0.5}{\percent}) across both input datasets were retained.  The fourth order model from case C (shaded in grey) performed the best across  both training and validation profiles and is chosen as the final model.}
    \label{tbl:sysidnegcases}
    \begin{tabular*}{\textwidth}{@{} c   S[table-format=1.4] S[table-format=1.4] S[table-format=1.4] S[table-format=1.4]  S[table-format=1.4,table-column-width=0.95cm] S[table-format=1.4,table-column-width=0.95cm] S[table-format=1.4,table-column-width=0.95cm] S[table-format=1.4,table-column-width=0.95cm] S[table-format=2.2] S[table-format=2.2] @{}}\toprule
        \multirow{2}[2]{*}{\footnotesize Case} & \multicolumn{4}{c}{\footnotesize Numerator} & \multicolumn{4}{c}{\footnotesize Denominator} &  {\multirow{2}[2]{*}{\footnotesize \makecell{Training \\accuracy\\(\%)}}} & {\multirow{2}[2]{*}{\footnotesize \makecell{Validation\\accuracy\\(\%)}}}\\
        \cmidrule(lr){2-5} \cmidrule(lr){6-9}
        {} & \multicolumn{1}{c}{$b_1$}  & \multicolumn{1}{c}{$b_2$}   & \multicolumn{1}{c}{$b_3$}  & \multicolumn{1}{c}{$b_4$}   & \multicolumn{1}{c}{$a_1$} & \multicolumn{1}{c}{$a_2$} & \multicolumn{1}{c}{$a_3$} & \multicolumn{1}{c}{$a_4$} \\
        \midrule
        A & 0.0026 & -0.0025 & {}      & {}      & -1.922 & 0.923  & {}     & {}    & 95.11 & 95.13 \\
        B & 0.0028 & -0.0052 & 0.0025  & {}      & -2.833 & 2.669  & -0.836 & {}    & 99.14 & 98.54 \\
        \Rowcolor{cbrewerintergray}
        C & 0.0028 & -0.0075 & 0.0066  & -0.0019 & -3.577 & 4.767  & -2.801 & 0.612 & 99.73 & 99.28 \\
        D & 0.0026 & 0.0026  & -0.0024 & -0.0024 & 0.060  & -1.906 & -0.058 & 0.907 & 95.12 & 95.14 \\
        \bottomrule
    \end{tabular*}
    \endgroup
\end{table}

\Cref{tbl:sysidnegcases}   shows   the   results  obtained   by   applying   the
aforementioned   non-linear  identification   routines  to   the  time-evolution
subsystems in the negative electrode region. The coefficient orders tried in the
system identification  procedure were informed  by the inferences from  the bode
magnitude plots as well as that obtained by applying the deterministic \gls{aic}
and \gls{mdl}  criteria. Only those  models that yielded similar  errors (within
\SI{0.5}{\percent}) across both input datasets were retained.

As  discussed  in \cref{subsec:initguesscoefforder},   a  first  order  transfer
function cannot capture all the  dynamics of the subsystems under consideration.
Therefore, the lowest order tried in  the identification procedure was two (case
A in \cref{tbl:sysidnegcases}).  As higher order  models were tried,  the system
accuracy improves steadily as  seen in cases B and C. However  in order to avoid
overfitting, the  \emph{lowest} order  model that  produces the  highest matched
accuracy across both training and validation profiles must be chosen.

Case D illustrates  the importance of the initial values  used in the non-linear
optimisation algorithms.  Despite using an  identical number of  coefficients as
case C,  the optimisation algorithm  converges to  a radically different  set of
zeros  and  poles  resulting  in  a  percentage  error  comparable  to  that  of
the  simple second  order  case. The  fourth  order model  from  case C  (shaded
grey  in \cref{tbl:sysidnegcases}) performs  the best  across both  training and
validation profiles and  is chosen as the final model.  The number of numerators
and  denominators match  exactly that  predicted by  the deterministic  criteria
given in \cref{subsec:refinementofcoefforder}. A similar selection procedure was
applied  for  the  identification  of the  transfer  function  corresponding  to
$\widetilde{Q}_{\text{e,p}}$ in the positive electrode region.

The final identified transfer functions (for the scaled output) are
\begin{align}
    \frac{\widetilde{Q}_{\text{e,n}}(z)}{\widetilde{I}(z)} & = \frac{0.002842 z^{-1} - 0.00753 z^{-2} + 0.006595 z^{-3} - 0.001906 z^{-4}}{1 - 3.577 z^{-1} + 4.767 z^{-2} - 2.801 z^{-3} + 0.6118 z^{-4}} \label{eq:finaldisctfneg}\\
    \frac{\widetilde{Q}_{\text{e,p}}(z)}{\widetilde{I}(z)} & = \frac{-0.002809 z^{-1} + 0.007139 z^{-2} - 0.005944 z^{-3} + 0.001614 z^{-4}}{1 - 3.464 z^{-1} + 4.444 z^{-2} - 2.495 z^{-3} + 0.515 z^{-4}}\label{eq:finaldisctfpos}
\end{align}

\begin{figure}[!htbp]
    \centering
    \includegraphics{p2d_sysid_train_qen.pdf}
    \caption[$\widetilde{Q}_{\text{e,n}}(t)$ outputs from \glsfmtshort{p2d} and
    identified transfer function for training profile]{%
        Time-evolution of~$\widetilde{Q}_{\text{e,n}}$ computed using the
        \glsfmtshort{p2d} model  and the identified transfer function
        of \cref{eq:finaldisctfneg} (scaled by~0.001) with the synthetic
        training input profile of \cref{fig:sysidtrainingcurrent}. The output
        predicted by the identified transfer function closely matches the `true'
        output obtained by a high-fidelity \glsfmtshort{p2d} simulation with an
        \glsfmtshort{rms} error of \SI{5.70e-6}{\mole\per\meter\squared} and a
        \glsfmtshort{mae} of~\SI{19.19e-6}{\mole\per\meter\squared}. Note that the
        transfer function in \cref{eq:finaldisctfneg} was originally obtained by
        scaling the output by~1000. The transfer function output is
        multiplied by the reciprocal of the same scaling factor to obtain the
        predicted response shown here, thereby once again justifying the
        linearity assumption for this subsystem.
    }%
    \label{fig:tfpredQentrain}
\end{figure}

\Cref{fig:tfpredQentrain} shows a comparison of the $\widetilde{Q}_{\text{e,n}}$
output for
\begin{enumerate*}[label=\emph{\alph*})]
    \item the \gls{p2d} model, and
    \item the identified transfer function of \cref{eq:finaldisctfneg}
\end{enumerate*}
using  the  training  current  profile  of \cref{fig:sysidtrainingcurrent}.  The
transfer function of \cref{eq:finaldisctfneg} was obtained by scaling the output
of the  training profile to  be of order~$\mathcal{O}(1)$  by a factor  of~1000.
Therefore,  for final  implementation and  comparison purposes,  the raw  output
produced  by applying  the transfer  function  needs to  be scaled  back by  its
reciprocal. If  the system  is linear,  then this scaling  factor shall  have no
impact  on  the  frequency-dependent  dynamics  of  the  subsystem.  The  output
predicted  by the  identified transfer  function is  virtually indistinguishable
from  the `true'  output computed  by post-processing  the \gls{p2d}  model with
an  \glsfmtshort{rms}  error   of  \SI{5.70e-6}{\mole\per\meter\squared}  and  a
\glsfmtshort{mae} of~\SI{19.19e-6}{\mole\per\meter\squared}.  This high accuracy
of the transfer  function prediction justifies the linearity  assumption for the
subsystem.  \Cref{fig:tfpredQepval}  presents  the  same  comparison  using  the
validation input profile for the subsystem in the positive electrode region. The
accuracy of  the identified transfer function  for this independent data  set is
clearly illustrated.

\begin{figure}[!htbp]
    \centering
    \includegraphics{p2d_sysid_val_qep.pdf}
    \caption[$\widetilde{Q}_{\text{e,p}}(t)$ outputs from \glsfmtshort{p2d} and
    identified transfer function for training profile]{%
        Time-evolution of~$\widetilde{Q}_{\text{e,p}}$ computed using the
        \glsfmtshort{p2d} model  and the identified transfer function
        of \cref{eq:finaldisctfpos} (scaled by~0.001) with the synthetic
        validation input profile of \cref{fig:sysidvalidationcurrent}. The output
        predicted by the identified transfer function closely matches the `true'
        output obtained by a high-fidelity \glsfmtshort{p2d} simulation with an
        \glsfmtshort{rms} error of \SI{12.07e-6}{\mole\per\meter\squared} and a
        \glsfmtshort{mae} of~\SI{31.59e-6}{\mole\per\meter\squared}. Note that the
        transfer function in \cref{eq:finaldisctfpos} was originally obtained by
        scaling the output by~1000. The transfer function output is
        multiplied by the reciprocal of the same scaling factor to obtain the
        predicted response shown here, thereby once again confirming the
        linearity of this subsystem.
    }%
    \label{fig:tfpredQepval}
\end{figure}

The  poles of \cref{eq:finaldisctfneg}  lie  very close  to their  corresponding
counterparts of \cref{eq:finaldisctfpos}  in the  stable region of  the Z-domain
\ie~within   the  unit  circle.   This  confirms  the  hypothesis   that  the
time-evolution subsystems  in these  two regions  exhibit similar  dynamics. The
slight differences in  the pole locations could be attributed  to the variations
in  the  physical  parameters  pertaining  to the  two  electrode  regions.  The
numerator coefficients  of \cref{eq:finaldisctfneg} and \cref{eq:finaldisctfpos}
are  also  close  to  each  other  except  that  their  signs  are  opposite  to
each   other.  This   is  to   be   expected,  since   as  seen   in  the   step
response   plots   of \cref{fig:linearity},   $\widetilde{Q}_{\text{e,n}}$   and
$\widetilde{Q}_{\text{e,p}}$ evolve in time in opposite directions. This is also
explained by  the fact  that, for  a given  applied current,  a decrease  in the
number of ions in the negative electrode has to be accompanied by an increase in
the positive electrode and vice-versa (the values of the changes are not exactly
equal owing to the presence of the separator). The identified transfer functions
are thus consistent  and deemed to be suitable for  representing the electrolyte
time-evolution in these regions.

\subsection{Numerical implementation of identified transfer functions}\label{subsec:sysidnumericalimpl}

The concept  of deploying a Z-domain  transfer function may seem  incongruous to
the  one of  the  major  goals of  this  thesis \viz~time-domain  implementation
of  \glspl{rom} in  an  embedded  environment such  as  a  \gls{bms}. While  the
majority  of the  models is  derived  and implemented  entirely in  time-domain,
only  the two  time-evolution subsystems  of  the electrolyte  seems to  deviate
from  this  trajectory.  However,  an   explanation  for  this  is  provided  in
\cref{subsec:suitablesysid}.   In  particular,   it   was   mentioned  that   an
approximation-free  conversion   to  time-domain  from  Z-domain   exists,  that
mitigates this perceived drawback for  these two sub-systems. This conversion is
amenable for discrete-time implementation without any other modifications.

Starting from the generic structure of the identified transfer functions (see \cref{eq:outputwithsysonly}),

\begin{DispWithArrows}[fleqn,mathindent=0cm,jot=2ex,%
    ,xoffset=-4mm
    ]
    G(z) &= \frac{b_1z^{-1} + \dots + b_{n_b}z^{-{n_b}}}{1 + a_1z^{-1} + \dots + a_{n_a}z^{-{n_a}}} \Arrow{Replace with analogous \\ transfer operator $q=z$ \\ in time domain} \notag\\
    G(q) &= \frac{b_1q^{-1} + \dots + b_{n_b}q^{-{n_b}}}{1 + a_1q^{-1} + \dots + a_{n_a}q^{-{n_a}}} \Arrow{Apply the definition\\ of~$G(q)$ on the \glsfmtshort{lhs}}\notag \\
    \frac{y[k]}{u[k]} &= \frac{b_1q^{-1} + \dots + b_{n_b}q^{-{n_b}}}{1 + a_1q^{-1} + \dots + a_{n_a}q^{-{n_a}}} \Arrow{Cross-multiply}\notag \\
    \left(1 + a_1q^{-1} + \dots + a_{n_a}q^{-{n_a}}\right)y[k] &= \left(b_1q^{-1} + \dots + b_{n_b}q^{-{n_b}}\right)u[k] \Arrow{Expand on both sides} \notag \\
    y[k] + a_1q^{-1}y[k] + \dots + a_{n_a}q^{-{n_a}}y[k] &= b_1q^{-1}u[k] + \dots + b_{n_b}q^{-{n_b}}u[k] \Arrow{Apply the definition\\ $q^{-p}x[k] = x[k-p]$}\notag \\
    y[k] + a_1y[k-1] + \dots + a_{n_a}y[k-n_a] &= b_1u[k-1] + \dots + b_{n_b}u[k-n_b] \Arrow{Rearrange to obtain\\ the final expression}\notag \\
    y[k] &= -a_1y[k-1] - \dots - a_{n_a}y[k-n_a] \notag \\[-2ex]
         &\qquad   + b_1u[k-1] + \dots + b_{n_b}u[k-n_b] %\label{eq:lccde}
\end{DispWithArrows}

We  thus obtain  a  simple  algebraic expression  (a  difference equation)  that
computes the output  at the given time-step given past  inputs and outputs. This
is a highly memory-efficient implementation  since, at any given time-step, only
the previous~$n_a$ (four) output samples  and $n_b$ (four) input samples need to
be  `remembered'  (stored).  This  concludes all  the  aspects  (derivation  and
implementation) of  this author's new  model for the  electrolyte time-evolution
subsystem.  The  performance  of  this  model  for  computation  of  electrolyte
concentration needs to be evaluated, which is performed next.

\section{Performance Analysis of New Model: Ionic Concentration}\label{sec:perfanalysisnewmodel}

To demonstrate that a suitable advancement of the field has indeed been achieved
through  this system  identification exercise,  a comparison  with the  existing
state of the art in reduced  order electrolyte modelling is warranted. Secondly,
to  comprehend its  extent of  validity  and performance  boundaries, the  newly
developed \gls{rom} must also be  pitted against the full-order \gls{p2d} model.
This section  aims to  provide such  a comparative discussion  for two  types of
inputs ---
\begin{enumerate*}[label=\itshape\alph*\upshape)]
    \item constant current inputs
    \item dynamic load profiles
\end{enumerate*}

\subsection{Constant current inputs}\label{subsec:tfquadceconstcurrinput}

\Cref{fig:tfquadp2dspatialionicconc1C} shows  the spatial distribution  of ionic
concentration  in  the electrolyte  along  cell  thickness  for a  1C~discharge
beginning at \SI{100}{\percent} \gls{soc}. The spatial concentration computed by
each of the three approaches ---
\begin{enumerate*}[label=\roman*)]
    \item the \gls{p2d} model,
    \item the quadratic approximation model and
    \item the newly developed system identification model(s).
\end{enumerate*}

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{tf_quadratic_ce_approx_spatial.pdf}
    \caption[Spatial distribution of ionic concentration in
    electrolyte for a 1C~discharge computed by the \glsfmtshort{p2d}, quadratic
    approximation \& system identification models]{%
        Spatial distribution of ionic concentration  in electrolyte along cell
        thickness at various  snapshots of  time computed  by each of  the three
        models for  a 1C~discharge.  The concentration  profile  computed by
        the  \gls{p2d} model is used as the benchmark reference. The  system
        identification model performs noticeably better than the quadratic
        approximation model during  the initial  transient  while delivering a
        similar performance as a \gls{qss} is reached.
}%
\label{fig:tfquadp2dspatialionicconc1C}
\end{figure}

During  the  initial  phase  of   discharge,  the  \gls{p2d}  model  exhibits  a
characteristic inflection point near the  separator interfaces that diffuses out
over time  until a  \gls{qss}. This  is due to  the fact  the reaction  front is
initially established  close to the  separator, and as surface  concentration of
lithium  in particles  near separator  is  depleted, the  reaction starts  moves
further  into the  electrode thickness.  Neither  of the  two \glspl{rom}  under
consideration here  could successfully  capture this  characteristic inflection.
This is  explained by  the fact  that both  of them  use the  standard quadratic
approximation profile for the \emph{spatial}  profile, which means that only one
apex  point is  possible  per  electrode, which  is  pinned  to their  separator
interfaces by design.

During the transient portion of discharge (approximately up to \SI{357}{\second}
as   shown   in \cref{fig:tfquadp2dspatialionicconc1C}),   the  locus   of   the
concentration  profile computed  by  the newly  developed system  identification
model(s) clearly lies  much closer to the \gls{p2d} model  than that computed by
the  quadratic  approximation model.  After  the  initial transition  phase,  it
appears  that  the  concentration  profile predicted  by  both  the  \glspl{rom}
converge to the \gls{p2d} model's concentration profile.

To obtain  a quantifiable  perspective on  the accuracy  of the  newly developed
model, it  is desirable  to plot  the temporal  evolution of  the concentration,
particularly  at  the  two  current   collector  interfaces.  The  behaviour  of
the  baseline  quadratic approximation  model  in  this regard  was  established
in \cref{subsubsec:simresultsbaselinequad}.   Therefore  it   is  important   to
ascertain whether a noteworthy improvement  was achieved using the model arrived
at using the system identification procedure.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{tf_quad_ce_at_cc_1Cdischg}
    \caption[%
    Time evolution  of ionic  concentrations at  current collectors  computed by
    \glsfmtshort{p2d}, quadratic  approximation \& system  identification models
    for 1C~discharge
    ]%
    {%
    Evolution  of ionic  concentration over  time at  the two  current collector
    interfaces for a 1C~discharge for
    \begin{enumerate*}[label=\roman*)]
        \item the \glsfmtshort{p2d} model,
        \item the quadratic approximation model and
        \item the newly developed system identification model(s)
    \end{enumerate*}
    (top row). For the quadratic approximation and system identification models,
    the time evolution of their absolute error relative to the \glsfmtshort{p2d}
    benchmark  is also  shown  (bottom  row). At  both  current collectors,  the
    transient performance of the system  identification model is superior to the
    quadratic  approximation model.  At \gls{qss},  the quadratic  approximation
    model is slightly more accurate than the system identification model.
}%
\label{fig:temporalcetfquadratic}
\end{figure}

\Cref{fig:temporalcetfquadratic}   shows  the   time-evolution   of  the   ionic
concentrations at the current collector  interfaces of the negative and positive
electrodes for a 1C~discharge. The  concentration profiles computed
by the three approaches ---
\begin{enumerate*}[label=\roman*)]
    \item \glsfmtshort{p2d} model,
    \item quadratic approximation model and the
    \item newly developed system identification model(s)
\end{enumerate*}
are overlaid in the top row of  plots, wherein the left hand side corresponds to
the  current collector  interface  at  the negative  electrode  while the  right
hand  side  corresponds  to  that  at  the  positive  electrode.  The  plots  in
the bottom  row of \cref{fig:temporalcetfquadratic}  show the  time-evolution of
the  absolute  value  of  their  errors. The  concentration  error  of  each  of
the  two  \glspl{rom}  is  defined  with  respect  to  the  benchmark  \gls{p2d}
model  \ie~$\varepsilon_{c_{\text{e,}j}(t)}   =  c_{\text{e,}j_\text{ROM}}  -
c_{\text{e,}j_\text{p2d}}(t)$. The  absolute value  of the  error is  plotted so
that  the magnitude  of the  error can  be visualised  better, aiding  immediate
comparisons based on the plots.

For both  current collectors,  the newly  developed system  identification model
outperforms  the  quadratic  approximation  model during  the  transient  phase.
At  the  negative  electrode/current  collector  interface,  the  error  of  the
system  identification  model  remains  strictly below  that  of  the  quadratic
approximation model until \approx \SI{650}{\second} and remains comparable to it
until~\approx\SI{1600}{\second}. Beyond  this time, the  quadratic approximation
model has a  slightly better accuracy, although the  system identification model
still remains at a comparable distance from it. After~\approx\SI{2000}{\second},
both models  yield the same  response shape. For the  positive electrode/current
collector interface, the error of  the system identification model remains below
that of the quadratic approximation model until \approx \SI{3300}{\second}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{zoomed_tf_quad_ce_at_cc_1Cdischg.pdf}
    \caption[%
    Transient phase of ionic  concentration evolution at  the two current collectors  computed by
    \glsfmtshort{p2d}, quadratic  \& system  identification models
    for 1C~discharge
    ]%
    {%
    Transient phase of the temporal evolution  of ionic  concentration at  the two  current collector
    interfaces for a 1C~discharge as computed by ---
    \begin{enumerate*}[label=\roman*)]
        \item the \glsfmtshort{p2d} model,
        \item the quadratic approximation model, and
        \item the newly developed system identification model(s).
    \end{enumerate*}
    The significantly improved accuracy of the system identification model(s)
    relative to the state of the art quadratic approximation model is clearly demonstrated.
}%
\label{fig:zoomedcetfquadtemporal}
\end{figure}

\Cref{fig:zoomedcetfquadtemporal} shows  a zoomed version of  the time-evolution
of the  ionic concentration  at the  two current  collectors, wherein  the first
\SI{300}{\second}  after  application  of  the  load  current  is  plotted.  The
significant  improvement in  accuracy  achieved by  the  newly developed  system
identification model(s) is clearly demonstrated. At both the current collectors,
the concentration computed  by the system identification  model(s) closely track
that of the benchmark \gls{p2d} model.

The  loss  of fidelity  exhibited  past  the  initial transient  phase  warrants
an  explanation. It  should  be  recalled that  the  natural  decoupling of  the
temporal and  spatial systems were taken  advantage of in developing  the system
identification technique. This  means that, for the spatial  profile, the system
identification  model reverts  to the  same  quadratic profile  as the  baseline
quadratic approximation  model. This  explains why the  two models  have similar
shape past the initial transient. During  the transient phase when the \gls{qss}
behaviour is yet to be established, it is reasonable to assume that the temporal
dynamics  are of  paramount importance  in governing  the concentration  profile
evolution.  After a  \gls{qss}  has  been established  with  the reaction  front
diffusing out  and a steady  stream of ion-electron  separation/recombination in
place,  it is  hypothesised  that the  temporal dynamics  have  settled and  the
spatial configuration assumes importance.

With a  sustained application  of constant current  past the  initial transient,
strong spatial gradients  in the ionic concentration are  established within the
cell \ie~the  concentrations are far from the initial  equilibrium value. This
precisely  exposes the  realm  where the  system  identification model  exhibits
its  natural  weakness.  By  following  the  theory  of  system  identification,
which  necessitates   bias  removal,   the  training  and   validation  profiles
of \cref{fig:sysidtrainingcurrent}   and \cref{fig:sysidvalidationcurrent}   had
nearly  zero mean.  This means  that the  currents were  as equally  positive as
negative leading to a small-signal  perturbation around the equilibrium value of
the electrolyte  concentration. While this  profile is ideally suited  to excite
the system's  dynamics, it  fails to  capture the large  signal behaviour.  As a
topic  of future  research,  perhaps a  spatially-coupled system  identification
could be attempted to handle this issue.

The  main  implication of  these  results  is  that  the identified  models  are
primarily suitable for  transient \ie~dynamic load profiles,  which is typical
of a real-life scenario in an electric/hybrid electric vehicular operation. Such
a  model is  less  suitable  for sustained  constant  current application.  This
implies that  a \gls{bms} in a  vehicle undergoing a \gls{cccv}  charging cannot
rely on  these identified electrolyte  models. However, this exclusion  does not
seriously hamper the model's wider applicability since a simple coulomb-counting
approach with  a high-precision \gls{adc} is  much more accurate than  any other
\gls{pbm} in this particular scenario.

Although constant  current discharge is  not a practical use-case  for vehicular
batteries, performing this benchmark evaluation  has helped in understanding the
limits of the newly  developed model. This study has also  helped in providing a
glimpse of its  potential strength \viz~significantly  improved accuracy under
dynamic load conditions, which is presented next.

\subsection{Dynamic current inputs}

To characterise  the performance  of the  newly developed  system identification
electrolyte   concentration  model(s)   under  dynamic   load  conditions,   the
\gls{udds}  drivecycle  was  used.  The  details  of  this  drivecycle  such  as
its  speed  versus  time  data  and its  highly  dynamic  nature  was  discussed
in \cref{subsubsec:dynamicspmp2dsim}. The peak of  the applied load current used
corresponds to a discharge current of \SI{180}{\ampere} \ie~3C. A plot of this
current  profile was  shown in  the top  row of \cref{fig:uddssimp2dspmresults}.
This  load  profile  was  applied   to  the  three  models  under  consideration
---
\begin{enumerate*}[label=\itshape\alph*\upshape)] \item \glsfmtshort{p2d}
model,  \item   quadratic  approximation   model,  and  \item   newly  developed
system identification  model(s) \end{enumerate*} ---
and the spatio-temporal evolution of ionic concentration in electrolyte computed
by each of them was studied.

Since  the  load   current  is  highly  dynamic   and  continuously  alternating
between  charging   and  discharging   at  various  magnitudes   throughout  the
profile   duration,   it   is   difficult  to   discern   a   specific   pattern
or   trend  within   the  spatial   thickness   of  the   cell.  Hence,   unlike
the   case   of  prolonged   unidirectional   current   application  wherein   a
clear   reaction  front   that  diffuses   gradually  out   can  be   visualised
(see \cref{fig:tfquadp2dspatialionicconc1C}), little  information can  be gained
from  visualisation   of  spatial   concentration  profiles.  Since   the  ionic
concentrations at  the two  current collectors have  a direct  (and two-pronged)
influence on the  electrolyte overpotential (see \cref{eq:electrolytepdwithce}),
it is particularly important to characterise  the accuracy at these two critical
spatial locations.

Since a  direct correspondence between  the time-dependent dynamics of  the load
profile and that of the electrolyte concentration can be intuitively visualised,
its values  at the two current  collector interfaces are examined.  The plots in
the top row of \cref{fig:uddsTfQuadCeatCC} shows the time evolution of the ionic
concentration at the two current  collector locations for the \gls{udds} current
profile computed by  each of the three models under  consideration. The plots to
the left  pertain to the negative  current collector location while  that to the
right correspond to  the positive current collector location. The  bottom row of
plots show the absolute value of concentration error of the quadratic and system
identification models relative to the  \gls{p2d} reference benchmark. As seen in
\cref{fig:uddsTfQuadCeatCC}, the  absolute error  of the newly  developed system
identification models remain below that  of the baseline quadratic approximation
model throughout the drivecycle.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{tf_quad_ce_at_cc_udds}
    \caption[%
    Time   evolution  of   ionic  concentrations   at  current   collectors  for
    \glsfmtshort{p2d}, quadratic  approximation \& system  identification models
    with a \glsfmtshort{udds} input profile
    ]%
    {%
        Evolution of ionic concentration over  time at the two current collector
        interfaces with  a \gls{udds}  input profile (see  topmost plot
        of \cref{fig:uddssimp2dspmresults}) as computed by
        \begin{enumerate*}[label=\roman*)]
            \item the \glsfmtshort{p2d} model,
            \item the quadratic approximation model and
            \item the newly developed system identification model(s)
        \end{enumerate*}
        (top   row).  The   plots  on   the   left  pertain   to  the   negative
        electrode/current  collector   interface,  while   that  on   the  right
        corresponds to  the positive electrode/current collector  interface. For
        the  quadratic approximation  and  system  identification models,  their
        absolute error relative to the \glsfmtshort{p2d} benchmark is also shown
        (bottom  row).  The system  identification  model  is considerably  more
        accurate  than the  quadratic approximation  model for  the entire  time
        horizon of the drivecycle.
    }%
    \label{fig:uddsTfQuadCeatCC}
\end{figure}

Based   on   the   conclusions   from   the   constant   current   input   study
of \cref{subsec:tfquadceconstcurrinput},  it   is  to   be  expected   that  the
system  identification  model(s)  exhibit  a  superior  performance  during  the
transient  phase   of  the   simulation.  As  seen   in  the   initial  duration
of \cref{fig:uddsTfQuadCeatCC}, the absolute error  of the system identification
model is indeed  lower than that of the baseline  quadratic approximation model.
Particular, when a sudden current spike is applied at \approx \SI{200}{\second},
the  quadratic approximation  model is  unable to  cope and  its absolute  error
deviates  far  away   from  its  mean  value.  The  absolute   error  of  system
identification model  remains well controlled  and even with  this instantaneous
load demand, its standard deviation is remarkably close to its median value as
shown in \cref{tbl:errormetricsquadtfce}.

\begin{table}[!htbp]
    \centering
    \caption[Error statistics for the quadratic approximation \& system identification models]{Summary of error statistics for the quadratic approximation and system identification models. The metric used is the absolute value of the concentration difference with respect to the \glsfmtshort{p2d} model at the two current collector interfaces.}
    \label{tbl:errormetricsquadtfce}
    \begin{tabular}{@{} l S[table-format=3.2] S[table-format=3.2] S[table-format=3.2] S[table-format=3.2] @{}}
        \toprule
        \multirow{2}[2]{*}{\makecell{Error  statistic \\ (\si{\mole\per\meter\cubed})}} & \multicolumn{2}{c}{$\big\lvert \varepsilon_{c_\text{e}} \big \rvert$ at Neg/CC} &
        \multicolumn{2}{c}{$\big\lvert \varepsilon_{c_\text{e}} \big \rvert$ at Pos/CC} \\
        \cmidrule(lr){2-3} \cmidrule(l){4-5}
        {} & {Quadratic} & {SysID} & {Quadratic} & {SysID} \\
        \midrule
        Max                & 307.27 & 190.04 & 292.20 & 114.44 \\
        Mean               & 66.38  & 54.98  & 55.15  & 25.02  \\
        Median             & 49.65  & 47.12  & 40.39  & 20.93  \\
        Standard Deviation & 66.80  & 37.18  & 60.50  & 20.17  \\
        \bottomrule
    \end{tabular}
\end{table}

While the  superior accuracy of the  newly developed model during  the transient
phase  was not  surprising, the  fact  that its  performance remains  consistent
throughout  the  entire  time  horizon  is  noteworthy.  Despite  being  subject
to  incessant  changes   in  load  demands,  the   system  identification  model
responds better  than the  quadratic approximation model  well past  the initial
transient.  \Cref{fig:zoomedcetfquadtemporaludds} shows  a  zoomed  view of  the
ionic concentration in the electrolyte  at the two current collector interfaces.
To prove the improved performance of the developed model well into the operation
of the cell, a \SI{50}{\second} window beginning at \approx \SI{60}{\percent} of
the overall  profile duration is examined  in detail. Although it  exhibits some
oscillations,  the system  identification model(s)  reasonably track  the `true'
concentrations computed by the \gls{p2d}  model. However, the baseline quadratic
approximation  model seems  to suffer  from  a large  bias with  respect to  the
\gls{p2d} model.  It should also  be noted that nearly  every `kink' in  the two
\glspl{rom}  is identical.  This could  be attributed  to the  fact the  spatial
profile  used  in  both of  them  is  identical.  Hence,  it must  be  concluded
that  the difference  in their  amplitude arises  from the  improved calculation
of coefficients~$a_k(t)$ in \cref{eq:cenqquadstart} and \cref{eq:cepqquadstart}
through  the  usage  of  more  accurate  $Q_{\text{e,n}}$  and  $Q_{\text{e,p}}$
in  the  \gls{lhs} of \cref{eq:Qenbyintegration}  and \cref{eq:Qepbyintegration}
respectively.  Detailed   error  metrics  of   the  two  \glspl{rom}   is  shown
in \cref{tbl:errormetricsquadtfce}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{zoomed_tf_quad_ce_at_cc_udds}
    \caption[%
    Zoomed view of ionic  concentration at  both current collectors  computed by
    the \glsfmtshort{p2d}, quadratic  \& system  identification models
    for the \glsfmtshort{udds} profile
    ]%
    {%
        A zoomed  view of  the ionic  concentration (showing  a \SI{50}{\second}
        window  beginning at  \approx \SI{60}{\percent}  of the  overall profile
        duration) in the electrolyte at the two current collector interfaces for
        the \gls{udds} profile of \cref{fig:uddssimp2dspmresults} as computed by
        ---
        \begin{enumerate*}[label=\roman*)]
            \item the \glsfmtshort{p2d} model,
            \item the quadratic approximation model, and
            \item the newly developed system identification model(s).
        \end{enumerate*}
        At both current collector interfaces, the system identification model(s)
        exhibits  a reasonable  tracking of  the concentration  profile computed
        by  the  benchmark \gls{p2d}.  The  profile  computed by  the  quadratic
        approximation  model  seems  to  suffer from  offsets/bias  issues  that
        adversely affects its accuracy.
}%
\label{fig:zoomedcetfquadtemporaludds}
\end{figure}

Based  on  the  evidence presented  thus  far,  it  can  be concluded  that  the
time-evolution subsystem model(s) developed here using the system identification
technique  indeed  represent  an  advancement  of the  field  of  reduced  order
electrolyte  modelling. With  this  aspect  thus tackled,  it  is imperative  to
explore the potential benefits of  incorporating the discrete-time model(s) thus
obtained into the conventional \gls{spm} and is discussed next.

\section{Composite SPM Model with Electrolyte Dynamics}

At this  stage, it must  be recalled that the  purpose of developing  the system
identification electrolyte  model was  to mitigate the  poor performance  of the
basic  \gls{spm} at  C-rates above~0.5C (see \cref{subsec:simresultsbasicspm}).
This sub-optimal performance was attributed  to the lack of electrolyte dynamics
in  the  basic  \gls{spm}.  The   performance  of  the  newly  developed  system
identification model has been proved to be  superior to the current state of the
art. The next step  is to embed this electrolyte model  into the basic \gls{spm}
so as to  obtain a composite \gls{spm}. The performance  of this composite model
is evaluated to ascertain its suitability towards online implementation.

\subsection{Computation of electrolyte overpotential}\label{subsec:electrolyteopcalc}

The missing component in the terminal voltage computation of the basic \gls{spm}
is  the  contribution from  the  electrolyte  overpotential  term. This  is  the
potential difference in  the entire electrolyte \ie~the electrolyte potential
at the positive current collector interface with respect to that at the negative
current collector interface.

As discussed in \cref{sec:electrolyteinclusion}, using  the equation proposed by
Prada~\etal~\cite{Prada2012}, the  overpotential in the electrolyte  is computed
as
\begin{align}
    \quad \phi_\epos - \phi_\eneg &= (1-t_{+}^0) \frac{2RT}{F}\ln \frac{c_\text{e,\tiny pos/cc}}{c_\text{e,\tiny neg/cc}}\nonumber\\
    {} &\quad -\frac{I}{2 A}\left(\frac{l_\text{neg}}{\kappa_\text{eff,neg}} + 2 \frac{l_\text{sep}}{\kappa_\text{eff,sep}} + \frac{l_\text{pos}}{\kappa_\text{eff,pos}}\right) \tag{\cref{eq:electrolytepdwithce} revisited}
\end{align}

\Cref{eq:electrolytepdwithce} consists of two distinct terms ---
\begin{enumerate*}[label=\roman*)]
    \item a diffusion overpotential due to concentration gradient in the electrolyte, and
    \item an ohmic resistance term that is dependent upon
        \begin{enumerate*}[label=\itshape\alph*\upshape)]
            \item the instantaneous value of applied current,
            \item the thicknesses of the three cell regions, and
            \item the effective ionic conductivity in each of the three regions. %which in-turn depends on ionic concentration,.
        \end{enumerate*}
\end{enumerate*}

The ohmic  loss term  of \cref{eq:electrolytepdwithce} needs  to be  examined in
closer detail.  The dependence of  this term  on instantaneous load  current and
cell thicknesses  can be accounted  in a straightforward manner.  However, there
are ambiguities  in computing the  effective ionic  conductivity in each  of the
three cell regions. The effective value of ionic conductivity in the electrolyte
depends on its intrinsic conductivity, the Bruggeman constants and porosities of
each  of  the three  regions.  The  intrinsic electrolyte  conductivity  in-turn
depends on the electrolyte concentration.

Ambiguities   arise   in  interpreting   the   value   of  ionic   concentration
to   be    used   for   computation   of    electrolyte   concentration.   Since
\cref{eq:electrolytepdwithce}  deals  with  overall potential  drop  across  the
entire  length of  the cell,  the concentration  used for  computing electrolyte
conductivity could,  for example be  that at the respective  current collectors.
This concept however  introduces inconsistencies with the  separator term. Using
the  separator concentration  from one  of the  electrode interfaces  introduces
unequal  weighting  in this  computation.  If  the  ionic concentration  at  the
midpoint of the separator is used, this scheme becomes inconsistent with that at
the  two current  collectors. Another  possibility for  computing the  effective
conductivity in a  cell region is to  use the mean of the  concentration in that
region. However, since the mean is nothing but a simple statistical first moment
is  equally influenced  by the  entire  concentration profile  within each  cell
region. This is questionable given that the electrolyte overpotential across the
entire cell thickness  is most likely governed by the  conductivities at the two
current  collector interfaces.  Some form  of weighted  mean could  be conjured,
wherein the  current collector locations  are given  the highest weight  and the
separator locations the  least weight. However, finding the  weights becomes yet
another  exercise and  from the  engineering perspective  of computing  these in
real-time, seems to be in the realm of diminishing returns.

In  published  literature,  only  a  cursory  treatment  has  been  accorded  to
the  aforementioned  ambiguities.  In  Prada~\etal~\cite{Prada2012},  the  usage
of  initial concentrations  is  used  to only  introduce  the  concept of  ohmic
resistance  in that  article.  However,  the author  of  this  thesis wishes  to
extend  this  concept further.  In  the  simulations  conducted by  this  thesis
author, it  became clear  that the  dependence on  applied current  was required
in  order to  obtain  reasonable accuracies.  Computing  mean of  concentrations
in  cell  regions for  calculation  of  ionic  conductivities  led to  a  biased
computation of overpotentials.  Therefore, this author decided to  use the value
of  initial concentration  for the  computation of  ionic conductivities  in the
current-dependent  contribution  to  electrolyte  overpotential  throughout  the
entire time horizon considered.

Hence, as per the adopted scheme \cref{eq:electrolytepdwithce} gets modified as
\begin{align}
    \quad \phi_\epos(t) - \phi_\eneg(t) & = (1-t_{+}^0) \frac{2RT}{F}\ln \frac{c_\text{e,\tiny pos/cc}(t)}{c_\text{e,\tiny neg/cc}(t)}\nonumber \\
    {}                             &\quad -\frac{I}{2 A}\left(\frac{l_\text{neg}}{\kappa_\text{eff,neg}\left(c_\text{e}\left(0\right)\right)} + 2
    \frac{l_\text{sep}}{\kappa_\text{eff,sep}\left(c_\text{e}\left(0\right)\right)} +
\frac{l_\text{pos}}{\kappa_\text{eff,pos}\left(c_\text{e}\left(0\right)\right)}\right)\label{eq:electrolytepdwithcenew}
\end{align}
wherein  the time-dependent terms are explicitly shown in the notation.

Using \cref{eq:electrolytepdwithcenew} for electrolyte overpotential computation
has an  important implication. The  two-pronged influence of  the time-dependent
electrolyte concentration on the electrolyte overpotential \viz
\begin{enumerate*}[label=\itshape\alph*\upshape)]
    \item a direct influence in the form of concentration dependent diffusion polarisation, and
    \item an indirect influence through its use in ionic conductivity calculations
\end{enumerate*}
has  now  been  reduced  to  just   one.  This  implies  the  results  from  the
system  identification   model  are  now   required  only  in  the   first  term
of \cref{eq:electrolytepdwithcenew}.

In the light of the decision of use the (constant) initial concentration for the
ohmic term, it is natural to question the gains from the circuitous route of the
system  identification  exercise that  was  undertaken  to obtain  the  improved
electrolyte model. Therefore,  it is imperative to quantify  the relative weight
of  the  concentration  dependent  diffusion resistance  compared  to  the  bulk
solution resistance.

\begin{figure}[!htbp]
    \centering
    \includegraphics{contribution_to_phie_1C.pdf}
    \caption[%
    Contribution to electrolyte overpotential from the gradient-induced polarisation
    term and the bulk solution resistance term for a 1C~discharge
    ]%
    {%
        Contribution to the overpotential in the electrolyte from each of the
        two terms in \cref{eq:electrolytepdwithcenew} for a 1C~discharge. The
        bulk solution resistance is approximated as a constant value determined
        by the equilibrium initial concentration. The concentration dependent
        polarisation term governs the dynamic behaviour of the overall
        overpotential. Furthermore, this gradient-induced diffusion resistance
        has a strong contribution to the steady state, higher than the bulk
        solution resistance and cannot be neglected without introducing
        significant errors.
}%
\label{fig:contributiontophiefromtwoterms}
\end{figure}

\Cref{fig:contributiontophiefromtwoterms} shows the  contribution to the overall
potential drop~$\phi_\text{e,pos}$ and~$\phi_\text{e,neg}$ in  the electrolyte
from  each  of  the  two  terms  in \cref{eq:electrolytepdwithcenew}  for  a  1C~discharge. The bulk  solution resistance is constant owing to  the fact that the
initial  electrolyte concentration  is  used in  computing  the effective  ionic
conductivities in the three regions of  the cell. The gradient induced diffusion
polarisation term, however has a stronger contribution in both the transient and
steady  state. The  entire dynamics  of the  overall potential  drop during  the
transient  phase is  governed by  this concentration-dependent  term, while  its
steady state contribution  is in-fact higher than the  bulk solution resistance.
The  constant  ohmic resistance  term  merely  provides  a non-zero  offset  for
the  electrolyte  solution  overpotential.  In questioning  whether  the  system
identification exercise was indeed worthwhile,  if the concentrations in the two
current collectors had not been computed  at each time-step, then this diffusion
polarisation  term  would  become  zero.  This is  because,  the  numerator  and
denominator in \cref{eq:electrolytepdwithcenew} would have to be retained at the
initial concentration, leading to a unit  ratio whose natural logarithm is zero.
Therefore, it  is clear  that computing  the concentrations  at the  two current
collectors  through system  identification has  indeed helped  in improving  the
modelling accuracy.

Having established the relative  importance of computing the diffusion-dependent
polarisation   overpotential,  the   next  question   that  arises   is  whether
the   constant    approximation   for   the   bulk    solution   resistance   is
indeed   appropriate.   It  also   remains   to   be   seen  if   the   accurate
computation   of  the   ionic   concentration   through  system   identification
(see \cref{sec:perfanalysisnewmodel}) has  translated into a  similarly accurate
computation of  electrolyte overpotential. This  is answered by a  comparing the
electrolyte overpotential computed by the  system identification model with that
obtained from the \gls{p2d} model.

\begin{figure}[!htbp]
    \centering
    \includegraphics{phie_delta_cnst_1C.pdf}
    \caption[%
    Electrolyte  overpotential  computed  by the  \glsfmtshort{p2d}  and  system
    identification models for a 1C~discharge
    ]%
    {%
        Comparison    of    electrolyte    overpotential   computed    by    the
        \gls{p2d}     model    and     the    system     identification    model
        (using \cref{eq:electrolytepdwithcenew}) for a  1C~discharge. During the
        transient phase, the profile obtained by the system identification model
        closely matches that of the \gls{p2d} model. The mismatch in the initial
        overpotential does not arise to the  use of a constant concentration for
        the bulk  resistance contribution,  since at  equilibrium this  value is
        exact and  not an  approximation. Past  the initial  transient, accuracy
        of  the system  identification  model degrades.  This  can be  explained
        by  its  analogous  behaviour   for  concentration  computation  in  the
        \glsfmtlong{qss} (see \cref{subsec:tfquadceconstcurrinput}) for constant
        current inputs.
    }%
    \label{fig:phiedeltacnst1C}
\end{figure}

\Cref{fig:phiedeltacnst1C} shows  a comparison of the  electrolyte overpotential
computed  by   the  \gls{p2d}  and   system  identification  models  for   a  1C~discharge. There  is a discrepancy  in the  initial offset of  the overpotential
value.  However,  this  cannot  be  attributed   to  the  use  of  the  constant
concentration  approximation   in  the   computation  of   ionic  conductivities
in \cref{eq:electrolytepdwithcenew}.  This   is  because,  at   equilibrium  the
concentration used  is exactly  the initial  concentration. Furthermore,  at the
instant of applying the current, diffusion gradients in the electrolyte have not
yet been established.  Hence, the contribution from  the diffusion overpotential
is zero,  which can  also be  seen in \cref{fig:contributiontophiefromtwoterms}.
Thus, it can be  concluded that this initial mismatch is due  to the presence of
some  other unmodelled  phenomena  that  affects the  DC  offset of  electrolyte
overpotential, and is not arising due to the approximations used by this author.

In \cref{fig:phiedeltacnst1C},   the  shape   of   the   transient  profile   of
overpotential  computed  by  the  system identification  model  closely  matches
that  of the  \gls{p2d} model.  This validates  that the  newly developed  model
does  indeed  capture the  electrolyte  dynamics  sufficiently well  during  the
initial transient.  However, past  the initial  transient, the  model's accuracy
degrades and  the resulting  profile does  not track  the \gls{p2d}  model. This
behaviour in overpotential is analogous to that exhibited in the spatio-temporal
concentration   study   discussed  in \cref{subsec:tfquadceconstcurrinput}   for
constant current inputs,  wherein it was deemed that this  newly developed model
is  more  suitable  for  dynamic  loads. The  same  conclusion  for  electrolyte
overpotential   accuracy  is   reached   from  this   constant  current   study.
Nevertheless, even for  constant current loads, using the  newly developed model
is better than having no electrolyte model whatsoever as in the basic \gls{spm}.

\begin{figure}[!htbp]
    \centering
    \includegraphics{phie_delta_udds.pdf}
    \caption[%
    Electrolyte  overpotential  computed  by the  \glsfmtshort{p2d}  and  system
    identification models for a \glsfmtshort{udds} load profile
    ]%
    {%
        Comparison    of    electrolyte    overpotential   computed    by    the
        \gls{p2d}     model    and     the    system     identification    model
        (using \cref{eq:electrolytepdwithcenew}) for a  \gls{udds} load profile.
        The overpotential  profile computed  by the system  identification model
        reasonably matches  the profile obtained  by the \gls{p2d} model  with a
        \glsfirst{mae} of \SI{15.88}{\milli\volt} and  a \glsfirst{rms} error of~\SI{24.11}{\milli\volt}.
    }%
    \label{fig:phiedeltacnstudds}
\end{figure}

\Cref{fig:phiedeltacnstudds} shows a comparison of the electrolyte overpotential
computed by the \gls{p2d} and system identification models for a \gls{udds} load
profile. The  input current corresponding to  this load profile is  shown in the
top row  of \cref{fig:uddssimp2dspmresults}. The system  identification model is
able to  reasonably track  the overpotential profile  computed by  the \gls{p2d}
model. Unlike the  case of sustained unidirectional current input,  the error in
this case  remains well-contained. The  \gls{mae} obtained for this  profile was
\SI{15.88}{\milli\volt}  with  an  \gls{rms}  error  of~\SI{24.11}{\milli\volt}.
This  corresponds to  \SI{8.19}{\percent} and  \SI{12.44}{\percent} of  the peak
magnitude of the overpotential (\SI{193.86}{\milli\volt}).

Hence, it can be concluded  that the electrolyte overpotential computation using
the system identification  model provides an acceptable  performance for dynamic
load profiles.  The next step  is to incorporate this  electrolyte overpotential
calculation into the basic \gls{spm} and to quantify the voltage accuracy of the
resulting composite \gls{spm}.

\subsection{Terminal voltage computation of composite \glsfmtshort{spm}}

In \cref{subsec:simresultsbasicspm}, it  was shown that in  the basic \gls{spm},
the computation of the cell's \gls{soc}  is of sufficient accuracy. However, its
terminal  voltage  strongly deviates  from  the  true  value  as computed  by  a
\gls{p2d} model.  This mismatch between  \gls{soc} and terminal  voltage hinders
the  suitability of  the basic  \gls{spm}  as the  plant model  in online  state
estimation applications. The discrepancy in terminal  voltage is due to the lack
of electrolyte overpotential contribution in  its computation. Having obtained a
suitable methodology  to compute this  (see \cref{subsec:electrolyteopcalc}), it
is now possible to refine the computation of the cell's terminal voltage.

Referring   to \cref{eq:posoverpotential}  and \cref{eq:negoverpotential},   the
reaction overpotential in each of the two porous electrode regions is given by
\begin{align}
    η_\text{pos} &= ϕ_\spos - ϕ_\epos - U_\text{pos} \label{eq:posoverpotentialoverall} \\% \tag{\cref{eq:posoverpotential} revisited}\\
    η_\text{neg} &= ϕ_\sneg - ϕ_\eneg - U_\text{neg} \label{eq:negoverpotentialoverall} %\tag{\cref{eq:negoverpotential} revisited}
\end{align}
wherein  the  contribution  from   the  electrolyte  potential  terms~$ϕ_\epos$
and~$ϕ_\eneg$ are no longer to be neglected.

Subtracting \cref{eq:negoverpotentialoverall}
from \cref{eq:posoverpotentialoverall}
\begin{align}
 η_\text{pos} - η_\text{neg} &= \underbrace{ϕ_\spos - ϕ_\sneg}_{V_\text{cell}} - ϕ_\epos + ϕ_\eneg - U_\text{pos} + U_\text{neg}\\
\shortintertext{whose rearrangement yields}
V_\text{cell} &= η_\text{pos} - η_\text{neg} + \underbrace{ϕ_\epos -
ϕ_\eneg}_{\Delta \phi_\text{e}} + U_\text{pos} -
U_\text{neg}\label{eq:intermediatevoltagewithphie}
\end{align}

Substituting for ${\Delta \phi_\text{e}}$ from \cref{eq:electrolytepdwithcenew} in
into \cref{eq:intermediatevoltagewithphie},  and  expanding  each of  its  terms
(see derivation of \cref{eq:spmbasicoutputvoltagefinal}  for details), the final
expression for the cell's terminal voltage is obtained as
\begin{multline}
    V_\text{cell}(t) = \frac{2 R T}{F }\sinh^{-1} \left( \frac{- I(t)}{2 A l_\text{pos} a_\spos F k_\posr \sqrt{c_\text{e} c_\spossurf(t) \left(c_\sposmax - c_\spossurf(t)\right)}}\right) \\
    - \frac{2 R T}{F }\sinh^{-1} \left( \frac{I(t)}{2 A \, l_\text{neg} a_\sneg F k_\negr \sqrt{c_\text{e} c_\snegsurf(t) \left(c_\snegmax - c_\snegsurf(t)\right)}}\right) \\
    \hphantom{\text{hello worl}}+ (1-t_{+}^0) \frac{2RT}{F}\ln \frac{c_\text{e,\tiny pos/cc}(t)}{c_\text{e,\tiny neg/cc}(t)} -\frac{I}{2 A}\left(\frac{l_\text{neg}}{\kappa_\text{eff,neg}\left(c_\text{e}\left(0\right)\right)} + 2 \frac{l_\text{sep}}{\kappa_\text{eff,sep}\left(c_\text{e}\left(0\right)\right)} +
\frac{l_\text{pos}}{\kappa_\text{eff,pos}\left(c_\text{e}\left(0\right)\right)}\right)\\
    + \mathcal{U}_\text{pos}\left(c_\spossurf(t)\right) - \mathcal{U}_\text{neg}\left(c_\snegsurf(t)\right)\label{eq:spmcompositeoutputvoltagefinal}
\end{multline}

All  other   expressions  and  computations   of  the  basic   \gls{spm}  remain
unchanged (see \cref{sec:spmmodeldevelopment} for the  complete set of equations
constituting the model). The final step  is to show that the composite \gls{spm}
thus obtained has an improved performance especially in those scenarios that the
basic \gls{spm} performed poorly.

\subsection{Validation of composite \glsfmtshort{spm}: Terminal voltage accuracy}

The final  step in  this model  development effort is  the validation  phase. In
particular, the voltage accuracy of  the composite \gls{spm} is compared against
the  \gls{p2d} model  for standard  input conditions.  In order  to compare  and
contrast the  gains achieved  by the composite  \gls{spm}, the  terminal voltage
output of the basic \gls{spm} is also considered here.

\subsubsection*{Constant Current Inputs}

The  voltage  accuracy of  the  newly  developed  composite \gls{spm}  is  first
evaluated for  the standard test  case of 1C~discharge current starting  from a
cell \gls{soc} of~\SI{100}{\percent}.

\begin{figure}[!htbp]
    \centering
    \includegraphics{composite_spm_vcell_1C.pdf}
    \caption[%
    Comparison  of  terminal  voltages  of  composite  \glsfmtshort{spm},  basic
    \glsfmtshort{spm} and the \glsfmtshort{p2d} model for a 1C~discharge
    ]%
    {%
        Voltage output  of various \glspl{spm}  for a 1C~discharge  beginning at
        \SI{100}{\percent} \gls{soc} (top  plot). Since it does  not account for
        electrolyte overpotentials,  the voltage  profile computed by  the basic
        \gls{spm} lies above that of the benchmark \gls{p2d} model. On the other
        hand, the composite \gls{spm} tends  to over correct for the electrolyte
        overpotential  so that  its terminal  voltage lies  below the  \gls{p2d}
        output. Since  the two \glspl{rom}  have outputs  on either side  of the
        \gls{p2d}  model,  it  is  convenient  to  use  the  absolute  error  to
        compare  them. In  the  bottom  plot, the  percentage  deviation of  the
        absolute error of the two  \glspl{rom} is shown. The composite \gls{spm}
        performs  significantly better  with a  peak absolute  error of  \approx
        \SI{4}{\percent} in  contrast to nearly \SI{11}{\percent}  for the basic
        \gls{spm}.
    }%
    \label{fig:voltageoutputcompareallSPMs1C}
\end{figure}

\Cref{fig:voltageoutputcompareallSPMs1C}  shows the  terminal voltage  output of
various \glspl{spm} for a 1C~discharge beginning at \SI{100}{\percent} \gls{soc}
(top  plot). Since  it  does  not account  for  electrolyte overpotentials,  the
voltage profile computed by the basic \gls{spm} lies above that of the benchmark
\gls{p2d}  model. On  the  other hand,  the composite  \gls{spm}  tends to  over
correct  for the  electrolyte overpotential  so that  its terminal  voltage lies
below  the \gls{p2d}  output. Since  the output  of the  two \glspl{rom}  lie on
either side of the \gls{p2d} model, it  is appropriate to use the absolute value
of their errors with respect to the  \gls{p2d} benchmark to compare them. In the
bottom  plot,  the  percentage  deviation  of the  absolute  error  of  the  two
\glspl{rom} is shown. The statistics of this deviation is quantified
in \cref{tbl:errorsummarycntcurrdischgallspms}.

\begin{table}[!htbp]
    \caption[%
    Error statistics for basic  and composite \glsfmtshortpl{spm} for 1C~discharge
    ]%
    {%
    Summary of statistics for the percentage absolute error
        in terminal voltage
    for the basic \glsfmtshort{spm} and the composite \glsfmtshort{spm} in constant current 1C~discharge simulations.
}%
    \label{tbl:errorsummarycntcurrdischgallspms}
    \centering
    \begin{tabular}{@{} l S[table-format=2.2] S[table-format=1.2] @{}}
        \toprule
        \makecell{Error Statistic \\ for \si{\percent}$\abs{\hat{\varepsilon}_v}$} & {\makecell{Basic \\ \glsfmtshort{spm}}} & {\makecell{Composite \\ \glsfmtshort{spm}}} \\
        \midrule
        Worst Case        & 10.67 & 4.05 \\
        Mean              & 2.92  & 1.54 \\
        \glsfmtshort{rms} & 3.27  & 1.65 \\
        \bottomrule
    \end{tabular}
\end{table}

In  each of  the error  statistic considered,  the composite  \gls{spm} performs
significantly better than the basic \gls{spm} for the 1C~discharge case.

One   of   the   biggest   drawbacks   of   the   conventional   \gls{spm}   was
its    poor    voltage    accuracy    at    moderate    C-rates    above~0.5C
(see \cref{tbl:errorsummarycntcurrdischgspmp2d}). The high accuracy achieved for
the 1C~rate  seems to indicate that  the composite \gls{spm} is  indeed a viable
solution for all  high C-rates, especially given the backdrop  of its methodical
derivation steeped in systems theory.

However,  there exists  a  fundamental  flaw in  all  models  that use  a~priori
assumptions  of  simplified spatial  profiles  for  ionic concentration  in  the
electrolyte.  In  the  case  of  both the  baseline  quadratic  and  the  system
identification models, a parabolic profile spanning the entire thickness of each
region within the cell was chosen a~priori. However, no attempt to modify the
profile upon encountering an ion starvation event at any spatial location.

This  critical flaw  is  exposed  by the  sustained  application  of any  higher
current  that  induces  an  ion  starvation at  one  of  the  electrodes  during
operation.\Cref{fig:2Cionstarvation}  depicts  the  ionic concentration  in  the
electrolyte  over  time at  both  current  collectors  for a  2C~discharge.  The
profiles  computed  by  both  the \gls{p2d}  and  system  identification  models
are  plotted.  For  the  system  identification  model,  the  current  collector
interface  at  the  positive  electrode  experiences  an  ion  starvation  event
at~\approx\SI{150}{\second}. The  quadratic spatial  profile used by  this model
does not account for such a  reduction in the effective electrode thickness. All
the  boundary conditions  and coefficients  were formulated  using the  original
electrode  thickness.  Therefore,  beyond \SI{150}{\second},  the  concentration
becomes negative which  is not physically meaningful. The author  of this thesis
has implemented a saturation mechanism in the code that detects an ion depletion
event and prevents the concentrations from becoming negative.

Implementing  this  hard   lower  bound  of  zero  for   the  ion  concentration
does    not   mitigate    the   problems    associated   with    computing   the
electrolyte   overpotential.   Specifically,  computational   difficulties   are
encountered    when   computing    the    concentration   dependent    diffusion
overpotential \cref{eq:electrolytepdwithcenew}. In the case  of ion depletion at
the positive  current collector,  the argument of  the logarithmic  term becomes
zero which leads to a non-feasible computation~($-\infty$). Ion depletion at the
negative current collector  is equally detrimental to  the computation. However,
this scenario has  a lower probability owing to the  low C-rates during charging
operation (see \cref{subsec:basicspmsimsetup}).  Furthermore, in the  absence of
the lower  bound of zero  for the  concentrations, complex numbers  are obtained
from  the logarithmic  term, which  lead to  physically erroneous  overpotential
calculations. An  alternative is  to simply omit  the diffusion  impedance term.
However, since  this term is  responsible for  the large-signal dynamics  of the
overpotential (see \cref{fig:contributiontophiefromtwoterms}), omitting this and
reverting to  a simple ohmic  resistance contribution shall lead  to significant
errors  in  the electrolyte  overpotential,  and  consequently in  the  terminal
voltage.  Finally, setting  the diffusion  impedance to  zero at  the transition
boundary of ion starvation is also not a feasible solution. This is because, the
sudden inflection in  the trajectory of the terminal voltage  shall induce large
errors in any state estimation algorithms that depend on the composite \gls{spm}
as the plant model.

The  difficulties  encountered  in electrolyte  overpotential  computations  for
ion  depletion scenarios  have  not  yet been  discussed  in  the literature  by
the  research  community that  use  such  quadratic approximation  models.  This
thesis author  therefore assumes that  such a  scenario had not  been previously
encountered  for  the  parameter  set  and C-rate  combinations  used  by  those
researchers. Despite the  fact that this phenomenon might be  an artefact of the
idiosyncrasies of the  parameter set used here, it  is nevertheless questionable
to not  have mathematically adapted  the parabolic  profile to such  events. The
aspect  of rendering  the model  robust to  such vagaries  is currently  an open
problem in the field and can be the subject of future research. It can therefore
be concluded that  this composite \gls{spm} is \emph{unsuitable}  in its present
form for  sustained constant current  discharge at higher C-rates.  Despite this
setback due  to deficiencies in  the mathematical formulation of  the underlying
spatial profile, the superior performance  of the system identification model in
the computation  of ionic  concentrations and overpotentials  for \emph{dynamic}
conditions warrant such a study for the composite \gls{spm}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{problematic_2C_conc.pdf}
    \caption[
    Time evolution of ionic concentration computed by the \glsfmtshort{p2d} and system
    identification models at both current collectors for a 2C~discharge
    ]
    {%
        Time evolution of ionic concentration in electrolyte computed by the \gls{p2d} and
        system identification models at ---
        \begin{enumerate*}[label=\emph{\alph*})]
            \item negative current collector interface (left plot), and
            \item positive current collector interface (right plot)
        \end{enumerate*}
        for a constant current discharge at \SI{120}{\ampere} \ie~2C. In the
        system identification mode, ion
        starvation occurs at the positive current collector interface at~\approx\SI{150}{\second}. The quadratic spatial profile used by the system
        identification model spans the entire electrode region and does not
        account for ion depletion scenarios. In this thesis, the author has
        implemented a saturation mechanism in the computer code to prevent the
        ionic concentration from becoming negative. Despite this
        mitigating action, the computation of electrolyte overpotential
        using \cref{eq:electrolytepdwithcenew} is problematic in such scenarios.
    }%
    \label{fig:2Cionstarvation}
\end{figure}

\subsubsection*{Dynamic Load Conditions}

In  order to  evaluate the  performance of  the composite  \gls{spm} to  dynamic
inputs, the  input profile  corresponding to  the \gls{udds}  drivecycle profile
in \cref{fig:uddssimp2dspmresults}  with  a  peak current  of  \SI{180}{\ampere}
\ie~3C was used.

\Cref{fig:voltageoutputcompareallSPMsudds}  shows  the  voltage  output  of  the
composite  \gls{spm}  for a  \gls{udds}  input  profile  with a  peak  magnitude
of   \SI{180}{\ampere}  \ie~3C  (see \cref{fig:uddssimp2dspmresults}).   The
voltage   profiles  computed   by  the   basic  \gls{spm}   and  the   benchmark
\gls{p2d}  model   is  also  overlaid   (top  plot).  The   percentage  absolute
error  of  the  two  \glspl{rom}  relative  to  the  \gls{p2d}  model  is  shown
in  the  bottom  plot.  Clearly,  it  is  seen  that  the  terminal  voltage  of
the  composite  \gls{spm}   is  significantly  more  accurate   than  the  basic
\gls{spm}  (see \cref{tbl:errorsummaryuddsdischgallspms}).   For  instance,  the
voltage  profile  computed by  composite  \gls{spm}  matches the  complex  shape
characteristics  of the  \gls{p2d} model  while remaining  very close  to it  in
magnitude.

\begin{figure}[!htbp]
    \centering
    \includegraphics{composite_spm_vcell_udds.pdf}
    \caption[%
    Terminal voltage output of --- \emph{a}) the \glsfmtshort{p2d} model, \emph{b}) the
    basic \glsfmtshort{spm}, and \emph{c}) the composite \glsfmtshort{spm} for a
    \glsfmtshort{udds} input profile
    ]%
    {%
        Voltage output of the composite \gls{spm} for a \gls{udds} input profile
        with a peak magnitude of \SI{180}{\ampere} \ie~3C
        (see \cref{fig:uddssimp2dspmresults}). The voltage
        profiles computed by the basic \gls{spm} and the benchmark \gls{p2d}
        model is also overlaid (top plot). The percentage absolute error of the
        two \glspl{rom} relative to the \gls{p2d} model is shown in the bottom
        plot. The terminal voltage of the composite \gls{spm} is significantly
        more accurate than the basic \gls{spm}
        (see \cref{tbl:errorsummaryuddsdischgallspms}).
    }%
    \label{fig:voltageoutputcompareallSPMsudds}
\end{figure}

\begin{table}[!htbp]
    \caption[%
    Error statistics for basic  and composite \glsfmtshortpl{spm} for a \glsfmtshort{udds} load profile
    ]%
    {%
    Summary of statistics for the percentage absolute error
        in terminal voltage
        for the basic \glsfmtshort{spm} and the composite \glsfmtshort{spm} with \gls{udds} input profile.
}%
    \label{tbl:errorsummaryuddsdischgallspms}
    \centering
    \begin{tabular}{@{} l S[table-format=2.2] S[table-format=1.2] @{}}
        \toprule
        \makecell{Error Statistic \\ for \si{\percent}$\abs{\hat{\varepsilon}_v}$} & {\makecell{Basic \\ \glsfmtshort{spm}}} & {\makecell{Composite \\ \glsfmtshort{spm}}} \\
        \midrule
        Worst Case        & 2.59 & 0.72 \\
        Mean              & 0.51 & 0.11 \\
        \glsfmtshort{rms} & 0.68 & 0.16 \\
        \bottomrule
    \end{tabular}
\end{table}

In  summary, while  the newly  developed composite  \gls{spm} is  not considered
robust for use in  sustained discharge at high C-rates, it  is indeed a suitable
option for  dynamic load profiles, even  for those with high  peak magnitudes of
instantaneous charge or discharge. Such  load profiles are typically encountered
in vehicular  applications, particularly  in hybrid  electric vehicles.  Thus, a
suitable time-domain \gls{rom} that can be directly implemented in discrete-time
has  been  developed  through  system   identification  and  its  strengths  and
weaknesses have been quantified. The applicability of this model has been proven
for real-life  scenarios using a  highly dynamic  load cycle. Thus,  this author
concludes that the  composite \gls{spm} developed here does  indeed represent an
advancement to  the present  modelling art. This  model may now  be used  as the
plant  model  in  state  estimation  and control  applications  in  a  vehicular
\gls{bms}. This concludes the chapter as  well as all the implementation aspects
of physics-based battery modelling discussed in this thesis.

\setcounter{chapter}{6}

\clearpage
\chapter{Conclusions}\label{ch:conclusions}
\startcontents[chapters]
\printcontents[chapters]{}{1}{\setcounter{tocdepth}{1}}

\bigskip

\capolettera{I}{n} this  thesis, the  deployment of  physics-based computational
modelling  of lithium  ion  cells  for electric  vehicle  applications has  been
rigorously examined  with a three-pronged strategy  \viz~through their analysis,
design and implementation.  The \gls{p2d} implementation of  the \gls{dfn} model
was  used  as  the  backbone  of  all  modelling  efforts.  Salient  conclusions
drawn  from each  of these  aspects are  presented in  this chapter.  Based upon
the  invaluable  experience gained  during  the  course  of this  research,  and
particularly  from the  findings presented  herein, key  areas in  physics-based
modelling that can benefit from further study in the future are also identified.

\section{\glsfmtlongpl{pbm} as a Design Tool}

\subsection{Conclusions from the model-based design study}\label{sec:modelbasedconclusion}

\Cref{ch:modelbaseddesign} presented  a computational framework to  optimise the
number  of electrochemical  layers within  a pouch  cell so  as to  maximise its
usable energy while  meeting specific power demands. In  particular, this helped
to construct a model-based deterministic approach to optimally design cells that
can  be subjected  to  fast-charging without  the concerns  of  plating. In  the
context of electric vehicle applications,  using this approach has the potential
to alleviate  the two immediate concerns  of consumers \viz{} range  anxiety and
long charging times.

To  facilitate  immediate  adoption   by  relevant  stakeholders,  the  concepts
developed  in  the  optimisation  framework  of  \cref{ch:modelbaseddesign}  was
realised in  computer code and  presented in the  form of an  open-source design
toolbox, \gls{bold}. This toolbox was applied  to the optimal layer design of an
example cell from literature to obtain two sets of power-dependent optimal layer
configurations for two drivetrains --- a \gls{bev} and a \gls{phev}. By suitably
adapting the  numerical values of  parameters to a real-world  cell, model-based
cell  designs can  be  obtained, which  can potentially  help  to eliminate  the
current trend  of over-engineering of  cells using conservative  empirical layer
choices.

From a  perspective of technical  advancements to the underlying  \gls{pbm}, the
standard form  of the \gls{p2d} model  has been suitably modified  to facilitate
a  direct  application of  input  power  densities.  This was  achieved  through
reformulation of the boundary conditions on the solid-phase potential \gls{pde}.
Although  this innate  power input  capability has  been claimed  as purportedly
developed  in  extant  literature,  its independent  derivation  and  accessible
documentation  provided herein  shall help  other researchers  to apply  this in
a  straight-forward  manner  for  vehicle drivecycles,  acceleration  tests  and
power-based charging protocols.

This investigation also  revealed that the fast charging  process determines the
optimal layer  configuration instead of  either acceleration runs  or drivecycle
requirements. This may  help to counter the current trend  in publications which
often rely  primarily upon a  drivecycle-based dynamic input current  profile to
evaluate various  aspects of cell  modelling such as predicting  degradation and
for advanced control and estimation  algorithms. While validation against such a
dynamic input profile  is certainly vital, for future  advancements dealing with
aspects  of  cell  design  or plating-related  degradation,  validation  against
fast-charging power profiles is deemed to be absolutely essential.

The  study  also  provided  important  guidelines  about  the  role  of  thermal
environment on cell performance. It became  clear that at very low temperatures,
a high  number of layers was  required for satisfying a  specific charging power
level relative  to that  needed at  moderate thermal  environments such  as room
temperatures. A practical  takeaway from this conclusion is that  it suffices to
use a low number of layers in  vehicles to be sold in territories with perennial
moderate temperature conditions.

Finally, this design study revealed that the speed at which lithium intercalates
into the negative  electrode during charging limits the  charge-addition rate to
the cell. Lowering  the charging times of electric vehicles  requires the use of
higher charging  powers. However, this necessitates  a high number of  layers to
absorb the overpotentials  and to provide adequate number  of thermal conduction
pathways (owing  to the higher  number of  current collectors) to  dissipate the
additional heat  generated. Consequently, this  has a detrimental effect  on the
capacity and hence, the \gls{aer} of the vehicle.

\subsection{Future work informed by  the optimal layer design framework}

As     a     direct     inference     of     the     final     conclusion     in
\cref{sec:modelbasedconclusion}, assuming that  the electric grid infrastructure
is  adequately equipped  to cope  with  the surge  in future  power demands  for
charging  of  electric vehicles,  the  solid  state  diffusion at  the  negative
electrode becomes the bottleneck. It  is therefore important for future research
to  focus  on the  development  of  new  materials  for the  negative  electrode
possessing much higher  solid phase diffusion coefficients,  particularly at low
temperatures.

From a perspective of improving the framework itself, at the outset, it is clear
that the plating threshold assessment can be made more accurate by incorporating
the solid phase diffusion coefficient as  function of \gls{soc}. In the interest
of simplicity and  to lay the foundation for such  model-based cell designs, the
scope of this  work was intentionally narrowed down to  solely focus on changing
the layer  configurations within  cells. In doing  so, certain  assumptions were
made  that  might have  to  be  revisited  and  potentially relaxed  before  its
application to real-world cell designs.

For instance, adherence  to the specific type of cooling  phenomena used \ie~tab
cooling, is one of the stronger assumptions used in this work. In this work, the
benefits of  employing this  cooling mechanism  has been  enumerated, and  it is
desirable that future  pack designs adopt it. However, the  vast majority of the
current generation of battery packs  use surface-cooled designs. This means that
temperature for all layers within the pouch shall not be the same, which further
implies that it longer suffices to  simulate just a single layer. Therefore, the
framework  needs  to be  suitably  modified  to  handle multiple  layer  choices
concurrently.

Furthermore,  using surface  cooling shall  invalidate the  assumption of  small
thermal gradients along the planar axis of  the cell. This means that the lumped
thermal model  shall no longer  be accurate  to model the  temperature evolution
of  the cell.  Furthermore,  the differential  temperature  evolution along  the
cross-sectional direction  shall influence the transport  and kinetic properties
of the  cell. This electrochemical-thermal  coupling along the  planar direction
shall necessitate adding another spatial  dimension to the underlying \gls{pbm},
thereby rendering the  presently used \gls{p2d} model ineffective.  With the aim
of minimising  the optimising  run-times, future  research may  focus on  how to
suitably adapt the computational infrastructure that was proposed in this thesis
to account for these considerations.

For  real-world cell  designs, it  is prudent  to examine  the examine  the role
of  variable  porosities  to  achieve  the balancing  of  active  materials  per
layer.  Since  the computational  framework  developed  in  this thesis  uses  a
modular  approach, in  the  future  the constant  volume-fractions  used in  the
methodology  could simply  be replaced  by values  informed by  optimal porosity
computations. For this purpose, researchers could investigate the feasibility of
adapting  a suitable  scheme from  the available  pool of  literature that  have
focussed  on  using  model-based  porosity  optimisation~\cite{Xue2013,Xue2014a,
Christensen2006}. Finally, experimental prototyping is  an important step in any
cell  design and  it  is  no exception  here  either. Therefore,  experimentally
applying the desired power levels to confirm the optimal layer choices predicted
by the  framework is an important  step to be undertaken  before its large-scale
deployment.

\section{Analysis of Salient Physics-based \glsfmtlongpl{rom}}

Chapters~\ref{ch:improveddra} and~\ref{ch:spmanalysis} of  this thesis primarily
focussed on performing an in-depth analysis of two distinct \glspl{rom} from two
distinct perspectives.  In \cref{ch:improveddra}, the hybrid  \gls{rom} obtained
by  using the  \gls{dra}  is analysed  to  investigate its  \emph{computational}
bottlenecks. In \cref{ch:spmanalysis}, an in-depth analysis of a niche selection
of  candidate models  from  the  family of  \glspl{spm}  is  presented from  the
perspective of \emph{modelling accuracy} \ie~their ability to faithfully compute
the  system-level quantities  of the  cell such  as its  \gls{soc} and  terminal
voltage. Finally, the early portions of \cref{ch:newelectrolytemodel} provides a
thorough analysis  of the bottlenecks  of the quadratic approximation  model for
computing the  spatial profile  of ionic concentration  in the  electrolyte. The
conclusions drawn  from all aforementioned  analyses are presented  next. Topics
that may  be of interest to  future researchers engaging with  these \glspl{rom}
are also proposed.

\subsection{Conclusions from analysis of the \glsfmtshort{dra}-based state-space \glsfmtshort{rom}}

In \cref{ch:improveddra}, \gls{svd} of a large Block-Hankel matrix is identified
as a key computational bottleneck  in applying the classical \gls{dra} procedure
for the hybrid \gls{rom} discussed therein. It is concluded that this bottleneck
arises due  to the  slow dynamics of  solid phase diffusion  which leads  to the
aforesaid large sized Block-Hankel matrices.

To mitigate this  bottleneck, an improved \gls{dra} scheme  was presented, whose
centrepiece is an iterative \gls{svd}  algorithm. This algorithm was obtained as
a  combination of  the Golyandina-Usevich  and Lanczos  algorithms discussed  in
\cref{ch:improveddra}.  The results  of applying  the improved  \gls{dra} scheme
demonstrate  a significant  performance improvement  achieved by  using the  new
method  without trading-off  model  fidelity.  At a  single  operating point  of
\gls{soc}  and temperature,  for  a  Hankel block  size  of~8000, the  \gls{rom}
workflow incorporating the improved  \gls{dra} is approximately 100~times faster
than that employing the classical  \gls{dra}. On a standard computer workstation
whose  specifications  are  given in  \cref{ch:improveddra},  for  100~operating
points  (combinations of  10~\gls{soc}  and temperature  values), obtaining  the
\gls{rom}  required  only 6~hours  using  the  improved \gls{dra},  whereas  the
classical \gls{dra}  consumed 666~hours~(\approx 27~days). Furthermore,  for the
same block-size, the improved \gls{dra} is  demonstrated to be superior in terms
of memory efficiency,  drastically reducing the memory  requirements from 112~GB
down to  2~GB. Finally, the  improved \gls{dra} demonstrates  improved modelling
accuracy even  in moderately  equipped computing  environments such  as standard
consumer-grade laptops.

\subsection{Future outlook for the \glsfmtshort{dra}-based hybrid state-space \glsfmtshort{rom}}

The improved  \gls{dra} method  proposed in  \cref{ch:improveddra} opens  up the
possibility of  applying the  hybrid \gls{rom}  modelling procedure  to physical
quantities in  other locations within the  cell's geometry \eg~in the  middle of
the electrode region,  without being hindered by  computational limitations that
would  have otherwise  rendered  it intractable.  Furthermore, high  sample-rate
\glspl{rom} capable of handling highly dynamic  load profiles can be deployed in
future \gls{bms} applications.  The proposed scheme also  empowers the \gls{rom}
framework to tackle other cell chemistries with slower diffusion coefficients or
even  those with  completely different  rate-limiting mechanisms,  and therefore
prima~facie, appears to be promising.

Despite   the  aforementioned   euphoric   possibilities   facilitated  by   the
streamlining  of  the reduced  order  modelling  workflow through  the  improved
\gls{dra},  there  exists a  fundamental  deficiency  in this  hybrid  modelling
approach  that impede  its near-term  adoption in  state estimation  tasks. This
aspect was already discussed in \cref{ch:littreview} and is reiterated here. The
entries  in  the  matrices  of  the  final  state  space  model  depend  on  the
linearisation point of \gls{soc} and temperature. This linearisation requirement
adversely affects the usability of the model for state estimation tasks, wherein
the \gls{soc} is in fact an unknown quantity and is to be estimated. This cyclic
dependency  between  the linearisation  point  and  the state-estimation  entity
renders this  model questionable for use  in a demanding application  such as in
embedded \glspl{bms} on-board electric vehicles. Therefore, the immediate future
step is to analyse  the stability of this internal feedback  loop. Once this has
been performed,  researchers may consider to  engage in the process  of adapting
the derivation of this hybrid  state-space \gls{rom} approach to higher C-rates,
in conjunction  with the numerical  benefits afforded by the  improved \gls{dra}
developed here.

\subsection{Conclusions from analysis of the \glsfmtshort{spm} family of models}

Based    upon   the    holistic   evaluation    of   various    \glspl{rom}   in
\cref{ch:littreview},  owing   to  its  simplicity,  the   \gls{spm}  family  of
models  was  identified  as  the  most promising  modelling  candidate  from  an
\emph{implementation}  perspective. \Cref{ch:spmanalysis}  provided an  in-depth
analysis of the strengths and drawbacks of this modelling family.

Results from  simulation of  the basic \gls{spm}  revealed that  two contrasting
aspects. Firstly, the  \gls{soc} computation of the \gls{spm}  was of acceptable
accuracy even at moderate C-rates thereby validating the fourth order polynomial
approximation approach  for capturing  solid phase diffusion  dynamics. However,
the basic  \gls{spm} suffers  from severe inaccuracies  in computing  the cell's
terminal voltage  at currents above  0.5C. This dichotomous  behaviour, revealed
through  this  analysis, has  not  been  explicitly  commented upon  in  present
literature.  In  particular,  despite  its overarching  simplicity,  it  can  be
concluded that it is this contrasting  aspect that renders the model unusable as
the  plant model  for  state  estimation tasks.  This  is  because, the  voltage
measured  from the  model  in a  feedback  estimator shall  map  to a  radically
distant \gls{soc} operating point requiring  excessively strong gain factors for
correcting it adversely affecting the stability of estimators.

Several  research efforts  from literature  that  have attempted  to tackle  the
voltage inaccuracies  of the  basic \gls{spm}  through inclusion  of electrolyte
dynamics were also presented in  \cref{ch:spmanalysis}. A critical evaluation of
each  of  the  salient  efforts  revealed that  a  suitable  approach  that  can
successfully handle all possible operational scenarios  is yet to be devised. In
particular, the  existing modelling approaches for  electrolyte inclusion either
made  far-fetched assumptions  that  were easily  violated  or presented  nearly
intractable  mathematical  expressions  that  pushed  the  \gls{spm}  closer  in
computational complexity  to the  \gls{p2d} dynamics.  My analysis  of pertinent
literature  also  revealed  the  possibility of  re-using  certain  portions  of
existing work \eg~the electrolyte  overpotential expression, whilst also arguing
the need  for a fresh  approach to model  other aspects of  electrolyte dynamics
such as the ionic concentration profile within the cell's thickness.

The  final  section  of  \cref{ch:spmanalysis}  presented  the  assumptions  and
governing equations of the popular quadratic approximation model for the spatial
profile of  ionic concentration. The  results obtained by simulating  this model
reveal that while its spatial  profile computation for a galvanostatic operation
is of  acceptable accuracy, the temporal  performance of the model  is mediocre.
Particularly, the time evolution of ionic concentration at the current collector
interfaces computed by the model fail to capture the intricacies in the temporal
evolution exhibited by  the \gls{p2d} model's profile.  Furthermore, the spatial
profile uses  the \gls{qss} approximation  which is violated during  the initial
transient. Hence, the  most impactful conclusion from the  foregoing analysis is
that the  basic quadratic approximation  model is unsuitable for  dynamic loads,
thereby ruling it out for deployment in vehicular applications.

The initial portions of \cref{ch:newelectrolytemodel} analysed the causal factor
contributing to the mediocre performance of the quadratic approximation model.
For this analysis, a genetic programming approach was employed to synthesise
suitable alternative reduced order equations for modelling the spatial profile
of the electrolyte concentration. The foregoing analysis helped to reveal that
given the constraints and interior-point boundary conditions of the underlying
\gls{dfn} model at the separator interfaces, the number of coefficients used in
the quadratic spatial profile does indeed make the best use of all available
equations. The genetic programming approach being able to synthesise suitable
mathematical structures that can potentially capture the spatial profile
accurately during both transient and steady state conditions. However, there is
a shortfall in the number of equations in order to uniquely solve for these
extra coefficients. The final conclusion that stems from this fact is that, by decoupling
the spatial and temporal profiles of the electrolyte concentration dynamics, the
performance of the present state of the art can indeed be improved upon.

\subsection{Proposed analysis routes for the \glsfmtshort{spm} modelling family}

Albeit extensive, the analyses of \glspl{spm}  performed in this thesis is by no
means complete. It is more appropriate to  say that this author chose to analyse
\glspl{spm} from  their implementation  perspective, particularly  their voltage
and \gls{soc}  accuracies in  an open-loop  implementation. However,  a holistic
evaluation covering  other aspects  are necessary before  their deployment  in a
vehicular \gls{bms} can be considered. For instance, the observability of models
must be  proven before  they can  be employed in  the feedback  path of  a state
estimator. Even  within the  broad stream of  observability analysis,  there are
several details that  need to be meticulously handled of  which some avenues for
future exploration are identified.

In the  simplification of the  state-vector of  the basic \gls{spm}  proposed by
Di~Domenico~\cite{DiDomenico2010}, the bulk concentration  in the two electrodes
was assumed to be equal  (see \cref{subsec:basicspmstatespace}). This allowed to
eliminate the bulk concentrations of one of the two electrodes, thereby reducing
the state  vector to~$\mathbb{R}^{3  \times 1}$. This  assumption hinges  on the
assumption  that  there is  no  loss  of  cycleable  lithium. However,  such  an
assumption  is valid  only for  a brand  new cell.  As the  cell ages,  owing to
various  phenomena such  as parasitic  side reactions  and decomposition  of the
solid conductive matrix,  this assumption shall no longer  hold true. Therefore,
analysis  of models  obtained by  augmenting the  basic or  electrolyte-enhanced
\glspl{spm}  with equations  describing degradation  shall become  critical. Not
only does this force to retain both bulk concentrations in the state vector, the
states from the  degradation rate-equations appear in it,  thereby enlarging it.
In  future  studies, the  effect  of  these  augmented  state variables  on  the
observability of the system needs to be quantified.

In this thesis,  only an \emph{isothermal} analysis of  various \glspl{spm} have
been performed. While this is an important initial step to analyse the strengths
and weaknesses of  the state of the art incumbent  \gls{spm} models by isolating
the  purely  electrochemical  aspects,  the  effect  of  temperature  cannot  be
underplayed. It  is well-known that the  thermal conditions of the  cell affects
its  electrochemical  and  vice-versa.  Therefore, future  works  shall  benefit
from  performing  comprehensive   analyses  of  coupled  electrochemical-thermal
\glspl{spm}. Considering the simplicity of \glspl{spm}, the lumped thermal model
might be a suitable candidate for it be paired with. Finally, in addition to its
influence  on the  accuracy of  open-loop  terminal voltage  and \gls{soc},  the
effect of  temperature on the  observability of the  holistic model needs  to be
evaluated. Since the cell temperature is available as an additional measurement,
it is likely to improve the model's observability. However, there is a trade-off
since this comes at  the cost of increased size of the state  vector. It is also
worthwhile  to explore  the  inflection point  of this  trade-off  to limit  the
model's fidelity at  a sufficient level whilst reaping the  maximum gains out of
the additional temperature measurement.

Based upon the conclusion that the performance of any reduced order spatial
profile model is hamstrung by the equation deficiencies in the underlying
\gls{dfn} model, it is worthwhile to reproduce the \gls{mggp} approach with a
different \gls{pbm}. For this future task, it is imperative to choose a model
that provides additional interior-point conditions \ie{} not just at the
separator, but perhaps a second order condition within an interior location at
each electrode. Once such a suitable \gls{pbm} has been identified, this thesis
author is confident that the genetic programming approach shall indeed
synthesise an accurate description of the electrolyte's spatio-temporal
dynamics.

\section{Implementation Aspects of Basic and Composite \glsfmtshort{spm}}

A driving impetus behind this thesis is to deliver \glspl{rom} amenable  to
embedded \emph{implementation}. Large portions of \cref{ch:spmanalysis} and
nearly the entirety of \cref{ch:newelectrolytemodel} were devoted to this study.
The conclusions that emerged from these implementation efforts are summarised
here. Future areas of research are also identified in-line.

In \cref{ch:spmanalysis}, the aspects of discrete-time implementation in a
microcontroller were discussed. In particular, the computation of the
discrete-time system and input matrices through  the  matrix exponential
approach is presented. A straightforward conclusion from the discrete-time
implementation is that they run orders of magnitude faster than their
continuous-time counterparts. This is owing to the fact that adaptive
time-stepping integrators are not required and can be replaced by a simple
matrix-vector multiplication scheme. This implementation detail provides
necessary starting point for battery researchers to start coding the \glspl{rom}
discussed herein. Future work in this direction shall benefit from including
various real-world issues such as accounting for sample delays as well as
implementing a progressive update scheme for the matrix entries to account for
degradation effects. Important aspects of numerical implementation arise during
the design of state estimators. Having a robust open-loop implementation of a
discrete-time plant model shall facilitate easy implementation of such feedback
algorithms.

\Cref{ch:newelectrolytemodel} discussed the implementation aspects of \gls{rom}
from a different perspective --- that of formulating a new electrolyte enhanced
composite \gls{spm} for embedded implementation. The temporal evolution of
electrolyte dynamics in the two electrode regions were characterised through
system identification techniques that have never been tried before in
literature. The identified model structures are presented in the final form as
discrete-time difference equations that can be readily incorporated into the
discrete-time equations developed in \cref{ch:spmanalysis} for the basic
\gls{spm}. The salient conclusion from this modelling effort is that, system
identification is indeed a viable candidate for the derivation of \glspl{rom} of
lithium ion batteries. The improved accuracy of electrolyte concentration
dynamics relative to the state of the art quadratic approximation model
corroborates the success of this strategy. Nevertheless, before widespread
adoption of this technique can be advocated, certain aspects of this approach
must be examined carefully. For instance, the assumptions of linearity and
time-invariance must be revisited for higher magnitudes of charge and discharge
currents. Thermal effects must also be incorporated into the overall system
identification approach. Machine learning and system identification are two
complementary approaches to the same task \ie~identification of internal
dynamics from terminal measurements. Future research could also explore this
possibility and perhaps a combined system identification/machine learning
strategy might metamorphose into the approach that powers future generation of
surrogate \glspl{rom} for electric vehicle applications.

\section{Closing Remarks}

The feasibility of bringing \glspl{pbm} of lithium batteries into electrified
transportation has been studied in this thesis from a multi-dimensional
perspective. Yet, there exists a common underpinning that connects these
seemingly different routes to enhancement of our extant knowledge --- that of
parametrising the underlying \gls{pbm}. The number of parameters in any
\gls{pbm} is excessively large to the point of detracting potential adopters.
Even without considering degradation effects, obtaining the physical, geometric,
transport and kinetic parameters of a cell shall require access to specialised
laboratory equipment that are sometimes exclusive to large scale research
organisations. The studies discussed here shall assume real-world significance
only upon a successful demonstration of a cost-effective parametrisation
strategy. The author's contributions to an optimal `Design of Experiments~(DoE)'
numerical procedure for identifying the parameters of an \gls{spm} is detailed
in~\cite{Pozzi2018}. However, the broader task of parametrising a
full-order \gls{pbm} is well beyond the scope of this thesis or indeed any
single researcher, and needs the concerted effort of the community as a whole to
tackle it.

The next task in the journey to real-world implementation of the advancements
brought about by this thesis is to  experimentally validate them. However, this
is contingent upon obtaining a successful parametrisation strategy, and should
be embarked upon as soon as a robust procedure to identify the physical
parameters is made available. Nevertheless, this author hopes that through the
three-pronged approach to cell modelling presented in this thesis, the goal of
bringing physics-based battery models to electrified transportation has been
brought a step closer to realisation.

\backmatter
\singlespacing
\begin{footnotesize} % Bibliography/References
    \renewcommand{\bibname}{References} % changes the header; default: Bibliography
    \cleardoublepage
    \phantomsection
    \addcontentsline{toc}{chapter}{\bibname}
    \printbibliography
\end{footnotesize}

\makeatletter
\@mainmattertrue
\makeatother
\cleardoublepage

\begin{appendices} % Using the appendices environment (from appendix package) for more functionality
    \crefalias{chapter}{appchap}

\chapter{Full Listing of Program Codes}
\startcontents[chapters]
\printcontents[chapters]{}{1}{\setcounter{tocdepth}{1}}

\cleardoublepage
\fakesection{MATLAB codes for continuous-time SPM}

\glsdisablehyper
\matlabcodelisting[\textsc{MATLAB} code for simulation of continuous time SPM]{cts_time_spm_simulation.m}{sc:ctstimespm}

\cleardoublepage
\fakesection{MATLAB codes for discrete-time SPM}
\matlabcodelisting[\textsc{MATLAB} code for simulation of discrete time SPM]{disc_time_spm_simulation_massive.m}{sc:disctimespm}

\glsenablehyper

\chapter{Permissions Summary}\label{ch:permissions}
\startcontents[chapters]
\printcontents[chapters]{}{1}{\setcounter{tocdepth}{1}}

\fakesection{Permissions Table}

\begin{landscape}
    \makeatletter \PLS@RemoveRotate % from chat with Ulrike Fischer
    \centering
    \begin{footnotesize}
        \begingroup
        \renewcommand{\arraystretch}{1.5}
        \begin{longtable}[c]{@{} l  l p{7.5cm} l c c p{1.6cm} @{}}
            \caption{\normalsize Summary of permissions for reuse of third-party copyrighted material} \label{tbl:permissionstable} \\

            \toprule
        \multicolumn{1}{c}{\makecell{Page \\ no.}} & \makecell{Usage in \\ thesis} & \makecell{Source \\ \vphantom{of work}} & \makecell{Copyright holder \& \\ Contact (organisations only)} & \makecell{Permission \\ requested on} & \makecell{Have \\ permission?} & \makecell[lt]{Permission \\ remarks} \\
        \midrule
        \endfirsthead

        \multicolumn{7}{c}%
        {{\normalsize \bfseries \tablename\ \thetable{} --- \normalfont  continued from previous page}} \\
        \toprule
        \multicolumn{1}{c}{\makecell{Page \\ no.}} & \makecell{Usage in \\ thesis} & \makecell{Source \\ \vphantom{of work}} & \makecell{Copyright holder \& \\ Contact (organisations only)} & \makecell{Permission \\ requested on} & \makecell{Have \\ permission?} & \makecell{Permission \\ remarks} \\
        \midrule
        \endhead

        \midrule
        \multicolumn{7}{ r @{}}{{\normalsize  Continued on next page}} \\[-1ex]
        \bottomrule
        \endfoot

        \bottomrule
       \endlastfoot

           \Cpageref{fig:energyvspowercell}         & \Cref{fig:energyvspowercell}          & \fullcite{VonSrbik2015}     & \Citeauthor*{VonSrbik2015}          & N/A                                                                & Yes                            & CC-BY-NC-ND                                           \\
           \Cpageref{fig:fig_CC_discharge_curves}   & \Cref{fig:fig_CC_discharge_curves}    & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{fig:1d_fv_mesh}                & \Cref{fig:1d_fv_mesh}                 & \fullcite{Torchio2016}      & \Citeauthor{Torchio2016}            & \DTMdate{2018-09-28}                                               & Yes                            & `Rightslink' service agreement attached               \\
           \Cpageref{fig:anodeoverhangpouchcell}    & \Cref{fig:anodeoverhangpouchcell}     & \fullcite{Bond2017}         & \Citeauthor{Bond2017}               & N/A                                                                & Yes                            & CC-BY                                                 \\
           \Cpageref{fig:topologies}                & \Cref{fig:topologies}                 & \fullcite{Northrop2011}     & \Citeauthor{Northrop2011}           & \DTMdate{2018-09-27}                                               & Yes                            & `Rightslink' service agreement attached               \\
           \Cpageref{fig:fig_generate_heatmap_BEV}  & \Cref{fig:fig_generate_heatmap_BEV}   & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{fig:fig_generate_heatmap_PHEV} & \Cref{fig:fig_generate_heatmap_PHEV}  & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{fig:fig_CapacityQuadrants}     & \Cref{fig:fig_CapacityQuadrants}      & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{ch:improveddra}                & \makecell[lt]{All figures,           \\ tables and                 \\ captions of                        \\ \cref{ch:improveddra}}                                             & \fullcite{Gopalakrishnan2017}  & \makecell[lt]{The American Society                    \\ of Mechanical Engineers   \\ (ASME)  \\ \href{mailto:copyright@asme.com}{copyright@asme.com}}  & \DTMdate{2016-04-19} & Yes & \makecell[lt]{Copyright \\ agreement} \\
           \Cpageref{fig:sandwichtospm}             & \Cref{fig:sandwichtospm}              & \fullcite{Moura2012}        & \makecell[lt]{The American Society \\ of Mechanical Engineers                                           \\ (ASME)                        \\ \href{mailto:copyright@asme.com}{copyright@asme.com}}  & \DTMdate{2018-09-25}       & Yes  & `Rightslink' service agreement attached                          \\ \Cpageref{fig:timingdiagramBig}          & \Cref{fig:timingdiagramBig}           & \fullcite{Southward2011}    & \Citeauthor*{Southward2011}         & \DTMdate{2018-09-26}                                               & Pending                        & Email request sent                                    \\
           \Cpageref{fig:timingdiagramSmall}        & \Cref{fig:timingdiagramSmall}         & \fullcite{PlettECE5540_02}  & \Citeauthor*{PlettECE5540_02}       & \DTMdate{2018-09-28}                                               & Yes                            & By email                                              \\
           \Cpageref{fig:coordsquadapprox}          & \Cref{fig:coordsquadapprox}           & \fullcite{Deng2018}         & \makecell[lt]{Elsevier             \\ \href{mailto:permissions@elsevier.com}{permissions@elsevier.com}}  & \DTMdate{2018-09-27}           & Yes                                                    & Elsevier license attached \\

        \end{longtable}
   \endgroup
    \end{footnotesize}
\end{landscape}

\cleardoublepage

\fakesection{Copyright Permissions for Torchio~\etal}
\includepdf[pages=-,scale=0.85,pagecommand={}]{redacted_JES_Torchio_permission_pdf.pdf}
\fakesection{Copyright Permissions for Northrop~\etal}
\includepdf[pages=-,scale=0.85,pagecommand={}]{redacted_Northrop_permission_pdf.pdf}
\fakesection{Copyright Permissions for Moura~\etal}
\includepdf[pages=-,scale=0.925,pagecommand={}]{redacted_Moura_etal_permissions.pdf}
\fakesection{Copyright Permissions for Gopalakrishnan~\etal}
\includepdf[pages=-,scale=0.925,pagecommand={}]{asme_copyright.pdf}
\fakesection{Copyright Permissions for Deng~\etal}
\includepdf[pages=-,scale=0.85,pagecommand={}]{redacted_Deng_copyright.pdf}
\fakesection{Copyright Agreement --- Krishnakumar Gopalakrishnan and Ian D.\ Campbell}
\includepdf[pages=-,scale=0.85,pagecommand={}]{campbell_krishna_agreement.pdf}

\end{appendices}

\batchmode
\end{document}
