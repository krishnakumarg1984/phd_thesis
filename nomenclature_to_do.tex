\shortintertext{where $L(\cdot)$ is a postive-valued scalar loss function.}
\intertext{In a typical system identification task, the sum of squares of the error sequence is  used as the typical loss function, thereby yielding}
    V_N(\theta)  & = \sum_{k=1}^N \varepsilon^2[k;\theta]\label{eq:nonlincostfcnsysid}
    \shortintertext{The vector~$\hat{\theta}$ that minimises this cost function is desired}
    \hat{\theta} & = \text{arg}\,\underset{\theta}{\text{min}} V_N(\theta)
\end{align}

For  the \gls{arx}  model structure, \cref{eq:nonlincostfcnsysid}  reduces to  a
standard quadratic optimisation  problem which may be  solved analytically using
least  squares  linear  algebra.  However,  for  robustness  against  estimation
bias,  instead of  the  standard \gls{ols}  estimates,  the \gls{iv}  estimation
method~\cite{Ljung1999} was used  for this model order  selection task. Applying
this to  the \gls{arx} model  structure, two deterministic model  order criteria
have been defined ---
\begin{enumerate*}[label=\emph{\alph*})]
    \item \gls{aic}, and
    \item \gls{mdl}~\cite{Ljung1999}.
\end{enumerate*}

In  the \gls{aic},  the  optimal  number of  parameters~$\hat{d}$ in  $\theta$
is  obtained   by  minimising   the  modified   log  likelihood   cost  function
\begin{equation}
    V_{N,\text{mod}}(\theta) =  \ln V_N(\theta)  + \frac{2  d}{N}, \quad N \gg d
\end{equation}
In the \gls{mdl} criterion, this cost function is modified to
\begin{equation}
    V_{N,\text{mod}}(\theta) =  V_N(\theta)\left(1 + \frac{d\, \ln N}{N}  \right)
\end{equation}

For the two subsystems at hand, both  criteria converged to the same choices for
the coefficient orders,  yielding ${n_a = 4,  n_b = 4}$ and~${n_k  = 0}$. Therefore,
these values  were used as the  starting points for the  non-linear optimisation
algorithms  used in  determining  the  exact pole  and  zero  locations for  the
discrete-time transfer functions which is described next.

\subsection{Final transfer function coefficients --- Nonlinear optimisation}

For         the         \gls{armax}        and         Box-Jenkins         model
structures, \cref{eq:nonlincostfcnsysid} results  in a non-linear  cost function
which  is  minimised iteratively  using  quasi-Newton  approaches. The  theoretical
foundation  of  standard non-linear  optimisation  methods  such as  L-BFGS  and
Levenberg-Marquardt are  well established whose  detailed explanation is  out of
the scope of this thesis. Although state of the art methods are not covered, the
interested reader  may consult the  textbook by Scales~\cite{Scales1985}  for an
introductory overview of this topic.

The  final  model structures  (for  both  the  positive electrode  and  negative
electrode time-evolution subsystems) in the z-domain are given by
\begin{equation}
    G(z) = \frac{b_1z^{-1} + \dots + b_{n_b}z^{-{n_b}}}{1 + a_1z^{-1} + \dots + a_{n_a}z^{-{n_a}}}\label{eq:genericZtf}
\end{equation}
wherein the coefficients in the numerator and denominator are to be determined.

The  number of  coefficients obtained  from \cref{subsec:refinementofcoefforder}
was  used as  the initial  guess for  the coefficient  orders in  the non-linear
optimisation.  For  the  initial  guesses   for  the  numerical  values  of  the
coefficients~$(a_1, a_2,  \dots a_{n_a})$ and ${(b_1, b_2, \dots  , b_{n_b} )}$, a
randomised  multi-start  algorithm was  used.  For  the two  transfer  functions
identified, no distinction is made  between whether the \gls{armax} structure or
Box-Jenkins structure was  used to arrive at the coefficients.  Since the output
magnitudes of~$\widetilde{Q}_{\text{e,n}}$  and $\widetilde{Q}_{\text{e,p}}$ are
of~$\mathcal{O}{10^{-3}}$,  a  constant  scaling   factor  of~${k  =  1000}$  is
used  to  bring the  order  of  magnitude of  output  data  values to  unity.  A
well-chosen  scaling factor  is often  vital  to the  convergence of  non-linear
optimisation algorithms.  Since the system  is linear, this constant  gain shall
not fundamentally change the dynamics of the  system and can be accounted for by
using the reciprocal  scaling factor of~0.001 in  numerical implementations. The
identification procedure  was carried  out using MATLAB's  System Identification
Toolbox~\cite{matlabsysidtool}.

\begin{table}[!htbp]
    \begingroup
    \sisetup{group-digits=false}
    \centering
    \caption[A sample of system identification results for $\widetilde{Q}_\text{e,n}$]{A sample of results showing four discrete-time transfer functions identified for the electrolyte time-evolution subsystem in the negative electrode region. Only those models that yielded similar errors (within \SI{0.5}{\percent}) across both input datasets were retained.  The fourth order model from case C (shaded in grey) performed the best across  both training and validation profiles and is chosen as the final model.}
    \label{tbl:sysidnegcases}
    \begin{tabular*}{\textwidth}{@{} c   S[table-format=1.4] S[table-format=1.4] S[table-format=1.4] S[table-format=1.4]  S[table-format=1.4,table-column-width=0.95cm] S[table-format=1.4,table-column-width=0.95cm] S[table-format=1.4,table-column-width=0.95cm] S[table-format=1.4,table-column-width=0.95cm] S[table-format=2.2] S[table-format=2.2] @{}}\toprule
        \multirow{2}[2]{*}{\footnotesize Case} & \multicolumn{4}{c}{\footnotesize Numerator} & \multicolumn{4}{c}{\footnotesize Denominator} &  {\multirow{2}[2]{*}{\footnotesize \makecell{Training \\accuracy\\(\%)}}} & {\multirow{2}[2]{*}{\footnotesize \makecell{Validation\\accuracy\\(\%)}}}\\
        \cmidrule(lr){2-5} \cmidrule(lr){6-9}
        {} & \multicolumn{1}{c}{$b_1$}  & \multicolumn{1}{c}{$b_2$}   & \multicolumn{1}{c}{$b_3$}  & \multicolumn{1}{c}{$b_4$}   & \multicolumn{1}{c}{$a_1$} & \multicolumn{1}{c}{$a_2$} & \multicolumn{1}{c}{$a_3$} & \multicolumn{1}{c}{$a_4$} \\
        \midrule
        A & 0.0026 & -0.0025 & {}      & {}      & -1.922 & 0.923  & {}     & {}    & 95.11 & 95.13 \\
        B & 0.0028 & -0.0052 & 0.0025  & {}      & -2.833 & 2.669  & -0.836 & {}    & 99.14 & 98.54 \\
        \Rowcolor{cbrewerintergray}
        C & 0.0028 & -0.0075 & 0.0066  & -0.0019 & -3.577 & 4.767  & -2.801 & 0.612 & 99.73 & 99.28 \\
        D & 0.0026 & 0.0026  & -0.0024 & -0.0024 & 0.060  & -1.906 & -0.058 & 0.907 & 95.12 & 95.14 \\
        \bottomrule
    \end{tabular*}
    \endgroup
\end{table}

\Cref{tbl:sysidnegcases}   shows   the   results  obtained   by   applying   the
aforementioned   non-linear  identification   routines  to   the  time-evolution
subsystems in the negative electrode region. The coefficient orders tried in the
system identification  procedure were informed  by the inferences from  the bode
magnitude plots as well as that obtained by applying the deterministic \gls{aic}
and \gls{mdl}  criteria. Only those  models that yielded similar  errors (within
\SI{0.5}{\percent}) across both input datasets were retained.

As  discussed  in \cref{subsec:initguesscoefforder},   a  first  order  transfer
function cannot capture all the  dynamics of the subsystems under consideration.
Therefore, the lowest order tried in  the identification procedure was two (case
A in \cref{tbl:sysidnegcases}).  As higher order  models were tried,  the system
accuracy improves steadily as  seen in cases B and C. However  in order to avoid
overfitting, the  \emph{lowest} order  model that  produces the  highest matched
accuracy across both training and validation profiles must be chosen.

Case D illustrates  the importance of the initial values  used in the non-linear
optimisation algorithms.  Despite using an  identical number of  coefficients as
case C,  the optimisation algorithm  converges to  a radically different  set of
zeros  and  poles  resulting  in  a  percentage  error  comparable  to  that  of
the  simple second  order  case. The  fourth  order model  from  case C  (shaded
grey  in \cref{tbl:sysidnegcases}) performs  the best  across both  training and
validation profiles and  is chosen as the final model.  The number of numerators
and  denominators match  exactly that  predicted by  the deterministic  criteria
given in \cref{subsec:refinementofcoefforder}. A similar selection procedure was
applied  for  the  identification  of the  transfer  function  corresponding  to
$\widetilde{Q}_{\text{e,p}}$ in the positive electrode region.

The final identified transfer functions (for the scaled output) are
\begin{align}
    \frac{\widetilde{Q}_{\text{e,n}}(z)}{\widetilde{I}(z)} & = \frac{0.002842 z^{-1} - 0.00753 z^{-2} + 0.006595 z^{-3} - 0.001906 z^{-4}}{1 - 3.577 z^{-1} + 4.767 z^{-2} - 2.801 z^{-3} + 0.6118 z^{-4}} \label{eq:finaldisctfneg}\\
    \frac{\widetilde{Q}_{\text{e,p}}(z)}{\widetilde{I}(z)} & = \frac{-0.002809 z^{-1} + 0.007139 z^{-2} - 0.005944 z^{-3} + 0.001614 z^{-4}}{1 - 3.464 z^{-1} + 4.444 z^{-2} - 2.495 z^{-3} + 0.515 z^{-4}}\label{eq:finaldisctfpos}
\end{align}

\begin{figure}[!htbp]
    \centering
    \includegraphics{p2d_sysid_train_qen.pdf}
    \caption[$\widetilde{Q}_{\text{e,n}}(t)$ outputs from \glsfmtshort{p2d} and
    identified transfer function for training profile]{%
        Time-evolution of~$\widetilde{Q}_{\text{e,n}}$ computed using the
        \glsfmtshort{p2d} model  and the identified transfer function
        of \cref{eq:finaldisctfneg} (scaled by~0.001) with the synthetic
        training input profile of \cref{fig:sysidtrainingcurrent}. The output
        predicted by the identified transfer function closely matches the `true'
        output obtained by a high-fidelity \glsfmtshort{p2d} simulation with an
        \glsfmtshort{rms} error of \SI{5.70e-6}{\mole\per\meter\squared} and a
        \glsfmtshort{mae} of~\SI{19.19e-6}{\mole\per\meter\squared}. Note that the
        transfer function in \cref{eq:finaldisctfneg} was originally obtained by
        scaling the output by~1000. The transfer function output is
        multiplied by the reciprocal of the same scaling factor to obtain the
        predicted response shown here, thereby once again justifying the
        linearity assumption for this subsystem.
    }%
    \label{fig:tfpredQentrain}
\end{figure}

\Cref{fig:tfpredQentrain} shows a comparison of the $\widetilde{Q}_{\text{e,n}}$
output for
\begin{enumerate*}[label=\emph{\alph*})]
    \item the \gls{p2d} model, and
    \item the identified transfer function of \cref{eq:finaldisctfneg}
\end{enumerate*}
using  the  training  current  profile  of \cref{fig:sysidtrainingcurrent}.  The
transfer function of \cref{eq:finaldisctfneg} was obtained by scaling the output
of the  training profile to  be of order~$\mathcal{O}(1)$  by a factor  of~1000.
Therefore,  for final  implementation and  comparison purposes,  the raw  output
produced  by applying  the transfer  function  needs to  be scaled  back by  its
reciprocal. If  the system  is linear,  then this scaling  factor shall  have no
impact  on  the  frequency-dependent  dynamics  of  the  subsystem.  The  output
predicted  by the  identified transfer  function is  virtually indistinguishable
from  the `true'  output computed  by post-processing  the \gls{p2d}  model with
an  \glsfmtshort{rms}  error   of  \SI{5.70e-6}{\mole\per\meter\squared}  and  a
\glsfmtshort{mae} of~\SI{19.19e-6}{\mole\per\meter\squared}.  This high accuracy
of the transfer  function prediction justifies the linearity  assumption for the
subsystem.  \Cref{fig:tfpredQepval}  presents  the  same  comparison  using  the
validation input profile for the subsystem in the positive electrode region. The
accuracy of  the identified transfer function  for this independent data  set is
clearly illustrated.

\begin{figure}[!htbp]
    \centering
    \includegraphics{p2d_sysid_val_qep.pdf}
    \caption[$\widetilde{Q}_{\text{e,p}}(t)$ outputs from \glsfmtshort{p2d} and
    identified transfer function for training profile]{%
        Time-evolution of~$\widetilde{Q}_{\text{e,p}}$ computed using the
        \glsfmtshort{p2d} model  and the identified transfer function
        of \cref{eq:finaldisctfpos} (scaled by~0.001) with the synthetic
        validation input profile of \cref{fig:sysidvalidationcurrent}. The output
        predicted by the identified transfer function closely matches the `true'
        output obtained by a high-fidelity \glsfmtshort{p2d} simulation with an
        \glsfmtshort{rms} error of \SI{12.07e-6}{\mole\per\meter\squared} and a
        \glsfmtshort{mae} of~\SI{31.59e-6}{\mole\per\meter\squared}. Note that the
        transfer function in \cref{eq:finaldisctfpos} was originally obtained by
        scaling the output by~1000. The transfer function output is
        multiplied by the reciprocal of the same scaling factor to obtain the
        predicted response shown here, thereby once again confirming the
        linearity of this subsystem.
    }%
    \label{fig:tfpredQepval}
\end{figure}

The  poles of \cref{eq:finaldisctfneg}  lie  very close  to their  corresponding
counterparts of \cref{eq:finaldisctfpos}  in the  stable region of  the Z-domain
\ie~within   the  unit  circle.   This  confirms  the  hypothesis   that  the
time-evolution subsystems  in these  two regions  exhibit similar  dynamics. The
slight differences in  the pole locations could be attributed  to the variations
in  the  physical  parameters  pertaining  to the  two  electrode  regions.  The
numerator coefficients  of \cref{eq:finaldisctfneg} and \cref{eq:finaldisctfpos}
are  also  close  to  each  other  except  that  their  signs  are  opposite  to
each   other.  This   is  to   be   expected,  since   as  seen   in  the   step
response   plots   of \cref{fig:linearity},   $\widetilde{Q}_{\text{e,n}}$   and
$\widetilde{Q}_{\text{e,p}}$ evolve in time in opposite directions. This is also
explained by  the fact  that, for  a given  applied current,  a decrease  in the
number of ions in the negative electrode has to be accompanied by an increase in
the positive electrode and vice-versa (the values of the changes are not exactly
equal owing to the presence of the separator). The identified transfer functions
are thus consistent  and deemed to be suitable for  representing the electrolyte
time-evolution in these regions.

\subsection{Numerical implementation of identified transfer functions}\label{subsec:sysidnumericalimpl}

The concept  of deploying a Z-domain  transfer function may seem  incongruous to
the  one of  the  major  goals of  this  thesis \viz~time-domain  implementation
of  \glspl{rom} in  an  embedded  environment such  as  a  \gls{bms}. While  the
majority  of the  models is  derived  and implemented  entirely in  time-domain,
only  the two  time-evolution subsystems  of  the electrolyte  seems to  deviate
from  this  trajectory.  However,  an   explanation  for  this  is  provided  in
\cref{subsec:suitablesysid}.   In  particular,   it   was   mentioned  that   an
approximation-free  conversion   to  time-domain  from  Z-domain   exists,  that
mitigates this perceived drawback for  these two sub-systems. This conversion is
amenable for discrete-time implementation without any other modifications.

Starting from the generic structure of the identified transfer functions (see \cref{eq:outputwithsysonly}),

\begin{DispWithArrows}[fleqn,mathindent=0cm,jot=2ex,%
    ,xoffset=-4mm
    ]
    G(z) &= \frac{b_1z^{-1} + \dots + b_{n_b}z^{-{n_b}}}{1 + a_1z^{-1} + \dots + a_{n_a}z^{-{n_a}}} \Arrow{Replace with analogous \\ transfer operator $q=z$ \\ in time domain} \notag\\
    G(q) &= \frac{b_1q^{-1} + \dots + b_{n_b}q^{-{n_b}}}{1 + a_1q^{-1} + \dots + a_{n_a}q^{-{n_a}}} \Arrow{Apply the definition\\ of~$G(q)$ on the \glsfmtshort{lhs}}\notag \\
    \frac{y[k]}{u[k]} &= \frac{b_1q^{-1} + \dots + b_{n_b}q^{-{n_b}}}{1 + a_1q^{-1} + \dots + a_{n_a}q^{-{n_a}}} \Arrow{Cross-multiply}\notag \\
    \left(1 + a_1q^{-1} + \dots + a_{n_a}q^{-{n_a}}\right)y[k] &= \left(b_1q^{-1} + \dots + b_{n_b}q^{-{n_b}}\right)u[k] \Arrow{Expand on both sides} \notag \\
    y[k] + a_1q^{-1}y[k] + \dots + a_{n_a}q^{-{n_a}}y[k] &= b_1q^{-1}u[k] + \dots + b_{n_b}q^{-{n_b}}u[k] \Arrow{Apply the definition\\ $q^{-p}x[k] = x[k-p]$}\notag \\
    y[k] + a_1y[k-1] + \dots + a_{n_a}y[k-n_a] &= b_1u[k-1] + \dots + b_{n_b}u[k-n_b] \Arrow{Rearrange to obtain\\ the final expression}\notag \\
    y[k] &= -a_1y[k-1] - \dots - a_{n_a}y[k-n_a] \notag \\[-2ex]
         &\qquad   + b_1u[k-1] + \dots + b_{n_b}u[k-n_b] %\label{eq:lccde}
\end{DispWithArrows}

We  thus obtain  a  simple  algebraic expression  (a  difference equation)  that
computes the output  at the given time-step given past  inputs and outputs. This
is a highly memory-efficient implementation  since, at any given time-step, only
the previous~$n_a$ (four) output samples  and $n_b$ (four) input samples need to
be  `remembered'  (stored).  This  concludes all  the  aspects  (derivation  and
implementation) of  this author's new  model for the  electrolyte time-evolution
subsystem.  The  performance  of  this  model  for  computation  of  electrolyte
concentration needs to be evaluated, which is performed next.

\section{Performance Analysis of New Model: Ionic Concentration}\label{sec:perfanalysisnewmodel}

To demonstrate that a suitable advancement of the field has indeed been achieved
through  this system  identification exercise,  a comparison  with the  existing
state of the art in reduced  order electrolyte modelling is warranted. Secondly,
to  comprehend its  extent of  validity  and performance  boundaries, the  newly
developed \gls{rom} must also be  pitted against the full-order \gls{p2d} model.
This section  aims to  provide such  a comparative discussion  for two  types of
inputs ---
\begin{enumerate*}[label=\itshape\alph*\upshape)]
    \item constant current inputs
    \item dynamic load profiles
\end{enumerate*}

\subsection{Constant current inputs}\label{subsec:tfquadceconstcurrinput}

\Cref{fig:tfquadp2dspatialionicconc1C} shows  the spatial distribution  of ionic
concentration  in  the electrolyte  along  cell  thickness  for a  1C~discharge
beginning at \SI{100}{\percent} \gls{soc}. The spatial concentration computed by
each of the three approaches ---
\begin{enumerate*}[label=\roman*)]
    \item the \gls{p2d} model,
    \item the quadratic approximation model and
    \item the newly developed system identification model(s).
\end{enumerate*}

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{tf_quadratic_ce_approx_spatial.pdf}
    \caption[Spatial distribution of ionic concentration in
    electrolyte for a 1C~discharge computed by the \glsfmtshort{p2d}, quadratic
    approximation \& system identification models]{%
        Spatial distribution of ionic concentration  in electrolyte along cell
        thickness at various  snapshots of  time computed  by each of  the three
        models for  a 1C~discharge.  The concentration  profile  computed by
        the  \gls{p2d} model is used as the benchmark reference. The  system
        identification model performs noticeably better than the quadratic
        approximation model during  the initial  transient  while delivering a
        similar performance as a \gls{qss} is reached.
}%
\label{fig:tfquadp2dspatialionicconc1C}
\end{figure}

During  the  initial  phase  of   discharge,  the  \gls{p2d}  model  exhibits  a
characteristic inflection point near the  separator interfaces that diffuses out
over time  until a  \gls{qss}. This  is due to  the fact  the reaction  front is
initially established  close to the  separator, and as surface  concentration of
lithium  in particles  near separator  is  depleted, the  reaction starts  moves
further  into the  electrode thickness.  Neither  of the  two \glspl{rom}  under
consideration here  could successfully  capture this  characteristic inflection.
This is  explained by  the fact  that both  of them  use the  standard quadratic
approximation profile for the \emph{spatial}  profile, which means that only one
apex  point is  possible  per  electrode, which  is  pinned  to their  separator
interfaces by design.

During the transient portion of discharge (approximately up to \SI{357}{\second}
as   shown   in \cref{fig:tfquadp2dspatialionicconc1C}),   the  locus   of   the
concentration  profile computed  by  the newly  developed system  identification
model(s) clearly lies  much closer to the \gls{p2d} model  than that computed by
the  quadratic  approximation model.  After  the  initial transition  phase,  it
appears  that  the  concentration  profile predicted  by  both  the  \glspl{rom}
converge to the \gls{p2d} model's concentration profile.

To obtain  a quantifiable  perspective on  the accuracy  of the  newly developed
model, it  is desirable  to plot  the temporal  evolution of  the concentration,
particularly  at  the  two  current   collector  interfaces.  The  behaviour  of
the  baseline  quadratic approximation  model  in  this regard  was  established
in \cref{subsubsec:simresultsbaselinequad}.   Therefore  it   is  important   to
ascertain whether a noteworthy improvement  was achieved using the model arrived
at using the system identification procedure.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{tf_quad_ce_at_cc_1Cdischg}
    \caption[%
    Time evolution  of ionic  concentrations at  current collectors  computed by
    \glsfmtshort{p2d}, quadratic  approximation \& system  identification models
    for 1C~discharge
    ]%
    {%
    Evolution  of ionic  concentration over  time at  the two  current collector
    interfaces for a 1C~discharge for
    \begin{enumerate*}[label=\roman*)]
        \item the \glsfmtshort{p2d} model,
        \item the quadratic approximation model and
        \item the newly developed system identification model(s)
    \end{enumerate*}
    (top row). For the quadratic approximation and system identification models,
    the time evolution of their absolute error relative to the \glsfmtshort{p2d}
    benchmark  is also  shown  (bottom  row). At  both  current collectors,  the
    transient performance of the system  identification model is superior to the
    quadratic  approximation model.  At \gls{qss},  the quadratic  approximation
    model is slightly more accurate than the system identification model.
}%
\label{fig:temporalcetfquadratic}
\end{figure}

\Cref{fig:temporalcetfquadratic}   shows  the   time-evolution   of  the   ionic
concentrations at the current collector  interfaces of the negative and positive
electrodes for a 1C~discharge. The  concentration profiles computed
by the three approaches ---
\begin{enumerate*}[label=\roman*)]
    \item \glsfmtshort{p2d} model,
    \item quadratic approximation model and the
    \item newly developed system identification model(s)
\end{enumerate*}
are overlaid in the top row of  plots, wherein the left hand side corresponds to
the  current collector  interface  at  the negative  electrode  while the  right
hand  side  corresponds  to  that  at  the  positive  electrode.  The  plots  in
the bottom  row of \cref{fig:temporalcetfquadratic}  show the  time-evolution of
the  absolute  value  of  their  errors. The  concentration  error  of  each  of
the  two  \glspl{rom}  is  defined  with  respect  to  the  benchmark  \gls{p2d}
model  \ie~$\varepsilon_{c_{\text{e,}j}(t)}   =  c_{\text{e,}j_\text{ROM}}  -
c_{\text{e,}j_\text{p2d}}(t)$. The  absolute value  of the  error is  plotted so
that  the magnitude  of the  error can  be visualised  better, aiding  immediate
comparisons based on the plots.

For both  current collectors,  the newly  developed system  identification model
outperforms  the  quadratic  approximation  model during  the  transient  phase.
At  the  negative  electrode/current  collector  interface,  the  error  of  the
system  identification  model  remains  strictly below  that  of  the  quadratic
approximation model until \approx \SI{650}{\second} and remains comparable to it
until~\approx\SI{1600}{\second}. Beyond  this time, the  quadratic approximation
model has a  slightly better accuracy, although the  system identification model
still remains at a comparable distance from it. After~\approx\SI{2000}{\second},
both models  yield the same  response shape. For the  positive electrode/current
collector interface, the error of  the system identification model remains below
that of the quadratic approximation model until \approx \SI{3300}{\second}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{zoomed_tf_quad_ce_at_cc_1Cdischg.pdf}
    \caption[%
    Transient phase of ionic  concentration evolution at  the two current collectors  computed by
    \glsfmtshort{p2d}, quadratic  \& system  identification models
    for 1C~discharge
    ]%
    {%
    Transient phase of the temporal evolution  of ionic  concentration at  the two  current collector
    interfaces for a 1C~discharge as computed by ---
    \begin{enumerate*}[label=\roman*)]
        \item the \glsfmtshort{p2d} model,
        \item the quadratic approximation model, and
        \item the newly developed system identification model(s).
    \end{enumerate*}
    The significantly improved accuracy of the system identification model(s)
    relative to the state of the art quadratic approximation model is clearly demonstrated.
}%
\label{fig:zoomedcetfquadtemporal}
\end{figure}

\Cref{fig:zoomedcetfquadtemporal} shows  a zoomed version of  the time-evolution
of the  ionic concentration  at the  two current  collectors, wherein  the first
\SI{300}{\second}  after  application  of  the  load  current  is  plotted.  The
significant  improvement in  accuracy  achieved by  the  newly developed  system
identification model(s) is clearly demonstrated. At both the current collectors,
the concentration computed  by the system identification  model(s) closely track
that of the benchmark \gls{p2d} model.

The  loss  of fidelity  exhibited  past  the  initial transient  phase  warrants
an  explanation. It  should  be  recalled that  the  natural  decoupling of  the
temporal and  spatial systems were taken  advantage of in developing  the system
identification technique. This  means that, for the spatial  profile, the system
identification  model reverts  to the  same  quadratic profile  as the  baseline
quadratic approximation  model. This  explains why the  two models  have similar
shape past the initial transient. During  the transient phase when the \gls{qss}
behaviour is yet to be established, it is reasonable to assume that the temporal
dynamics  are of  paramount importance  in governing  the concentration  profile
evolution.  After a  \gls{qss}  has  been established  with  the reaction  front
diffusing out  and a steady  stream of ion-electron  separation/recombination in
place,  it is  hypothesised  that the  temporal dynamics  have  settled and  the
spatial configuration assumes importance.

With a  sustained application  of constant current  past the  initial transient,
strong spatial gradients  in the ionic concentration are  established within the
cell \ie~the  concentrations are far from the initial  equilibrium value. This
precisely  exposes the  realm  where the  system  identification model  exhibits
its  natural  weakness.  By  following  the  theory  of  system  identification,
which  necessitates   bias  removal,   the  training  and   validation  profiles
of \cref{fig:sysidtrainingcurrent}   and \cref{fig:sysidvalidationcurrent}   had
nearly  zero mean.  This means  that the  currents were  as equally  positive as
negative leading to a small-signal  perturbation around the equilibrium value of
the electrolyte  concentration. While this  profile is ideally suited  to excite
the system's  dynamics, it  fails to  capture the large  signal behaviour.  As a
topic  of future  research,  perhaps a  spatially-coupled system  identification
could be attempted to handle this issue.

The  main  implication of  these  results  is  that  the identified  models  are
primarily suitable for  transient \ie~dynamic load profiles,  which is typical
of a real-life scenario in an electric/hybrid electric vehicular operation. Such
a  model is  less  suitable  for sustained  constant  current application.  This
implies that  a \gls{bms} in a  vehicle undergoing a \gls{cccv}  charging cannot
rely on  these identified electrolyte  models. However, this exclusion  does not
seriously hamper the model's wider applicability since a simple coulomb-counting
approach with  a high-precision \gls{adc} is  much more accurate than  any other
\gls{pbm} in this particular scenario.

Although constant  current discharge is  not a practical use-case  for vehicular
batteries, performing this benchmark evaluation  has helped in understanding the
limits of the newly  developed model. This study has also  helped in providing a
glimpse of its  potential strength \viz~significantly  improved accuracy under
dynamic load conditions, which is presented next.

\subsection{Dynamic current inputs}

To characterise  the performance  of the  newly developed  system identification
electrolyte   concentration  model(s)   under  dynamic   load  conditions,   the
\gls{udds}  drivecycle  was  used.  The  details  of  this  drivecycle  such  as
its  speed  versus  time  data  and its  highly  dynamic  nature  was  discussed
in \cref{subsubsec:dynamicspmp2dsim}. The peak of  the applied load current used
corresponds to a discharge current of \SI{180}{\ampere} \ie~3C. A plot of this
current  profile was  shown in  the top  row of \cref{fig:uddssimp2dspmresults}.
This  load  profile  was  applied   to  the  three  models  under  consideration
---
\begin{enumerate*}[label=\itshape\alph*\upshape)] \item \glsfmtshort{p2d}
model,  \item   quadratic  approximation   model,  and  \item   newly  developed
system identification  model(s) \end{enumerate*} ---
and the spatio-temporal evolution of ionic concentration in electrolyte computed
by each of them was studied.

Since  the  load   current  is  highly  dynamic   and  continuously  alternating
between  charging   and  discharging   at  various  magnitudes   throughout  the
profile   duration,   it   is   difficult  to   discern   a   specific   pattern
or   trend  within   the  spatial   thickness   of  the   cell.  Hence,   unlike
the   case   of  prolonged   unidirectional   current   application  wherein   a
clear   reaction  front   that  diffuses   gradually  out   can  be   visualised
(see \cref{fig:tfquadp2dspatialionicconc1C}), little  information can  be gained
from  visualisation   of  spatial   concentration  profiles.  Since   the  ionic
concentrations at  the two  current collectors have  a direct  (and two-pronged)
influence on the  electrolyte overpotential (see \cref{eq:electrolytepdwithce}),
it is particularly important to characterise  the accuracy at these two critical
spatial locations.

Since a  direct correspondence between  the time-dependent dynamics of  the load
profile and that of the electrolyte concentration can be intuitively visualised,
its values  at the two current  collector interfaces are examined.  The plots in
the top row of \cref{fig:uddsTfQuadCeatCC} shows the time evolution of the ionic
concentration at the two current  collector locations for the \gls{udds} current
profile computed by  each of the three models under  consideration. The plots to
the left  pertain to the negative  current collector location while  that to the
right correspond to  the positive current collector location. The  bottom row of
plots show the absolute value of concentration error of the quadratic and system
identification models relative to the  \gls{p2d} reference benchmark. As seen in
\cref{fig:uddsTfQuadCeatCC}, the  absolute error  of the newly  developed system
identification models remain below that  of the baseline quadratic approximation
model throughout the drivecycle.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{tf_quad_ce_at_cc_udds}
    \caption[%
    Time   evolution  of   ionic  concentrations   at  current   collectors  for
    \glsfmtshort{p2d}, quadratic  approximation \& system  identification models
    with a \glsfmtshort{udds} input profile
    ]%
    {%
        Evolution of ionic concentration over  time at the two current collector
        interfaces with  a \gls{udds}  input profile (see  topmost plot
        of \cref{fig:uddssimp2dspmresults}) as computed by
        \begin{enumerate*}[label=\roman*)]
            \item the \glsfmtshort{p2d} model,
            \item the quadratic approximation model and
            \item the newly developed system identification model(s)
        \end{enumerate*}
        (top   row).  The   plots  on   the   left  pertain   to  the   negative
        electrode/current  collector   interface,  while   that  on   the  right
        corresponds to  the positive electrode/current collector  interface. For
        the  quadratic approximation  and  system  identification models,  their
        absolute error relative to the \glsfmtshort{p2d} benchmark is also shown
        (bottom  row).  The system  identification  model  is considerably  more
        accurate  than the  quadratic approximation  model for  the entire  time
        horizon of the drivecycle.
    }%
    \label{fig:uddsTfQuadCeatCC}
\end{figure}

Based   on   the   conclusions   from   the   constant   current   input   study
of \cref{subsec:tfquadceconstcurrinput},  it   is  to   be  expected   that  the
system  identification  model(s)  exhibit  a  superior  performance  during  the
transient  phase   of  the   simulation.  As  seen   in  the   initial  duration
of \cref{fig:uddsTfQuadCeatCC}, the absolute error  of the system identification
model is indeed  lower than that of the baseline  quadratic approximation model.
Particular, when a sudden current spike is applied at \approx \SI{200}{\second},
the  quadratic approximation  model is  unable to  cope and  its absolute  error
deviates  far  away   from  its  mean  value.  The  absolute   error  of  system
identification model  remains well controlled  and even with  this instantaneous
load demand, its standard deviation is remarkably close to its median value as
shown in \cref{tbl:errormetricsquadtfce}.

\begin{table}[!htbp]
    \centering
    \caption[Error statistics for the quadratic approximation \& system identification models]{Summary of error statistics for the quadratic approximation and system identification models. The metric used is the absolute value of the concentration difference with respect to the \glsfmtshort{p2d} model at the two current collector interfaces.}
    \label{tbl:errormetricsquadtfce}
    \begin{tabular}{@{} l S[table-format=3.2] S[table-format=3.2] S[table-format=3.2] S[table-format=3.2] @{}}
        \toprule
        \multirow{2}[2]{*}{\makecell{Error  statistic \\ (\si{\mole\per\meter\cubed})}} & \multicolumn{2}{c}{$\big\lvert \varepsilon_{c_\text{e}} \big \rvert$ at Neg/CC} &
        \multicolumn{2}{c}{$\big\lvert \varepsilon_{c_\text{e}} \big \rvert$ at Pos/CC} \\
        \cmidrule(lr){2-3} \cmidrule(l){4-5}
        {} & {Quadratic} & {SysID} & {Quadratic} & {SysID} \\
        \midrule
        Max                & 307.27 & 190.04 & 292.20 & 114.44 \\
        Mean               & 66.38  & 54.98  & 55.15  & 25.02  \\
        Median             & 49.65  & 47.12  & 40.39  & 20.93  \\
        Standard Deviation & 66.80  & 37.18  & 60.50  & 20.17  \\
        \bottomrule
    \end{tabular}
\end{table}

While the  superior accuracy of the  newly developed model during  the transient
phase  was not  surprising, the  fact  that its  performance remains  consistent
throughout  the  entire  time  horizon  is  noteworthy.  Despite  being  subject
to  incessant  changes   in  load  demands,  the   system  identification  model
responds better  than the  quadratic approximation model  well past  the initial
transient.  \Cref{fig:zoomedcetfquadtemporaludds} shows  a  zoomed  view of  the
ionic concentration in the electrolyte  at the two current collector interfaces.
To prove the improved performance of the developed model well into the operation
of the cell, a \SI{50}{\second} window beginning at \approx \SI{60}{\percent} of
the overall  profile duration is examined  in detail. Although it  exhibits some
oscillations,  the system  identification model(s)  reasonably track  the `true'
concentrations computed by the \gls{p2d}  model. However, the baseline quadratic
approximation  model seems  to suffer  from  a large  bias with  respect to  the
\gls{p2d} model.  It should also  be noted that nearly  every `kink' in  the two
\glspl{rom}  is identical.  This could  be attributed  to the  fact the  spatial
profile  used  in  both of  them  is  identical.  Hence,  it must  be  concluded
that  the difference  in their  amplitude arises  from the  improved calculation
of coefficients~$a_k(t)$ in \cref{eq:cenqquadstart} and \cref{eq:cepqquadstart}
through  the  usage  of  more  accurate  $Q_{\text{e,n}}$  and  $Q_{\text{e,p}}$
in  the  \gls{lhs} of \cref{eq:Qenbyintegration}  and \cref{eq:Qepbyintegration}
respectively.  Detailed   error  metrics  of   the  two  \glspl{rom}   is  shown
in \cref{tbl:errormetricsquadtfce}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{zoomed_tf_quad_ce_at_cc_udds}
    \caption[%
    Zoomed view of ionic  concentration at  both current collectors  computed by
    the \glsfmtshort{p2d}, quadratic  \& system  identification models
    for the \glsfmtshort{udds} profile
    ]%
    {%
        A zoomed  view of  the ionic  concentration (showing  a \SI{50}{\second}
        window  beginning at  \approx \SI{60}{\percent}  of the  overall profile
        duration) in the electrolyte at the two current collector interfaces for
        the \gls{udds} profile of \cref{fig:uddssimp2dspmresults} as computed by
        ---
        \begin{enumerate*}[label=\roman*)]
            \item the \glsfmtshort{p2d} model,
            \item the quadratic approximation model, and
            \item the newly developed system identification model(s).
        \end{enumerate*}
        At both current collector interfaces, the system identification model(s)
        exhibits  a reasonable  tracking of  the concentration  profile computed
        by  the  benchmark \gls{p2d}.  The  profile  computed by  the  quadratic
        approximation  model  seems  to  suffer from  offsets/bias  issues  that
        adversely affects its accuracy.
}%
\label{fig:zoomedcetfquadtemporaludds}
\end{figure}

Based  on  the  evidence presented  thus  far,  it  can  be concluded  that  the
time-evolution subsystem model(s) developed here using the system identification
technique  indeed  represent  an  advancement  of the  field  of  reduced  order
electrolyte  modelling. With  this  aspect  thus tackled,  it  is imperative  to
explore the potential benefits of  incorporating the discrete-time model(s) thus
obtained into the conventional \gls{spm} and is discussed next.

\section{Composite SPM Model with Electrolyte Dynamics}

At this  stage, it must  be recalled that the  purpose of developing  the system
identification electrolyte  model was  to mitigate the  poor performance  of the
basic  \gls{spm} at  C-rates above~0.5C (see \cref{subsec:simresultsbasicspm}).
This sub-optimal performance was attributed  to the lack of electrolyte dynamics
in  the  basic  \gls{spm}.  The   performance  of  the  newly  developed  system
identification model has been proved to be  superior to the current state of the
art. The next step  is to embed this electrolyte model  into the basic \gls{spm}
so as to  obtain a composite \gls{spm}. The performance  of this composite model
is evaluated to ascertain its suitability towards online implementation.

\subsection{Computation of electrolyte overpotential}\label{subsec:electrolyteopcalc}

The missing component in the terminal voltage computation of the basic \gls{spm}
is  the  contribution from  the  electrolyte  overpotential  term. This  is  the
potential difference in  the entire electrolyte \ie~the electrolyte potential
at the positive current collector interface with respect to that at the negative
current collector interface.

As discussed in \cref{sec:electrolyteinclusion}, using  the equation proposed by
Prada~\etal~\cite{Prada2012}, the  overpotential in the electrolyte  is computed
as
\begin{align}
    \quad \phi_\epos - \phi_\eneg &= (1-t_{+}^0) \frac{2RT}{F}\ln \frac{c_\text{e,\tiny pos/cc}}{c_\text{e,\tiny neg/cc}}\nonumber\\
    {} &\quad -\frac{I}{2 A}\left(\frac{l_\text{neg}}{\kappa_\text{eff,neg}} + 2 \frac{l_\text{sep}}{\kappa_\text{eff,sep}} + \frac{l_\text{pos}}{\kappa_\text{eff,pos}}\right) \tag{\cref{eq:electrolytepdwithce} revisited}
\end{align}

\Cref{eq:electrolytepdwithce} consists of two distinct terms ---
\begin{enumerate*}[label=\roman*)]
    \item a diffusion overpotential due to concentration gradient in the electrolyte, and
    \item an ohmic resistance term that is dependent upon
        \begin{enumerate*}[label=\itshape\alph*\upshape)]
            \item the instantaneous value of applied current,
            \item the thicknesses of the three cell regions, and
            \item the effective ionic conductivity in each of the three regions. %which in-turn depends on ionic concentration,.
        \end{enumerate*}
\end{enumerate*}

The ohmic  loss term  of \cref{eq:electrolytepdwithce} needs  to be  examined in
closer detail.  The dependence of  this term  on instantaneous load  current and
cell thicknesses  can be accounted  in a straightforward manner.  However, there
are ambiguities  in computing the  effective ionic  conductivity in each  of the
three cell regions. The effective value of ionic conductivity in the electrolyte
depends on its intrinsic conductivity, the Bruggeman constants and porosities of
each  of  the three  regions.  The  intrinsic electrolyte  conductivity  in-turn
depends on the electrolyte concentration.

Ambiguities   arise   in  interpreting   the   value   of  ionic   concentration
to   be    used   for   computation   of    electrolyte   concentration.   Since
\cref{eq:electrolytepdwithce}  deals  with  overall potential  drop  across  the
entire  length of  the cell,  the concentration  used for  computing electrolyte
conductivity could,  for example be  that at the respective  current collectors.
This concept however  introduces inconsistencies with the  separator term. Using
the  separator concentration  from one  of the  electrode interfaces  introduces
unequal  weighting  in this  computation.  If  the  ionic concentration  at  the
midpoint of the separator is used, this scheme becomes inconsistent with that at
the  two current  collectors. Another  possibility for  computing the  effective
conductivity in a  cell region is to  use the mean of the  concentration in that
region. However, since the mean is nothing but a simple statistical first moment
is  equally influenced  by the  entire  concentration profile  within each  cell
region. This is questionable given that the electrolyte overpotential across the
entire cell thickness  is most likely governed by the  conductivities at the two
current  collector interfaces.  Some form  of weighted  mean could  be conjured,
wherein the  current collector locations  are given  the highest weight  and the
separator locations the  least weight. However, finding the  weights becomes yet
another  exercise and  from the  engineering perspective  of computing  these in
real-time, seems to be in the realm of diminishing returns.

In  published  literature,  only  a  cursory  treatment  has  been  accorded  to
the  aforementioned  ambiguities.  In  Prada~\etal~\cite{Prada2012},  the  usage
of  initial concentrations  is  used  to only  introduce  the  concept of  ohmic
resistance  in that  article.  However,  the author  of  this  thesis wishes  to
extend  this  concept further.  In  the  simulations  conducted by  this  thesis
author, it  became clear  that the  dependence on  applied current  was required
in  order to  obtain  reasonable accuracies.  Computing  mean of  concentrations
in  cell  regions for  calculation  of  ionic  conductivities  led to  a  biased
computation of overpotentials.  Therefore, this author decided to  use the value
of  initial concentration  for the  computation of  ionic conductivities  in the
current-dependent  contribution  to  electrolyte  overpotential  throughout  the
entire time horizon considered.

Hence, as per the adopted scheme \cref{eq:electrolytepdwithce} gets modified as
\begin{align}
    \quad \phi_\epos(t) - \phi_\eneg(t) & = (1-t_{+}^0) \frac{2RT}{F}\ln \frac{c_\text{e,\tiny pos/cc}(t)}{c_\text{e,\tiny neg/cc}(t)}\nonumber \\
    {}                             &\quad -\frac{I}{2 A}\left(\frac{l_\text{neg}}{\kappa_\text{eff,neg}\left(c_\text{e}\left(0\right)\right)} + 2
    \frac{l_\text{sep}}{\kappa_\text{eff,sep}\left(c_\text{e}\left(0\right)\right)} +
\frac{l_\text{pos}}{\kappa_\text{eff,pos}\left(c_\text{e}\left(0\right)\right)}\right)\label{eq:electrolytepdwithcenew}
\end{align}
wherein  the time-dependent terms are explicitly shown in the notation.

Using \cref{eq:electrolytepdwithcenew} for electrolyte overpotential computation
has an  important implication. The  two-pronged influence of  the time-dependent
electrolyte concentration on the electrolyte overpotential \viz
\begin{enumerate*}[label=\itshape\alph*\upshape)]
    \item a direct influence in the form of concentration dependent diffusion polarisation, and
    \item an indirect influence through its use in ionic conductivity calculations
\end{enumerate*}
has  now  been  reduced  to  just   one.  This  implies  the  results  from  the
system  identification   model  are  now   required  only  in  the   first  term
of \cref{eq:electrolytepdwithcenew}.

In the light of the decision of use the (constant) initial concentration for the
ohmic term, it is natural to question the gains from the circuitous route of the
system  identification  exercise that  was  undertaken  to obtain  the  improved
electrolyte model. Therefore,  it is imperative to quantify  the relative weight
of  the  concentration  dependent  diffusion resistance  compared  to  the  bulk
solution resistance.

\begin{figure}[!htbp]
    \centering
    \includegraphics{contribution_to_phie_1C.pdf}
    \caption[%
    Contribution to electrolyte overpotential from the gradient-induced polarisation
    term and the bulk solution resistance term for a 1C~discharge
    ]%
    {%
        Contribution to the overpotential in the electrolyte from each of the
        two terms in \cref{eq:electrolytepdwithcenew} for a 1C~discharge. The
        bulk solution resistance is approximated as a constant value determined
        by the equilibrium initial concentration. The concentration dependent
        polarisation term governs the dynamic behaviour of the overall
        overpotential. Furthermore, this gradient-induced diffusion resistance
        has a strong contribution to the steady state, higher than the bulk
        solution resistance and cannot be neglected without introducing
        significant errors.
}%
\label{fig:contributiontophiefromtwoterms}
\end{figure}

\Cref{fig:contributiontophiefromtwoterms} shows the  contribution to the overall
potential drop~$\phi_\text{e,pos}$ and~$\phi_\text{e,neg}$ in  the electrolyte
from  each  of  the  two  terms  in \cref{eq:electrolytepdwithcenew}  for  a  1C~discharge. The bulk  solution resistance is constant owing to  the fact that the
initial  electrolyte concentration  is  used in  computing  the effective  ionic
conductivities in the three regions of  the cell. The gradient induced diffusion
polarisation term, however has a stronger contribution in both the transient and
steady  state. The  entire dynamics  of the  overall potential  drop during  the
transient  phase is  governed by  this concentration-dependent  term, while  its
steady state contribution  is in-fact higher than the  bulk solution resistance.
The  constant  ohmic resistance  term  merely  provides  a non-zero  offset  for
the  electrolyte  solution  overpotential.  In questioning  whether  the  system
identification exercise was indeed worthwhile,  if the concentrations in the two
current collectors had not been computed  at each time-step, then this diffusion
polarisation  term  would  become  zero.  This is  because,  the  numerator  and
denominator in \cref{eq:electrolytepdwithcenew} would have to be retained at the
initial concentration, leading to a unit  ratio whose natural logarithm is zero.
Therefore, it  is clear  that computing  the concentrations  at the  two current
collectors  through system  identification has  indeed helped  in improving  the
modelling accuracy.

Having established the relative  importance of computing the diffusion-dependent
polarisation   overpotential,  the   next  question   that  arises   is  whether
the   constant    approximation   for   the   bulk    solution   resistance   is
indeed   appropriate.   It  also   remains   to   be   seen  if   the   accurate
computation   of  the   ionic   concentration   through  system   identification
(see \cref{sec:perfanalysisnewmodel}) has  translated into a  similarly accurate
computation of  electrolyte overpotential. This  is answered by a  comparing the
electrolyte overpotential computed by the  system identification model with that
obtained from the \gls{p2d} model.

\begin{figure}[!htbp]
    \centering
    \includegraphics{phie_delta_cnst_1C.pdf}
    \caption[%
    Electrolyte  overpotential  computed  by the  \glsfmtshort{p2d}  and  system
    identification models for a 1C~discharge
    ]%
    {%
        Comparison    of    electrolyte    overpotential   computed    by    the
        \gls{p2d}     model    and     the    system     identification    model
        (using \cref{eq:electrolytepdwithcenew}) for a  1C~discharge. During the
        transient phase, the profile obtained by the system identification model
        closely matches that of the \gls{p2d} model. The mismatch in the initial
        overpotential does not arise to the  use of a constant concentration for
        the bulk  resistance contribution,  since at  equilibrium this  value is
        exact and  not an  approximation. Past  the initial  transient, accuracy
        of  the system  identification  model degrades.  This  can be  explained
        by  its  analogous  behaviour   for  concentration  computation  in  the
        \glsfmtlong{qss} (see \cref{subsec:tfquadceconstcurrinput}) for constant
        current inputs.
    }%
    \label{fig:phiedeltacnst1C}
\end{figure}

\Cref{fig:phiedeltacnst1C} shows  a comparison of the  electrolyte overpotential
computed  by   the  \gls{p2d}  and   system  identification  models  for   a  1C~discharge. There  is a discrepancy  in the  initial offset of  the overpotential
value.  However,  this  cannot  be  attributed   to  the  use  of  the  constant
concentration  approximation   in  the   computation  of   ionic  conductivities
in \cref{eq:electrolytepdwithcenew}.  This   is  because,  at   equilibrium  the
concentration used  is exactly  the initial  concentration. Furthermore,  at the
instant of applying the current, diffusion gradients in the electrolyte have not
yet been established.  Hence, the contribution from  the diffusion overpotential
is zero,  which can  also be  seen in \cref{fig:contributiontophiefromtwoterms}.
Thus, it can be  concluded that this initial mismatch is due  to the presence of
some  other unmodelled  phenomena  that  affects the  DC  offset of  electrolyte
overpotential, and is not arising due to the approximations used by this author.

In \cref{fig:phiedeltacnst1C},   the  shape   of   the   transient  profile   of
overpotential  computed  by  the  system identification  model  closely  matches
that  of the  \gls{p2d} model.  This validates  that the  newly developed  model
does  indeed  capture the  electrolyte  dynamics  sufficiently well  during  the
initial transient.  However, past  the initial  transient, the  model's accuracy
degrades and  the resulting  profile does  not track  the \gls{p2d}  model. This
behaviour in overpotential is analogous to that exhibited in the spatio-temporal
concentration   study   discussed  in \cref{subsec:tfquadceconstcurrinput}   for
constant current inputs,  wherein it was deemed that this  newly developed model
is  more  suitable  for  dynamic  loads. The  same  conclusion  for  electrolyte
overpotential   accuracy  is   reached   from  this   constant  current   study.
Nevertheless, even for  constant current loads, using the  newly developed model
is better than having no electrolyte model whatsoever as in the basic \gls{spm}.

\begin{figure}[!htbp]
    \centering
    \includegraphics{phie_delta_udds.pdf}
    \caption[%
    Electrolyte  overpotential  computed  by the  \glsfmtshort{p2d}  and  system
    identification models for a \glsfmtshort{udds} load profile
    ]%
    {%
        Comparison    of    electrolyte    overpotential   computed    by    the
        \gls{p2d}     model    and     the    system     identification    model
        (using \cref{eq:electrolytepdwithcenew}) for a  \gls{udds} load profile.
        The overpotential  profile computed  by the system  identification model
        reasonably matches  the profile obtained  by the \gls{p2d} model  with a
        \glsfirst{mae} of \SI{15.88}{\milli\volt} and  a \glsfirst{rms} error of~\SI{24.11}{\milli\volt}.
    }%
    \label{fig:phiedeltacnstudds}
\end{figure}

\Cref{fig:phiedeltacnstudds} shows a comparison of the electrolyte overpotential
computed by the \gls{p2d} and system identification models for a \gls{udds} load
profile. The  input current corresponding to  this load profile is  shown in the
top row  of \cref{fig:uddssimp2dspmresults}. The system  identification model is
able to  reasonably track  the overpotential profile  computed by  the \gls{p2d}
model. Unlike the  case of sustained unidirectional current input,  the error in
this case  remains well-contained. The  \gls{mae} obtained for this  profile was
\SI{15.88}{\milli\volt}  with  an  \gls{rms}  error  of~\SI{24.11}{\milli\volt}.
This  corresponds to  \SI{8.19}{\percent} and  \SI{12.44}{\percent} of  the peak
magnitude of the overpotential (\SI{193.86}{\milli\volt}).

Hence, it can be concluded  that the electrolyte overpotential computation using
the system identification  model provides an acceptable  performance for dynamic
load profiles.  The next step  is to incorporate this  electrolyte overpotential
calculation into the basic \gls{spm} and to quantify the voltage accuracy of the
resulting composite \gls{spm}.

\subsection{Terminal voltage computation of composite \glsfmtshort{spm}}

In \cref{subsec:simresultsbasicspm}, it  was shown that in  the basic \gls{spm},
the computation of the cell's \gls{soc}  is of sufficient accuracy. However, its
terminal  voltage  strongly deviates  from  the  true  value  as computed  by  a
\gls{p2d} model.  This mismatch between  \gls{soc} and terminal  voltage hinders
the  suitability of  the basic  \gls{spm}  as the  plant model  in online  state
estimation applications. The discrepancy in terminal  voltage is due to the lack
of electrolyte overpotential contribution in  its computation. Having obtained a
suitable methodology  to compute this  (see \cref{subsec:electrolyteopcalc}), it
is now possible to refine the computation of the cell's terminal voltage.

Referring   to \cref{eq:posoverpotential}  and \cref{eq:negoverpotential},   the
reaction overpotential in each of the two porous electrode regions is given by
\begin{align}
    _\text{pos} &= _\spos - _\epos - U_\text{pos} \label{eq:posoverpotentialoverall} \\% \tag{\cref{eq:posoverpotential} revisited}\\
    _\text{neg} &= _\sneg - _\eneg - U_\text{neg} \label{eq:negoverpotentialoverall} %\tag{\cref{eq:negoverpotential} revisited}
\end{align}
wherein  the  contribution  from   the  electrolyte  potential  terms~$_\epos$
and~$_\eneg$ are no longer to be neglected.

Subtracting \cref{eq:negoverpotentialoverall}
from \cref{eq:posoverpotentialoverall}
\begin{align}
 _\text{pos} - _\text{neg} &= \underbrace{_\spos - _\sneg}_{V_\text{cell}} - _\epos + _\eneg - U_\text{pos} + U_\text{neg}\\
\shortintertext{whose rearrangement yields}
V_\text{cell} &= _\text{pos} - _\text{neg} + \underbrace{_\epos -
_\eneg}_{\Delta \phi_\text{e}} + U_\text{pos} -
U_\text{neg}\label{eq:intermediatevoltagewithphie}
\end{align}

Substituting for ${\Delta \phi_\text{e}}$ from \cref{eq:electrolytepdwithcenew} in
into \cref{eq:intermediatevoltagewithphie},  and  expanding  each of  its  terms
(see derivation of \cref{eq:spmbasicoutputvoltagefinal}  for details), the final
expression for the cell's terminal voltage is obtained as
\begin{multline}
    V_\text{cell}(t) = \frac{2 R T}{F }\sinh^{-1} \left( \frac{- I(t)}{2 A l_\text{pos} a_\spos F k_\posr \sqrt{c_\text{e} c_\spossurf(t) \left(c_\sposmax - c_\spossurf(t)\right)}}\right) \\
    - \frac{2 R T}{F }\sinh^{-1} \left( \frac{I(t)}{2 A \, l_\text{neg} a_\sneg F k_\negr \sqrt{c_\text{e} c_\snegsurf(t) \left(c_\snegmax - c_\snegsurf(t)\right)}}\right) \\
    \hphantom{\text{hello worl}}+ (1-t_{+}^0) \frac{2RT}{F}\ln \frac{c_\text{e,\tiny pos/cc}(t)}{c_\text{e,\tiny neg/cc}(t)} -\frac{I}{2 A}\left(\frac{l_\text{neg}}{\kappa_\text{eff,neg}\left(c_\text{e}\left(0\right)\right)} + 2 \frac{l_\text{sep}}{\kappa_\text{eff,sep}\left(c_\text{e}\left(0\right)\right)} +
\frac{l_\text{pos}}{\kappa_\text{eff,pos}\left(c_\text{e}\left(0\right)\right)}\right)\\
    + \mathcal{U}_\text{pos}\left(c_\spossurf(t)\right) - \mathcal{U}_\text{neg}\left(c_\snegsurf(t)\right)\label{eq:spmcompositeoutputvoltagefinal}
\end{multline}

All  other   expressions  and  computations   of  the  basic   \gls{spm}  remain
unchanged (see \cref{sec:spmmodeldevelopment} for the  complete set of equations
constituting the model). The final step  is to show that the composite \gls{spm}
thus obtained has an improved performance especially in those scenarios that the
basic \gls{spm} performed poorly.

\subsection{Validation of composite \glsfmtshort{spm}: Terminal voltage accuracy}

The final  step in  this model  development effort is  the validation  phase. In
particular, the voltage accuracy of  the composite \gls{spm} is compared against
the  \gls{p2d} model  for standard  input conditions.  In order  to compare  and
contrast the  gains achieved  by the composite  \gls{spm}, the  terminal voltage
output of the basic \gls{spm} is also considered here.

\subsubsection*{Constant Current Inputs}

The  voltage  accuracy of  the  newly  developed  composite \gls{spm}  is  first
evaluated for  the standard test  case of 1C~discharge current starting  from a
cell \gls{soc} of~\SI{100}{\percent}.

\begin{figure}[!htbp]
    \centering
    \includegraphics{composite_spm_vcell_1C.pdf}
    \caption[%
    Comparison  of  terminal  voltages  of  composite  \glsfmtshort{spm},  basic
    \glsfmtshort{spm} and the \glsfmtshort{p2d} model for a 1C~discharge
    ]%
    {%
        Voltage output  of various \glspl{spm}  for a 1C~discharge  beginning at
        \SI{100}{\percent} \gls{soc} (top  plot). Since it does  not account for
        electrolyte overpotentials,  the voltage  profile computed by  the basic
        \gls{spm} lies above that of the benchmark \gls{p2d} model. On the other
        hand, the composite \gls{spm} tends  to over correct for the electrolyte
        overpotential  so that  its terminal  voltage lies  below the  \gls{p2d}
        output. Since  the two \glspl{rom}  have outputs  on either side  of the
        \gls{p2d}  model,  it  is  convenient  to  use  the  absolute  error  to
        compare  them. In  the  bottom  plot, the  percentage  deviation of  the
        absolute error of the two  \glspl{rom} is shown. The composite \gls{spm}
        performs  significantly better  with a  peak absolute  error of  \approx
        \SI{4}{\percent} in  contrast to nearly \SI{11}{\percent}  for the basic
        \gls{spm}.
    }%
    \label{fig:voltageoutputcompareallSPMs1C}
\end{figure}

\Cref{fig:voltageoutputcompareallSPMs1C}  shows the  terminal voltage  output of
various \glspl{spm} for a 1C~discharge beginning at \SI{100}{\percent} \gls{soc}
(top  plot). Since  it  does  not account  for  electrolyte overpotentials,  the
voltage profile computed by the basic \gls{spm} lies above that of the benchmark
\gls{p2d}  model. On  the  other hand,  the composite  \gls{spm}  tends to  over
correct  for the  electrolyte overpotential  so that  its terminal  voltage lies
below  the \gls{p2d}  output. Since  the output  of the  two \glspl{rom}  lie on
either side of the \gls{p2d} model, it  is appropriate to use the absolute value
of their errors with respect to the  \gls{p2d} benchmark to compare them. In the
bottom  plot,  the  percentage  deviation  of the  absolute  error  of  the  two
\glspl{rom} is shown. The statistics of this deviation is quantified
in \cref{tbl:errorsummarycntcurrdischgallspms}.

\begin{table}[!htbp]
    \caption[%
    Error statistics for basic  and composite \glsfmtshortpl{spm} for 1C~discharge
    ]%
    {%
    Summary of statistics for the percentage absolute error
        in terminal voltage
    for the basic \glsfmtshort{spm} and the composite \glsfmtshort{spm} in constant current 1C~discharge simulations.
}%
    \label{tbl:errorsummarycntcurrdischgallspms}
    \centering
    \begin{tabular}{@{} l S[table-format=2.2] S[table-format=1.2] @{}}
        \toprule
        \makecell{Error Statistic \\ for \si{\percent}$\abs{\hat{\varepsilon}_v}$} & {\makecell{Basic \\ \glsfmtshort{spm}}} & {\makecell{Composite \\ \glsfmtshort{spm}}} \\
        \midrule
        Worst Case        & 10.67 & 4.05 \\
        Mean              & 2.92  & 1.54 \\
        \glsfmtshort{rms} & 3.27  & 1.65 \\
        \bottomrule
    \end{tabular}
\end{table}

In  each of  the error  statistic considered,  the composite  \gls{spm} performs
significantly better than the basic \gls{spm} for the 1C~discharge case.

One   of   the   biggest   drawbacks   of   the   conventional   \gls{spm}   was
its    poor    voltage    accuracy    at    moderate    C-rates    above~0.5C
(see \cref{tbl:errorsummarycntcurrdischgspmp2d}). The high accuracy achieved for
the 1C~rate  seems to indicate that  the composite \gls{spm} is  indeed a viable
solution for all  high C-rates, especially given the backdrop  of its methodical
derivation steeped in systems theory.

However,  there exists  a  fundamental  flaw in  all  models  that use  a~priori
assumptions  of  simplified spatial  profiles  for  ionic concentration  in  the
electrolyte.  In  the  case  of  both the  baseline  quadratic  and  the  system
identification models, a parabolic profile spanning the entire thickness of each
region within the cell was chosen a~priori. However, no attempt to modify the
profile upon encountering an ion starvation event at any spatial location.

This  critical flaw  is  exposed  by the  sustained  application  of any  higher
current  that  induces  an  ion  starvation at  one  of  the  electrodes  during
operation.\Cref{fig:2Cionstarvation}  depicts  the  ionic concentration  in  the
electrolyte  over  time at  both  current  collectors  for a  2C~discharge.  The
profiles  computed  by  both  the \gls{p2d}  and  system  identification  models
are  plotted.  For  the  system  identification  model,  the  current  collector
interface  at  the  positive  electrode  experiences  an  ion  starvation  event
at~\approx\SI{150}{\second}. The  quadratic spatial  profile used by  this model
does not account for such a  reduction in the effective electrode thickness. All
the  boundary conditions  and coefficients  were formulated  using the  original
electrode  thickness.  Therefore,  beyond \SI{150}{\second},  the  concentration
becomes negative which  is not physically meaningful. The author  of this thesis
has implemented a saturation mechanism in the code that detects an ion depletion
event and prevents the concentrations from becoming negative.

Implementing  this  hard   lower  bound  of  zero  for   the  ion  concentration
does    not   mitigate    the   problems    associated   with    computing   the
electrolyte   overpotential.   Specifically,  computational   difficulties   are
encountered    when   computing    the    concentration   dependent    diffusion
overpotential \cref{eq:electrolytepdwithcenew}. In the case  of ion depletion at
the positive  current collector,  the argument of  the logarithmic  term becomes
zero which leads to a non-feasible computation~($-\infty$). Ion depletion at the
negative current collector  is equally detrimental to  the computation. However,
this scenario has  a lower probability owing to the  low C-rates during charging
operation (see \cref{subsec:basicspmsimsetup}).  Furthermore, in the  absence of
the lower  bound of zero  for the  concentrations, complex numbers  are obtained
from  the logarithmic  term, which  lead to  physically erroneous  overpotential
calculations. An  alternative is  to simply omit  the diffusion  impedance term.
However, since  this term is  responsible for  the large-signal dynamics  of the
overpotential (see \cref{fig:contributiontophiefromtwoterms}), omitting this and
reverting to  a simple ohmic  resistance contribution shall lead  to significant
errors  in  the electrolyte  overpotential,  and  consequently in  the  terminal
voltage.  Finally, setting  the diffusion  impedance to  zero at  the transition
boundary of ion starvation is also not a feasible solution. This is because, the
sudden inflection in  the trajectory of the terminal voltage  shall induce large
errors in any state estimation algorithms that depend on the composite \gls{spm}
as the plant model.

The  difficulties  encountered  in electrolyte  overpotential  computations  for
ion  depletion scenarios  have  not  yet been  discussed  in  the literature  by
the  research  community that  use  such  quadratic approximation  models.  This
thesis author  therefore assumes that  such a  scenario had not  been previously
encountered  for  the  parameter  set  and C-rate  combinations  used  by  those
researchers. Despite the  fact that this phenomenon might be  an artefact of the
idiosyncrasies of the  parameter set used here, it  is nevertheless questionable
to not  have mathematically adapted  the parabolic  profile to such  events. The
aspect  of rendering  the model  robust to  such vagaries  is currently  an open
problem in the field and can be the subject of future research. It can therefore
be concluded that  this composite \gls{spm} is \emph{unsuitable}  in its present
form for  sustained constant current  discharge at higher C-rates.  Despite this
setback due  to deficiencies in  the mathematical formulation of  the underlying
spatial profile, the superior performance  of the system identification model in
the computation  of ionic  concentrations and overpotentials  for \emph{dynamic}
conditions warrant such a study for the composite \gls{spm}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{problematic_2C_conc.pdf}
    \caption[
    Time evolution of ionic concentration computed by the \glsfmtshort{p2d} and system
    identification models at both current collectors for a 2C~discharge
    ]
    {%
        Time evolution of ionic concentration in electrolyte computed by the \gls{p2d} and
        system identification models at ---
        \begin{enumerate*}[label=\emph{\alph*})]
            \item negative current collector interface (left plot), and
            \item positive current collector interface (right plot)
        \end{enumerate*}
        for a constant current discharge at \SI{120}{\ampere} \ie~2C. In the
        system identification mode, ion
        starvation occurs at the positive current collector interface at~\approx\SI{150}{\second}. The quadratic spatial profile used by the system
        identification model spans the entire electrode region and does not
        account for ion depletion scenarios. In this thesis, the author has
        implemented a saturation mechanism in the computer code to prevent the
        ionic concentration from becoming negative. Despite this
        mitigating action, the computation of electrolyte overpotential
        using \cref{eq:electrolytepdwithcenew} is problematic in such scenarios.
    }%
    \label{fig:2Cionstarvation}
\end{figure}

\subsubsection*{Dynamic Load Conditions}

In  order to  evaluate the  performance of  the composite  \gls{spm} to  dynamic
inputs, the  input profile  corresponding to  the \gls{udds}  drivecycle profile
in \cref{fig:uddssimp2dspmresults}  with  a  peak current  of  \SI{180}{\ampere}
\ie~3C was used.

\Cref{fig:voltageoutputcompareallSPMsudds}  shows  the  voltage  output  of  the
composite  \gls{spm}  for a  \gls{udds}  input  profile  with a  peak  magnitude
of   \SI{180}{\ampere}  \ie~3C  (see \cref{fig:uddssimp2dspmresults}).   The
voltage   profiles  computed   by  the   basic  \gls{spm}   and  the   benchmark
\gls{p2d}  model   is  also  overlaid   (top  plot).  The   percentage  absolute
error  of  the  two  \glspl{rom}  relative  to  the  \gls{p2d}  model  is  shown
in  the  bottom  plot.  Clearly,  it  is  seen  that  the  terminal  voltage  of
the  composite  \gls{spm}   is  significantly  more  accurate   than  the  basic
\gls{spm}  (see \cref{tbl:errorsummaryuddsdischgallspms}).   For  instance,  the
voltage  profile  computed by  composite  \gls{spm}  matches the  complex  shape
characteristics  of the  \gls{p2d} model  while remaining  very close  to it  in
magnitude.

\begin{figure}[!htbp]
    \centering
    \includegraphics{composite_spm_vcell_udds.pdf}
    \caption[%
    Terminal voltage output of --- \emph{a}) the \glsfmtshort{p2d} model, \emph{b}) the
    basic \glsfmtshort{spm}, and \emph{c}) the composite \glsfmtshort{spm} for a
    \glsfmtshort{udds} input profile
    ]%
    {%
        Voltage output of the composite \gls{spm} for a \gls{udds} input profile
        with a peak magnitude of \SI{180}{\ampere} \ie~3C
        (see \cref{fig:uddssimp2dspmresults}). The voltage
        profiles computed by the basic \gls{spm} and the benchmark \gls{p2d}
        model is also overlaid (top plot). The percentage absolute error of the
        two \glspl{rom} relative to the \gls{p2d} model is shown in the bottom
        plot. The terminal voltage of the composite \gls{spm} is significantly
        more accurate than the basic \gls{spm}
        (see \cref{tbl:errorsummaryuddsdischgallspms}).
    }%
    \label{fig:voltageoutputcompareallSPMsudds}
\end{figure}

\begin{table}[!htbp]
    \caption[%
    Error statistics for basic  and composite \glsfmtshortpl{spm} for a \glsfmtshort{udds} load profile
    ]%
    {%
    Summary of statistics for the percentage absolute error
        in terminal voltage
        for the basic \glsfmtshort{spm} and the composite \glsfmtshort{spm} with \gls{udds} input profile.
}%
    \label{tbl:errorsummaryuddsdischgallspms}
    \centering
    \begin{tabular}{@{} l S[table-format=2.2] S[table-format=1.2] @{}}
        \toprule
        \makecell{Error Statistic \\ for \si{\percent}$\abs{\hat{\varepsilon}_v}$} & {\makecell{Basic \\ \glsfmtshort{spm}}} & {\makecell{Composite \\ \glsfmtshort{spm}}} \\
        \midrule
        Worst Case        & 2.59 & 0.72 \\
        Mean              & 0.51 & 0.11 \\
        \glsfmtshort{rms} & 0.68 & 0.16 \\
        \bottomrule
    \end{tabular}
\end{table}

In  summary, while  the newly  developed composite  \gls{spm} is  not considered
robust for use in  sustained discharge at high C-rates, it  is indeed a suitable
option for  dynamic load profiles, even  for those with high  peak magnitudes of
instantaneous charge or discharge. Such  load profiles are typically encountered
in vehicular  applications, particularly  in hybrid  electric vehicles.  Thus, a
suitable time-domain \gls{rom} that can be directly implemented in discrete-time
has  been  developed  through  system   identification  and  its  strengths  and
weaknesses have been quantified. The applicability of this model has been proven
for real-life  scenarios using a  highly dynamic  load cycle. Thus,  this author
concludes that the  composite \gls{spm} developed here does  indeed represent an
advancement to  the present  modelling art. This  model may now  be used  as the
plant  model  in  state  estimation  and control  applications  in  a  vehicular
\gls{bms}. This concludes the chapter as  well as all the implementation aspects
of physics-based battery modelling discussed in this thesis.

\setcounter{chapter}{6}

\clearpage
\chapter{Conclusions}\label{ch:conclusions}
\startcontents[chapters]
\printcontents[chapters]{}{1}{\setcounter{tocdepth}{1}}

\bigskip

\capolettera{I}{n} this  thesis, the  deployment of  physics-based computational
modelling  of lithium  ion  cells  for electric  vehicle  applications has  been
rigorously examined  with a three-pronged strategy  \viz~through their analysis,
design and implementation.  The \gls{p2d} implementation of  the \gls{dfn} model
was  used  as  the  backbone  of  all  modelling  efforts.  Salient  conclusions
drawn  from each  of these  aspects are  presented in  this chapter.  Based upon
the  invaluable  experience gained  during  the  course  of this  research,  and
particularly  from the  findings presented  herein, key  areas in  physics-based
modelling that can benefit from further study in the future are also identified.

\section{\glsfmtlongpl{pbm} as a Design Tool}

\subsection{Conclusions from the model-based design study}\label{sec:modelbasedconclusion}

\Cref{ch:modelbaseddesign} presented  a computational framework to  optimise the
number  of electrochemical  layers within  a pouch  cell so  as to  maximise its
usable energy while  meeting specific power demands. In  particular, this helped
to construct a model-based deterministic approach to optimally design cells that
can  be subjected  to  fast-charging without  the concerns  of  plating. In  the
context of electric vehicle applications,  using this approach has the potential
to alleviate  the two immediate concerns  of consumers \viz{} range  anxiety and
long charging times.

To  facilitate  immediate  adoption   by  relevant  stakeholders,  the  concepts
developed  in  the  optimisation  framework  of  \cref{ch:modelbaseddesign}  was
realised in  computer code and  presented in the  form of an  open-source design
toolbox, \gls{bold}. This toolbox was applied  to the optimal layer design of an
example cell from literature to obtain two sets of power-dependent optimal layer
configurations for two drivetrains --- a \gls{bev} and a \gls{phev}. By suitably
adapting the  numerical values of  parameters to a real-world  cell, model-based
cell  designs can  be  obtained, which  can potentially  help  to eliminate  the
current trend  of over-engineering of  cells using conservative  empirical layer
choices.

From a  perspective of technical  advancements to the underlying  \gls{pbm}, the
standard form  of the \gls{p2d} model  has been suitably modified  to facilitate
a  direct  application of  input  power  densities.  This was  achieved  through
reformulation of the boundary conditions on the solid-phase potential \gls{pde}.
Although  this innate  power input  capability has  been claimed  as purportedly
developed  in  extant  literature,  its independent  derivation  and  accessible
documentation  provided herein  shall help  other researchers  to apply  this in
a  straight-forward  manner  for  vehicle drivecycles,  acceleration  tests  and
power-based charging protocols.

This investigation also  revealed that the fast charging  process determines the
optimal layer  configuration instead of  either acceleration runs  or drivecycle
requirements. This may  help to counter the current trend  in publications which
often rely  primarily upon a  drivecycle-based dynamic input current  profile to
evaluate various  aspects of cell  modelling such as predicting  degradation and
for advanced control and estimation  algorithms. While validation against such a
dynamic input profile  is certainly vital, for future  advancements dealing with
aspects  of  cell  design  or plating-related  degradation,  validation  against
fast-charging power profiles is deemed to be absolutely essential.

The  study  also  provided  important  guidelines  about  the  role  of  thermal
environment on cell performance. It became  clear that at very low temperatures,
a high  number of layers was  required for satisfying a  specific charging power
level relative  to that  needed at  moderate thermal  environments such  as room
temperatures. A practical  takeaway from this conclusion is that  it suffices to
use a low number of layers in  vehicles to be sold in territories with perennial
moderate temperature conditions.

Finally, this design study revealed that the speed at which lithium intercalates
into the negative  electrode during charging limits the  charge-addition rate to
the cell. Lowering  the charging times of electric vehicles  requires the use of
higher charging  powers. However, this necessitates  a high number of  layers to
absorb the overpotentials  and to provide adequate number  of thermal conduction
pathways (owing  to the higher  number of  current collectors) to  dissipate the
additional heat  generated. Consequently, this  has a detrimental effect  on the
capacity and hence, the \gls{aer} of the vehicle.

\subsection{Future work informed by  the optimal layer design framework}

As     a     direct     inference     of     the     final     conclusion     in
\cref{sec:modelbasedconclusion}, assuming that  the electric grid infrastructure
is  adequately equipped  to cope  with  the surge  in future  power demands  for
charging  of  electric vehicles,  the  solid  state  diffusion at  the  negative
electrode becomes the bottleneck. It  is therefore important for future research
to  focus  on the  development  of  new  materials  for the  negative  electrode
possessing much higher  solid phase diffusion coefficients,  particularly at low
temperatures.

From a perspective of improving the framework itself, at the outset, it is clear
that the plating threshold assessment can be made more accurate by incorporating
the solid phase diffusion coefficient as  function of \gls{soc}. In the interest
of simplicity and  to lay the foundation for such  model-based cell designs, the
scope of this  work was intentionally narrowed down to  solely focus on changing
the layer  configurations within  cells. In doing  so, certain  assumptions were
made  that  might have  to  be  revisited  and  potentially relaxed  before  its
application to real-world cell designs.

For instance, adherence  to the specific type of cooling  phenomena used \ie~tab
cooling, is one of the stronger assumptions used in this work. In this work, the
benefits of  employing this  cooling mechanism  has been  enumerated, and  it is
desirable that future  pack designs adopt it. However, the  vast majority of the
current generation of battery packs  use surface-cooled designs. This means that
temperature for all layers within the pouch shall not be the same, which further
implies that it longer suffices to  simulate just a single layer. Therefore, the
framework  needs  to be  suitably  modified  to  handle multiple  layer  choices
concurrently.

Furthermore,  using surface  cooling shall  invalidate the  assumption of  small
thermal gradients along the planar axis of  the cell. This means that the lumped
thermal model  shall no longer  be accurate  to model the  temperature evolution
of  the cell.  Furthermore,  the differential  temperature  evolution along  the
cross-sectional direction  shall influence the transport  and kinetic properties
of the  cell. This electrochemical-thermal  coupling along the  planar direction
shall necessitate adding another spatial  dimension to the underlying \gls{pbm},
thereby rendering the  presently used \gls{p2d} model ineffective.  With the aim
of minimising  the optimising  run-times, future  research may  focus on  how to
suitably adapt the computational infrastructure that was proposed in this thesis
to account for these considerations.

For  real-world cell  designs, it  is prudent  to examine  the examine  the role
of  variable  porosities  to  achieve  the balancing  of  active  materials  per
layer.  Since  the computational  framework  developed  in  this thesis  uses  a
modular  approach, in  the  future  the constant  volume-fractions  used in  the
methodology  could simply  be replaced  by values  informed by  optimal porosity
computations. For this purpose, researchers could investigate the feasibility of
adapting  a suitable  scheme from  the available  pool of  literature that  have
focussed  on  using  model-based  porosity  optimisation~\cite{Xue2013,Xue2014a,
Christensen2006}. Finally, experimental prototyping is  an important step in any
cell  design and  it  is  no exception  here  either. Therefore,  experimentally
applying the desired power levels to confirm the optimal layer choices predicted
by the  framework is an important  step to be undertaken  before its large-scale
deployment.

\section{Analysis of Salient Physics-based \glsfmtlongpl{rom}}

Chapters~\ref{ch:improveddra} and~\ref{ch:spmanalysis} of  this thesis primarily
focussed on performing an in-depth analysis of two distinct \glspl{rom} from two
distinct perspectives.  In \cref{ch:improveddra}, the hybrid  \gls{rom} obtained
by  using the  \gls{dra}  is analysed  to  investigate its  \emph{computational}
bottlenecks. In \cref{ch:spmanalysis}, an in-depth analysis of a niche selection
of  candidate models  from  the  family of  \glspl{spm}  is  presented from  the
perspective of \emph{modelling accuracy} \ie~their ability to faithfully compute
the  system-level quantities  of the  cell such  as its  \gls{soc} and  terminal
voltage. Finally, the early portions of \cref{ch:newelectrolytemodel} provides a
thorough analysis  of the bottlenecks  of the quadratic approximation  model for
computing the  spatial profile  of ionic concentration  in the  electrolyte. The
conclusions drawn  from all aforementioned  analyses are presented  next. Topics
that may  be of interest to  future researchers engaging with  these \glspl{rom}
are also proposed.

\subsection{Conclusions from analysis of the \glsfmtshort{dra}-based state-space \glsfmtshort{rom}}

In \cref{ch:improveddra}, \gls{svd} of a large Block-Hankel matrix is identified
as a key computational bottleneck  in applying the classical \gls{dra} procedure
for the hybrid \gls{rom} discussed therein. It is concluded that this bottleneck
arises due  to the  slow dynamics of  solid phase diffusion  which leads  to the
aforesaid large sized Block-Hankel matrices.

To mitigate this  bottleneck, an improved \gls{dra} scheme  was presented, whose
centrepiece is an iterative \gls{svd}  algorithm. This algorithm was obtained as
a  combination of  the Golyandina-Usevich  and Lanczos  algorithms discussed  in
\cref{ch:improveddra}.  The results  of applying  the improved  \gls{dra} scheme
demonstrate  a significant  performance improvement  achieved by  using the  new
method  without trading-off  model  fidelity.  At a  single  operating point  of
\gls{soc}  and temperature,  for  a  Hankel block  size  of~8000, the  \gls{rom}
workflow incorporating the improved  \gls{dra} is approximately 100~times faster
than that employing the classical  \gls{dra}. On a standard computer workstation
whose  specifications  are  given in  \cref{ch:improveddra},  for  100~operating
points  (combinations of  10~\gls{soc}  and temperature  values), obtaining  the
\gls{rom}  required  only 6~hours  using  the  improved \gls{dra},  whereas  the
classical \gls{dra}  consumed 666~hours~(\approx 27~days). Furthermore,  for the
same block-size, the improved \gls{dra} is  demonstrated to be superior in terms
of memory efficiency,  drastically reducing the memory  requirements from 112~GB
down to  2~GB. Finally, the  improved \gls{dra} demonstrates  improved modelling
accuracy even  in moderately  equipped computing  environments such  as standard
consumer-grade laptops.

\subsection{Future outlook for the \glsfmtshort{dra}-based hybrid state-space \glsfmtshort{rom}}

The improved  \gls{dra} method  proposed in  \cref{ch:improveddra} opens  up the
possibility of  applying the  hybrid \gls{rom}  modelling procedure  to physical
quantities in  other locations within the  cell's geometry \eg~in the  middle of
the electrode region,  without being hindered by  computational limitations that
would  have otherwise  rendered  it intractable.  Furthermore, high  sample-rate
\glspl{rom} capable of handling highly dynamic  load profiles can be deployed in
future \gls{bms} applications.  The proposed scheme also  empowers the \gls{rom}
framework to tackle other cell chemistries with slower diffusion coefficients or
even  those with  completely different  rate-limiting mechanisms,  and therefore
prima~facie, appears to be promising.

Despite   the  aforementioned   euphoric   possibilities   facilitated  by   the
streamlining  of  the reduced  order  modelling  workflow through  the  improved
\gls{dra},  there  exists a  fundamental  deficiency  in this  hybrid  modelling
approach  that impede  its near-term  adoption in  state estimation  tasks. This
aspect was already discussed in \cref{ch:littreview} and is reiterated here. The
entries  in  the  matrices  of  the  final  state  space  model  depend  on  the
linearisation point of \gls{soc} and temperature. This linearisation requirement
adversely affects the usability of the model for state estimation tasks, wherein
the \gls{soc} is in fact an unknown quantity and is to be estimated. This cyclic
dependency  between  the linearisation  point  and  the state-estimation  entity
renders this  model questionable for use  in a demanding application  such as in
embedded \glspl{bms} on-board electric vehicles. Therefore, the immediate future
step is to analyse  the stability of this internal feedback  loop. Once this has
been performed,  researchers may consider to  engage in the process  of adapting
the derivation of this hybrid  state-space \gls{rom} approach to higher C-rates,
in conjunction  with the numerical  benefits afforded by the  improved \gls{dra}
developed here.

\subsection{Conclusions from analysis of the \glsfmtshort{spm} family of models}

Based    upon   the    holistic   evaluation    of   various    \glspl{rom}   in
\cref{ch:littreview},  owing   to  its  simplicity,  the   \gls{spm}  family  of
models  was  identified  as  the  most promising  modelling  candidate  from  an
\emph{implementation}  perspective. \Cref{ch:spmanalysis}  provided an  in-depth
analysis of the strengths and drawbacks of this modelling family.

Results from  simulation of  the basic \gls{spm}  revealed that  two contrasting
aspects. Firstly, the  \gls{soc} computation of the \gls{spm}  was of acceptable
accuracy even at moderate C-rates thereby validating the fourth order polynomial
approximation approach  for capturing  solid phase diffusion  dynamics. However,
the basic  \gls{spm} suffers  from severe inaccuracies  in computing  the cell's
terminal voltage  at currents above  0.5C. This dichotomous  behaviour, revealed
through  this  analysis, has  not  been  explicitly  commented upon  in  present
literature.  In  particular,  despite  its overarching  simplicity,  it  can  be
concluded that it is this contrasting  aspect that renders the model unusable as
the  plant model  for  state  estimation tasks.  This  is  because, the  voltage
measured  from the  model  in a  feedback  estimator shall  map  to a  radically
distant \gls{soc} operating point requiring  excessively strong gain factors for
correcting it adversely affecting the stability of estimators.

Several  research efforts  from literature  that  have attempted  to tackle  the
voltage inaccuracies  of the  basic \gls{spm}  through inclusion  of electrolyte
dynamics were also presented in  \cref{ch:spmanalysis}. A critical evaluation of
each  of  the  salient  efforts  revealed that  a  suitable  approach  that  can
successfully handle all possible operational scenarios  is yet to be devised. In
particular, the  existing modelling approaches for  electrolyte inclusion either
made  far-fetched assumptions  that  were easily  violated  or presented  nearly
intractable  mathematical  expressions  that  pushed  the  \gls{spm}  closer  in
computational complexity  to the  \gls{p2d} dynamics.  My analysis  of pertinent
literature  also  revealed  the  possibility of  re-using  certain  portions  of
existing work \eg~the electrolyte  overpotential expression, whilst also arguing
the need  for a fresh  approach to model  other aspects of  electrolyte dynamics
such as the ionic concentration profile within the cell's thickness.

The  final  section  of  \cref{ch:spmanalysis}  presented  the  assumptions  and
governing equations of the popular quadratic approximation model for the spatial
profile of  ionic concentration. The  results obtained by simulating  this model
reveal that while its spatial  profile computation for a galvanostatic operation
is of  acceptable accuracy, the temporal  performance of the model  is mediocre.
Particularly, the time evolution of ionic concentration at the current collector
interfaces computed by the model fail to capture the intricacies in the temporal
evolution exhibited by  the \gls{p2d} model's profile.  Furthermore, the spatial
profile uses  the \gls{qss} approximation  which is violated during  the initial
transient. Hence, the  most impactful conclusion from the  foregoing analysis is
that the  basic quadratic approximation  model is unsuitable for  dynamic loads,
thereby ruling it out for deployment in vehicular applications.

The initial portions of \cref{ch:newelectrolytemodel} analysed the causal factor
contributing to the mediocre performance of the quadratic approximation model.
For this analysis, a genetic programming approach was employed to synthesise
suitable alternative reduced order equations for modelling the spatial profile
of the electrolyte concentration. The foregoing analysis helped to reveal that
given the constraints and interior-point boundary conditions of the underlying
\gls{dfn} model at the separator interfaces, the number of coefficients used in
the quadratic spatial profile does indeed make the best use of all available
equations. The genetic programming approach being able to synthesise suitable
mathematical structures that can potentially capture the spatial profile
accurately during both transient and steady state conditions. However, there is
a shortfall in the number of equations in order to uniquely solve for these
extra coefficients. The final conclusion that stems from this fact is that, by decoupling
the spatial and temporal profiles of the electrolyte concentration dynamics, the
performance of the present state of the art can indeed be improved upon.

\subsection{Proposed analysis routes for the \glsfmtshort{spm} modelling family}

Albeit extensive, the analyses of \glspl{spm}  performed in this thesis is by no
means complete. It is more appropriate to  say that this author chose to analyse
\glspl{spm} from  their implementation  perspective, particularly  their voltage
and \gls{soc}  accuracies in  an open-loop  implementation. However,  a holistic
evaluation covering  other aspects  are necessary before  their deployment  in a
vehicular \gls{bms} can be considered. For instance, the observability of models
must be  proven before  they can  be employed in  the feedback  path of  a state
estimator. Even  within the  broad stream of  observability analysis,  there are
several details that  need to be meticulously handled of  which some avenues for
future exploration are identified.

In the  simplification of the  state-vector of  the basic \gls{spm}  proposed by
Di~Domenico~\cite{DiDomenico2010}, the bulk concentration  in the two electrodes
was assumed to be equal  (see \cref{subsec:basicspmstatespace}). This allowed to
eliminate the bulk concentrations of one of the two electrodes, thereby reducing
the state  vector to~$\mathbb{R}^{3  \times 1}$. This  assumption hinges  on the
assumption  that  there is  no  loss  of  cycleable  lithium. However,  such  an
assumption  is valid  only for  a brand  new cell.  As the  cell ages,  owing to
various  phenomena such  as parasitic  side reactions  and decomposition  of the
solid conductive matrix,  this assumption shall no longer  hold true. Therefore,
analysis  of models  obtained by  augmenting the  basic or  electrolyte-enhanced
\glspl{spm}  with equations  describing degradation  shall become  critical. Not
only does this force to retain both bulk concentrations in the state vector, the
states from the  degradation rate-equations appear in it,  thereby enlarging it.
In  future  studies, the  effect  of  these  augmented  state variables  on  the
observability of the system needs to be quantified.

In this thesis,  only an \emph{isothermal} analysis of  various \glspl{spm} have
been performed. While this is an important initial step to analyse the strengths
and weaknesses of  the state of the art incumbent  \gls{spm} models by isolating
the  purely  electrochemical  aspects,  the  effect  of  temperature  cannot  be
underplayed. It  is well-known that the  thermal conditions of the  cell affects
its  electrochemical  and  vice-versa.  Therefore, future  works  shall  benefit
from  performing  comprehensive   analyses  of  coupled  electrochemical-thermal
\glspl{spm}. Considering the simplicity of \glspl{spm}, the lumped thermal model
might be a suitable candidate for it be paired with. Finally, in addition to its
influence  on the  accuracy of  open-loop  terminal voltage  and \gls{soc},  the
effect of  temperature on the  observability of the  holistic model needs  to be
evaluated. Since the cell temperature is available as an additional measurement,
it is likely to improve the model's observability. However, there is a trade-off
since this comes at  the cost of increased size of the state  vector. It is also
worthwhile  to explore  the  inflection point  of this  trade-off  to limit  the
model's fidelity at  a sufficient level whilst reaping the  maximum gains out of
the additional temperature measurement.

Based upon the conclusion that the performance of any reduced order spatial
profile model is hamstrung by the equation deficiencies in the underlying
\gls{dfn} model, it is worthwhile to reproduce the \gls{mggp} approach with a
different \gls{pbm}. For this future task, it is imperative to choose a model
that provides additional interior-point conditions \ie{} not just at the
separator, but perhaps a second order condition within an interior location at
each electrode. Once such a suitable \gls{pbm} has been identified, this thesis
author is confident that the genetic programming approach shall indeed
synthesise an accurate description of the electrolyte's spatio-temporal
dynamics.

\section{Implementation Aspects of Basic and Composite \glsfmtshort{spm}}

A driving impetus behind this thesis is to deliver \glspl{rom} amenable  to
embedded \emph{implementation}. Large portions of \cref{ch:spmanalysis} and
nearly the entirety of \cref{ch:newelectrolytemodel} were devoted to this study.
The conclusions that emerged from these implementation efforts are summarised
here. Future areas of research are also identified in-line.

In \cref{ch:spmanalysis}, the aspects of discrete-time implementation in a
microcontroller were discussed. In particular, the computation of the
discrete-time system and input matrices through  the  matrix exponential
approach is presented. A straightforward conclusion from the discrete-time
implementation is that they run orders of magnitude faster than their
continuous-time counterparts. This is owing to the fact that adaptive
time-stepping integrators are not required and can be replaced by a simple
matrix-vector multiplication scheme. This implementation detail provides
necessary starting point for battery researchers to start coding the \glspl{rom}
discussed herein. Future work in this direction shall benefit from including
various real-world issues such as accounting for sample delays as well as
implementing a progressive update scheme for the matrix entries to account for
degradation effects. Important aspects of numerical implementation arise during
the design of state estimators. Having a robust open-loop implementation of a
discrete-time plant model shall facilitate easy implementation of such feedback
algorithms.

\Cref{ch:newelectrolytemodel} discussed the implementation aspects of \gls{rom}
from a different perspective --- that of formulating a new electrolyte enhanced
composite \gls{spm} for embedded implementation. The temporal evolution of
electrolyte dynamics in the two electrode regions were characterised through
system identification techniques that have never been tried before in
literature. The identified model structures are presented in the final form as
discrete-time difference equations that can be readily incorporated into the
discrete-time equations developed in \cref{ch:spmanalysis} for the basic
\gls{spm}. The salient conclusion from this modelling effort is that, system
identification is indeed a viable candidate for the derivation of \glspl{rom} of
lithium ion batteries. The improved accuracy of electrolyte concentration
dynamics relative to the state of the art quadratic approximation model
corroborates the success of this strategy. Nevertheless, before widespread
adoption of this technique can be advocated, certain aspects of this approach
must be examined carefully. For instance, the assumptions of linearity and
time-invariance must be revisited for higher magnitudes of charge and discharge
currents. Thermal effects must also be incorporated into the overall system
identification approach. Machine learning and system identification are two
complementary approaches to the same task \ie~identification of internal
dynamics from terminal measurements. Future research could also explore this
possibility and perhaps a combined system identification/machine learning
strategy might metamorphose into the approach that powers future generation of
surrogate \glspl{rom} for electric vehicle applications.

\section{Closing Remarks}

The feasibility of bringing \glspl{pbm} of lithium batteries into electrified
transportation has been studied in this thesis from a multi-dimensional
perspective. Yet, there exists a common underpinning that connects these
seemingly different routes to enhancement of our extant knowledge --- that of
parametrising the underlying \gls{pbm}. The number of parameters in any
\gls{pbm} is excessively large to the point of detracting potential adopters.
Even without considering degradation effects, obtaining the physical, geometric,
transport and kinetic parameters of a cell shall require access to specialised
laboratory equipment that are sometimes exclusive to large scale research
organisations. The studies discussed here shall assume real-world significance
only upon a successful demonstration of a cost-effective parametrisation
strategy. The author's contributions to an optimal `Design of Experiments~(DoE)'
numerical procedure for identifying the parameters of an \gls{spm} is detailed
in~\cite{Pozzi2018}. However, the broader task of parametrising a
full-order \gls{pbm} is well beyond the scope of this thesis or indeed any
single researcher, and needs the concerted effort of the community as a whole to
tackle it.

The next task in the journey to real-world implementation of the advancements
brought about by this thesis is to  experimentally validate them. However, this
is contingent upon obtaining a successful parametrisation strategy, and should
be embarked upon as soon as a robust procedure to identify the physical
parameters is made available. Nevertheless, this author hopes that through the
three-pronged approach to cell modelling presented in this thesis, the goal of
bringing physics-based battery models to electrified transportation has been
brought a step closer to realisation.

\backmatter
\singlespacing
\begin{footnotesize} % Bibliography/References
    \renewcommand{\bibname}{References} % changes the header; default: Bibliography
    \cleardoublepage
    \phantomsection
    \addcontentsline{toc}{chapter}{\bibname}
    \printbibliography
\end{footnotesize}

\makeatletter
\@mainmattertrue
\makeatother
\cleardoublepage

\begin{appendices} % Using the appendices environment (from appendix package) for more functionality
    \crefalias{chapter}{appchap}

\chapter{Full Listing of Program Codes}
\startcontents[chapters]
\printcontents[chapters]{}{1}{\setcounter{tocdepth}{1}}

\cleardoublepage
\fakesection{MATLAB codes for continuous-time SPM}

\glsdisablehyper
\matlabcodelisting[\textsc{MATLAB} code for simulation of continuous time SPM]{cts_time_spm_simulation.m}{sc:ctstimespm}

\cleardoublepage
\fakesection{MATLAB codes for discrete-time SPM}
\matlabcodelisting[\textsc{MATLAB} code for simulation of discrete time SPM]{disc_time_spm_simulation_massive.m}{sc:disctimespm}

\glsenablehyper

\chapter{Permissions Summary}\label{ch:permissions}
\startcontents[chapters]
\printcontents[chapters]{}{1}{\setcounter{tocdepth}{1}}

\fakesection{Permissions Table}

\begin{landscape}
    \makeatletter \PLS@RemoveRotate % from chat with Ulrike Fischer
    \centering
    \begin{footnotesize}
        \begingroup
        \renewcommand{\arraystretch}{1.5}
        \begin{longtable}[c]{@{} l  l p{7.5cm} l c c p{1.6cm} @{}}
            \caption{\normalsize Summary of permissions for reuse of third-party copyrighted material} \label{tbl:permissionstable} \\

            \toprule
        \multicolumn{1}{c}{\makecell{Page \\ no.}} & \makecell{Usage in \\ thesis} & \makecell{Source \\ \vphantom{of work}} & \makecell{Copyright holder \& \\ Contact (organisations only)} & \makecell{Permission \\ requested on} & \makecell{Have \\ permission?} & \makecell[lt]{Permission \\ remarks} \\
        \midrule
        \endfirsthead

        \multicolumn{7}{c}%
        {{\normalsize \bfseries \tablename\ \thetable{} --- \normalfont  continued from previous page}} \\
        \toprule
        \multicolumn{1}{c}{\makecell{Page \\ no.}} & \makecell{Usage in \\ thesis} & \makecell{Source \\ \vphantom{of work}} & \makecell{Copyright holder \& \\ Contact (organisations only)} & \makecell{Permission \\ requested on} & \makecell{Have \\ permission?} & \makecell{Permission \\ remarks} \\
        \midrule
        \endhead

        \midrule
        \multicolumn{7}{ r @{}}{{\normalsize  Continued on next page}} \\[-1ex]
        \bottomrule
        \endfoot

        \bottomrule
       \endlastfoot

           \Cpageref{fig:energyvspowercell}         & \Cref{fig:energyvspowercell}          & \fullcite{VonSrbik2015}     & \Citeauthor*{VonSrbik2015}          & N/A                                                                & Yes                            & CC-BY-NC-ND                                           \\
           \Cpageref{fig:fig_CC_discharge_curves}   & \Cref{fig:fig_CC_discharge_curves}    & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{fig:1d_fv_mesh}                & \Cref{fig:1d_fv_mesh}                 & \fullcite{Torchio2016}      & \Citeauthor{Torchio2016}            & \DTMdate{2018-09-28}                                               & Yes                            & `Rightslink' service agreement attached               \\
           \Cpageref{fig:anodeoverhangpouchcell}    & \Cref{fig:anodeoverhangpouchcell}     & \fullcite{Bond2017}         & \Citeauthor{Bond2017}               & N/A                                                                & Yes                            & CC-BY                                                 \\
           \Cpageref{fig:topologies}                & \Cref{fig:topologies}                 & \fullcite{Northrop2011}     & \Citeauthor{Northrop2011}           & \DTMdate{2018-09-27}                                               & Yes                            & `Rightslink' service agreement attached               \\
           \Cpageref{fig:fig_generate_heatmap_BEV}  & \Cref{fig:fig_generate_heatmap_BEV}   & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{fig:fig_generate_heatmap_PHEV} & \Cref{fig:fig_generate_heatmap_PHEV}  & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{fig:fig_CapacityQuadrants}     & \Cref{fig:fig_CapacityQuadrants}      & Unpublished work            & Ian D.\ Campbell                    & \DTMdate{2018-09-30}                                               & Yes                            & Written agreement                                     \\
           \Cpageref{ch:improveddra}                & \makecell[lt]{All figures,           \\ tables and                 \\ captions of                        \\ \cref{ch:improveddra}}                                             & \fullcite{Gopalakrishnan2017}  & \makecell[lt]{The American Society                    \\ of Mechanical Engineers   \\ (ASME)  \\ \href{mailto:copyright@asme.com}{copyright@asme.com}}  & \DTMdate{2016-04-19} & Yes & \makecell[lt]{Copyright \\ agreement} \\
           \Cpageref{fig:sandwichtospm}             & \Cref{fig:sandwichtospm}              & \fullcite{Moura2012}        & \makecell[lt]{The American Society \\ of Mechanical Engineers                                           \\ (ASME)                        \\ \href{mailto:copyright@asme.com}{copyright@asme.com}}  & \DTMdate{2018-09-25}       & Yes  & `Rightslink' service agreement attached                          \\ \Cpageref{fig:timingdiagramBig}          & \Cref{fig:timingdiagramBig}           & \fullcite{Southward2011}    & \Citeauthor*{Southward2011}         & \DTMdate{2018-09-26}                                               & Pending                        & Email request sent                                    \\
           \Cpageref{fig:timingdiagramSmall}        & \Cref{fig:timingdiagramSmall}         & \fullcite{PlettECE5540_02}  & \Citeauthor*{PlettECE5540_02}       & \DTMdate{2018-09-28}                                               & Yes                            & By email                                              \\
           \Cpageref{fig:coordsquadapprox}          & \Cref{fig:coordsquadapprox}           & \fullcite{Deng2018}         & \makecell[lt]{Elsevier             \\ \href{mailto:permissions@elsevier.com}{permissions@elsevier.com}}  & \DTMdate{2018-09-27}           & Yes                                                    & Elsevier license attached \\

        \end{longtable}
   \endgroup
    \end{footnotesize}
\end{landscape}

\cleardoublepage

\fakesection{Copyright Permissions for Torchio~\etal}
\includepdf[pages=-,scale=0.85,pagecommand={}]{redacted_JES_Torchio_permission_pdf.pdf}
\fakesection{Copyright Permissions for Northrop~\etal}
\includepdf[pages=-,scale=0.85,pagecommand={}]{redacted_Northrop_permission_pdf.pdf}
\fakesection{Copyright Permissions for Moura~\etal}
\includepdf[pages=-,scale=0.925,pagecommand={}]{redacted_Moura_etal_permissions.pdf}
\fakesection{Copyright Permissions for Gopalakrishnan~\etal}
\includepdf[pages=-,scale=0.925,pagecommand={}]{asme_copyright.pdf}
\fakesection{Copyright Permissions for Deng~\etal}
\includepdf[pages=-,scale=0.85,pagecommand={}]{redacted_Deng_copyright.pdf}
\fakesection{Copyright Agreement --- Krishnakumar Gopalakrishnan and Ian D.\ Campbell}
\includepdf[pages=-,scale=0.85,pagecommand={}]{campbell_krishna_agreement.pdf}

\end{appendices}

\batchmode
\end{document}
