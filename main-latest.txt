
Fuel                   Electric                         `  Pbfaastttchg           3-phase             dt                  Gear Box        ÝÑ vf
            ICE       Generator          3-phase                     ÝÑ Pbaactct  Inverter                                                       Pw
                                         Rectifier                                                  PMSM
                                                           Battery                                  Motor
                                                        ´   Pack
                                                                                                      b

                                         Series String of 8 Identical Modules:

                      Module     Module  Module            Module  Module         Module    Module        Module
                          1          2       3                 4       5              6         7             8

                                                                                          :
                                                                                           BEV pack : 3 parallel strings

                                                                                           PHEV pack : 1 parallel string

                                                                                                 Pos. Electrode           Neg. Electrode
                                                                                          Pos. Curr. Collector
12 identical series-  ...                                                                                                           Separator
connected cells per
module                                                                                                                                                                                Neg. Curr. Collector

                                                                                            lAl     lpos         lsep     lneg            lCu

                                                                                                    ...                                  x

                                                                                                                          ...

  Figure 3.3§ Schematic depicting the vehicle-to-cell hierarchical overview of a typical electrified
  powertrain architecture. This represents the system-level context within which the proposed
  layer optimisation framework has been developed. Two xEV powertrains -- a) a Battery Electric
  Vehicle (BEV), and b) a series Plug-in Hybrid Electric Vehicle (PHEV) are chosen as examples to
  demonstrate how the methodology facilitates common module designs for such battery packs.

     §This figure was created by Krishnakumar Gopalakrishnan who asserts copyright, with intellectual
contributions from and the right to use asserted by Ian D. Campbell.

                                                                 68

                                                            3.3 Scope and Context within xEV Powertrain

              Omitting the components to the left of the battery pack (represented as text boxes with
          light grey border) shall render a powertrain corresponding to that of a BEV. The proposed
          layer optimisation methodology is developed and presented in the context of this BEV
          powertrain. However, being a modular framework, the optimisation methodology may be
          readily extended to a PHEV powertrain.

              As shown in fig. 3.3, the BEV powertrain typically comprises of -- a) a battery pack,
          b) a three phase inverter, c) a Permanent Magnet Synchronous Motor (PMSM), d) a gearbox
          for torque multiplication, and e) the rest of the powertrain (differential shaft and driven
          wheels). Considering the worst-case scenarios, the power to be handled by the battery pack
          arises due to -- i) fast charging from the mains bfaastttchg (charge), or ii) acceleration from
          standstill baactct (discharge). The acceleration power is computed from the power required at
          the wheels w. The details of this calculation is presented in section 3.5.2. The sign convention
          used in this chapter is that the charging power is positive (and consequently, the discharging
          power is negative).

        3.3.2 Pack-level -- strings, modules & cells

          Delving into the battery pack under consideration, this thesis considers a standard modular
          layout wherein the PHEV pack has one string while the BEV pack has three parallel strings.
          Within each string, both vehicular platforms employ 8 series-connected modules. Taking
          cognisance of the benefits of common module design, identical pack modules are assumed
          across both xEV platforms which is then extrapolated to impose a stronger condition of
          identical geometry for the constituent cells (see section 3.2.1). The exterior dimensions of the
          pouch cells under consideration are listed in table 3.2.

              Each module consists of 12 identical series-connected cells denoted by battery circuit
          symbols (cyan-filled blocks in fig. 3.3). The PHEV pack is smaller and consists of only 1/3rd of
          the cells in the BEV pack. Assuming that the BEV pack consists of a 96S-3P cell assembly,
          this implies that the PHEV pack shall conform to a 96S-1P layout. The DC bus voltage is
          unaltered since both packs have same amount of series cells. The power flow is assumed to be
          uniformly distributed across all the cells within the pack(s). At first, the power required at the
          terminals of the pack is computed. From this, a first-order design ball-parking of the layers

                                                                 69

                                                            3.3 Scope and Context within xEV Powertrain

          of the cell is made through a single cell simulation. This process enables reduced simulation
          run-time with the conditions of one cell assumed to be representative of all cells in the pack.

              While the aforementioned assumption of identical cell conditions across the pack
          seems infeasible at first glance, three careful considerations have been made to justify this
          assumption. Firstly, power (and not current) is used as the stimulus to the cell. This implies
          that, despite the parallel connection of cells (in groups of three cells within each module),
          each cell experiences the same power. Even across parallel-connected strings, the power
          handled by each cell shall be the same. This necessitates the modification of the standard DFN
          model in order to accommodate power inputs which is discussed in section 3.4.2. Secondly,
          although the current in all cells of a series string remain the same (by virtue of Kirchoff's
          current law), their terminal voltage levels could drift away from each other and becomes
          unbalanced over time [3]. This naturally raises questions on the assumption of identical
          conditions for all cells. However, this voltage unbalance is mitigated with the help of modern
          Battery Management Systems (BMSs) that employ balancing techniques such as passive
          bleeder resistors or sophisticated active dc/dc converters. Yet another adverse effect that
          poses a threat to the assumption of identical conditions is the uneven distribution of cell
          temperatures. In automotive packs employing natural convection, cells that are physically
          located innermost in the string tend to get hotter than the outermost cells. Through good
          thermal management design e.g. forced cooling through circulation of the coolant through
          conduits grooved into the pack, thermal balance may be achieved. Therefore, it can be argued
          that, when operating in a well-designed and controlled environment, cell-to-cell deviations
          are minimised. This justifies the global representation of all cells in the pack through a single-
          cell simulation, although modifications to the simulation model are deemed necessary to
          facilitate power inputs.

        3.3.3 Cell-level -- layers, cooling, electrochemical & thermal models

          The illustration at the centre of the bottom row in fig. 3.3 shows a schematic representation of
          a cell arranged within each module. In practice, the physical layout of cells within a module
          is slightly more complex. For instance, a typical arrangement consists of groups of 3 parallel
          cells. However, the illustration in fig. 3.3 suffices to explain the necessary details required for
          the specific task at hand.

                                                                 70

                                                            3.3 Scope and Context within xEV Powertrain

              Each cell in the pack consists of a number of identical layers . Each layer consists
          of -- i) a positive current-collector, ii) a positive electrode region, iii) a separator material,
          iv) a negative electrode region, and v) a negative current-collector. Particular attention is
          called out in regard to the distribution of temperature within the cell. In the schematic
          of fig. 3.3 the shading scheme is such that greener tints represent the hotter regions of
          the cell while bluer tints represent colder regions. Furthermore, heat exchange with the
          surroundings is also graphically illustrated through cooling plates mounted at the tabs of
          the cell. This highlights the specific type of cooling assumed viz. tab-cooling as opposed
          to conventional surface-cooling historically employed for automotive applications. The
          assumption of tab-cooling is an essential requirement for upholding the validity of the
          proposed layer optimisation scheme, and therefore warrants further justification.

              An experimental study by Hunt et al. [88] compared tab cooling of cells against
          conventional surface cooling. It was found that 8 % increase in the usable capacity of pristine
          cells was achieved with tab cooling relative to that achieved with surface cooling. Secondly,
          with surface cooling, the loss rate of usable capacity over thousand cycles was nearly thrice
          of that with tab cooling. This implies that using tab cooling can potentially help to extend the
          lifetime of the pack by three times. Thirdly, at higher discharge rates, surface cooling resulting
          in a loss of usable capacity of 9.2 % compared to just 1.2 % for tab cooling. The simulations
          discussed as part of the optimisation framework reported in section 3.5 are intended to
          obtain robust cell designs capable of handling worst-case power inputs. In these scenarios,
          tab cooling is more appropriate. Therefore, this author has no qualms about recommending
          this specific cooling mechanism to be used in conjunction with the results reported (see
          section 3.6) by applying the proposed layer optimisation scheme.

              Apart from its aforementioned beneficial effects on cell longevity and performance, with
          the integral assumption of tab cooling, there exists an important side effect that affects the
          very core of the numerics of the layer optimisation methodology. Carefully examining the
          shading scheme used for the schematic in the centre-bottom of fig. 3.3, it is clear that at
          any vertical co-ordinate in space within the cell, the shading across the entire cell width
          remains uniform throughout. This implies that each layer along a one-dimensional cross-
          section of the cell is at the same temperature. Based on the inferences from Hunt et al. [88],
          with tab cooling, only small thermal gradients are induced in the planar direction. In this

                                                                 71

                                                            3.3 Scope and Context within xEV Powertrain

          unique scenario, the thermal effects within the cell are not large enough to warrant a detailed
          numerical discretisation. On the other hand, ignoring the temperature distribution of the cell
          shall not lead to robust cell designs, especially given that design simulations typically involve
          high magnitudes of power.

              In situations akin to aforementioned circumstances, a lumped thermal model of the cell
          has been recommended by Pals and Newman [87]. This represents a good trade-off between
          accuracy and simplicity and hence, is deemed to be appropriate for this design application.
          A suitable value for the convective heat transfer coefficient  (see table 3.2), comparable
          to the typical magnitudes in forced air convection, is used to represent the heat transfer
          from the cell to the environment. The heat exchange area is the combined surface area
          of the two cooling tabs that are situated at either end of the cell. The temperature of the
          coolant (a thermal `sink' in thermodynamic terminology) is denoted by sink. In this work,
          this ambient temperature is held constant during the course of a simulation run, but is allowed
          to change to different constant values between set of simulations as per relevant vehicle
          testing standards. The details of this aspect is discussed in section 3.5. The material properties
          of the constituent components of each layer coupled with the total number of layers used
          determine the lumped mass and specific heat capacity of the pouch cell. These computations
          are discussed in sections 3.5.8 and 3.5.9 respectively. The assumption of tab cooling thus
          leads to this qualitative description of the lumped thermal model to be used for the design
          simulations. Further quantification by way of relevant model equations and the computation
          of the constituent parameters of the thermal model is embedded as an integral aspect of the
          layer optimisation framework and shall be presented in section 3.5.9.

              As a final observation, all layers within the cell are electrically in parallel which implies
          that their terminal voltages are identical. The current (or power) at the cell terminals is shared
          equally among each layer. The aforementioned considerations have important ramifications
          on the cell modelling and helps to drastically simplify it. Specifically, these considerations
          imply that the electrochemical performance of any one layer is identical to every other
          layer. Therefore, in conjunction with a lumped thermal model, a standard Pseudo Two-
          Dimensional (P2D) discretisation of the DFN model suffices to capture the electrochemical
          behaviour of the entire cell. The bottom-right illustration of fig. 3.3 presents a one-dimensional
          discretisation of the cell layer across its thickness. The spheres along the axial direction

                                                                 72

                                             3.4 Enhancements/Modifications to Standard DFN Model

          represent computational nodes wherein the solid-phase diffusion equation is to be solved
          (see section 1.3 for a brief overview). It is this standard DFN model, suitably amended to
          accept power inputs, that will be the backbone of the electrochemical aspects of the design
          simulation. The electrochemical model shall be strongly coupled in a bidirectional sense to the
          lumped thermal model i.e., the temperature of the cell shall influence various cell parameters
          (see table 3.2) while the overpotentials and currents in the cell shall play a role in the rate of
          heat generation and cell temperature simultaneously.

              Thus, through a systematic set of simplifying assumptions that are justifiable in a real-
          world design, the system-level requirements at the pack-level can be suitably scaled down to
          power-density inputs at the layer level. Having established the contextual setting and scope
          of this work within the broader landscape of drivetrain optimisation, it is now possible to
          proceed to the set of numerical enhancements required to be incorporated into the DFN
          model to handle the specific requirements of this layer optimisation task.

       3.4 Enhancements/Modifications to Standard DFN Model

        3.4.1 Augmentations to parameter set

          Cell capacity and electrochemically active surface area

          The P2D implementation of the standard DFN model lacks certain parameters that are vital to
          the layer optimisation process. The cell's nominal capacity is a fundamental quantity that gets
          altered as the number of layers is varied. However, it may be surprising to discover that this
          parameter is absent in present research literature discussing the P2D model. The rationale
          behind this glaring omission becomes clear upon closer examination of the model equations
          presented in table 1.1. These equations do not operate on a cell level, but instead are formulated
          on a normalised basis. To clarify, only one layer of the cell is being modelled wherein the
          stimulus driving the model is the applied current density per unit area rather than the total
          external current. The model to be used in the layer optimisation task therefore faces a unique
          predicament -- the need to adhere to the present modelling paradigm for compatibility with
          the status quo whilst being flexible enough to incorporate the cell's capacity as a function of
          number of layers.

                                                                 73

3.4 Enhancements/Modifications to Standard DFN Model

    To tackle the aforementioned quandary, it is key to realise that the core parameter that
varies with the number of layers in a pouch cell is the electrochemically active cross-sectional
surface area cell. Curiously, published literature on physics-based cell modelling do not place
rigorous emphasis on this key parameter. More often, much to this author's chagrin, this
parameter is simply listed in a standard table of parameters and is typically sourced from a
historic parameter-set without further explanation.

    For a pouch cell, the overall electrochemically active surface area can be defined as

cell =  × elec  (3.1)

where  is the number of layers and elec is the active surface area per layer.

Surface area per layer

A literature search reveals that akin to the cell's capacity, there is no information of cross-
sectional geometry in articles dealing with the P2D implementation of the DFN model. To
determine the surface area per layer, relying on certain assumptions and present literature, a
novel methodology is proposed involving a sequence of steps. The process involves selection
of a real-world cell, and determining its surface area per layer. To the best knowledge of the
author, this reverse parametrisation process (explained next), mapping from a real-world cell
to a new P2D parameter, is a unique idea.

          1) Selection of a suitable reference capacity cell
               This is a crucial first-step towards obtaining a complete parameter set -- particularly to

          determine the surface area per layer.
               The focus of this chapter is to provide a ready-to-use solution to industry that improves

          upon the present empirical designs through optimal layer configuration of pouch cells. There
          is a clear motivation to further increase cell capacities so as to maximise the AER, as laid out
          in the beginning of this chapter (see section 3.1).

               With this guiding principle, as a starting point towards choosing a reference capacity
          cell, a survey was performed to identify the production BEV with the highest driving range.
          As of 2018, the Chevrolet Bolt BEV bears this distinction with a range of 383 km as rated by
          the United States Environmental Protection Agency (EPA). The specifications of its battery

                                                                 74

                  3.4 Enhancements/Modifications to Standard DFN Model

pack is listed in Liu et al. [89]. The battery pack of this BEV consists of 288 cells arranged
in a 96S-3P configuration, in agreement with the configuration discussed in the drivetrain
hierarchy of section 3.3.2.

     The Chevrolet Bolt BEV pack has an energy capacity of 60.0 kWh with a nominal pack
voltage of 350 V [89]. However, for this specific task, the Ah capacity is required. This can be
obtained as

Ah capacity of reference cell =                     Pack Energy (Wh)                          (3.2)

                                   Nominal pack voltage (V) × No. of cells in parallel

                             =     60000                                                      (3.3)

                                   350 × 3

                             = 57.14 Ah                                                       (3.4)

 · DC bus voltage and revised cell capacity
     Even without a dc/dc boost converter, robust design of the powertrain during brown-

outs should allow for continued operation even with a slightly diminished DC bus voltage
4­5 % lower than nominal [28]. Considering a maximum permissible dip of 4 % in the bus
voltage i.e., 336 V, the cell's capacity may be refined as

Ah  capacity  of  reference  cell  =  Lowest  pack    Pack Energy (Wh)          in  parallel  (3.5)
                                                    voltage (V) × No. of cells

                                      60000
                                   = 336 × 3                                                  (3.6)

                                   = 59.52 Ah                                                 (3.7)

The reference cell's Ah capacity is therefore rounded to 60 Ah¶.

 · Lower cutoff voltage for cells
     In this layer optimisation work, following the assumptions of section 3.2.1, the overall

pack configuration remains unchanged i.e., independent of number of layers within the
pouch. This implies that the undervoltage threshold for DC bus voltage throughout this
work shall remain fixed at 336 V. Therefore, with 96 series connected cells in a string, the

                 ¶In the interest of maintaining consistency, this computed capacity is retained for the cell used in chapters 5
            and 6 of this thesis. This also explains the use of 60 A for the simulations used for demonstrating energy/power
            trade-off of section 3.2.3 since this current level corresponds to the 1C-rate of this reference cell.

                                                                 75

3.4 Enhancements/Modifications to Standard DFN Model

lower cut-off voltage for an individual cell is 3.5 V. This value is reported in table 3.2 and
is used as a termination condition for all simulations as explained in section 3.5.

2) Computation of electrochemically overall active surface area for reference cell

     For the cell properties in tables 3.2 and 5.2, the majority of parameters are sourced from
Subramanian et al. [90] and Northrop et al. [72]. In Northrop et al. [72], the current density that
corresponds to a 1C-rate discharge of a cell with this parameter set is reported to be 30 A m-2.
With the help of carefully designed numerical simulations (very slow discharge with a trickle
current from fully charged state until charge depletion), this value is refined to 29.23 A m-2.

     The task of determining the electrochemically active overall surface area of the reference
cell is now straightforward, and is obtained as

                                                             Cell capacity (Ah)   (3.8)
Overall surface area of reference cell, refcell = 1C-rate density (A m-2)         (3.9)
                                                                                 (3.10)
=   60
   29.23

= 2.053 m2

This value is listed in table 5.2 for use in chapters 5­6, but is not used directly in this layer
optimisation work. This is because, as the number of layers change, the overall surface area
changes as per eq. (3.1). However, determining this value is an important initial step in the
determination of the surface area per layer.

3) Setting the pouch height for the reference cell

     Although the official press release [91] from the manufacturer of the Bolt BEV does
contain data on the cross-sectional geometry of the cell, it does not report the cell's height.
Hence, this information needs to be assumed by extrapolation from an alternate source
wherein the conditions are similar and so that value may be applied for the reference cell.

     The review article by Gröger et al. [92] discusses the state of the art in energy densities of
electrode materials used in various lithium ion chemistries. At the time of its publication, the
areal capacity of cells were 2.0 mAh cm-2. These authors recommended an areal capacity
target of 4.0 mAh cm-2 for future automotive applications. The said publication also considers
the aspect of stacking layers into pouches of certain geometries. In particular, table IV of

                                                                 76

3.4 Enhancements/Modifications to Standard DFN Model

Gröger et al. [92] considers a pouch of 10 mm height, for which the aforementioned areal
capacities were calculated.

     In the case of the reference cell under consideration, the areal capacity is

Areal capacity of reference cell  =  60 000 mAh  = 2.92 mAh cm-2  (3.11)
                                     20 527 cm2

which is close to the desired value in automotive applications as per the recommendations in
Gröger et al.. Considering that the reference cell is based on the high energy density Chevrolet
Bolt BEV cell, a pouch height of 10 mm is justifiable for this task and is reported in table 3.2.
As per the assumptions discussed in section 3.2.1, this value is held constant throughout the
layer optimisation process.

4) Computation of stack thickness of reference cell

     In a pouch of given height, the available space to accommodate layers therein is restricted
by a number of factors. For instance, the wiring from the current collectors to the tabs,
protective elements such as fuses etc. consume physical space. Furthermore, the pouch
material itself has a finite thickness and hence after accounting for this, the stack thickness
available for layer placement is lower than the pouch thickness.

Stack thickness, stack = Pouch height - 2 × pouch thickness       (3.12)
                           = pouch - 2pouch                       (3.13)
                           = 10.0 - 2 × (160 × 10-3)              (3.14)
                                                                  (3.15)
                    stack = 9.68 mm

The computed value of stack thickness is held constant for all layer choices trialled in the
entire layer optimisation process.

5) Determination of number of layers within reference cell
     The next step is to determine the number of layers within the reference pouch cell refcell.

The thickness of a complete electrochemical sandwich multiplied by the number of layers
yields the total stack height

refcell (Al + pos + sep + neg + Cu) = stack                       (3.16)

                                                                 77

3.4 Enhancements/Modifications to Standard DFN Model

     The product of number of layers and the thickness of an electrochemical sandwich cannot
exceed the overall stack height. This implies that the equality in eq. (3.16) is to be changed
to an inequality, with the upper bound of the expression on the Left-Hand Side (LHS) of
eq. (3.16) set to the stack height.

refcell (Al + pos + sep + neg + Cu)  stack                                           (3.17)
                                                                                     (3.18)
                      refcell       Al    +  pos                 stack   neg  +  Cu
                                                                + sep +

     Since fractional layers do not have any physical meaning, the number of layers that
can be accommodated within any pouch must be an integer quantity. Therefore, refcell is
computed as the `floor' of the quantity in the Right-Hand Side (RHS) of eq. (3.18)

refcell  =                  stack                                                    (3.19)
                           + sep +                                                   (3.20)
              Al   +  pos           neg      +  Cu                                   (3.21)

         =    (15  +  72  +  25  9.68  +  10)   ×               10-3
                                 + 88


refcell = 46

The reference cell is thus determined to consist of 46 layers.

6) Computation of surface area per layer

     Substituting the values of refcell and refcell into eq. (3.1), the electrochemically active
surface area per layer is obtained as

              elec    =    refcell                                                   (3.22)
                           refcell                                                   (3.23)
                                                                                     (3.24)
                        2.053 m2
                      =

                            46

                      = 44.63 mm2

     The surface area per layer thus computed is listed in table 3.2 and is held constant across
all layer choices tried during the layer optimisation process. This assumption is immediately
justifiable from a physical viewpoint, since the process of assembling layers is performed

                                                                 78

                                   3.4 Enhancements/Modifications to Standard DFN Model

along the axial thickness direction (aligned with pouch height) and is independent of the
planar (cross-sectional) direction.

3.4.2 Modification of standard DFN model to handle power inputs

As discussed in section 3.3.2, assuming identical cell conditions during operation necessitates
that the external stimulus to each cell is an applied power value. The cell's terminal voltage
and current can be viewed as its natural response to this power input. To simulate this
condition and achieve a model-based optimal layer design, the standard DFN model, which
conventionally handles current stimuli, has to be suitably modified to accept power inputs.

Plett [13] suggests a methodology for applying power inputs to equivalent circuit models

for simulation at a fixed sample rate. This involves converting the input power  to a

current  using an equivalent series resistance 0. The value of 0 is updated at each time

index  as per eq. (3.25).

                                  -  2 -   40
                                       20
                             =                 (3.25)

where  is the cell's terminal voltage at time index , evolved from the applied current up
to and including the ( - 1)th time step.

    There are two disadvantages in using Plett's simplified approach for the proposed layer
optimisation study. Firstly, this necessitates the quantification of a lumped electrical resistance
for a Physics-Based Model (PBM). Such an idea is at loggerheads with the fundamental
philosophy of PBMs which strive to represent a detailed picture of underlying phenomena, as
opposed to the system-level terminal behavioural characterisation facilitated by Equivalent
Circuit Models (ECMs). Translating power to current in this manner also necessitates a two-
pass conversion between the physical and electrical domains -- a process likely to significantly
degrade modelling fidelity. Since the results from application of the model shall inform the
number of layers to be used in a real-world cell design, such loss of fidelity is unacceptable.
Secondly, the constraint of using fixed interval updates implies that a high-speed adaptive
time-stepping solver cannot be used for handling this power input condition. This shall slow
down the simulation speed considerably since the search space of layer combinations to be
considered is fairly large. Furthermore, the simulations have to be repeated over multiple
combinations of initial and ambient temperatures which shall significantly slow down the

                                                                 79

        3.4 Enhancements/Modifications to Standard DFN Model

model-based design simulations and offset its advantages over a conventional prototype-
based design.

    Dees et al. [93] identified the requirement of having a P2D model that can run on applied
power. However, in the aforementioned work, the relevant equations for reformulation of
solid-phase boundary conditions are not presented. An independent derivation of reformu-
lating the P2D model to facilitate an innate power input capability is therefore provided.
Since the equations are derived for a single layer, the power density, obtained by dividing the
applied power by the overall active cross-sectional area cell, is used as the driving input.

    In the P2D model, charge conservation in solid phase is given by eq. (1.6), which is revisited
below. The subsequent two equations pertain to the corresponding boundary conditions. In
these equations, the current density  represents the applied input.

        (eff     s ( ,   )       =        s (,   )                                  (eq. (1.6) revisited)
                          )                                                                        (3.26)
                                                                                                   (3.27)
eff      s ( ,       )  ||| pos/Alc=c     -

                        neg/Cucc

eff      s ( ,       )  |||pos/sep=       0

                        neg/sep

    Equation (3.28) replaces the boundary condition in eq. (3.26) to use the applied power
density  to drive the model.

effneg  (s ( ,   )   s ( ,   )         |  -  effpos  (s ( ,   )   s ( ,   )   |  =           (3.28)
                              )        |                                   )  |
                                       |                                      |
                                         =neg/Cucc                                =pos/Alcc

    Eqs. (3.29)­(3.30) represent the constraints pertaining to physical laws and are to be
satisfied.

                                  -  = 0                                                     (3.29)
                                       > 0                                                   (3.30)

                                                                 80

                                   3.4 Enhancements/Modifications to Standard DFN Model

Equation (3.29) conveys the condition that the product of the terminal voltage and com-
puted current density shall equal the externally applied power density, whereas eq. (3.30)
implies that the cell's terminal voltage shall always remain positive during operation.
Eqs. (3.28)­(3.30) are then discretised for numerical implementation as follows.

    Figure 3.4 describes a schematic overview of a one-dimensional cell-centred Finite Volume
(FV) discretisation scheme. Here, evenly spaced nodes are considered to form the support
mesh along the through-thickness dimension of a layer. Vertical lines denote the edges
of control volumes whereas the filled circles depict computational nodes where the axial-
direction variables from table 1.1 are solved.

Figure 3.4 Simplified illustration of a standard cell-centred FV discretisation scheme. Illustra-
tion reproduced from Torchio et al. [94].

Equation (3.31) represents the weak form of eq. (1.6) applied on the FV mesh for each

control  volume,  wherein  subscripts    and    ±  1  denote  the  th  FV  node  and  its  associated  left
                                                   2

and right edges respectively.

                               eff  s(, )       |+    1  =  s ()                           (3.31)
                                                      2

                                                |
                                                |
                                                   -  1
                                                      2

    At this juncture, a simplifying approximation for the solid-phase potentials can be
considered. In the standard FV scheme, the solution values at the faces (edges of control
volumes) is obtained by interpolating from the two nearest FV node values. At either extrema
of this one-dimensional computational domain, a linear extrapolation of the values from the
first and last nodes can be performed. This increases the accuracy of computations, thereby
providing good estimates of solid potentials at the two current collector interfaces. However,

                                                                 81

                                   3.4 Enhancements/Modifications to Standard DFN Model

with the increased fidelity comes the penalty of a mathematically complex set of boundary

conditions. When using high node densities in the negative and positive electrode regions

(see  table  3.2),  for  the  two  outermost   control  volumes,    the  values  of     become  small.  With
                                                                                     2

a reasonably small mesh interval, the potentials at the cell centres can be considered to be

nearly equal to that at their corresponding current collector interfaces. This assumption helps

to keep the resulting mathematical expressions tractable.

    Applying eq. (3.31) to the first control volume (0th node) in the positive electrode and to
the last control volume (nth node) in the negative electrode,

                                   -effpos s0  +  effpos s1  +   =  spos  0pos                          (3.32)
                                     pos           pos                                                  (3.33)

                              -effneg s  +     effneg s-1    -   =  sneg  neg
                                neg              neg

Multiplying eq. (3.32) by s0 and eq. (3.33) by s and subtracting,

-effpos s20 - effneg s2 + effpos s0 s1 + effneg s s-1
      pos           neg            pos                  neg

                                                  +  - spos  0poss0 - sneg  negs = 0 (3.34)

    Two solutions exist for the quadratic equation in eq. (3.34). However, the solid phase
potential, being a physical quantity of the cell, has a unique solution. Therefore, in order
to achieve numerical convergence, an additional positivity constraint, the FV-discretised
equivalent of eq. (3.30), is imposed.

                                                  s0 - s > 0                                            (3.35)

Finally, since the input to the model is the applied power density , the current density within
each layer , needs to be solved for. This is facilitated by employing the discretised form of
eq. (3.29). Furthermore, since this equation is mathematically simple, the aforementioned
assumption of using node values at current collector interfaces is no longer required. Applying
a linear extrapolation scheme at the outermost control volumes, the algebraic residual

                                                                 82

                                3.4 Enhancements/Modifications to Standard DFN Model

equation is obtained as

                                                                                                       (3.36)
                          0 =  -

                                  1.5s0 - 0.5s1 + 0.5s-1 - 1.5s-1

The computer code used (LIONSIMBA v2.0, to be discussed in section 3.6.1) employs the
Differential Algebraic Equation (DAE) solver IDA [95] to handle such algebraic constraints.

    Eqs. (3.34)­(3.36) therefore represents the discretised form of the reformulated boundary
condition and associated algebraic constraints for the solid phase potential Partial Differential
Equation (PDE) that can be applied to either electrode to facilitate the use of an input power
density to the P2D model.

3.4.3 Hybrid spectral-FV scheme

Fast and accurate estimation of the solid phase lithium concentration, particularly its value
at the surface of electrode particles is an inherent requirement of the layer optimisation
procedure presented in section 3.5. The high power densities to be handled, particularly
at low layer counts necessitate this requirement. It has been acknowledged that solid-
phase concentration calculations employing polynomial approximations lack fidelity at high
charge/discharge rates [96]. Hence, a conventional full-order solution based on Fick's law of
diffusion is required for this layer optimisation task.

With full-order solid phase diffusion dynamics, applying the FV scheme (that has been

employed in LIONSIMBA v1.0x (see section 3.6.1 for a discussion of this modelling platform)

to discretise all through-thickness PDEs of the P2D model) results in a very large system

of equations. This is due to the requirement of using a high radial node density per

spherical particle for improved accuracy. Consequently, the computational cost is high and

simulation run-time becomes prohibitive when exploring the search space of all possible

layer configurations. Moreover, with a cell-centered FV discretisation, it is non-trivial to

directly apply the ionic flux boundary condition at the particle surface, since this involves

extrapolation from at least two other nodes within the particle. While such extrapolations

are acceptable in the axial dimension -- particularly with high node densities providing

small  values  of     --  they  are  undesirable  in  the  radial  dimension.  This  is  because  the  cell's
                   2

Open Circuit Potential (OCP) and terminal voltage strongly depends on the concentration

                                                                 83

         3.4 Enhancements/Modifications to Standard DFN Model

at the particle surface. Spectral methods offer a combination of high accuracy and speed
while permitting the use of a lower number of radial discretisation nodes. To implement a
spectral scheme on a non-periodic domain, a Chebyshev discretisation [68] may be applied.
Bizeray et al. [74] discretised all of the P2D model equations using this approach. However,
this entails a bi-directional mapping of all field variables between the physical and Chebyshev
domains, incurring computational overhead.

    For the proposed layer optimisation simulations, a hybrid formulation of the P2D model
is proposed wherein a standard FV scheme in the axial dimension and a spectral scheme in
the radial domain are used. Exploiting this natural separation of the axial and radial domains
enables to -- i) retain the ability to easily couple the molar flux density at the particle surface
through reformulation of the boundary conditions of the solid diffusion PDE, and ii) solve for
solid-phase lithium concentration in the Chebyshev domain and locally transform to physical
domain, without requiring system-wide Chebyshev reformulations. Although the proposed
implementation does not globally employ a spectral scheme, the combined beneficial effects
of radial-domain spectral scheme and automatic differentiation of system equations using
CasADi [97] facilitate rapid simulations, enabling the completion of the layer optimisation in
a short duration. Eqs. (3.37)­(3.40) detail the steps leading up to the reformulated solid phase
diffusion and its associated boundary conditions in the Chebyshev domain.

    The r Chebyshev collocation nodes, defined on a 1D mesh in the radial direction, are
given by eq. (3.37) (see [68]).

                              = 0, 1, ... r   [-1, 1]              (3.37)
 = cos ( ) ,

          r

Assuming constant diffusivity, expanding the derivative in the standard form of the Fickian

spherical diffusion equation (see eq. (1.3)) for each particle, we obtain eq. (3.38), presented

along with its Neumann boundary conditions, eqs. (3.38a) and (3.38b).  is the molar flux

density (mol m-2 s-1) and p is the particle radius (m).

         s     =  seff  (    s  +  2s   )                  [0, p]  (3.38)
                                     2

      (  s  )= 0                                                   (3.38a)
                                                                   (3.38b)
             =0

seff  (  s  )  = -

               =p

                                                                 84

                                                           3.5 Computational Framework

Mapping   [0, p]    [-1, 1],                                         (3.39)
                                            = p ( + 1)
                                                 2

    Applying eq. (3.39) to eqs. (3.38)­(3.38b) whilst retaining s in the physical space yields
eqs. (3.40)­(3.40b).

            s  =4    seff      2                        s  +  2s  )   (3.40)
                     p2    ( + 1                              2      (3.40a)
                                                                     (3.40b)
         (  s  )= 0

               =-1

2  seff  (  s  )= -
   p
               =1

    During the iterative solution process, the spatial gradients of solid phase lithium concen-
tration in eq. (3.40) in this case are not computed through an explicit differentiation procedure
as usual, but instead evaluated by pre-multiplying the concentration values at the collocation
nodes by a Chebyshev differentiation matrix. This particular aspect is responsible for the
inherent reduction of simulation run-time achieved by introducing a spectral method. In the
updated version of LIONSIMBA v2.0 (created specifically for this layer optimisation work;
see section 3.6.1 for a brief overview of the modelling platform), differentiation matrices
of suitable dimensions as well as the Chebyshev collocation nodes are generated using the
MATLAB function cheb.m distributed along with the book by Trefethen [68].

       3.5 Computational Framework

        3.5.1 Introduction and guidelines for flow diagram traversal

          The methodology adopted by the proposed layer optimisation framework can be explained
          by using the flow diagram in fig. 3.5. The power handled by the cell during normal operation
          (evaluated by considering various drivecycles) is much lower than that experienced during
          acceleration (discharge) and fast-charging (charge) scenarios. Section 3.6 provides a brief
          summary of the peak and median powers across all standard drivecycles. Therefore, from a
          design perspective, it is sufficient to consider the power requirements for these two extreme

                                                                 85

                                                                                 3.5 Computational Framework

          cases. Hence, the schematic in fig. 3.5 can be studied by broadly dividing the flow diagram
          into two parts -- i) an acceleration pathway (primarily consisting of blocks shaded in grey),
          and ii) a fast-charging pathway (predominantly composed of blocks shaded in cyan).

              As indicated by the legend in fig. 3.5, blocks with a light grey border represent input data/-
          parameters for computations. Blocks with a standard black border represent computations
          common to both acceleration and fast charging pathways. The design output is given by the
          double-bordered block at the bottom centre of fig. 3.5. Other types of blocks and arrows are
          appropriately listed in the legend key. To aid the understanding of the layer optimisation
          framework, the reader is encouraged to correlate the narrative in this section with the blocks
          and arrows in the schematic. The acceleration and fast charging pathways are not amenable
          for standalone comprehension and are to be parsed in conjunction with the flow of control
          through the infrastructure blocks as if the entire flow diagram is a single cohesive unit. These
          `control' blocks, common to both pathways in fig. 3.5, govern how these two pathways are to
          be traversed with the presently trialled layer choice and quantify the suitable reformulations
          needed whenever a new layer choice is to be used. The computational aspects covered by
          these blocks are described in sections 3.5.4­3.5.9.

        3.5.2 Acceleration pathway

          The computations for acceleration-based layer optimisation begins at the anchor block
          labelled `Start Acc. Calcs.'.

          Determination of acceleration rate, final speed and acceleration time

          The first step is to determine the rate of acceleration to be used for computing the power
          requirements for accelerating an xEV from standstill. For various other regulatory reasons,
          vehicular standards for electrified transport are codified by various standardisation bodies
          (e.g. the SAE J1772 standard [98]). The standards published by these regulatory agencies
          typically specify a minimum required acceleration rate for the vehicle under consideration
          to be certified as an electric vehicle. Additionally, vehicle manufacturers often provide their
          own specifications, which typically exceed these minimum standards. However, for certain
          classes of electric vehicles such as golf carts, the manufacturer-specified standards might fall

                                                                 86

                                        Figure 3.5 Flow diagram depicting an overview of the proposed layer optimisation methodology                                           "Konstanzmasterflowdiagramthesismod" -- 2018/9/21 -- 20:14 -- page 1 -- #1
                                     for Li-ion pouch cells.
                                                                                                                                                           Key                                                                                Cell                                                                    P  fastchg            Pcfealsltchg                Sim. params
                           This figure was created by Krishnakumar Gopalakrishnan who asserts copyright, with intellectual            Input Data/Parameters                                                                               Parameters                                                                     batt                                          for fast charge
                       contributions from and the right to use asserted by Ian D. Campbell.
                                                                                                                                      Standard Computations                                     Start Acc. Calcs.                                                                                        Start Fast-                    1                            pfastchg
           87                                                                                                                                                                                                                                                                                          Charge Calcs.                ncells
                                                                                                                                      Fast Charge Computations                                                                                                                                                                                            ÷
                                                                                                                                                                                                astd. >aman. ?                                                                                                                                                          P2D Simulation
                                                                                                                                      Calcs. producing updated sim.                                                                                                                                                                                                       (fast charge)
                                                                                                                                      params. for given layer                                                                                vbase                                                                                          Acell
                                                                                                                                                                                                                                                                                                                                                                   results(t  tmax )
                                                                                                                                      Subset of cell params. that in-          Cell Parameters  tfman.                                tf     Compute vf                                          vfman.
                                                                                                                                      fluence layer calculations                                tfstd.                                                                                           vfstd.
                                                                                                                                                                                                                                             Pmass
                                                                                                                                      Design Output
                                                                                                                                      (optimal layer choice)                                                                                 ,Cd ,Av

                                                                                                                                      Start of Acc/Fast Chg Pathways                                                                         Compute                                                  Mc                                                       no
                                                                                                                                                                                                                                               Pdrag                                                  Mp                                                                 T (t) < Tmax?
                                                                                                                                                            Composite Signal                                                                                                                                                                                                     yes
                                                                                                                                                         Layer Iteration n(i)                                                                       Cr                                                Mo
                                                                                                                                                        Updated sim param.                                                                                                                                                                                     no
                                                                                                                                                                                                                                             Compute                                             Mcells                                                                  V (t) < Vmax?
                                                                                                                                       Sim. params.                            Pcaeclcl         1       Pbaactct    1  Pw                       Proll            Mv                                    ncells
                                                                                                                                      for acceleration
                                                                                                                                                                                                                                             Zg                                                                                                                                                   3.5 Computational Framework
                                                                                                                                                        tf                                      ncells             dt
                                                                                                                                                                                                                                             Compute                                                                                                                                     advance simulation further in time
                                                                                                                                                                 ÷             Acell                                                           Pgrade

                                                                                                                                      Thermally Coupled pacc
                                                                                                                                        P2D Simulation
                                                                                                                                           (discharge)

                                                                                                                                                       results(tf )                                                                                                                                                                                                       yes

                                                                                                                                                           no                                                                                                                                    mcell                         Compute cavg
                                                                                                                                      T (tf ) < Tmax?
                                                                                                                                                                                                                                                                                                                                       cAl , cpos , cneg
                                                                                                                                                                                                              ×                                                                                                                        c , c , c sep Cu LiPF6
                                                                                                                                               yes                                                                                                                                                                                                                 no     cs < cssat

                                                                                                                                                                              nmin = 1                                                                  Aelec                                         Compute:                       fipos , fineg
                                                                                                                                                                                                                                                                                                                                    Lpouch, Wpouch
                                                                                                                                                                                                                                                                                                      mAl , mpos , mneg

                                                                                                                                                                                                                                                                                                      m , m , m sep
                                                                                                                                                                                                                                                                                                               Cu        LiPF6

                                                                                                                                                                                                                                                                                                                                                                          yes

                                                                                                                                                        no Bisect Customised Binary                                    Search  use new n(i)         Compute:                                     lAl                           pos                             no                        yes
                                                                                                                                                              Upwards Search Algorithm                                                               lneg, lpos
                                                                                                                                      V (tf ) > Vmin?                                                                  Converged? no                                                             lsep                          neg                                        t < tmax?

                                                                                                                                                                                                                                                                                                 lCu

                                                                                                                                                                                                              yesBisect                                                                  Lstack                 Al, pos, neg
                                                                                                                                      yes                                      Downwards                                                                                                                       sep, Cu, pouch

                                                                                                                                                                                                                                                                                         Compute nmax                          Compute lratio

                                                                                                                                                            yes                    Store                                                                                                                                                                       yes
                                                                                                                                      z(tf ) > zmin?                           nfeas = n(i)                                                                                                                                                                                z(t)  z?

                                                                                                                                               no                              noapcct(Ti(nki)t, Ts(ikn)k) = nfeas                           nopt = max(naopcct, nfoapsttchg),                          nofapsttchg(Ti(nki)t, Ts(ikn)k) = nfeas                    exit

                                                                                                                                                                                                                                                                           Tinit, Tsink                                                                        condn.= 2  no
                                                       3.5 Computational Framework

below that of a roadworthy electric vehicle. This thesis advocates a conservative design by
choosing the higher of the two values.

    The acceleration rate is calculated by dividing a pre-determined final speed f by the
time f taken to attain that speed from standstill. The manufacturer-specified acceleration
rate man. is compared against the minimum acceleration rate specified by the governing
vehicular standards std.. The two Single Pole Double Throw (SPDT) switches assign the final
speed f and acceleration time f using the corresponding values from the appropriate source
depending on which of the two acceleration rates is higher.

Computation of acceleration power at the wheels

The next step is to calculate the acceleration power required at the driving wheels w. Using
the governing equations from basic vehicle dynamics [28], the power at the wheels of an xEV

is given by eq. (3.41).

                         w = mass + drag + roll + grade   (3.41)
                                                         (3.41a)
                         mass  =  1  v()  (b2  +  f2)    (3.41b)
                                  2    a

                         drag  =  1  (airdvf3)
                                  2

                         roll = rv() f                   (3.41c)

                         grade = v()  f                  (3.41d)

              The individual components contributing to the summation for wheel-power computation
          presented in eq. (3.41) is briefly explained. mass represents the power required to accelerate
          the vehicle's mass. drag and roll denote the powers required to overcome air resistance and
          rolling resistance respectively. Finally, grade represents the power required to negotiate a road
          gradient. Except for v() which is described next, all terms in the RHS of eqs. (3.41a)­(3.41d)
          are constants. The nomenclature for each of these terms is explained in tables 3.3 and 3.4
          along with their numerical values used in simulation.

          Computation of layer-dependent vehicle mass

          Changing the layer count used within a cell changes its mass. This in-turn affects the mass of
          the pack, which further influences the overall vehicle mass. Hence, for precise computation

                                                                 88

                 3.5 Computational Framework

of mass in eq. (3.41a), the vehicle's mass is computed as a function of number of layers within
each cell .

    In the schematic of fig. 3.5, this layer-dependent calculation of mass of all cells in the
pack cells is shown by the product of the signal labelled cell and the triangular gain block
representing the overall number of cells in the pack cells.

cells =  × cell  (3.42)

              The mass of the vehicle is given by the sum of chassis mass c, vehicle payload p, pack
          overhead o and the layer-dependent mass of all cells in the pack cells as computed in
          eq. (3.42). The computation of mass of a single cell cell is detailed in section 3.5.8.

          Computation of acceleration power density per layer

          Since the P2D equations of the DFN model are based upon a normalised unit area and is
          applicable only to each electrochemical layer, the goal is to compute the power density
          experienced by each layer. This is arrived at by a sequence of simple scaling steps.

              Firstly, the power demanded at the pack terminals baactct is computed by dividing the power
          at the wheels by the efficiency of the drivetrain. As explained in section 3.2.1, the drivetrain
          consists of a number of components, the efficiencies of which depend on the operating point
          (such as the speed and torque of the electric motor, current drawn by the power electronics
          etc.). Following the assumptions detailed in section 3.2.1, a single lumped efficiency dt can
          be used for the powertrain. The power demand on the pack is then divided by the number
          of cells in the pack cells to obtain the power demand at the input of the cell's terminals caeclcl.
          For each layer choice , the overall electrochemically active surface area is computed using
          by using eq. (3.1), wherein the surface area per layer elec listed in table 3.2 is held constant
          throughout. Finally, the acceleration power density per layer acc is computed by dividing
          caeclcl by the overall surface area cell.

          Thermally-coupled P2D simulation and exit conditions

          For the presently trialled layer choice , a thermally-coupled P2D simulation is performed
          for a duration of f seconds with the applied power density caeclcl corresponding to the present

                                                                 89

                                                                                 3.5 Computational Framework

          layer choice as input to the model. When the simulation terminates, the cell's condition is
          compared against three criteria

              1. the maximum possible values of cell temperature max,

              2. the minimum allowed terminal voltage min, and

              3. the lowest allowed cell SOC min.

          This helps to determine whether the cell constructed from the present layer choice is able
          to successfully satisfy the acceleration power demands. These comparison operations are
          represented by decision blocks placed in the leftmost region of the schematic in fig. 3.5.

              If any one of the three aforementioned exit checks fail, the present layer configuration is
          deemed to be not feasible and the entire workflow is repeated by trialling a new layer choice.
          A sophisticated search algorithm, to be described in section 3.5.4, is employed to minimise the
          number of iterations needed until a successful layer choice oacpct is obtained. The above process
          is repeated for different combinations of initial and ambient temperatures (init, sink). The
          largest successful layer value from all temperature combinations is deemed as the canonical
          optimal design choice when considering acceleration demands. This concludes the narrative
          describing the acceleration-specific pathway.

        3.5.3 Fast-charging pathway

          The workflow describing the optimal layer calculation for the fast charging scenario begins
          with the anchor block labelled `Start Fast-Charge Calcs.' in fig. 3.5. The charging algorithm
          used in this framework is based upon the model-based strategy proposed by Choe et al. [99],
          wherein the surface concentration is never allowed to exceed its saturation value. Adopting
          this charging scheme leads to a robust cell design that is resilient to lithium plating. A major
          departure from the scheme in Choe et al. [99] is the fact that the constant current phase used
          therein is replaced by a constant power phase. This is so that the assumption of identical
          conditions across all cells in the pack holds true (see section 3.2.1 for details). Furthermore, the
          pulsing phase used to top-up the cell's SOC in Choe et al. [99] is omitted. This is because, the
          level 3 fast charging specifications typically require charging to a target SOC that is typically
          well below 100 % (see table 3.2).

                                                                 90

                                                                                 3.5 Computational Framework

              At first, the charging power applied at the pack's terminals bfaastttchg is scaled down by the
          overall number of cells in the pack. This results in the charging power experienced by each
          cell in the pack cfealsltchg. Following the strategy used in section 3.5.2, the power at the cell's
          terminals is scaled down by the electrochemically active overall surface area cell. This yields
          the power density fastchg experienced by each layer in the cell and is now amenable to be
          applied to the normalised P2D equations of the DFN model (that has been suitably modified
          to handle power inputs).

          Thermally-coupled fast-charging simulations and exit conditions

          After computing the power density per layer, the thermally-coupled P2D model is then
          invoked. While the simulation runs, the cell's state is continually evaluated against various
          termination criteria.

              1. the maximum possible values of cell temperature max,

              2. the maximum allowed terminal voltage max, and
              3. the surface concentration s not to exceed the saturation concentration s,sat

              If any of these three criteria are violated, the simulation immediately stops and the
          trialled layer choice is deemed to not satisfy the fast charging power requirements. The
          search algorithm then updates the layer choice suitably and the entire workflow is repeated.

              If the simulation for any layer choice passes the aforementioned termination criteria,
          the SOC achieved by the cell is compared against the fast-charging target . If () > ,
          then the present layer choice represents the minimum (and therefore optimum) value for
          this specific fast charging application. The successful layer choice is labelled ofapsttchg. If
          the surface concentration has not yet reached the saturation limit, then the charge time is
          compared against the upper bound for fast charging specifications max. If this preset duration
          has not been reached, then the simulation is allowed to advance further in time, with the
          aforementioned termination criteria being continuously tested at each subsequent time-step.

              The above process is repeated for different combinations of initial and ambient temper-
          atures (init, sink). The largest successful layer value from all temperature combinations is

                                                                 91

                                                                                 3.5 Computational Framework

          deemed as the canonical optimal design choice when considering the fast charging power
          demands. This concludes the narrative describing the fast charging pathway.

              Finally, the maximum of the layer choices across all temperature combinations from the
          acceleration and fast charging scenarios is deemed as the globally optimal number of layers
          to be used for this model-led cell design. This concludes the overall narrative describing
          the layer optimisation framework. The results obtained by applying this methodology to a
          specific numerical example is presented next in section 3.6.

        3.5.4 Search algorithm

          A customised binary search algorithm is designed for the layer optimisation framework. Bin-
          ary search is a computationally efficient search algorithm requiring a worst-case operational
          count of (log ) where  is the overall number of layer candidates to be searched [100].
          However, this algorithm is applicable only when the array to be searched is already sorted in
          either ascending or descending order. By recognising the relationship between the magnitude
          of power density applied versus the factors that deem a layer suitable or unsuitable for the
          application, a customised set of `exit conditions' that meet the aforementioned sorted-array
          requirement can be enforced. This specific mapping is a unique idea and is claimed as a
          contribution by this thesis author to the art.

              This search strategy is equally applicable (with small modifications to exit conditions as
          explained next) for both acceleration and fast charging pathways.

          Binary search for acceleration pathway

          If all the termination criteria are successfully met, the exit condition is set to a value of 1. If
          any of these conditions fail, then the exit condition is assigned a value of 0. Thus, the search
          vector in this bespoke strategy consists of only two Boolean possibilities. For ultra-low layer
          counts, the applied power densities are extremely high. Therefore, one of the exit conditions
          is likely to fail. For very high layer counts, the power densities are very low, implying that
          acceleration runs shall always be successful. When considering layer counts from the lowest
          to the highest, there exists a critical transition point viz. the first layer count for which the
          exit vector toggles from 0 to 1. Through a systematic bisection of the layer search space, the
          search algorithm speedily converges to the optimal layer value.

                                                                 92

                                                                                 3.5 Computational Framework

          Binary search for fast-charging pathway

          If all the fast-charging termination criteria are successfully met, the exit condition is set to
          a value of 1. For violating any of the following three failure conditions (see section 3.5.3)
          viz. exceeding a) upper cutoff temperature and/or, b) upper cutoff voltage and/or c) the
          maximum allowed charging despite encountering surface saturation, the exit condition is
          assigned the value of 0. The search array is bisected by using this failed layer choice as the
          new lower bound. If no termination criterion is violated, then the presently trialled layer
          choice is deemed a success and the exit condition is set to 1. The search space is narrowed
          down by using the current layer choice as the new upper bound.

              However, there exists an additional third possibility for the fast charging case. If the
          aforementioned termination criteria are not violated, but the charging process fails to meet the
          target SOC specification, this implies that the number of layers used is too high (see fig. 3.10
          and section 3.6 for a brief explanation of this case). The exit condition corresponding to this
          failure mode is assigned a value of 2. Thus, the search vector in this bespoke strategy consists
          of three distinct numbered exit conditions. Despite being a failure, from the perspective
          of narrowing down the search space, exit condition 2 is treated in the same way as exit
          condition 1 i.e., the trialled layer choice is deemed to be too high.

              Akin to the acceleration pathway, the optimal layer choice for fast charging is deemed
          to be at the critical transition point wherein the exit condition toggles from 0 to 1 and
          hence, minimal customisation is needed in the computer code to handle these two cases.
          The handling of exit condition 2 is shown in the lower rightmost portion of fig. 3.5. Despite
          being a failure, from the search algorithms point of view this is treated as a success, with
          the only difference being the assignment of the exit condition value purely for logging and
          debugging purposes.

          Alternative search algorithm -- linear search

          A simpler alternative to using the binary search algorithm is the standard linear search
          algorithm. This is a simple search strategy which involves sequentially iterating from min
          to max until arriving at the lowest value oacpct that satisfies all the termination criteria.
          However, a naive use of the linear search algorithm is computationally expensive with a
          worst case operation count of (). Therefore, this thesis author recommends the use of the

                                                                 93

                                              3.5 Computational Framework

bespoke binary search algorithm. The choice of minimum and maximum values for the layer
search space is discussed in section 3.5.5.

3.5.5 Upper and lower bounds on search space

It is helpful to determine the highest possible number of layers that can be physically
accommodated in a stack of height stack. For instance, this value may be used as the upper
bound to the binary search algorithm (which compulsorily requires such an upper bound)
described in section 3.5.4. This can be obtained by defining a simple integer optimisation
task as shown in eq. (3.43). The objective function here is to maximise the value of the layer
count  subject to the physical constraint that the thicknesses of both electrodes always
remains positive.

max

        pos  =  ( stack  -  Al() - Cu()    -  sep  )  >  0
                              (1 + ratio)
  s.t.                                                             (3.43)

        neg  =  ( ratio(stack  - Al() - Cu()  -    sep) )    >  0
                                (1 + ratio)

    Equation (3.44) represents the analytical closed-form solution to the integer optimisation
problem of eq. (3.43).

max     =  max  (  2 (stack  -  Cu)   ,    2stack - Al - Cu  )     (3.44)
                   Al + Cu   +  2sep        Al + Cu + 2sep


              The first argument to the max function in eq. (3.44) represents the maximum number
          of physically feasible odd layers while the second argument represents the maximum such
          value when considering odd layers. Therefore, the greater of these two values is chosen as
          the maximum permissible layer choice max and is used as an input to the search algorithm.

              In the absence of published information on how the minimum layers within a pouch cell
          is currently set, there is presently no unique way to determine min. Therefore, for this layer
          optimisation study, the value of min used by the search algorithm is currently set to one --
          the minimum physically feasible number of layers. Design engineers from industry may opt
          to tweak this to a higher value based on insights gained from present empirical designs.

                                                                 94

3.5 Computational Framework

3.5.6 Electrode thickness ratio for capacity balancing

A key idea of the layer optimisation scheme is that, for computing the physical lengths of
electrodes as a function of number of layers, the ratios of their thicknesses ratio, is held
constant. This coefficient is germane to the concept of capacity balancing of electrodes with
a view to equalise their loading. The idea of matching the capacity of anode and cathode
materials is widely accepted as a standard principle in cell design [23]. The computation of
this ratio parameter is discussed here.

    Equating the active material volume of both electrodes,

elec,posposs,pos = elec,negnegs,neg  (3.45)

    While stacking the layers within a pouch cell, for the negative electrode layers, there
exists an extra overhang of (< 2 mm) with respect to the positive electrode layers. Figure 3.6
shows a CT scan depicting the two-dimensional longitudinal-sections with a close-up view
of this overhang region. This is a design feature and helps to avoid plating of lithium at the
edges.

  Figure 3.6 CT scan showing the two-dimensional longitudinal-sections from the edge of the
  pouch cell with a close-up view of the graphite overhang region. For the negative electrode layers,
  there is an extra overhang of (< 2 mm) with respect to the positive electrode layers. This design
  feature helps to avoid plating of lithium at the edges. Image reproduced from Bond et al. [101].

    Neglecting overhangs of the negative electrode (typically below 2 mm to avoid plating
at the edges), both electrodes have the same cross-sectional area elec. Therefore, eq. (3.45)
reduces to

¨e¨le¨c poss,pos = ¨e¨le¨c negs,neg  (3.46)
      poss,pos = negs,neg            (3.47)

                                                                 95

                                 3.5 Computational Framework

    Owing to the reasons outlined in section 3.2.1, the volume fractions of the electrode
materials are assumed to be constant, which implies that their ratio is also a constant. The
electrode thickness ratio ratio is therefore obtained as

ratio  =  neg                    (by definition)                       (3.48)
          pos                    (rearranging eq. (3.47))              (3.49)
                                 (by definition, see eq. (5.60))       (3.50)
       = s,pos                   (substituting values from table 5.2)  (3.51)
         s,neg                                                         (3.52)

       = 1 - pos - fi,pos
         1 - neg - fi,neg

       =  1  -  0.385  -  0.025
          1  -  0.485  -  0.033

ratio = 1.22

3.5.7 Computation of electrode thicknesses per layer

In this section, a deterministic way to compute the thickness of electrode materials is
present. In the views of this thesis author, this represents a departure from the norm wherein
electrode thicknesses are designed on a trial and error basis [23]. Following the assumptions
listed in section 3.2.1, the exterior dimensions of the pouch are held constant. Furthermore,
as explained in section 3.4.1, the thickness of the electrochemical stack within the pouch
cell stack, is also considered to be constant. Therefore, when the number of layers forming
the stack is varied, this implies that the only quantities that may be allowed to change are
the thicknesses of the two electrodes within each layer i.e., higher the layer count, lower the
electrode thicknesses and vice-versa. In this section, this relationship between the number of
layers  and the electrode thicknesses  (  neg, pos) is quantified with the help of the key
ratio parameter obtained in section 3.5.6.

    Figure 2 of Northrop et al. [72] (suitably adapted and reproduced in fig. 3.7) considers two
possible configurations of stacking up layers within a pouch cell. In the first topology shown
in fig. 3.7a, the outermost current collectors are of copper. In the alternative configuration
shown in fig. 3.7b, a copper current collector occupies one end of the stack while an aluminium
current collector occupies its other end. The formulae derived here is equally applicable to

                                                                 96

                                                                       3.5 Computational Framework

both these cases. Although the use of aluminium current collectors at both extrema of the
stack is not studied, the approach presented here may be easily extended to this case.

                          (a) Topology 1       (b) Topology 2

Figure 3.7 Two possible topologies for arranging the layers within a pouch cell. The first
possibility entails using an even number of layers as shown in the example illustration with
four layers in the left sub-figure. Here, both extrema of the stack are occupied by copper current
collectors. The second possible arrangement consists of using an odd number of layers and is
depicted in the sample illustration with three layers in the right sub-figure. This represents a
heterogeneous topology wherein the outermost current collectors of the stack consist of copper
at one end and aluminium at its other end. Illustration adapted from Northrop et al. [72].

The stack height may be obtained by the sum of thicknesses of the constituent regions.

       stack =  () + Al() + Cu()                  ,   {pos, sep, neg}  (3.53)



where

       () =                                                            (3.53a)
                                                                       (3.53b)
       Al()  =   (     )  Al,     if  is even                          (3.53c)
                {   2             if  is odd

                (   +1    )  Al,
                     2

       Cu()  =   (  +2    )  Cu,  if  is even
                {    2

                (   +1    )  Cu,  if  is odd
                     2

                                                                 97

                                      3.5 Computational Framework

    The combined thickness of the two electrode regions in each layer ce can be then obtained
by rearranging eq. (3.53)

ce  =  stack  -  0.5(  + 1)Cu      - 0.5Al  -  sep       (3.54)


    The individual electrode thicknesses can then be obtained from eq. (3.54) by suitably
substituting in ratio and performing simple algebraic manipulations.

                 pos   =     ce    1                     (3.55)
                          ratio +                        (3.56)

                 neg = ce - pos

    The values of the two electrode thicknesses thus obtained using Eqs. (3.55)­(3.56) are
used as computational domain lengths in the P2D simulations. Therefore, these thicknesses
have to be recomputed each time the trialled number of layers  is updated by the search
algorithm.

3.5.8 Computation of layer-dependent cell mass

The mass of the cell varies as a function of number of layers. This is because, the thicknesses
of the two electrodes within each layer changes each time a different layer choice is simulated.
For a given layer choice , the cell mass is computed as per eq. (3.57).

  cell =   + Al + Cu + LiPF6 + pouch,   {pos, sep, neg}   (3.57)

                                                         (3.57a)
                                                         (3.57b)
      = elec                                             (3.57c)
   Al = elecAlAl                                         (3.57d)
   Cu = elecCuCu
                                                         (3.57e)
LiPF6 = elec( (1 - fi - ))LiPF6



pouch = 2pouchpouchpouchpouch

                                                                 98

                                                          3.6 Results and Discussion

    Equation (3.57) consists of both constant components as well as components that vary
with the number of layers. For instance, the mass of the electrolyte LiPF6 as well as that of
the pouch material pouch are constants and are computed only once.

3.5.9 Computation of layer-dependent cell specific heat

A lumped thermal model of the cell given by eq. (3.58) is used to model the thermal dynamics
of the cell. This thermal model is coupled with the electrochemical model equations of the
P2D model for the simulations used to determine the optimal layer configurations. The cell's
temperature cell() is also obtained from this lumped thermal model.

        cellavg   cell  =  -tabs (cell() - sink)  +  pol              (3.58)
                                                                     (3.58a)
                                                                     (3.58b)
                 pol = cell||  | -  |                                (3.58c)

                  = pos(pos)||=pos/-Alccneg(neg)||=neg/Cucc

                  = s||=pos/-Alccs||=neg/Cucc

    The average specific heat of the cell avg used in eq. (3.58) is a function of the number of
layers and is given by eq. (3.59).

avg  =  1     [  + AlAl + CuCu + LiPF6 LiPF6         + pouchpouch],    {pos, sep, neg}
                                                                                    (3.59)
        cell

    The first three terms in eq. (3.59) are evaluated as a function of the number of layers
by substituting the appropriate layer-dependent mass values computed in eqs. (3.57a)­(3.57c).
The latter two terms i.e., the specific heats of the electrolyte material and the pouch are held
constant since their corresponding mass values do not vary with the number of layers used.

       3.6 Results and Discussion

          At the outset, it is worth mentioning that the focus of this chapter is on the layer optimisation
          methodology itself. The results as such do not stand alone outside of the modelling universe
          with all its inherent assumptions discussed thus far. Presently, the value added by this work

                                                                 99

                                                                                       3.6 Results and Discussion

          is its ready adaptability to industry through its modular design. A numerical implementation
          in the form of a toolbox  is also provided which is immediately available for download
          and use by relevant stakeholders. This author recommends that until the tool matures,
          cell manufacturers substitute their own parameters and adjust other numerical coefficients
          suitably so that the toolbox supplements, rather than supplants present empirical layer
          designs. Hence, the results presented in this section must be interpreted in the backdrop
          of the context within which the methodology was developed implying that the reader must
          consciously strive to interpret all numerical values in relative terms of magnitude. To aid this
          thought process, this author chooses to deliberately limit the discussion around the absolute
          magnitude of numbers presented here.

        3.6.1 Modelling Platform and Preconditioning

          The complete parameter set used for simulation is presented in table 3.2. All cells are assumed
          to be in their equilibrium state prior to beginning of simulations. The thermally-coupled, P2D
          electrochemical model used for simulating each layer choice is implemented in MATLAB [111]
          using a heavily-modified version of the LIONSIMBA toolbox [94]. The work reported in this
          chapter helped to advance the toolbox from v1.0x to v2.0. The updated computer codes to
          which this author heavily contributed, is available from the project's official repository.

              The rationale behind choosing this specific software to implement layer optimisation is
          as follows. The LIONSIMBA v1.0x toolbox has already been validated against the results of
          the DUALFOIL [112] codes (which can be considered as the present benchmark standard).
          The toolbox is implemented in the MATLAB programming language. Since this chapter has
          a strong industry focus, the omnipresence of MATLAB in industry, its mature code-base and
          familiarity was a strong motivator in the adoption of this toolbox. The simulation speeds
          using LIONSIMBA have been shown to be comparable to the FORTRAN implementation of
          DUALFOIL, primarily owing to the sophisticated computation of the analytical Jacobian of
          the system through automatic differentiation [94]. In addition to fundamental enhancements
          to the modelling platform presented in section 3.4, numerous bug fixes and other minor

                 As an accompaniment to this chapter, an open-source software toolbox, (co-created with Ian D. Campbell
            and Davide M. Raimondo) for optimal layer selection in pouch cells viz. Battery Optimal Layer Design (BOLD)
            is made available for download from GitHub.

                https://github.com/ImperialCollegeESE/BOLD_Toolbox
                LIONSIMBA v2: https://github.com/lionsimbatoolbox/LIONSIMBA

                                                                100

                                                                   3.6 Results and Discussion

Table 3.2 Cell parameters and system conditions for a simulating an LCO cell with the DFN
electrochemical model and a lumped thermal model. These parameters, when augmented with
the values of the kinetic, geometric and transport properties of the cell (from table 5.2) represents
the complete information required for all simulations in this layer optimisation framework.

                                              System Conditions

Parameter                                    a3.50    Parameter                              c80.00
                                             b4.22                                           d55.00
Lower cutoff cell voltage, min (V)                    Target cell SOC for fast charge,  (%)
Upper cutoff cell voltage, max (V)                    Cell upper temperature limit, max (C)

                                      Geometric Parameters

Parameter

Surface area of pos. & neg. electrode overlap within a layer, elec (m2)                      b44.63 × 10-3
Exterior pouch length, pouch (m)                                                            e332.74 × 10-3
Exterior pouch width, pouch (m)                                                              e99.06 × 10-3
Exterior pouch height, pouch (m)
Pouch material thickness, pouch (m)                                                          f10.00 × 10-3
Stack thickness, stack (m)                                                                  g160.00 × 10-6

                                                                                              r9.68 × 10-3

                                      Thermal Parameters

Parameter                             Al. CC Pos           Sep     Neg      Cu. CC  LiPF6     Pouch

Sp. heat capacity,  (J kg-1 K-1)      h903   h1269.2      h1978.2  h1437.4    h385  h2055.1  i1464.8
Density,  (kg m-3)                    j2700  k2291.6      b1100.0  j2660.0   l8960  j1290.0  m1150.0
Activ. energy, diff. act,s (J mol-1)   --    p5000                 p5000
Activ. energy, rxn. act,k (J mol-1)                         --                 --      --      --
                                       --    p5000                 p5000
                                                            --                 --      --      --

                                  Other Geometric/Cell-Level Parameters                       f15 × 10-6
                                                                                              p10 × 10-6
Parameter                                                                                   b5.94 × 10-3

Thickness of pos. current collector, Al (m)                                                         b150
Thickness of neg. current collector, Cu (m)                                                        q1000
Total tab area, tabs (m2)
Lumped heat transfer coefficient,  (W m-2 K-1)
Initial electrolyte concentration, e,0 (mol m-3)

                                      Spatial Discretisation

Parameter                                             Pos                   Sep                          Neg

Nodes, through-thickness (axial), a                   40                    40                           40

Nodes, within spherical particle (radial), r          15                    --                           15

a Calculated in section `Lower cutoff voltage for cells' (also see section 3.4.1) b Assumed c Ref. [98]

d Ref. [102] e Converted from imperial units reported in Ref. [91] f Table IV of Ref. [92]

g Sum of values in table 1 of Ref. [103] h Ref. [104] i From constituent values (see [103]) using Ref. [105]

j Ref. [106] k Ref. [107] l Ref. [108, 109] m Ref. [110] p Ref. [72] q Ref. [90]

r See section `Computation of stack thickness of reference cell'

                                                                 101

                          3.6 Results and Discussion

enhancements to the original LIONSIMBA code-base have been provided by this thesis author.
Interested readers may peruse these from the README.md file from the project's repository.

3.6.2 xEV configurations

Table 3.3 Acceleration test parameters (common across xEV platforms)

Parameter

Coefficient of drag for xEV body, d                  a0.31
Frontal area of xEV, v (m2)                          b2.40
Acc. time dictated by standards, f,std (s)           c6.00
Acc. time specified by manufacturer, f,man (s)       d6.50
Speed, end of acc. (standards), f,std (m s-1)        e8.94
Speed, end of acc. (manufacturer), f,man (m s-1)    f26.82
Base speed of xEV, b (m s-1)                        e13.41
Air density at acc. test conditions, air (kg m-3)     f1.20
Drivetrain efficiency, dt                            g0.75
Payload, p (kg)                                    c150.60

Rolling resistance coefficient of road surface, r    f0.01
Road gradient,                                       g0.00

a Ref. [113] b Calculated from typical BEV dimensions in [114]
c Ref. [115] d Ref. [116] e Ref. [89] f Ref. [117] g Assumed

    Tables 3.3 and 3.4 show the xEV parameters used in simulations. The power demands
on the battery pack during normal operation are found to be significantly lower than that
experienced during the two extreme cases of discharging and charging viz. acceleration and
fast charging respectively. For instance, 50.83 kW is the peak discharge power while 14.20 kW
is the median discharge power for various standard drive cycles. Even with the assumption
that 100 % of braking energy can be recovered, the peak and median charging powers are
only 43.13 kW and 26.03 kW respectively.

    The discharging and charging powers experienced by the pack during acceleration and
fast charge are significantly higher than those experienced with any standard drivecycle.
Considering the acceleration parameters in table 3.3 for the BEV pack, 181.45 kW is the power
requirement for acceleration of a fixed vehicle mass on a flat road surface. Four distinct fast-
charging power levels viz. 50 kW, 80 kW, 110 kW and 130 kW are considered in this study.
This is in adherence to the minimum and maximum values of level 3 rating as suggested by

                                                                102

                                           3.6 Results and Discussion

Yilmaz and Krein [118]. Furthermore, near-term fast charging goals laid out in literature [119,
120] and the peak power capability of charging infrastructure further justify these choices.

                       Table 3.4 Acceleration test parameters (specific to each xEV)

Parameter                                  BEV       PHEV

Mass of xEV chassis, c (kg)                a1340.0   b1438.0
Mass of pack overhead (w/o cells), o (kg)   a196.4     c65.5
Upper cutoff SOC of cell, max (%)            d95.0     d90.0
Lower cutoff SOC of cell, min (%)                      e30.0
                                               d5.0

a Calculated based on [121] b Calculated based on [121, 122]
c Calculated (see sections 3.5.2 & 3.5.8) d Assumed e Ref. [117]

    For the acceleration tests, the initial cell SOC has been set to 40 %. This is in conformity
with the test criterion (50 ± 10) % of the SAE J1666 standard [98]. By choosing the worst
case starting SOC i.e., 40 %, a conservative design can be achieved. The chassis mass of the
vehicle as well as the mass of two passengers at 75.3 kg each [98] is considered for both
xEV platforms. The pack mass is computed as a function of number of layers as described
in section 3.5. Vehicle manufacturers General Motors Inc. provide the mass value of the
GM Ecotec series of engines [122] that can be used for the PHEV case which consists of a
range-extending ICE. The mass of the Bolt BEV pack reported in [121] minus the computed
mass of the overall cells used in the pack gives the overhead mass of the BEV pack. The
PHEV pack's overhead mass is determined by suitably scaling the mass by the proportion of
reduction in the number of cells used.

    For the BEV platform, a fast-charging scheme operated on a Constant Power (CP) mode
with an initial SOC of 20 % is employed. In the case of the PHEV, an initial SOC of 30 %
(10 % higher than that for BEV) is used. This facilitates a smaller SOC window by taking
into account the higher number of charge-discharge cycles which are typical with PHEV
designs [28]. Both xEV platforms are fast charged to a target SOC of 80 % in CP mode. This
SOC value corresponds to the end-of-charge target in level 3 charging standards [123].

        3.6.3 Acceleration studies

          For both vehicle platforms under study, the acceleration at a worst-case rate of 4.13 m s-2 is
          assumed for simulation. This corresponds to the manufacturer's acceleration specifications

                                                                103

                            3.6 Results and Discussion

for the BEV listed in table 3.3. The acceleration rate corresponding to the SAE J1772 standards
is lower than this rate. Therefore, to obtain a robust cell design, the higher of the two
acceleration rates needs to be considered.

    Table 3.5 gives the simulation results for various combinations of (init, sink) for both the
BEV and PHEV platforms. The following discussion is applicable for both vehicular platforms.

Table 3.5 xEV acceleration test results

(init, sink) oacpct oacpct

(degC)   BEV PHEV

(38,5)   21 55
(38,49)  21 57
(25,25)  23 63
(15,5)   27 69

    The specific combinations of temperatures for traversing the thermal design space
are chosen following the SAE J1772 guidelines. The high power densities resulting from
low numbers of layers lead to large overpotentials causing the cell's terminal voltage to
drop lower than min, thereby unable to satisfy acceleration requirements. However, at
higher init, owing to the reduction in overpotentials, a larger voltage overhead is available
to accommodate the internal polarisation drop. For all temperature combinations, the largest
deviation from init experienced by the BEV cell is a 0.48 C increase. Consequently, it can
be concluded that a single isolated acceleration event does not heat the BEV battery pack,
and therefore the cell temperature remains close to that of the initial value. The PHEV cell
experiences higher power levels and although its temperature increases much higher than the
corresponding BEV cell, the maximum temperature during acceleration remains well below
the upper cutoff limit. Furthermore, even for the worst case simulation run, the cell's SOC is
depleted only by a maximum value of 0.32 % for the BEV cell and by a slightly higher value
for the PHEV cell.

    The foregoing discussion has revealed that the lower cut-off voltage strongly influences
layer configuration for acceleration tests. Therefore, when considering acceleration require-
ments,  = 27 and  = 69 represent the optimal layer choices for the BEV and PHEV platforms
respectively .

                                                                104

                                                                                       3.6 Results and Discussion

        3.6.4 Fast-charging studies

          Figures 3.8 and 3.9 shows the results produced by the layer optimisation framework for the
          BEV and PHEV platforms respectively when considering fast charging requirements. Each
          heat map in these figures show the optimal number of layers ofapsttchg for various combinations
          of initial and ambient temperatures for four different charging powers. In each case, the values
          of ofapsttchg correspond to the temperature combination (init, sink) = (15, 5)C as shown in
          fig. 3.8. This represents the least number of layers required to fast charge the pack under CP
          conditions until the target SOC is reached. The charging scheme additionally considers the
          constraint that the cell temperature must stay within max = 55 C. Furthermore, its voltage
          must remain less than or equal to max = 4.22 V. Finally, the charging algorithm is plating-
          aware i.e., the charging stops as soon as the concentration at the particle surface reaches the
          maximum possible concentration limit, thereby preventing lithium plating at the surface of
          negative electrode particles.

              Thus, using the model-based design strategy presented in this chapter, an effective cell
          design is achieved which helps to maximise energy density and BEV range, without forgoing
          fast charging power targets. From figures 3.8 and 3.9, it is seen that ofapsttchg increases with
          increase in the charging power. This is because, as the charging power increases, the minimum
          number of layers required to maintain the cell voltage below the maximum permissible value
          also increases. This requires higher interfacial surface area to accommodate the increased
          power demand. Furthermore, rapid surface saturation occurs due to steep concentration
          profiles in the negative electrode particles when the charging power is high which causes
          plating. With higher layers, the resulting electrodes are thinner, thereby allowing faster
          diffusion of lithium in the solid particles and avoiding steep concentration gradients in them.
          This suggests that the number of layers must be large enough to prevent plating.

              Figure 3.10 shows the nominal capacity of cells and charge passed versus the number of
          layers during fast charging. In these plots, the theoretical capacity n of the cell versus the
          layer count  is represented by the linear downward-sloping line.

              For any layer choice, n therefore represents the upper bound on the charge that can be
          passed during charging. For both constant current and constant power charging, the loci of
          actual charge passed  lie much below this theoretical nominal capacity. For very low layer

                                                                105

                                                                                       3.6 Results and Discussion

                                    Figure 3.8 Optimal cell layer configurations for the BEV

                                   Figure 3.9 Optimal cell layer configurations for the PHEV
                These figures were created by Ian D. Campbell who asserts copyright, with intellectual contributions from
            and the right to use asserted by Krishnakumar Gopalakrishnan.

                                                                106

                                                                                                                                                    3.6 Results and Discussion

counts, as the number of layers decreases, the power density drops rapidly which implies that

the rate of heating is low. This allows for more charge to be passed. However, at ultra-low

layer counts, the overpotential due to the cell's internal resistance is quite high. Therefore,

hitting the upper bound on the terminal voltage is the reason for the failure of these layer

choices. This is indicated by the narrow max-limited region in fig. 3.10. For an intermediate
range of layer choices, the rate of power-density drop with layer count begins to flatten,

thereby leading to a plating-limited region. For these layer choices, the surface concentration

starts to exceed the saturation value before any thermal or voltage limits are reached. Finally,

further increasing the layer count beyond an intermediate optimal value leads to a linear drop

in the cell's charge accepting capability. During fast charging with the chosen power levels,

although these layer choices do not reach the thermal, voltage or concentration limits, they

are unable to attain the target SOC of 80 %. This is simply due to the lower nominal capacity

                            "fig_capacity_quadrants'' -- 2018/5/4 -- 20:14 -- page 1 -- #1

Nom. capacity & charge (Ah) Nom. capacity & charge (Ah)BEV Constant Current Charging                                                                BEV Constant Power Charging
                                                                              Nom. capacity & charge (Ah) Nom. capacity & charge (Ah)
                            Qn                                                                                                                                                         Qn
                                                                                                                               Plating-limited                                         q at 50 kW
60                          q at 20 A                                                                                                         60                                       q at 80 kW
                                                                                                                                                                                       q at 110 kW
                            q at 50 A                                                                                                                  Vmax -limited  Capacity-limited q at 135 kW

40                          q at 80 A                                                                                                         40

                            q at 90 A                                                                                                         20

20

                                                                                                                                                    Increasing utilisation

0   1  50 100 150 200 250                                                                                                                     0  1  50 100 150 200 250

       Number of layers, n                                                                                                                                            Number of layers, n

       PHEV Constant Current Charging                                                                                                               PHEV Constant Power Charging

                            Qn                                                                                                                                              Qn
                                                                                                                                                                            q at 50 kW
60                          q at 20 A                                                                                                         60                            q at 80 kW
                                                                                                                                                                            q at 110 kW
                            q at 50 A                                                                                                                  Vmax -limited        q at 135 kW

40                          q at 80 A                                                                                                         40

                            q at 90 A

20                                     20                                                                                                           Plating-limited   Capacity-limited

0                                                                                                                                             0     Increasing utilisation

    1  50 100 150 200 250                                                                                                                        1  50 100 150 200 250

       Number of layers, n                                                                                                                                            Number of layers, n

Figure 3.10§§ The right column shows nominal cell capacity and charge passed during CP
charging. Rate capability and cell utilisation are positively correlated with . With increasing
power levels, the optimal layer configuration shifts to higher values of . Similar behaviour is
observed for galvanostatic charging (left column). Plotted for init = sink = 25 C.

    §§This figure was created by Ian D. Campbell who asserts copyright, with intellectual contributions from
and the right to use asserted by Krishnakumar Gopalakrishnan.

                                                                107

                                                                                       3.6 Results and Discussion
          of the these cells. There is no benefit whatsoever in designing cells in this region. Figure 3.10
          provides clues to the design engineer on the degree of optimisation that can be achieved
          by careful design choices. For instance, by tuning certain design parameters, such as using
          electrode materials capable of operating at higher plating voltage or with higher saturation
          concentration, the optimisation point can be appropriately adjusted as per the application's
          demands.

              From the results discussed thus far, it is evident that it is the thermal environment that
          governs the optimal cell layer configuration in both acceleration and fast charging studies
          and for both vehicular platforms. For all charging powers simulated, ofapsttchg is the highest
          for the coldest temperature combination (init, sink) = (15, 5)C. This is due to the slow rate
          of electrochemical reaction and diffusion at cold temperatures. The thinner electrodes from
          using higher layer count enable fast charging without saturating the surface of the electrode
          particles. For the fast charging scenarios considered here, the optimal number of layers to
          use is 89 for the BEV cell and 153 for the PHEV cell. The globally optimal layer choice to be
          used for cell design is therefore the higher of the two values corresponding to acceleration
          and fast charging cases.

              Therefore, this model-based design framework recommends the use of 89 layers for the
          cells to be used in the BEV platform and 153 layers for the cells to be used in the PHEV
          platform. This concludes the discussion of results of this chapter as well as all design-related
          aspects of this thesis.

                                                                108

        4

     Computational Analysis and Numerical



                    Reformulation of the DRA

              4.1 Analysis of the Computational Bottlenecks of the DRA . . . . . . . . . . . . . 111

              4.2 Improved DRA for Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . 116

              4.3 Golyandina-Usevich Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . 119

              4.4 Customisations for Battery Modelling . . . . . . . . . . . . . . . . . . . . . . . 119

              4.5 Simulation Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . 121

                  This chapter is based on the journal publication -- Krishnakumar Gopalakrishnan, Teng Zhang and Gregory
            J. Offer. `A Fast, Memory-Efficient Discrete-Time Realization Algorithm for Reduced-Order Li-Ion Battery
            Models'. Journal of Electrochemical Energy Conversion and Storage 14.1 (Feb. 2017), p. 011001. issn: 2381-6872.
            All intellectual ideas in the aforementioned article are original contributions of this thesis author. All text,
            tables, figures and captions therein were contributed solely by this thesis author. Copyright clearance for
            non-commercial verbatim reproduction of the content (such as in this thesis) has been secured through the
            publication agreement with the copyright holder ASME (see appendix B). The contents in this chapter may be,
            in full or in part, included verbatim from the said publication. This author wishes to express his thankfulness to
            Teng Zhang, co-author of this article, for checking my calculations and providing valuable feedback that helped
            to refine the manuscript for that journal publication.

                                                                109

   This chapter presents an analysis and critical evaluation of a computational bottleneck
                present in a popular physics-based Reduced Order Model (ROM) framework of lithium-
          ion batteries and proposes an alternative numerical reformulation to mitigate it. From the
          literature review presented in chapter 2, it may be recalled that transcendental transfer
          functions of the cell's electrochemical field variables (except for ionic concentration and
          potential in the electrolyte) was obtained by Smith et al. [44] through linearisation of the
          underlying Pseudo Two-Dimensional (P2D) model equations. Lee et al. [45, 46] extended the
          aforementioned approach so as to obtain these missing electrolyte-specific transfer functions
          through a multi-modal EigenFunction expansion employing a Sturm-Liouville approach [124].

              In order to arrive at a Linear Time-Invariant (LTI) state-space representation of the system
          (see eq. (2.1)) for embedded implementation, Lee et al. devised the Discrete-Time Realisation
          Algorithm (DRA), a numerical procedure to systematically transform all transcendental
          transfer functions to the time domain. A special property of the DRA is that it retains the
          physical nature of the original Doyle-Fuller-Newman (DFN) equations until the very last
          step wherein the matrices governing the system's dynamics are generated. This yields a one-
          dimensional discrete-time ROM of the cell that is entirely based upon fundamental physical
          principles. The ROM thus obtained could then be used to compute the time-evolution of all the
          internal electrochemical quantities of the DFN model. Prima facie it appears that this model
          could be directly implemented for embedded vehicular applications, for example, as the plant
          model for state estimation tasks. However, a comprehensive analysis of the procedure reveals
          a critical issue that must be first tackled before implementation aspects can be considered.

              The unresolved issue in Lee et al. is the excessively high computational requirements
          associated with the DRA, which becomes a crippling bottleneck since the procedure needs
          to be repeated for multiple States of Charge (SOCs) and temperatures. This computational
          bottleneck arises from forming a large Block-Hankel matrix in memory upon which a
          Singular Value Decomposition (SVD) is performed. Under certain conditions as discussed in
          section 4.1.1, owing to the large size of the Block-Hankel matrix, the DRA computation is
          rendered intractable. This issue has been acknowledged by the original authors themselves
          in [5, 46]. In this chapter, this computational bottleneck is analysed and an improved
          scheme is proposed. Section 4.1 discusses an analytical evaluation of the massive computing
          requirements of the original DRA method. Redundancies and inefficiencies in this step are

                                                                 110

                                           4.1 Analysis of the Computational Bottlenecks of the DRA

          enumerated and the high computational costs are deemed as unnecessary. In section 4.2,
          a fast computational approach is presented which significantly reduces both the memory
          and computational time of the ROM workflow. Section 4.5 summarises the results obtained
          from applying the new workflow presented in section 4.2, by comparing and contrasting the
          much smaller computational requirements of the new method with the original DRA scheme.
          The improved modelling accuracy achieved by this proposed method when deployed under
          resource-constrained computing environments, is also highlighted.

       4.1 Analysis of the Computational Bottlenecks of the DRA

          The ROM proposed by Lee et al. aims for the simplified representation of the Pseudo
          Two-Dimensional (P2D) volume-averaged continuum model proposed by Doyle, Fuller and
          Newman [16, 125].

              The block diagram in fig. 4.1 depicts this thesis author's summary presentation of the
          overall modelling workflow in Lee et al.. Firstly, the governing Partial Differential Algebraic
          System (PDAE) equations of the DFN model (see table 1.1) are linearised about an operating
          point of SOC and temperature. Then, closed-form Laplace domain transcendental transfer
          functions of all the internal physical quantities (, , , , ) at different cell locations, are
          derived using applied current as the input. A detailed treatment of this analytical derivation
          is presented in Lee et al. [45]. The authors proposed a novel Discrete-Time Realisation
          Algorithm (DRA) scheme [126] in order to transform these transcendental transfer functions
          to standard state-space representation. Sublevel-1 of fig. 4.1 shows a breakout view of the
          DRA procedure and illustrates the steps involved in this computation. At the heart of this
          numerical method is the classical subspace identification approach known as Ho-Kalman
          algorithm [127], whose computation steps are shown via the exploded view in sublevel-2
          of fig. 4.1. Then, the Markov parameters (unit-pulse response) of this Single Input Multiple
          Output (SIMO) linear system of battery transfer functions are computed. They form the
          entries of a Block-Hankel matrix [128], wherein each block element is a column vector of
          the set of Markov parameters at a given time-step. A key computation in the Ho-Kalman
          algorithm is the Singular Value Decomposition (SVD) of this Block-Hankel matrix. A wide

                 hereafter referred interchangeably in this thesis by the two acronyms -- DFN and P2D.
                 A ubiquitous concept in linear systems and control theory, Markov parameters represent the discrete-time
            unit pulse response of a linear system.

                                                                 111

           4.1 Analysis of the Computational Bottlenecks of the DRA

separation in the magnitude drop between successive singular values serves as a guide for the
modeller in choosing a suitable reduced order to represent the entire dynamics of the system.
The analyses of this thesis author, presented in section 4.1.2 and section 4.1.3 reveal major
inefficiencies in both the Block-Hankel formation and the SVD computation steps which
hinder the entire reduced-order modelling workflow.

PDE Model  linearize around Linearized Laplace Transfer  Integrator Pole                 Discrete-Time           State-Space Augment Integrator Reduced Order

(Doyle-Fuller-Newman) given SOC, T PDE Model Transform Functions Removal (if present) ,  Realization Algorithm   Matrices  and Residues Model (ROM)

                                                                                         (DRA)

           Continuous-Time   Continuous-Time                                             Discrete-Time Unit      Ho-Kalman
           Impulse Response   Step Response                                                Pulse Response        , Algorithm

                                                                                            (Markov Parameters)

                              Block-Hankel                                               Singular Value          U, , V Extended Observability &
                             ,Matrix in RAM
                                                                                         ,Decomposition (SVD)    Controllability Matrices

                                                                                                                                                        Max. System Order

Figure 4.1 Reduced Order Model (ROM) workflow using classical Discrete-Time Realisation
Algorithm (DRA). The shaded blocks represent computational bottlenecks.

        4.1.1 Size of the Block-Hankel Matrix

          Large Block-Hankel matrices can occur in DRA computation due to the following reasons.

              1. For a given duration of Markov-parameter recording, if a high sample-rate ROM
                 is desired, the emulation frequency in the DRA scheme has to be proportionately
                 increased to accurately compute the continuous-time step and pulse responses in fig. 4.1.
                 This implies that the total number of time-samples  for each Markov parameter will
                 have to be scaled linearly to capture the desired duration of the unit-pulse response.
                 However, the size of the Block-Hankel matrix has a quadratic dependence on the
                 Markov parameter length.

              2. The recorded sample size  could also become large if the Markov parameters of just
                 one of the transfer functions decay very slowly. In Li-ion batteries, diffusion within
                 the solid particle is typically the slowest process. For the cell modelled in Lee et al.,
                 the unit-pulse response of surface concentration of Li adjacent to the positive current

                                                                 112

                                   4.1 Analysis of the Computational Bottlenecks of the DRA

collector requires approximately 16000 samples before reducing to an appreciably low
value, as shown in fig. 4.2.

3. For a battery modelling problem consisting of multiple transfer functions, the number
   of entries in the Block-Hankel matrix also scales linearly with the number of transfer
   functions. Thus, if more cell variables (e.g. concentrations and potentials at other spatial
   locations within the cell) are to be studied, then the size of the transfer function vector
   and that of the Block-Hankel matrix increases correspondingly.

                        0.02

                        0.00

c~sepos (0, t)[mol/m3]  -0.02
                        -0.04
                        -0.06      4000     8000          12000  16000
                        -0.08            Time [sec]
                        -0.10

                                0

Figure 4.2 Time evolution of Markov parameters of pole-removed transfer function corres-
ponding to surface concentration of Li in the solid particle adjacent to positive current collector.

    Considering the combined influence of these effects, if  transfer functions are to be
modelled and  time-samples of each Markov parameter are to be captured, the corresponding
size of the Block-Hankel matrix  is

                                   Size( )  ( 2) entries                (4.1)

              This has a significant computational impact as shown in section 4.1.2 and section 4.1.3.

        4.1.2 Classical DRA -- Memory (RAM) Requirements

          Lee et al. [45] modelled 28 transfer functions representing various electrochemical variables at
          the current collector and separator interfaces. Each Markov parameter is a 28 element column

                                                                 113

                                           4.1 Analysis of the Computational Bottlenecks of the DRA

          vector. 16000 time-samples were obtained at a sample-rate of 1 Hz, allowing sufficient time
          for the Markov parameters of the slowest dynamics i.e., solid surface concentration to settle
          to an acceptably low magnitude. The Block-Hankel matrix thus formed has 8000 blocks, each
          block consisting of 28 elements i.e., has 8000×28 = 224000 rows and 8000 columns. Hence, the
          overall number of elements in the Block-Hankel matrix is 224000 × 8000 = 1.79 × 109. Using
          double-precision arithmetic, its storage requirement can be estimated to be 27 GB.

              Computing the SVD results in the formation of three more large matrices in memory
         -- i) matrix of output singular vectors , ii) matrix of input singular vectors , and iii) the
          diagonal singular-value matrix . With 8000 Hankel-blocks, approximately 81 GB of Random
          Access Memory (RAM) is required for holding these three output matrices generated by a
          full SVD. However, the intermediate operational memory usage during the SVD computation
          is often much higher than the combined size of all the matrices. As these large matrices must
          be repeatedly handled for each operating point of SOC and temperature, the high memory
          demand of the classical DRA remains a persistent issue.

        4.1.3 Classical DRA -- CPU Operation Count

          The most widely used numerical algorithm for computing the full SVD of a generic dense
          matrix   ×,    is the two-stage Golub-Kahan-Reinsch method [129]. In the first stage,
            × is reduced to an upper bidiagonal form. In the second stage, SVD of this upper
          bidiagonal matrix   × is computed using an iterative procedure such as the Demmel-
          Kahan method [129]. If stage I of the SVD computation employs -Bidiagonalisation [129],
          then the overall process is referred to as -SVD. This is the fastest known full SVD
          computation method that may be applied to this battery modelling problem. The dgesvd
          algorithm, originally implemented in LAPACK [130], employs this method. This has been
          ported to many numerical computation packages such as MATLAB, GNU Octave and Scilab.
          Several numerical libraries such as NAG and Intel MKL also use the dgesvd codes due to
          its acclaimed stability, robustness and versatility. The MATLAB implementation `svd' is also
          based upon dgesvd and hence this can be considered as the de-facto baseline SVD code.

              The operation count for computing the singular values and vectors of a generic dense
          matrix   ×,    using the -SVD method is 42 + 223 [129]. Markov parameters
          of  transfer functions and  time-samples yields a Block-Hankel matrix with  =  rows

                                                                 114

4.1 Analysis of the Computational Bottlenecks of the DRA

and  =  columns. Hence,

CPU Operation Count = 4 () 2 + 22 3

                         = 2 3 (11 + 22)  (4.2)

Thus the Central Processing Unit (CPU) operation count scales as ( 3) with the number of
Markov time-samples  and as (2) with the number of transfer functions  being modelled.
The ROM computed in Lee et al. uses 28 transfer functions wherein the Markov parameters
are collected for 16 000 s with a sampling interval of 1 s. Thus, the CPU operation count for
performing this computation is approximately (160003)  4 × 1012 floating point operations.

4.1.4 Summary Effect of Computational Bottlenecks

The computational bottleneck in a classical DRA implementation arises due to the require-
ment of capturing a large number of Markov parameters, which in turn leads to growth in
Block-Hankel size. In the case of battery modelling, this can arise in the following real-life
scenarios:

    1. Electrochemical variables at additional locations of interest within the cell (e.g. middle
       of electrode or separator domain) might need to be modelled. This increases the number
       of transfer functions and hence the number of Markov parameters.

    2. High frequency load cycles necessitate higher sample-rates to obtain a high fidelity
       model. This leads to a correspondingly higher number of Markov parameters.

    3. In cells with large particle sizes and small diffusion coefficients, a large set of Markov
       parameters is needed to capture the full system dynamics.

Lack of specialised computing infrastructure necessitates early truncation of the Markov
parameters in the ROM workflow. The resulting errors in the singular value computation
lead to significant modelling errors in the physical variables of the cell. Thus, in practice, the
computational bottlenecks of classical DRA manifest as modelling errors when implemented
in a resource-constrained computing environment. Furthermore, this tedious computation
has to be repeated for multiple SOCs and temperatures.

                                                                 115

                                                                   4.2 Improved DRA for Battery Modelling

              The foregoing analysis clearly demonstrates that the high memory and CPU demands in
          a classical DRA implementation severely hamper the scope and applicability of the reduced
          order modelling process. This implies that the modelling workflow is not accessible to
          research groups without specialised computing infrastructure and its universal appeal is
          rendered questionable. The shaded blocks in fig. 4.1 depict the hierarchical propagation of
          the classical DRA's computational bottleneck throughout the ROM workflow.

       4.2 Improved DRA for Battery Modelling

          Collecting a large Markov parameter set is inevitable due to the fundamental physics of
          the cell dynamics as established in section 4.1.4. Hence, in order to circumvent the high
          computational demands of the classical DRA, the second step in the process i.e., forming the
          Block-Hankel matrix, is critically examined with the following scientific rationale.

              1. The unit-pulse responses of most battery transfer functions (other than those of rate-
                 limiting steps such as solid diffusion) decay relatively quickly. Hence it is inefficient
                 to record the Markov parameters of the full system for the entire duration needed to
                 capture the slowest dynamics.

              2. The Block-Hankel matrix is essentially redundant information since its entries are
                 simply the Markov parameters arranged in a repeating special structure. Thus, it is
                 wasteful to construct this huge matrix. If the SVD operation can be performed on a
                 virtual Hankel matrix, the memory requirements can be drastically reduced.

              3. The matrix of singular values  is diagonal and hence, sparse. It is redundant to hold
                 all the non-diagonal entries (zeros) in memory.

              4. It is not necessary to perform a full SVD operation in order to achieve order reduction.
                 When an upper bound on desired system order can be decided a priori, it is sufficient
                 to compute a truncated SVD yielding the first few dominant triplets of  ,  and .

          Thus, forming the large Block-Hankel matrix and computing its SVD is identified as an
          avoidable bottleneck in the classical DRA method. This can be tackled since forming the
          Block-Hankel matrix is an idiosyncrasy of the algorithm used and does not arise from any

                                                                 116

                                                                   4.2 Improved DRA for Battery Modelling

          fundamental physical limits. Facilitated by an efficient SVD implementation, this thesis author
          proposes an improved DRA that serves as a drop-in replacement in the ROM workflow.

        4.2.1 Candidate Schemes for Block-Hankel SVD

          Generic SVD routines such as dgesvd do not take advantage of the anti-diagonal structural
          symmetry of Block-Hankel matrices. Since it is sufficient to obtain the first few leading
          eigentriplets for order reduction, iterative algorithms such as the Jacobi and Lanczos schemes
          (see [129]) emerge as attractive candidates for computing these dominant singular values
          and vectors. In order to ensure accessibility to the large community of battery researchers
          and to encourage widespread adoption of the fast reduced order modelling framework, the
          author of this thesis considered only freely available open-source numerical libraries that
          exist in the public domain, especially those with permissive licensing terms. Otherwise the
          gains achieved by an efficient SVD computation for implementing DRA on non-specialised
          computing hardware would be offset by commercial licensing terms, usage restrictions and
          monetary considerations associated with using proprietary codes. Among these open-source
          candidate algorithms, the Jacobi scheme [129] is available through the xGESVD routine in
          the LAPACK suite [130]. FORTRAN 77 codes for the implicitly restarted Arnoldi and Lanczos
          schemes (see nu-TrLan [131]) are available as part of the ARPACK [132] library.

              The practical drawback of most SVD implementations, both open-source and proprietary,
          is that they require the entire matrix as input argument. Since operating upon the Block-
          Hankel matrix requires constructing it in the first place, the memory bottlenecks discussed
          in section 4.1.2 are not ameliorated. An example is the svds routine -- an economy size SVD
          implementation in MATLAB. Albeit this is a commercial implementation of the Arnoldi codes,
          any potential benefits of using an iterative scheme is nullified by the memory penalty. Owing
          to reasons enumerated in section 4.2, the chosen SVD algorithm needs to be able to handle
          the computation without actually forming the huge block-Hankel matrix in memory.

        4.2.2 SVD Operation on a Virtual Block-Hankel Matrix

          The pioneering work by Larsen, PROPACK [133], based on his earlier work [134] implements
          a numerically stable Lanczos SVD computation designed specifically for large and sparse
          matrices. In addition to the ability to operate on the matrix as a whole, the PROPACK

                                                                 117

                                                                   4.2 Improved DRA for Battery Modelling

          codes possess a unique flexibility of accepting input arguments in a functional form. A key
          highlight of the Lanczos SVD scheme is that it does not strictly require the matrix itself, but
          only the product of the matrix and its transpose with an arbitrary vector. This feature has
          been effectively exploited in the PROPACK suite. Therefore, these multiplication routines
          can be supplied as input arguments instead of forming the large Block-Hankel matrices in
          memory. Furthermore, this package includes sophisticated schemes such as Gram-Schmidt
          partial re-orthogonalisation [135] to compensate for numerical round-off errors in the basic
          Lanczos bidiagonalisation and ensures orthogonality of the input and output singular vectors.
          The PROPACK suite is available as both Fortran 77 and MATLAB codes distributed under a
          permissive BSD license. Version 1.1 of the MATLAB implementation of the PROPACK suite
          was used by this thesis author.

              For the ROM workflow, in order to use PROPACK's unique feature viz. its flexibility to
          accept functional form inputs, the key is to use an algorithm that effectively exploits the affine
          structure of the Block-Hankel matrix without actually forming it in memory. Recent research
          in a specialised time-series technique known as Singular Spectrum Analysis (SSA) [136] has
          yielded efficient methods for achieving this goal. Korobeynikov [137] proposed an algorithm
          that employs the Fast Fourier Transform (FFT) for implementing this matrix-vector product
          by embedding the Markov parameters into the column vectors of a circulant matrix. This
          is suitable for applications wherein the Hankel matrix is composed of scalar entries such
          as that formed by the Markov parameters of a Single Input Single Output (SISO) transfer
          function. Golyandina, Usevich and colleagues [138, 139] extended this approach to a generic
          2D-case for performing SSA on images. With this modification, this algorithm is rendered
          capable of handling the structure of Multi-level Block-Hankel matrices formed from the
          Markov parameters of a generic Multi Input Multi Output (MIMO) system. While the modified
          scheme does not construct the Block-Hankel matrix in memory, the operational rubrics of the
          Golyandina-Usevich algorithm in conjunction with PROPACK is such that they iteratively
          operate on a virtual Hankel matrix of equivalent size. The Golyandina-Usevich algorithm is
          briefly summarised in section 4.3.

                                                                 118

                                                                           4.3 Golyandina-Usevich Algorithm

       4.3 Golyandina-Usevich Algorithm

          The Golyandina-Usevich algorithm is used for computing the product of a Block-Hankel
          matrix with an arbitrary vector. The steps involved in this scheme are enumerated in
          Algorithm 3 of Golyandina et al. [139]. These steps are reproduced here in the context of
          the improved DRA for reduced order battery modelling.

              1. Compute a 2-D FFT of Markov parameter matrix.

              2. Form an augmented vector by zero-padding the arbitrary vector input from Lanczos
                 iteration.

              3. Perform a column-wise reshaping of this augmented vector to obtain a new matrix
                 with the same dimensions of the Markov parameter matrix.

              4. Compute the element-wise product of this newly created matrix with the 2-D FFT of
                 Markov parameter matrix.

              5. Reshape the resulting matrix back to a column vector.

              6. Extract the first  elements from this vector, wherein  =  .  represents the desired
                 block-Hankel size and  represents the number of transfer functions being modelled.

              At the end of Step 6, the product of the Hankel matrix and arbitrary vector is obtained.
          This is reused as an input for the Lanczos scheme which generates a new arbitrary vector
          in the subsequent iteration. Thus, the steps 1­6 are run in a loop within the main Lanczos
          scheme. These same steps can also be used for computing the product of the transpose of
          the Hankel matrix and the arbitrary vector. The only change is to account for the different
          dimensions of the arbitrary vector input from the Lanczos scheme in step 2. As a practical
          implementation, software code representing steps 1­6 is written in a plain-text file and used
          as functional-form inputs by the PROPACK scheme which implements the Lanczos iteration.

       4.4 Customisations for Battery Modelling

          Specific considerations are required for incorporating the Golyandina-Usevich algorithm in
          the ROM workflow for Li-ion batteries. The classical DRA architecture is set up to handle

                                                                 119

                                                                        4.4 Customisations for Battery Modelling

SIMO systems, wherein all transfer functions are derived by considering only a single input
viz. the applied battery current. Thus the Markov parameters form a 2D matrix wherein each
row corresponds to individual battery transfer functions with columns representing unit-
pulse response samples for each transfer function. The 2D moving-window illustrated in [139]
for Block-Hankel matrix formulation has to be suitably reshaped to account for this structure.
Step 3 of the algorithm deals with 2-D FFT computation of the Markov Parameter Matrix
(MPM). In this thesis author's implementation, this is pre-computed since it remains invariant
between iterations of the Hankel-vector product computation loop. This pre-allocation and
a priori computation contributes to overall code efficiency.

   PDE Model           linearize around  Linearized Laplace Transfer       Integrator Pole         Discrete-Time      State-Space Augment Integrator Reduced Order
                         given SOC, T    PDE Model Transform Functions  Removal (if present)  Realization Algorithm
(Doyle-Fuller-Newman)                                                                                                 Matrices   and Residues   Model (ROM)
                                                                                                        (DRA)

                       Continuous-Time                Continuous-Time                         Discrete-Time Unit      Ho-Kalman
                       Impulse Response                Step Response                            Pulse Response        Algorithm

                                                                                                 (Markov Parameters)

                                                  X^  Golyandina -      Hv                    PROPACK U, , V Extended Observability &

                                         2-D FFT      Usevich                                 (Lanczos SVD)           Controllability Matrices

                                                      Algorithm         H v

                                                                                                                                                              Max. System Order

Figure 4.3 Reduced Order Model (ROM) workflow using improved Discrete-Time Realisation
Algorithm (DRA).

    Figure 4.3 shows the ROM workflow with the improved DRA wherein all computational
bottlenecks highlighted by shaded blocks in fig. 4.1 have been eliminated. The strategy is to
first employ the (suitably modified) Golyandina-Usevich algorithm for describing the matrix-
vector multiplication routines. These two functions are then used as inputs to the PROPACK
codes. Eigentriplets up to the desired upper bound on system order is then computed using
a Lanczos SVD iteration. Figure 4.4 presents a comparison of singular values computed by
both the traditional and new methodologies. It is evident that the two sets of singular values
are identical. This proves that the new scheme can indeed serve as a drop-in replacement for
the classical DRA.

                                                                120

                 4.5 Simulation Results and Discussion

           103                                             Classical SVD
           102                                             Improved SVD

Magnitude  101

           100

           10-1

                    10-2
                               1 2 3 4 5 6 7 8 9 10
                                                          Singular Values

Figure 4.4 Comparison of singular values computed by the conventional and improved SVD
methods. Using the new scheme results in identical singular values

4.5 Simulation Results and Discussion

This section provides a quantitative demonstration of the reduced computational demand
of the improved DRA scheme by comparing it with the classical DRA implementation. The
physical parameters of the cell are the same as those published in Fuller et al. [16]. Table 4.1
lists the parameters used in the ROM workflow (same as those employed by Lee et al. [45]).

                 Table 4.1 Parameters for ROM Computation

           Initial Cell SOC                        60 %
                                                   8000
           Hankel Block Size                       1s
                                                   5
           Discrete-Time Model Sample-Rate,        128 Hz
           Number of Electrolyte EigenModes        10

           Continuous-Time Emulation Frequency, 1
           Desired Number of Singular Values

    Figure 4.5 shows a comparison of the memory usage of classical and improved DRA
methods. It is evident that the SVD step in classical DRA consumes an overwhelming majority
of the total memory demand, requiring 100 GB for a Hankel block size of 8000. This can be a
limiting factor in modelling slow cell dynamics without access to a large memory workstation.
The improved DRA method eliminates this bottleneck and the memory usage of SVD step is

                                                                 121

                        4.5 Simulation Results and Discussion

negligible. Overall memory usage of the improved DRA is dominated by Markov parameter
computation. Considering 10 GB of usable RAM, this means that 60000 Markov parameters
(Hankel Block-size of 30000) can be captured.

RAM Usage (GB)  100     Classical SVD Step
                 80     Overall (Classical DRA)
                 60     Improved SVD Step
                        Overall (Improved DRA)

                40

                                                                                Practical RAM Limit

                20

                0

                     0  5000 10000 15000 20000 25000

                        Number of Hankel Blocks

Figure 4.5 Memory usage of classical and improved DRA. Overall, RAM usage as well as the
memory used only for SVD computation is illustrated.

              Figure 4.6 shows a comparison of CPU times for computing the ROM at a single SOC
          and temperature for both the classical and the improved DRA methods§. Owing to the high
          operation count for the SVD computation (see eq. (4.2)), the classical DRA requires 40 min
          for a Hankel block size of 8000. Clearly, the overall CPU time for the classical DRA is almost
          exclusively spent for computing the SVD. The improved DRA method reduces the overall
          computational time by two orders of magnitude, taking 40 s for the same block-size. In this
          case, the CPU time is evenly split between the SVD and Markov parameter computations.

              From fig. 4.5, it is evident that if classical DRA is employed, a standard laptop with a
          nominal 10 GB RAM limit (dedicated for ROM workflow) cannot capture the full cell dynamics
          and hence is restricted to 2500 Hankel blocks. This necessitates early truncation of Markov
          parameters at 5000 s. From fig. 4.2, the truncation residue at 5000 s for the unit-pulse response
          of solid surface concentration at positive current collector is -0.0087 mol m-3. The truncation

                 § All computations reported in this chapter were performed on a dedicated high-RAM pool drawn from the
            compute cluster hosted at the Department of Mathematics at Imperial College London. The author of this thesis
            wishes to express his thankfulness to the relevant authorities for providing access to this facility. The resources
            borrowed were one core of a 4-core Intel® Xeon® E5-2637 v3 processor clocked at 3.50 GHz with 500 GB RAM.

                                                                122

                          4.5 Simulation Results and Discussion

CPU Time [mins]  100      Overall (Classical DRA)
                  10      Classical SVD Step
                    1     Overall (Improved DRA)
                          Improved SVD Step

                 0.1

                 0.01     2000 4000 6000 8000 10000 12000 14000
                       0                  Number of Hankel Blocks

Figure 4.6 Computation times for classical and improved DRA schemes

errors in the MPM directly translate to errors in computed singular values, adversely affecting
accuracy of simulated cell variables. It must be noted that the accuracy of simulation results
reported here does not bear a causal relationship to the particular DRA scheme employed. In
principle, when an upper bound on computational usage has not been enforced, the numerical
operations of both the existing and proposed DRA schemes lead to similar error magnitudes
for the modelled quantities. Instead, the accuracy comparison illustrated here primarily serves
to demonstrate the practical usefulness of the improved DRA scheme when implemented in
a commonplace computing environment.

    Figure 4.7 shows a comparison of singular values obtained by the classical and improved
SVD methods computed by imposing a RAM limit of 10 GB. Owing to early truncation of the
MPM, the dominant singular values computed by the conventional method differ significantly
from those computed by the improved SVD operating on untruncated data. With the same
memory constraints, the improved DRA can handle up to 30000 Hankel blocks, allowing for
capture of 60 000 s of Markov parameter data.

    For comparative analysis of modelling accuracy under this memory constraint, a time-
domain simulation of the ROMs obtained by classical and improved DRA methods is
performed. The input current profile corresponding to a Urban Dynamometer Driving

                                                                123

            4.5 Simulation Results and Discussion

       102  Classical DRA - 2110 Blocks
            Improved DRA - 30000 Blocks

       101

Value

       100

                        10-1

                                    1 2 3 4 5 6 7 8 9 10
                                                                    Singular Values

  Figure 4.7 Comparison of singular values computed by conventional and improved SVD
  methods under a practical RAM limit of 10 GB

Schedule (UDDS) drive cycle reported in Lee et al. [45] is used. Figure 4.8 depicts the time-
evolution of the solid surface concentration at the positive electrode/separator boundary.
For comparing the accuracy of the two ROMs, a COMSOL Multiphysics [140] simulation
of the full-order pseudo-2D porous-electrode PDAE model is used as the reference. The
ROM employing classical DRA diverges over time, and after 1500 s results in an error
of 1120 mol m-3. The ROM incorporating the new DRA workflow accurately tracks the
COMSOL simulation trend-line.

    Table 4.2 provides a summary of the key simulation results. At a single operating point
of SOC and temperature, for a Hankel block size of 8000, the ROM workflow incorporating
the improved DRA is 100 times faster than that employing the classical DRA. Using the
machine with specifications listed in the footnote§, for 100 operating points (combinations
of 10 SOC and temperature values), computing the ROM requires only 6 hours using the
improved DRA, whereas the classical DRA consumes 666 hours (27 days). Furthermore, for
the same block-size, the improved DRA is demonstrated to be superior in terms of memory
efficiency, drastically reducing the memory requirement from 112 GB down to 2 GB. Finally,
the improved DRA demonstrates superior modelling accuracy when implemented even in
moderately equipped computing environments such as laptops.

                                                                124

                                                           4.5 Simulation Results and Discussion

cs,e (Lneg + Lsep , t)[mol/m3]  12000

                                11000

                                10000       200  400                 COMSOL (Full Order Pseudo-2D)
                                 9000                                Classical DRA ROM - 2500 Hankel Blocks
                                         0                           Improved DRA ROM - 30000 Hankel Blocks

                                                           600 800 1000 1200 1400
                                                              Time [sec]

Figure 4.8 Time-domain simulation depicting solid surface concentrations at the boundary of
positive electrode and separator. The simulation results from the P2D model implemented in
COMSOL is used as the reference benchmark. The two ROMs were derived under a RAM limit
of 10 GB. The performance of the improved DRA is significantly better than the classical DRA
owing to the fact that its derivation could accommodate a larger number of Hankel blocks without
exceeding the specified memory limit.

                                Table 4.2 Salient Results -- Classical vs. Improved DRA

                                  ROM            Entity    Classical     Improved
                                Condition                    DRA           DRA

                                8000         Memory        111.80 GB     2.14 GB
                                Hankel                     97.93 GB      0.03 GB
                                Blocks        (overall)    39.78 min     0.63 min
                                                           39.30 min     0.14 min
                                             Memory

                                             (SVD step)

                                            CPU Time

                                              (overall)

                                            CPU Time

                                             (SVD step)

                                10 GB        Block Size    2500          30000
                                Memory       Max. error    1120 mol m-3  13 mol m-3
                                Limit       in ,pos (1, )

                                                                125

                                                                       4.5 Simulation Results and Discussion
              This chapter concludes with the view that, although the bottlenecks in Lee et al. [45]
          revealed by this in-depth analysis have been effectively tackled in this chapter, owing to the
          circular dependency between the linearisation point and model parameters, the underlying
          model itself is not robust enough for immediate implementation. Furthermore, the model
          derivation is convoluted with the derivation being performed in the frequency domain and
          implementation in the time-domain. This thesis author is of the opinion that a simple, yet
          accurate model derived and implemented entirely in time-domain is the need of the hour for
          encouraging the automotive industry to adapt physics-based battery models onto on-board
          Battery Management Systems (BMSs) of electric vehicles. In the quest to fulfil this need, an
          analysis of the simplest time-domain Physics-Based Model (PBM) viz. the Single Particle
          Model (SPM) is presented next in chapter 5.

                                                                126

         5

      Performance Evaluation of State of the
               Art in Single Particle Modelling

              5.1 The conventional Single Particle Model (SPM) . . . . . . . . . . . . . . . . . . 128
              5.2 SPM Model Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
              5.3 Numerical Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
              5.4 Desktop Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
              5.5 Towards Enhancing the Conventional SPM . . . . . . . . . . . . . . . . . . . . 175
              5.6 Quadratic Approximation of Ionic Spatial Concentration . . . . . . . . . . . . 184

   Taking into account the relative strengths and weaknesses of all the physics-based
                reduced order modelling families in the literature considered (see chapter 2), the
          overarching simplicity of the Single Particle Model (SPM) coupled with its immediate
          potential to bring the power of physics-based predictions to an embedded environment is a
          strong motivation to pursue an in-depth exploration of its horizons. This chapter discusses
          the performance of multiple SPM variants, ranging from basic to sophisticated. The governing

                                                                127

                                                        5.1 The conventional Single Particle Model (SPM)

          equations of the conventional SPM are first introduced and its baseline performance is
          evaluated. Next, an in-depth analysis of the basic SPM's drawbacks is performed. Various
          published attempts to mitigate their current challenges towards implementability is presented
          and their inadequacies discussed. Owing to its simplicity and latent potential, a popular
          modelling strategy from the existing art that aims to enhance the performance of the basic
          SPM through incorporation of electrolyte dynamics, is chosen for further analysis. The
          chapter concludes with the author's critical comments on its relative merits that come to view
          through comparison against a benchmark model, whilst simultaneously identifying its critical
          weakness whose mitigation forms the focal point of the research discussed in chapter 6.

       5.1 The conventional Single Particle Model (SPM)

          Reducing the number of computational dimensions in a physical model helps in formulating
          their low order approximations, thereby facilitating fast evaluations of the modelled quantities.
          The SPM, originally used in modelling the Metal-Hydride chemistry [84] and later on adapted
          for Li-ion cells [85], represents the canonical apogee of such dimension-reduction strategies.

              During the initial years following its inception, the formulation of the basic SPM was
          discussed extensively within application-specific contexts such as State of Charge (SOC)
          evaluation [141, 142], parameter estimation [143], and life cycle/ageing predictions [144, 145].
          There have also been detailed stand-alone publications discussing various facets of the basic
          SPM, such as its inherent assumptions and governing equations [96, 146]. The basic SPM
          suffers from certain major drawbacks which are discussed in the simulation results presented
          in section 5.4.3. Since the turn of the decade, researchers have attempted to tackle many of
          these issues and a holistic discussion of such efforts is presented in section 5.5.

              A survey of the most recent literature dealing with the SPM family of models reveals a
          diminishing rate of advancement in quantifiable improvements to the underlying plant model
          itself. This nearly-static trend can be attributed to the general consensus within the research
          community that these models may be too simplistic and not of suitable accuracy to warrant
          further studies. Other than a small minority of papers that either propose core modelling
          improvements to tackle their inaccuracies, or add new enhancements such as mechanical-
          stress physics [147, 148], latest work in this family of models predominantly pertains to
          their application in areas like state estimation [149­153], optimal charging [154, 155], cycling

                                                                128

                                                                                    5.2 SPM Model Development

          performance [156], conversion to equivalent circuits [157], parametrisation [158­161], pack-
          balancing studies [162] and observer design for joint state-parameter estimation [163]. The
          SPM approach was also extended to the case of composite electrodes, leading to a state
          estimator design after basic observablity analysis [164]. Owing to their simplicity, this author
          believes that SPMs hold the highest potential to bring a Physics-Based Model (PBM) to
          embedded Battery Management Systems (BMSs). With this goal in view, this thesis seeks
          to resurrect interest in this field by addressing the recent paucity in fundamental modelling
          improvements. However, prior to doing this, a complete analysis identifying the strengths
          and weaknesses of the salient models within the SPM family is warranted.

       5.2 SPM Model Development

          In order to establish a context for the author's work to be discussed in chapter 6, it is
          imperative to provide a holistic presentation of the basic SPM modelling art. The conventional
          SPM is the simplest of all time domain PBMs. The rest of this section provides this author's
          digested summary of its modelling rubrics based upon the keen insights gained from perusing
          the vanguard literature in this topic [96, 141, 165] as well as their relevant derivative works.

        5.2.1 Geometry

          A description of the working principle of the cell was presented in section 1.1 and is
          not repeated here. The SPM aims to capture the electrochemical phenomena along the
          thickness ,   {neg, pos} of each porous electrode by a representative spherical particle.
          Thus the two distinct solid phase porous regions of the cell i.e., the negative and positive
          electrode regions, are idealised as two spheres of radii neg and pos respectively.

              Figure 5.1 shows the geometrical origins of the basic SPM. In this arrangement, the spatial
          dimension along the axial thickness of each electrode degenerates to a single point which is
          represented by a sphere. Hence, the concentration of lithium within each electrode s,
         {neg, pos} is only a function of the radial position ,   {neg, pos} and the time . The surface
          area of each representative sphere is scaled appropriately, such that they are equivalent to the
          active area of the corresponding porous electrodes. Thus the SPM accounts for the reduced
          volume-fraction arising due to the microporous structure of the solid phase and hence, the
          storage capacity of the representative particles match that of the corresponding electrodes.

                                                                129

                                                                                    5.2 SPM Model Development
          The overarching assumption of the SPM modelling philosophy is that the electrochemical
          performance of these representative electrodes are sufficient to model the behaviour of the
          cell at its terminals. The SPM thus employs the coarsest possible spatial discretisation of the
          cell's thickness with the goal of minimising computational burden.

              Figure 5.1 Schematic illustration depicting the geometrical origins of the basic SPM. The model
              is obtained through a degenerate spatial discretisation of one electrochemical layer of a pouch
              cell. The active material of each porous electrode is represented by one representative spherical
              particle, thus entirely eliminating the spatial dimension along the axial direction. Illustration
              reproduced from Moura et al. [40].

        5.2.2 Scope and Assumptions

          Having described the geometrical representation of the model, it is imperative to establish
          its aims and scope. This section discusses the subset of physical phenomena that can be
          captured by the basic SPM and enumerates the inherent assumptions in model derivation.
          The validity of these assumptions and their effects on model accuracy shall be examined in
          the results presented in section 5.4.3. As a broad outline of its scope, the model attributes the

                                                                130

                                                                                    5.2 SPM Model Development

          cell polarisation to two dominant physics viz. reaction kinetics and solid phase transport
          phenomena i.e., diffusion dynamics.

              The SPM assumes that charge transfer happens throughout the surface of each represent-
          ative spherical particle where intercalation occurs. The electronic conductivity of the solid
          phase is assumed to be high enough to ignore the spatial distribution of charge i.e., the local
          volumetric current density is assumed to be uniform along the thickness of each porous
          electrode. This assumption is motivated by the early calculations performed by Newman
          and Tobias [166] in their stand-alone analysis of current distributions in porous electrodes,
          wherein a volume-averaged molar flux was deemed sufficient throughout the thickness of
          the electrode. This uniform current density assumption implies that all of the particles in
          the electrode active material are in parallel. Solid phase diffusion dynamics within each
          electrode are therefore solved by assuming this averaged electrochemical reaction rate. In
          the simulation study by Smith and Wang [32], it is reported that soon after the beginning
          of discharge, solid phase concentration and ionic flux become nearly independent of spatial
          position, and that lithium diffusion in solid particles may be driven by an averaged molar flux
          at the surface.

              Based on the discussion thus far, it is clear that the SPM does not attempt to model all
          physical processes within the cell. In particular, the model assumes instantaneous charge
          transport from one electrode to the other through the solution phase. This implies that
          electrolytic diffusion is sufficiently fast (relative to diffusion in the solid phase). Thus, mass
          transport phenomena in the electrolyte have been neglected in the basic SPM.

              During the operation of the cell, the SPM assumes that the electrolyte concentration e
          remains constant at its equilibrium initial value e,0 throughout the cell thickness. Neglecting
          local concentration gradients in the solution phase, together with ignoring its mass transport
          phenomena, implies that the current in the electrolyte does not vary over space and time.
          Hence, in the conventional SPM there is no contribution of the solution phase to internal
          overpotentials i.e., electrolyte dynamics have no influence on the cell's terminal voltage. The
          SPM also ignores any variations in material porosities in each electrode. Furthermore, all
          solid phase diffusivities and kinetic parameters are held constant. Finally, all thermal effects
          are assumed to be negligible and no degradation effects are attempted to be modelled in the
          basic SPM formulation.

                                                                 131

                                                        5.2 SPM Model Development

    These simplifying assumptions are made so as to facilitate the ease of implementing a
PBM, without incurring the heavy computational cost that typically accompanies it. The
impact of these assumptions on the accuracy of the model shall be examined in section 5.4.3
and later sections presents prior research that strives to straddle the fine balance between
model sophistication and computational complexity.

5.2.3 Governing Equations

As discussed in section 5.2.2, the SPM captures the cell's dynamics arising due to diffusion and
kinetics at the two representative spherical electrodes. It also accounts for the contribution
of their equilibrium thermodynamics to the cell's Open Circuit Potential (OCP).

Solid Phase Diffusion

Conservation of Li0 in the electrodes can be obtained by assuming that the movement of
neutral atoms within the solid phase is primarily due to diffusion within particles. This
diffusion phenomena is induced due to a concentration gradient that exists between the
surface and interior/core of the solid phase particles. Based on the geometrical assumptions
of the SPM as discussed in section 5.2.1 i.e., owing to the lack of spatial discretisation in
the axial direction , the concentrations of Li0 in the two electrodes s(, , ), reduce to
a function of the radial co-ordinate  and time , and is denoted by s(, ),   {neg, pos}.
To keep the notation tractable, this explicit spatio-temporal radial dependence is omitted,
further simplifying the representation to s. We start with the derivation of the solid-phase
diffusion equation eq. (1.3) in table 1.1, and then proceed to the simplifications of its boundary
conditions facilitated by the SPM assumptions.

Diffusion in the solid phase can be modelled by applying classical Fickian dynamics [66]

given by

                          s   =  (s s )         {neg, pos}                              (5.1)


The divergence of a vector field F(, , ) can be expressed in spherical co-ordinates as

          F            =  1    (2)  +    1     (sin  )  +    1                          (5.2)
                           2            sin                 sin

                                                                132

                           5.2 SPM Model Development

where  denotes the radius,  the polar angle, and  the azimuthal angle. ,  and  denote
the corresponding components of the vector field F.

    The co-ordinate origin at each electrode is aligned with the centre of its representative
spherical particle. Due to symmetry in the polar and azimuthal axes, the divergence becomes
a function of only the radial position. Equation (5.2) therefore reduces to

F     =   1    (2)                                                                  (5.3)
           2

Applying the Right-Hand Side (RHS) of the divergence operator of eq. (5.3) in eq. (5.1) yields

s  =  1       (  2s  s  )                                                           (5.4)
       2

As per the assumption of uniform diffusivity in the solid phase, eq. (5.4) becomes

s  =  s       ( 2s )                                                                (5.5)
       2

Applying the gradient operator of eq. (5.5) along the radial direction ,

s  =  s       ( 2   s )                                                             (5.6)
       2

Equation (5.6) represents a mass-balance equation describing solid phase diffusion in each

electrode and is identical to the governing equation eq. (1.3) from table 1.1. The potential at
each electrode depends on the solid phase surface concentration s,surf i.e., the Li0 concentra-
tion s (, ) evaluated at  = p ,   {neg, pos} where p represents the equivalent radius of
each representative spherical particle.

Due to spherical symmetry, flux at the centre of the particle is considered to be zero.

      (  s    )= 0                                                                  (5.7)

               =0

              Diffusion in the solid phase is driven by concentration gradients induced due to intercala-
          tion flux density at the particle surface i.e., the surface of each particle experiences a pore-wall
          flux density driven by reaction kinetics. Based on the SPM geometry discussed in section 5.2.1,

                                                                133

                                                           5.2 SPM Model Development

the spatial dependence of this molar flux density n(, ) is eliminated and it can therefore be
represented as n(),   {neg, pos}. For the sake of brevity, its explicit temporal dependence
is also omitted resulting in a simplified notation n. Hence, at the particle surface

                                        s    ( s    )= -n               (5.8)

                                                     =p

The sign convention chosen here is such that pore-wall flux leaving the particle surface is
considered to be positive.

    Charge conservation in solid phase is applied to evaluate the RHS in eq. (5.8), a detailed
derivation of which is presented in Domenico et al. [165]. In summary, by assuming a uniform
charge density throughout the thickness of each electrode (see section 5.2.2), we get

                                                ()
   n () = ±  s                                              (neg, pos)  (5.9)

Substituting eq. (5.9) in eq. (5.8)

s  (  s                                 )=                  (neg, pos)  (5.10)
                                               s
                                         =p

wherein the load current  () > 0 for discharge, whose explicit time-dependence has been
omitted in eq. (5.10) for being consistent notation with the Left-Hand Side (LHS). The positive
and negative signs apply to the negative and positive electrode respectively as indicated
by the ordered pair   (neg, pos). It should be noted that the term involving the Faraday
constant in the RHS of eq. (5.9) is , where  is the number of electrons transferred during
the reaction. However, since this thesis only discusses lithium-ion chemistries where  = 1,
this is implicitly conveyed and shall be omitted for all potential occurrences.

    The SOC of the cell can be obtained from the bulk concentration of lithium in either the
negative or positive electrode. By convention, the negative electrode is used.

 ( )                                 =      3       pneg  2s,neg(, )    (5.11)
                                        s,maxneg


                                                   0

                                                                134

                                                                          5.2 SPM Model Development

Given an initial cell SOC (0) = 0 at rest, the equilibrium concentration of Li0 in the two
individual electrodes can be computed as

s ( , 0) = s,max [0 (100% - 0% ) + 0% ]                               (5.12)

    Equation (5.6), its corresponding boundary conditions (5.7) and (5.10) along with initial
condition (5.12), provide the complete description of time-domain evolution of lithium in
the conventional SPM for a given applied current profile  (). Considerations for efficient
numerical simulation of this system is presented next.

Further Reduction in Dimensionality

A naive approach to numerically solving the solid phase diffusion equation is to discretise each
of the two representative particles in the radial direction . Given the elaborate simplifications
made to remove spatial resolution from the axial direction, the efficacy of using a radial
discretisation is rendered questionable, particularly within the scope of embedding the model
in an online simulation and state-estimation environment. Since diffusion in each spherical
particle is modelled by the well-known Fickian dynamics [66], several attempts have been
made to obtain an approximate analytical solution for the solid phase concentration in both
electrodes. In a dimensionless analysis study, Zhang and White [167] provide a comparative
evaluation of the various approximation methods for solid phase diffusion, a summary of
which is presented in table 5.1.

                Table 5.1 Summary of approximation methods for solid phase diffusion

Approximation Method                 Introduced by

Duhamel's superposition              Doyle, Fuller & Newman [15, 16]
Diffusion length                     Wang et al. [168]
Corrected Diffusion length           Wang and Srinivasan [169]
Polynomial approximation             Subramanian et al. [77, 170]
Pseudo steady-state                  Liu [80]

              In the aforementioned study, the computational burden i.e., storage requirements and
          Central Processing Unit (CPU) times of Duhamel's superposition method was found to
          be excessively high to warrant further interest in it. The original diffusion length method
          proposed by Wang et al. is valid only after the diffusion layer builds up to its steady state,

                                                                135

                                               5.2 SPM Model Development

and hence leads to significant errors in transient conditions. Although Wang and Srinivasan
introduced an empirical correction factor to the diffusion length to extend its validity to short-
time scale operations, this affected the convergence of the method for steady state conditions.
The pseudo steady state solution proposed by Liu uses a finite integral transform technique
to eliminate the radial dependence of solid phase concentration. However, this method uses
computations involving infinite summations, exponential and trigonometric quantities, which
in this thesis author's view, makes it less attractive for online implementations.

    The literature on polynomial methods by Subramanian et al. [77] provide detailed
derivations of the 2nd and 4th order polynomial approximations. The 2nd order solution
was found to have poor performance for transient behaviour, similar to that of the original
diffusion length method. However, higher order polynomial approximations were found to
provide acceptable levels of performance for both transient and steady state conditions and
shall therefore be examined further.

The polynomial approximation method describes the dynamic evolution of the volume

averaged concentration

                                      1                    (5.13)
                        s,avg () =   s ( , )



as a function of the applied load current  (). Here,  represents the volume of the spherical

particle. For notational brevity, s,avg () is shortened to s whilst also dropping its explicit
time dependence.

    The 4th order polynomial approximation assumes that the solid phase concentra-
tion s(, ) is a quartic function of the radial co-ordinate .

                          2                      4

                                                           (5.14)
                        s (, ) = () + () ( p ) + () ( p )

    The detailed derivation of the coefficients (), () and () is provided in Sub-
ramanian et al. [77]. Eqs. (5.15)­(5.17) summarise the governing equations obtained by
applying the 4th order polynomial approximation of eq. (5.14) to the system of equations

                                                                136

                                                                     5.2 SPM Model Development

given by eqs. (5.6), (5.7) and (5.10).

                                                         + 3 n    =0       (5.15)
                                                     s       p             (5.16)
                                                                           (5.17)
                                          +  30  s        45  n   =0
                                                 p2   + 2     p2

35  s                                   (s,surf  -  s )  -  8s    =  -n
    p

where () represents the volume averaged concentration flux, that defines the average
change of concentration with respect to the radial position .

    As per eq. (5.9), the interfacial flux density is proportional to the applied current. Hence
eq. (5.15) implies a simple linear relationship between the applied current and the rate of
evolution of average Li0 concentration within each spherical particle. This further implies
that the SOC of the cell has a linear rate-dependence on the externally applied current.
Furthermore, due to the elimination of radial discretisation, the computation of SOC, given
by eq. (5.11), reduces to the task of first computing the ratio of bulk (average) concentration
to surface concentration and then adjusting it to account for the useable stoichiometry limits
for the relevant electrode. Thus, the cell's SOC can be computed as

                                               s,neg   - 0%neg
                                             s,maxneg
                                         =                                 (5.18)
                                             100%neg - 0%neg

where s,neg is obtained by solving eq. (5.15) for the negative electrode.

    In the views of this author, this 4th order polynomial approximation proposed by
Subramanian et al. [77] strikes an acceptable balance between the three modelling pivots
-- i) computational complexity, ii) mathematical tractability, and iii) numerical accuracy and
has therefore been adopted for all SPM simulations presented in this work.

    At the end of this dimension-reduction step, spatial dependence is completely eliminated,
yielding a zero-order (in space) physical model whose dynamics are described by the
Differential Algebraic Equation (DAE) system of eqs. (5.15)­(5.17).

                                                                137

                                                               5.2 SPM Model Development

Equilibrium Thermodynamics

The equilibrium potential of a porous electrode is a thermodynamic property that depends on

the extent of lithiation in the outermost interstitial sites near the Solid-Electrolyte Interphase

(SEI) layer. This surface stoichiometry  for an electrode is obtained by computing the
surface concentration (using eq. (5.17)) and dividing by the maximum lithiation capacity of

that electrode.                            s,surf
                                           s,max
                                        =                              (5.19)

    Although based upon the theoretical foundation laid out by the Nernst equation, owing
to a multitude of complex phase transitions, the potential of porous electrodes (with respect
to metallic lithium) is usually given as empirical functions of its surface stoichiometry [4, 8].

                            () =  (())                                 (5.20)

where the empirical relationships  are typically high order polynomials or rational func-
tions that are fitted to relaxation data from Galvanostatic Intermittent Titration Technique
(GITT) experiments on half-cells [14, 171].

    In the SPM, the cell's OCP is obtained by subtracting the negative electrode equilibrium
potential neg from its positive electrode counterpart pos.

                            ocp = pos - neg                            (5.21)

Even though the concept of OCP is defined only in equilibrium conditions when no current
flows, the individual electrode potentials themselves form a significant component of the
cell's terminal voltage  ().

Reaction Kinetics

In the SPM, the reaction kinetics in each spherical electrode is modelled using the Butler-
Volmer expression (see eq. (1.7)).

                   n  =  0          (1  - )      )  -  exp  (  -   )]  (5.22)
                            [exp (

                                                                138

                                                               5.2 SPM Model Development

where

                0         =  r e1-s,surf  (s,max    -             1-                     (5.23)

                                                       s,surf )

    The equilibrium rate of forward and backward reactions at both electrodes is assumed to
be equal. With charge transfer coefficient  = 0.5, eq. (5.22) simplifies to

             n         =  2r es,surf     (s,max  -  s,surf  )  sinh   (     )            (5.24)
                                                                         2

    The expression for overpotential  can be obtained rearranging by eq. (5.24) whilst
substituting for n from by eq. (5.9) and is given by

                2         sinh-1                       ± ()

        ( )  =                                                                           (5.25)

                                    2  s    r es,surf       (s,max       -  s,surf  )

Cell Terminal Voltage

The terminal voltage of the cell under applied load is obtained by subtracting the potential
of the negative electrode from its positive counterpart.

Starting from the definition of the overpotential of each electrode

                                                       0                                 (5.26)
                             pos = s,pos - e¨,po¨B ¨s - pos                              (5.27)

                                                  ¨

                                                       0
                             neg = s,neg - e¨,ne¨B ¨g - neg

                                                   ¨

Within each electrode domain, the contribution of electrolyte potential is neglected (see
sections 5.2.1 and 5.2.2 for a brief discussion on the exclusion of electrolyte dynamics).

Subtracting eq. (5.27) from eq. (5.26),

                       pos - neg = s,po s - s,neg -pos + neg                             (5.28)

                                                   cell

                                                                139

                                                        5.2 SPM Model Development

whose rearrangement yields

                                   cell = pos - neg + pos - neg                             (5.29)

In the basic SPM, eq. (5.29) is used to compute the cell's terminal voltage under load. Although
their explicit time-dependence notation is omitted in the notation here, it is worth reminding
that all quantities in eq. (5.29) are indeed continuous functions of time.

State Space Representation

For control oriented applications, it is imperative to have a classical state space representation
that collates all intermediate equations and definitions presented thus far into a single system
of equations that describes the evolution of solid concentration and terminal voltage over
time, expressed as a response to the external current input  (). However, the non-linearities
in the equation for terminal voltage i.e., eq. (5.29) imply that it is not possible to represent
the SPM in the form of a classical Linear Time-Invariant (LTI) system of eq. (2.1). Instead,
the SPM can be summarised by a system of linear state equations together with the single
non-linear output equation.

  Rearranging eqs. (5.16) and (5.17), the state equation is obtained as

    pos        -30  s,pos       0      0     0        pos          45              1
                    p2pos                                          2     p2pos  poss,pos

                                s,neg
                                p2neg
     neg            0      -30         0     0          neg        45             -1
                                                             +     2     p2neg  negs,neg    ()

            =

   s,pos            0           0      0     0        s,pos                3

                                                                         ppos  poss,pos

   s,neg       0                0      0     0        s,neg              -3

                                                                  pne g negs,neg

                                                                                            (5.30)

which corresponds to the classical LTI form

                                       x =  x +  u                                          (5.31)

where x = [ pos neg s,pos s,neg ],   4×1 is the state vector. The scalar system input u
 is the applied current  (). The system matrix   4×4 and input matrix   4×1 are also

shown in eq. (5.30).

                                                                140

                                                                        5.2 SPM Model Development

    For state estimation and controller design purposes, it is important to keep the number
of elements in the state vector as small as possible by eliminating redundant variables. For
instance, Di Dominico et al. [165] noted that with output voltage as the only measured quantity,
the observablity of the four-state model of eq. (5.30) is adversely affected. To tackle this issue,
a state-reduction approach was proposed by Di Domenico et al. [165], which hinges upon the
principle of material balance.

The total number of moles of lithium in the system is given by

Li     =   s,pos pos         ppos  42s,pos(, )         +  s,neg neg       pneg  42s,neg(, )            (5.32)

           4    p3pos                                       4    p3neg
           3                                                3
                            0                                            0

Upon considering only the bulk concentration as per the dimensionality reduction procedure
outlined in section 5.2.3, eq. (5.32) reduces to

       Li  =  s,pos pos        s,pos    ppos  4  2     +  s,neg neg     s,neg    pneg   4  2           (5.33)
                                                                                                       (5.34)
                  4   p3pos                                 4    p3neg
                  3                                         3
                                       0                                        0

           = s,pos pos  s,pos + s,neg neg  s,neg

Assuming no loss of cycleable lithium or other degradation mechanisms, the total number of

moles  of  lithium   in  the  system  is  conserved  i.e.,   Li  =  0.  Substituting  this  into  eq.  (5.33),


                                                                                                       (5.35)
                               0 =  s,pos pos  s,pos +  s,neg neg  s,neg                               (5.36)


                        s,pos = -  s,neg

    As per eq. (5.36), the time evolution of the bulk concentration of one electrode can be
obtained as a function of the other. Furthermore, Di Domenico et al. [165] show that the
diffusion dynamics of the bulk concentrations can be algebraically related through their
stoichiometric factors as

       s,pos ( )  =  s,maxpos  [    s,neg() - 0%neg s,maxneg     (100%pos  -   0%pos )  +   0%pos ]    (5.37)
                                   (100%neg - 0%neg ) s,maxneg

                                                                 141

                                                                            5.2 SPM Model Development

    Hence, it is possible to eliminate the bulk concentration of any one of the electrodes from
the state-equation to arrive at a three-state description of the model dynamics. In extant
lithium-ion chemistries, owing to its proclivity for lithium deposition during charging, the
negative electrode is considered to be the limiting electrode (See Arora et al. [25]). Hence it
is retained in the state vector, thereby leading to the final form of the state dynamics of the
conventional SPM as

    pos           -30     s,pos       0      0          pos                 45            1
                          p2pos                                             2   p2pos  poss,pos

                                      s,neg
                                      p2neg
     neg       =  0              -30         0            neg          +    45           -1         ()     (5.38)
                                                                            2   p2neg  negs,neg

   s,neg          0                   0      0          s,neg                        -3

                                                                           pne g negs,neg



    The measured variable    is the cell's terminal voltage  () and is expressed as a
non-linear scalar function of the state vector and the load current.

                                              =  (x(), ())                                                 (5.39)

The output equation given by eq. (5.39) includes a non-zero direct feedthrough dependency
of the voltage on the input current, thereby modelling the resistive component of the cell's
impedance. The full expression for output voltage is given by expanding eq. (5.29) as

             2    sinh-1                                  - ()

cell ( )  =

                            2pos  s,pos      rpos  e  s,surfpos  (  )  (s,maxpos  -  s,surfpos  (  ))

             2    sinh-1                                      ()
                                 negs,neg rneg es,surfneg ()
          -

                            2                                          (s,maxneg  -    s,surfneg  (  ))

                                                   + pos (s,surfpos ()) - neg (s,surfneg ()) (5.40)

                                                                142

                                                5.3 Numerical Implementation

wherein the solid phase surface concentration at each electrode s,surf is obtained from its
corresponding bulk concentration s,avg by rearranging eq. (5.17) and is given by

s,surfpos  =  s,pos           +  8ppos  pos  +           ppos      ()  (5.41)
                                   35           35s,pos poss,pos       (5.42)

s,surfneg  =  s,neg           +  8pneg  neg  -           pneg      ()
                                   35           35s,neg negs,neg

where  () > 0 for discharge.

    Given the initial SOC of the cell (0), the initial bulk concentration of the negative
electrode at equilibrium s,neg(0) is obtained by eq. (5.12). The initial value of the mean radial
concentration flux in both electrodes is zero i.e., (0) = 0. Therefore, the initial state vector
is [ 0 0 s,neg(0) ]. Thus, the system of equations given by eqs. (5.37)­(5.42) form a complete
state-space representation of the conventional SPM. This state-space model can be simulated
as a standalone Initial Value Problem (IVP) or embedded as the plant model in control-oriented
applications such as for dynamic state estimation.

5.3 Numerical Implementation

The equations presented in section 5.2 are well-known, self-sufficient and fully descriptive so
as to implement the basic SPM. Although discrete-time numerical implementation of circuit-
oriented cell models has been considered [11, 172­174], there has been no such treatment of
this critical aspect in the SPM modelling literature. Since this thesis has a strong focus towards
enabling the use of PBMs in an embedded environment, at least the numerical aspects of
implementing these equations need to be discussed. The finer details and practical engineering
considerations of real-time programming, in particular the integration of the cell model into
the pack, interaction with upstream components and other such aspects of a typical vehicular
drivetrain controller, are beyond the scope of this academic work. Nevertheless, the discussion
here aims to lower the barrier to real-time implementation and is a unique contribution in
the implementation context of cell models.

                                                                143

                                      5.3 Numerical Implementation

5.3.1 Continuous-time Implementation

Analytical solution

Although not explicitly given in SPM literature, using LTI system theory, the analytical
solution for continuous-time state equation (eq. (2.1)) with current input is given by

                                                                                         (5.43)
                                                                                         (5.44)
                                x() = (-0)x(0) +  (-)u( )

                                                                          0

With a standard IVP, 0 = 0



                                x() = x(0) +  (-)u( )
                                                      0

                                                                   convolution integral

The matrix exponential  is known as the state-transition matrix and is defined as

                        -1 {( - )-1}                                                     (5.45)

          although several methods exist for its efficient numeric computation [175].

              The analytical solution given by eq. (5.44) can be applied to obtain the matrix-vector state
          equation eq. (5.38) of the SPM. Once the state variables are obtained at a given time-step, after
          evaluating the surface concentrations as per eq. (5.41) and eq. (5.42), they may be substituted
          into the output equation of eq. (5.40) to obtain the cell's terminal voltage for that time-step.

          Numerical considerations for continuous time implementation

          The procedure described thus far has a practical limitation. The input current  () to the cell
          has been defined as a continuous quantity. Although for the purpose of characterising the
          cell's behaviour, it is possible to use pre-determined continuous-functions as load profiles
          (e.g. sinusoidal waveforms for virtual Electrochemical Impedance Spectroscopy (EIS) testing),
          it is desirable to evaluate the model's response to typical real-life conditions. In a vehicular
          application, only samples of cell current measured by sensors at discrete-time intervals are

                  The analytical closed form solution cannot be obtained for constant voltage operation. This is because the
            boundary flux is implicitly determined by the non-linear Butler-Volmer equation eq. (1.7) and needs to be solved
            numerically with some variant of a Newton-type iteration scheme.

                                                                144

                                                                                 5.3 Numerical Implementation

          reported to the BMS. A Zero Order Hold (ZOH) operation is used at the model's input i.e., the
          level of current is assumed to be held constant between two successive measurements.

              It is tedious to hand-compute the convolution integral of eq. (5.44). However, a variety of
          state of the art adaptive-time solvers employing numerical schemes such as Dormand-Prince,
          Runge-Kutta, Collocation and Backward Differentiation Formula are available to efficiently
          handle such Ordinary Differential Equations (ODEs). Since lithium concentrations vary
          smoothly over time without abrupt discontinuities, a standard non-stiff solver of moderate
          order shall suffice. A single line of code using MATLAB's ode45 solver can implement this
          time integration e.g.
          [~,x_new] = ode45(@(t,x) stateEqn(x,Ik,spm_params), t_span, x_old);

              Since the direction of applied current is susceptible to sudden reversals, (e.g. due to
          acceleration and braking events in a vehicular application), the solver needs to be stopped
          and re-started every sample period. Algorithm 5.1 shows the sequence of operations for a
          desktop simulation of the continuous time SPM on a digital computer. The source code listing
          of an example implementation in MATLAB is provided in listing A.1.

              In the author's view, the continuous time SPM algorithm has limited practical use.
          Computing the convolution integral or deploying ODE solver codes onto a microcontroller is
          challenging and introduces substantial computational burden. Although the continuous time
          model can be used for desktop simulation, more sophisticated PBMs are already available for
          this task. Therefore, for online deployment in state estimation and control tasks, a discrete-
          time version of the model suitable for real-time implementation is needed.

        5.3.2 Conceptual Overview of Real-Time Processing

          The equations in section 5.2.3 are derived in continuous time form. In particular, the state
          equation given by eq. (5.38) describes the continuous time dynamic evolution of quantities
          such as the bulk concentration and rate of mean radial flux. However, a typical embedded
          controller such as that used in a vehicular BMS operates in discrete-time [3]. This implies
          that samples of voltage, current and temperature measurements are obtained at a periodic
          time interval . The updating of solution variables are performed between two successive
          data acquisition events from the sensors.

                                                                145

                                                                     5.3 Numerical Implementation

Algorithm 5.1 Continuous-time SPM

Require: Load profile                                                                              e.g. a csv file of  vs. C-rate

Require: SPM parameter set                                                                         e.g. stored in a struct params

User data: [1], f,user, f,condition, cell capacity 1C, sample rate                                        f,condition  {max, min}
Ensure: [1], cell[1] within limits                                                                 index [ = 1]  time ( = 0)

  1: procedure SimulateSPM

2:   f,desired = {max(f,user, f,profile), if f,condition == max;                                   may terminate early due to

             min(f,user, f,profile), otherwise.                                                   cut-off violations

     Note: Flexible end time. Extrapolate last C-rate from profile until f,desired if necessary.

3:   max      f,desired  +  1                                         max iterations assuming no cut-offs



4: Allocate storage of size max×1 for each simulation variable

5: Compute s,neg[1] as per eq. (5.12)                                                              C-rate[1] from profile
6:  [1]  1C × C-rate[1], x[1]  [ 0 0 s,neg[1] ]

7: cell[1]  ComputeCellVoltage(x[1],  [1], params)                                                 from direct feedthrough

8: for   2  max do

9:    []  interpolate from profile using ZOH

10:  Solve continuous-time equation eq. (5.38)                                                     solver IC set to [ - 1]

11:  x[]  last time-entry vector of soln. matrix  from an adaptive solver e.g. MATLAB's ode45

12:  Compute [] as per eq. (5.18)

13:  cell  ComputeCellVoltage(x[],  [], param)

14:  if [] or cell[] exceeded cut-off limits then

15:          - 1                                                                                   data from last step is invalid

16:       break;

17:  end if

18: end for
19: end procedure
20: subroutine ComputeCellVoltage(x, I, params)

21: Compute s,surfneg as per eq. (5.42)             consider saturating i.e., s,minneg  s,surfneg  s,maxneg

22: Compute s,pos as per eq. (5.37)

23: Compute s,surfpos as per eq. (5.41)

24: Compute cell as per eq. (5.40)                                    resume suspended line in SimulateSPM
25: return cell

                                                                146

                                                       5.3 Numerical Implementation

    Execution of control-oriented reduced-order PBMs such as the SPM and their associated
computations are modular sub-tasks of a vehicular BMS. A single BMS often provides a
whole host of other auxiliary functionality such as cell balancing, protection, diagnostics
and data-logging [13]. Although thermal management tasks are typically delegated to
dedicated controllers, the BMS software routines often handle data exchanged between
various subsystems on the vehicular communication bus. While some of these tasks such as
book-keeping and diagnostics can be performed at a low execution-rate, others such as cell
measurements and model-related computations need to be performed with high priority.

    Figure 5.2 shows an example of a plausible implementation of a BMS software in an em-
bedded microcontroller. The vast array of functionality performed by the BMS can be grouped
and managed as two separate processes -- i) a background thread, and ii) a foreground thread.
The background thread runs continuously within the main loop sequentially processing

(a) background process (low priority)                  (b) foreground processes (high priority)

Initialise: SOC & other global variables               begin Interrupt Service Routine ()
Ensure: voltage, current & temperature limits             read new sensor data from ADC
                                                          function ComputeSPM(-1, params)
   procedure Main()                                           evaluate spm model equations
       configure interrupts
       enable timers                                          compute model output voltage
                                                              function SOCEstimator(model,meas)
       while True do  until "key off" or shutdown                 state estimation subroutine
           background task #1  diagnostics/protection
           background task #2  canbus communication           end function
                                                              function ICEControl()
           if needs_balancing == 1 then
              function PackBalance(cells,SOC,)                    write control outputs to DACs
                  subroutine for pack balancing               end function
                                                          end function
              end function
           end if                                      return  resume suspended line in Main()

           background task #  supervisory reporting
       end while

   end procedure

Figure 5.2 Overview of the real-time software implementation of a typical BMS. Through an
interrupt-driven architecture for time-critical tasks as state estimation and control, the same
processor can be efficiently utilised by employing its idle CPU cycles for background tasks such
as diagnostics, fault logging and book-keeping.

                                                                147

                                                                                 5.3 Numerical Implementation

          instructions. Figure 5.2a shows an example illustration of typical background tasks that a
          BMS handles. All high-priority tasks are triggered by an interrupt and the supervisory control
          loop suspends the presently executing background task for later resumption. As shown in
          fig. 5.2b, a typical example of such an interrupt driven process is the evaluation of the SPM
          model equations and computation of control outputs and is discussed next.

              Figure 5.3 depicts an exploded view of the timing aspects of the Interrupt Service
          Routine that was briefly presented in fig. 5.2b. Upon the expiry of an on-chip timer calibrated
          against a baseline precision-clock, hardware interrupts are raised by one or more Analog to
          Digital Converters (ADCs) associated with voltage/current sensors mounted on cells. The ISR
          disables the interrupt and reads the samples of data from the ADCs into software. At the end of
          this process, the ISR rearms the interrupts and simultaneously sends and acknowledgement to
          the appropriate sensor which reloads its timer. The SPM model equations are then evaluated
          in software and the resulting computational variables such as voltage and concentrations
          are employed in other pertinent tasks such as state estimator subroutines. If the BMS also
          performs control tasks e.g. regulating the coolant's flow rate or Internal Combustion Engine

              Figure 5.3 Timing diagram of a real-time software loop of a BMS. The sequence of events
             within one sample period  in relation to the base clock of the controller is shown. Particular
              emphasis is placed on depicting the handling of Interrupt Service Routine (ISR) requests pertinent
              to cell models. Other background tasks performed by the CPU are de-emphasised. Moreover, the
              integration of the BMS software loop within the larger scope of a master vehicular controller is
              not shown. Illustration adapted from Southward [176].

                                                                148

                                                                                 5.3 Numerical Implementation

          (ICE) state-toggling such as in the hysteresis control of a series hybrid drivetrain, these control
          outputs are written to the relevant Digital to Analog Converters (DACs).

        5.3.3 Sample Delay Considerations

          Figure 5.4 shows a vertically compressed view of all CPU activities across a larger time
          horizon. The CPU's load factor is the ratio of time spent in foreground requests to its idling
          time. While a high load factor is beneficial in terms of efficient usage of resources, it adversely
          affects the power efficiency of the chip.

              Figure 5.4 A compressed timeline of CPU execution cycles showing details of activities within
              each sample interval. The execution sequence is shown over a larger horizon so as to illustrate
              the proportion of `activity time' relative to the `idle time'. The vast majority of the CPU cycle is
              spent in idling or background tasks. The servicing of the ISR occupies a relatively small fraction
              of each CPU cycle. Diagram reproduced from Plett [177].

              For Li-ion cell modelling, a sampling interval of  = 1s is commonly used, thus aiming
          to capture the cell dynamics below 500 mHz. The CPU's clock used is of several MHz, a vast
          majority of which is spent in background tasks or in sleep mode. Furthermore, a low-latency
          ISR code is employed in the tasks of reading the ADC value, evaluating the model equations
          and writing any control outputs to the DAC. Using a simplified PBM such as the SPM helps
          in achieving a low-latency throughput for the ISR.

              The overall implication of such a scheme is that any delays owing to the sample and
          hold process at the model input and outputs can be neglected. In conventional sampled-data
          systems, control delays may be analysed by considering a multiplicative factor of - in the
          Laplace domain transfer function of the system. Delay parameters of  = 0.5 or  = 1
          are commonly employed as conservative estimates. However, owing to the small CPU load
          factors, in this thesis this delay term is omitted for discrete-time formulation of the SPM.

                 In the ideal case, according to the Nyquist sampling theorem. In practice, the frequency range is smaller.

                                                                149

                                                   5.3 Numerical Implementation

5.3.4 Discrete-Time SPM Formulation

Due to the sampling and ZOH operations at the ADC input to the system, the input to
the SPM is transformed from a simple continuous time signal to discrete-time sequences
i.e., ()  [] and ()  [], where  = 0, 1, ... ,  is the sample index corresponding to
the continuous time instant  = . The continuous time plant model represented by the
ODE system of eq. (5.38) is therefore replaced by a discrete-time process and modelled by a
difference equation which is to be determined.

    Consider the general continuous-time solution given by eq. (5.43). Let 0 =  and
 = ( + 1), where  = 0, 1, ... , . Therefore,

(0) = ()  []                                                                   (5.46)
 () = (( + 1))  [ + 1]                                                         (5.47)

Substituting these relationships into eq. (5.43),

x[ + 1] =  x[] +   (+1)                            ((+1)-)u( )

                                                                               (5.48)



With the ZOH scheme discussed here, ( ) remains constant from  to ( + 1), and is
equal to () i.e., []. Consider a change-of-variable definition for the dummy variable of
integration  as  = ( + 1) - . Thus,  = ( + 1) - . Hence,  = -. Substituting these
into eq. (5.48),

                                                                            0  (5.49)
                                                                               (5.50)
                               x[ + 1] =  x[] + [ ] [] -



Reversing the order of integration leads to



                               x[ + 1] =  x[] + [  ] []

                                                                           0

    Equation (5.50) represents a discrete-time state-space representation of the dynamics of
the system whose generic representation is given by the difference equation

x[ + 1] = [] + []                                                              (5.51)

                                                                150

                                                                           5.3 Numerical Implementation

where     =     and    =       .            If  the  continuous-time           system       matrix       is  invertible,

                           0

a closed form expression for  is obtained as

                      = -1( - )                                              (if -1 exists)                  (5.52)

For the continuous time system matrix  of the SPM, its determinant is zero.

                                   |  -30  s,pos       0 0|
                                   |       p2pos              |
                                                                     =  0                                    (5.53)
                                   |       0      -30  s,neg   0  |
                                   |       0           p2neg      |
                                   |                           0|
                                                       0

and hence is not invertible. This necessitates an explicit evaluation of the integral in eq. (5.50)
for computation of the discrete-time input matrix .

    Since the only non-zero entries of the matrix lie along its main diagonal i.e., its modes are
decoupled, the matrix exponential reduces to a diagonal matrix whose elements are simply the
scalar exponentials of the original entries. The discrete-time input matrix  can be obtained
by evaluating eq. (5.55) as shown below.

                     -30  s,pos          0           0               -30     s,pos                       0
                          p2pos                                              p2pos
                                                     0                                          0        0
                          0
       =     =  exp              -30     s,neg       0         =                           -30  s,neg    1   (5.54)
                                         p2neg                                                  p2neg        (5.55)
                                                                     0                                       (5.56)

                      0                  0
                                                                     0                          0

                            -30       s,pos                          0         45  p2pos     1
                                      p2pos                                        p2neg    poss,pos
                                                        0            0       2
                                                                                            -1
                             0                          s,neg                  45           negs,neg
                                                   -30  p2neg                  2
 =    =
                                                                                            -3
         0

                       0              0                 0            1  pneg  negs,neg



                                                 1-exp(-30    s,pos    )
                                                              p2pos
                                              3
                                          4 s,pos poss,pos



                                   =             1-exp(-30    s,neg     )
                                         -                    p2neg
                                              3
                                              4   s,neg negs,neg



                                                          -3

                                                  pneg  negs,neg

                                                                 151

5.3 Numerical Implementation

    The discrete-time matrix-vector system presented in eq. (5.54) and eq. (5.56) have not
been presented in existing literature, but is vital to understanding the implementation of the
SPM in digital controllers. Although, simpler alternatives such as Forward Euler methods are
available to approximate the time-derivative of the state vector, they suffer from problems
such as a growth in the rate of local truncation error per time-step [178], necessitating the use
of very high sample rates, which increases the burden on the embedded controller. The matrix
exponential approach is superior in terms of accuracy and stability across a wide range of
sample rates.

    For a pre-determined sample-rate, the matrix exponential and hence the  and
matrices can be computed offline on a desktop and stored into the non-volatile memory of the
embedded controller to be loaded onto RAM during operation. The vectorised implementation
of the state dynamics presented here is highly efficient and directly amenable for use in
classical state-vector algorithms. For the cell's terminal voltage computation, the basic
structure and form of the output equation given by eq. (5.39) remains intact, except that the
continuous time variables (x(), ()) need to be replaced by their discrete-time counterparts
in the corresponding equation set i.e., eqs. (5.40)­(5.42). The discrete-time output function
is evaluated after updating the state vector (through eq. (5.51)).

[ + 1] = (x[ + 1], [ + 1])  (5.57)

              The complete sequence of steps for implementing the discrete-time variant of the SPM is
          given in algorithm 5.2. In particular, it can be seen that the discrete-time system and input
          matrices,  and  can be easily pre-computed from the parameter set using the matrix
          exponential approach. In MATLAB, this can be achieved by passing the arguments of the
          matrix exponential to the `expm' command. The vectorised implementation of the discrete-
          time state equation given in line 11 of algorithm 5.2 is a set of efficient linear algebra operations
          consisting of simple matrix-vector product and vector-addition routines.

              This thesis strives for an inclusive approach by taking into account that some battery
          researchers whose focus is on fundamental aspects of lithium ion cells e.g. those specialising
          in electrochemistry, might not be familiar with the nuances of the matrix exponential
          and discrete-time matrix computations (in line 7 of algorithm 5.2). Therefore, a snippet of

                                                                152

                                                                     5.3 Numerical Implementation

Algorithm 5.2 Discrete-time SPM

Require: Load profile                                                                              e.g. a csv file of  vs. C-rate

Require: SPM parameter set                                                                         e.g. stored in a struct params

User data: [1], f,user, f,condition, cell capacity 1C, sample rate                                        f,condition  {max, min}
Ensure: [1], cell[1] within limits                                                                 index [ = 1]  time ( = 0)

  1: procedure SimulateSPM

2:   f,desired = {max(f,user, f,profile), if f,condition == max;                                   may terminate early due to

             min(f,user, f,profile), otherwise.                                                   cut-off violations

     Note: Flexible end time. Extrapolate last C-rate from profile until f,desired if necessary.

3:   max      f,desired  +  1                                         max iterations assuming no cut-offs



4: Allocate storage of size max×1 for each simulation variable

5: Compute s,neg[1] as per eq. (5.12)                                                              C-rate[1] from profile
6:  [1]  1C × C-rate[1], x[1]  [ 0 0 s,neg[1] ]

7: Compute  and                                                                                    as per eq. (5.54) and eq. (5.56)
                                                                                                         from direct feedthrough
8: cell[1]  ComputeCellVoltage(x[1],  [1], params)

9: for   2  max do

10:   []  interpolate from profile using ZOH

11:  []  [ - 1] + [ - 1]                                                                                               eq. (5.51)

12:  Compute [] as per eq. (5.18)

13:  cell  ComputeCellVoltage(x[],  [], param)

14:  if [] or cell[] exceeded cut-off limits then

15:          - 1                                                                                   data from last step is invalid

16:       break;

17:  end if

18: end for                                                        uses discrete-time variants of eqs i.e., at index
19: end procedure
20: subroutine ComputeCellVoltage(x,I,params)

21: Compute s,surfneg as per eq. (5.42)             consider saturating i.e., s,minneg  s,surfneg  s,maxneg

22: Compute s,pos as per eq. (5.37)

23: Compute s,surfpos as per eq. (5.41)

24: Compute cell as per eq. (5.40)                                    resume suspended line in SimulateSPM
25: return cell

MATLAB code clarifying the computation of the discrete-time system and input matrices,
and  is given in code snippet 5.1. A full code listing of an example discrete-time SPM
implementation in MATLAB is provided in listing A.2.

                                                                153

                                                      5.4 Desktop Simulation

% Returns  and  matrices

A_cts = [-30*Ds_pos/(R_pos^2),                        0, 0; ...

                            0, -30*Ds_neg/(R_neg^2), 0; ...

                            0,                        0, 0];

%  =  (see eq. (5.54))

A_disc = expm(A_cts*Ts); % expm command computes the matrix exponential

B_cts = [ (45/2)/(R_pos^2*a_pos*L_pos*F*A); ...
              (-45/2)/(R_neg^2*a_neg*L_neg*F*A); ...
                    (-3/(R_neg*a_neg*L_neg*F*A))];

%    =           (see eqs.  (5.55)­(5.56))

         0
B_disc = nan(size(B_cts));

B_disc(1) = B_cts(1)*(exp(A_cts(1,1)*Ts)-1)/A_cts(1,1);

B_disc(2) = B_cts(2)*(exp(A_cts(2,2)*Ts)-1)/A_cts(2,2);

B_disc(3) = B_cts(3)*Ts;

        Code snippet 5.1 Computation of discrete-time matrices  and  in MATLAB

    Thus, a discrete-time model of the basic SPM is now available for implementation in
an embedded BMS. Further analysis of discrete-time issues such as aliasing, quantisation
noise, signal pre-conditioning and discrete Fourier analysis lies in the specialised engineering
domain of signal processing and falls outside the scope of the thesis. The results of the basic
SPM are presented next in section 5.4.

       5.4 Desktop Simulation

          In this section, the performance of the basic SPM is discussed through desktop simulation
          and by comparison against a standard Doyle-Fuller-Newman (DFN) benchmark model
          incorporating the full Pseudo Two-Dimensional (P2D) dynamics.

        5.4.1 Cell Parametrisation

          Table 5.2 lists the simulation parameters of an LCO cell whose positive and negative electrodes
          are LiCoO2 and LiC6 respectively. The electrolyte in this system consists of LiPF6 salt in a
          solution of Ethylene Carbonate (EC)/Dimethyl Carbonate (DMC)/Ethyl Methyl Carbonate

                 Some contents in this section overlap with section 3.4.1 and represents a joint effort with Ian D. Campbell.

                                                                154

                                                                                                    5.4 Desktop Simulation

   Table 5.2 Parameters for isothermal simulation of the P2D and SPM implementations of

   an Lithium Cobalt Oxide (LCO) cell (with LiCoO2­LiC6 electrode pair and LiPF6 electrolyte).
   Highlighted entries represent parameters exclusive to P2D model.   {pos, sep, neg}.

                System Conditions                      a2.50                                 Other Constants                   96487
Lower cutoff cell voltage, min (V)                     b4.30                                                                    8.314
Upper cutoff cell voltage, max (V)                                         Faraday constant,  (C m-1)
                                                                           Universal gas constant,  (J mol-1 K-1)             c298.15
Cell temperature, cell (K)                                                                                                     c1000
Init. electrolyte conc., e,0 (mol m-3)  Cell-level Parameters                                                                  i2.053
Overall active surface area,  (m2)

              Thermodynamic, Kinetic, Geometric and Transport Parameters

Parameter                                                         Pos                               Sep                       Neg

Bruggeman coefficient, brugg                                      c4                                c4                        c4
Intrinsic electrolyte diffusivity,  (m2 s-1)
                                                                  d3.22 × 10-10                  d3.22 × 10-10              d3.22 × 10-10
Intrinsic electrolyte conductivity,  (S m-1)
Li+ transference number, +0                                                   see table note e & section 5.4.2
Intrinsic electronic conductivity,  (S m-1)
                                                                  c0.363                            c0.363                    c0.363
Thickness,  (m)
                                                                  c100.00                           --                        c100.00
Electrolyte porosity,
                                                                  c72 × 10-6                     c25 × 10-6                   f88 × 10-6
Filler vol. fraction, fi
                                                                  c0.385                            c0.724                    c0.485
Particle radius, p (m)
Specific interfacial surface area, s (m2 m-3)                     c0.025                            --                        c0.033
Electrode diffusivity, s (m2 s-1)
                                                                  c2 × 10-6                         --                        c2 × 10-6
Stoichiometry, 0% SOC, min
                                                                  g885 × 103                        --                      g723.6 × 103
Stoichiometry, 100% SOC, max
Max concentration, s,max (mol m-3)                                c1 × 10-14                        --                      c3.9 × 10-14
Reaction rate coefficient, r (m2.5 mol-0.5 s-1)
                                                                  h0.9917                           --                        h0.0143
Open circuit potential,  (V)
                                                                  c0.4955                           --                        c0.8551

                                                                  c51 554                           --                        c30 555

                                                                  c2.33 × 10-11                     --                      c5.03 × 10-11

                                                                  ksee table note                   --          msee table note

                                        Spatial Discretisation

Parameter                                                         Pos                               Sep                       Neg

Nodes, through-thickness (axial), a                               15                                15                            15
                                                                                                                                  10
Nodes, within spherical particle (radial), r                      10                                --
                                                                                                                              (5.58)
a Ref. [72] b Set to 100 mV above the cell's OCP at 100 % cell SOC c Ref. [90]                                                (5.59)

d Computed at cell = 298.15 K using coefficients from table II in Ref. [179]
e Computed at cell = 298.15 K using coefficients from table III in Ref. [179] at e,0 = 1000 mol m-3
f Set up for capacity balance of electrodes such that neg = 1.22 × pos here (see section 3.5.6) g Computed as per eq. (5.61)
h Obtained as residual stoichiometries after a C/500 simulated discharge from 100 % cell SOC to 2.7 V

i Chosen so that current density for the electrochemical layer is 29.23 A m-2 for 60 A applied current (see section 3.4.1)

k   (pos)  =  -4.656+88.669p2os-401.119p4os+342.909p6os-462.471p8os+433.434p1o0s
                   -1+18.933p2os-79.532p4os+37.311p6os-73.083p8os+95.96p1o0s

m   (neg)  =  0.7222  +  0.1387neg  +  0.029n0e.5g  -  0.0172  +  0.0019   +  0.2808(0.9-15neg)  -  0.7984(0.4465neg-0.4108)
                                                        neg        n1e.5g

                                                                155

               5.4 Desktop Simulation

(EMC) in a 1:1:1 ratio. The standard set of DFN parameters have been extensively described and
documented in literature. The detailed characterisation of the physical properties of lithium-
ion cells falls outside the scope of this thesis. Here, the vast majority of electrochemical
parameters viz. the geometric, thermodynamic, kinetic and transport properties of the cell
have been sourced from Subramanian et al. [90]. The significance of each of the parameters
in the context of the modelling assumptions discussed in section 5.2.2 is examined.

    The simulation parameters that are applicable exclusively to the P2D model are shown as
highlighted text in table 5.2. It can be seen that only a subset of the isothermal DFN model's
parameters are required for the SPM. In particular, there is no requirement to estimate any
of the electrolyte-related parameters in each electrode region. Furthermore, the properties
of the separator material which are necessary in the DFN model are also not considered in
the SPM computations. A brief enumeration of the additional P2D-specific parameters in the
context of parametrisation requirements is provided here.

a. brugg (×3)  The empirical Bruggeman coefficient helps to define the effective values of
               conductivity and diffusivity of the electrolyte. Although an identical value (4)
               is used in table 5.2, in principle all three regions can have different values of
               brugg and need to be parametrised separately.

b.  (×1)       The intrinsic electrolyte diffusivity of a typical electrolyte consisting of
               LiPF6 salt in an organic solvent was experimentally characterised and
               provided as a table of polynomial coefficients by Valøen and Reimers [179].
               Evaluating this polynomial at a cell temperature of 298.15 K results in an
               intrinsic diffusivity of 3.22 × 10-10 m2 s-1. Since this is a material property
               independent of the region within the cell, it needs to be parametrised only
               once.

c.  (×1)       Like the diffusivity, the intrinsic electrolyte conductivity is also a material
               property and its value is independent of the region within the cell. Unlike
               the diffusivity, the electrolyte conductivity is a strong function of its ionic
               concentration. Thus, the polynomial proposed by Valøen and Reimers [179]
               needs to be evaluated at cell = 298.15 K and has to be updated during the

                                                                156

                                       5.4 Desktop Simulation

d. + (×1)  simulation as salt concentration within the electrolyte changes over time. A
           discussion on the choice of initial concentration is provided in section 5.4.2.

           The cationic transference number measures the relative mobility of the Li+ ion
           in the organic solvent and is independent of the region within the cell. Hence,
           this intrinsic property is to be parametrised only once (per solvent).

e.  (×2)   The intrinsic conductivity of the solid phase depends on the material used
           in the porous electrodes. Although a simplified assumption of equal conduct-
           ivity is used for the two electrodes, in practice, this property needs to be
           characterised for each of the two electrodes.

    Neglecting Arrhenius-type temperature dependence of physical properties and their
corresponding activation energies, the basic SPM facilitates the ability to afford physics-
based modelling capabilities with eight fewer parameters than the equivalent isothermal P2D
model. With the naive assumption of equal parametrisation effort per physical property,
this implies a 20 % reduction in parametrisation requirements for the basic SPM when
compared to its DFN counterpart. However, considering the fact that parametrising the
electrolyte's transport properties requires apparatus and infrastructure typically available
only in specialised chemical/materials science labs, the reduction in parametrisation overhead
for system-level engineering stakeholders is more pronounced.

Prima facie, it may seem that electrolyte porosities and filler volume fractions do not

influence the SPM model. However, they do have an indirect bearing on arriving at a critical

parameter viz. the solid phase volume fraction s. This parameter is required to compute the
specific interfacial surface area of the electrodes s i.e., the effective electrode area exposed
to reaction and is an important entity in the SPM model equations presented in section 5.2.3.

The solid phase volume fractions are also required in simulating the P2D model owing to

the need for computing the effective electronic conductivities of the electrodes (see eq. (1.6)).

They are calculated as

                        s = 1 -  - fi  (5.60)

where  and fi are the electrolyte and filler volume-fraction within the respective electrode
regions. Using the values from table 5.2 results in s,pos = 0.590 and s,neg = 0.482 for the
positive and negative electrodes respectively. The specific interfacial surface areas are then

                                                                157

                                                    5.4 Desktop Simulation

calculated as          4 p2

               s  = s  4    p3  =  3s               (5.61)
                       3           p

    As discussed in the assumptions made during model derivation (see section 5.2.2) and
consistent with the assumed model geometry, the parameters not covered by the SPM
pertain to those describing electrolyte dynamics and distribution of electronic charge along
the axial thickness direction of the cell. Properties such as the intrinsic diffusivities and
conductivities of the electrolyte as well as the transference number of Li+ in the organic
solvent are thus completely redundant for SPM simulation. The assumption of uniform
charge density along the through-thickness length of each electrode implies that the intrinsic
electronic conductivities of the two electrodes do not play any role in the model dynamics.
The porosities and Bruggeman coefficients in table 5.2 serve as modifying factors of the
intrinsic conductivities and diffusivities (see table 1.1) leading to an effective value within
each region of the electrochemical layer. Thus, their relevance is also rendered void for the
basic SPM simulation. The thickness of the separator material only plays a role in electrolyte
behaviour. By the model geometry presented in section 5.2.1, this parameter also falls outside
the scope of the basic SPM.

    The thicknesses of the electrodes are optimised for equal loading i.e., to achieve a balance
in their individual capacities to store Li atoms. The thickness of the positive electrode is
chosen as the value from Subramanian et al. [90]. The thickness of the negative electrode
region is then computed with the goal of equalising the volume of active material in each
electrode for every electrochemical layer in a pouch cell.

               elecpos s,pospos = elecneg s,negneg  (5.62)

              In a lithium-ion pouch cell, the electrodes are designed such that the layers can be overlaid
          on top of one another and finally encapsulated in a pouch. Geometrical considerations then
          imply that the cross-sectional area (or face area) of the two electrodes must be the same.
          However, due to the consideration of avoiding plating at the edges due to microscopic
          malformations, the design is done such as to have a small overhang of the negative electrode
          layer (< 2 mm) with respect to the positive electrode layer [101] (see fig. 3.6). Nevertheless,

                                                                158

                                                                      5.4 Desktop Simulation

the active surface area is just the common overlap area between the two electrodes, and hence
elec is equal to the cross-sectional area of the positive electrode.

Thus,  eq. (5.62)  reduces to  neg  =  pos  = 1.22,  yielding neg  =  72 µm.
                               pos     neg

    At first, it may be surprising to note that the values of the particle radius p used in
both the P2D and SPM remain identical. However, it is important to note that the P2D
equations of the DFN model are cast in a normalised form i.e., already set up to account
for the overall capacity of the cell under consideration implicitly through usage of a current
density (per unit area) for its simulation. Furthermore, this explains why increasing the
number of discretisation nodes does not increase the modelled capacity, but instead merely
serves to improves the simulation accuracy owing to the enhanced spatial resolution.

    The overall active surface area  = elec is the combined cross-sectional area of all layers
( is the number of electrochemical (pos, sep, neg) triplets) stacked into the pouch cell. In
both the P2D and SPM models, this parameter serves to scale the external load current down
to the current density experienced by each electrochemical layer. A value of 30 A m-2 was
reported in the results section of Subramanian et al. [90]. When considering a 60 Ah pouch
cell with 10 mm exterior thickness and using the parameters reported in [90], this results in
a cross-sectional area of 2.053 m2 (see section 3.4.1). Considering the equalisation of capacity
loading, with the newly chosen thickness value of the negative electrode, the 1C-rate capacity
of the cell has been revised to 29.23 A m-2.

    On simulating the P2D model with a trickle bleeding type discharge corresponding
to a current of C/500 and logging the data every 1 ms, after reaching 2.7 V§, the remnant
concentrations in the two electrodes were noted. The corresponding residual stoichiometry
values are reported in table 5.2.

    Since only isothermal cell behaviour is considered, table 5.2 omits the activation energies
for the various diffusivities and conductivities of materials (see section 5.4.2 for further
thermal considerations). For this reason, table 5.2 does not include other material properties
such as specific heats, and thermal conductivities. No properties of the current collectors
appear in the isothermal model equations for both the P2D and SPM models and hence are
omitted. All other electrochemical properties, viz. stoichiometries at 100 % SOC, maximum

     §From manufacturer datasheets for LCO chemistries, this value is considered to correspond to 0 % SOC.

                                                                159

                        5.4 Desktop Simulation

concentrations, diffusivities, reaction rate coefficients and OCP of the two electrodes remain
invariant between the P2D and SPM models.

5.4.2 Simulation Setup

For reproducibility of results, it is important to discuss the system-level parameters influen-
cing simulation setup.

    The lower cut-off voltage of the cell is chosen to be 2.5 V. This is deliberately kept
lower than the voltage corresponding to the cell's 0 % i.e., 2.7 V. If set above 2.7 V even at
infinitesimally small discharge currents, the cell would cut-off before achieving complete
discharge. Choosing a value lower than 2.7 V means that the cell gets a chance to recover
its terminal voltage, despite spikes in highly dynamic load currents that might bring the
voltage below this threshold momentarily. If a low-enough value is not chosen, a system-
level shutdown shall be initiated despite possessing the ability to continue to operate after
recovery of terminal voltage. In this case, choosing a cut-off voltage of 2.5 V does not damage
the cell since checks are in place to monitor the SOC and trigger cut-off in the event of charge
depletion (see algorithms 5.1 and 5.2). Northrop et al. [72] use this value, although no specific
explanation is given for this choice.

    The upper cut-off voltage of the cell is chosen at 4.3 V i.e., 100 mV higher than the
equilibrium OCP at 100 % SOC. There are several reasons for this smaller margin at the upper
end of the voltage spectrum.

safety       li-ion cells are less tolerant to overcharging and can pose fire hazards.

degradation  overcharging li-ion cells can lead to plating and accelerate other degrad-
             ation mechanisms.

low C-rates  charging C-rates are typically lower than discharge C-rates.

CCCV charging For on-board chargers, taper charging (such as in a Constant Current
                        Constant Voltage (CCCV) profile) is activated, which ensures that char-
                        ging current drops off rapidly, leading to a lower overvoltage towards
                        the upper SOC range.

                                                                160

5.4 Desktop Simulation

low probabilities The only charging event when an electrified vehicle is in motion is during
                        regenerative braking. The vehicular BMS manages the operating window
                        such that the starting SOC is much lower than the overvoltage that could
                        be caused due to braking. Furthermore, during operation, net discharge
                        events occur more frequently than regenerative braking events.

    For both the P2D model and the SPM model, the cell temperature is kept constant at its
initial value of 25 C (298.15 K). This might imply to the reader that the operation of the lithium
ion cell is assumed to be isothermal. While this is not true in general, for the C-rates considered
here (<5C), typical in a Battery Electric Vehicle (BEV) application particularly for the short-
duration transient loads studied, it is certainly a valid zeroth order coarse approximation
of the cell's thermal condition. Detailed modelling of thermal dynamics is not within the
scope of this thesis, as the primary goal is to obtain a PBM incorporating electrochemical
principles amenable for embedded application. Hence, the thermal dependence of parameters
through an Arrhenius-type relationship is also not considered. Future work could include
performing thermally coupled simulations i.e., incorporating thermally dependent parameters
and simplified heat generation expressions e.g. a lumped thermal model could be employed
for both the SPM and P2D and their performances may be compared.

    To understand the parametrisation of initial concentration, the expression for electrolyte
conductivity needs to be examined. As discussed in section 5.4.1, the intrinsic conductivity of
a specific type of electrolyte is a material property that depends on the local concentration
of Li+ ions and temperature. In the characterisation of the electrolyte by Valøen and
Reimers [179], the best fit expression for electrolyte conductivity was obtained as

(e,  )(, ) = 10-4e(, )(-10.5 + 0.668 × 10-3e(, ) + 0.494 × 10-6e(, )2                      (5.63)
                    + (0.074 - 1.78 × 10-5)e(, ) - 8.86 × 10-10e(, )2) ()
                                                 + (-6.96 × 10-5 + 2.8 × 10-8e(, )) ()2)2

              Figure 5.5 shows a surface plot of the electrolyte conductivity as a function of initial
          concentration e,0 and cell temperature cell. For the modelling task at hand, relevant aspects
          of this material property can be better understood through the simplifications afforded by the
          simulation conditions applicable here. At equilibrium initial condition, e is uniform over the

                                                                 161

                                                        5.4 Desktop Simulation

                                                              1.4

           2                                                  1.2

. (S m-1)  1.5                                                1

           1                                                  0.8

           0.5                                                0.6

           0                                                  0.4

           320

                300                        1500         2000  0.2
                                  1000
                     280

                           260 0  500                         0
                                           e (mol m-3)
                Temp. ( )

Figure 5.5 Electrolyte conductivity as a function of cell temperature and initial concentration.

axial space . Secondly, only isothermal cell behaviour is considered i.e.,  () = cell(0) = cell.
Hence, eq. (5.63) reduces to

 = 10-4e,0(-10.5 + 0.668 × 10-3e,0 + 0.494 × 10-6e2,0                                           (5.64)

                         + (0.074 - 1.78 × 10-5)e,0 - 8.86 × 10-10e2,0)cell
                                                       + (-6.96 × 10-5 + 2.8 × 10-8e,0)c2ell)2

              As inferred from fig. 5.5, the electrolyte conductivity  is a smooth function of e and cell.
          Thus eq. (5.64) can be effectively visualised through a parametric plot of  versus e with cell
          as the variable parameter as seen in fig. 5.6. From fig. 5.6, it is evident that at cell = 298.15 K,
          the maximum value of electrolyte conductivity is attained at e = 1000 mol m-3. It is advant-
          ageous to operate the cell around this salt concentration so as to minimise the cell's overall
          resistance. Hence, the initial concentration e,0 is chosen to be 1000 mol m-3. It should be
          noted that while the electrolyte concentration in the P2D model exhibits both spatial and
          temporal variations during the simulation, in the SPM model, it remains constant throughout.

              The reduction in parametrisation requirements discussed in section 5.4.1 is only one of
          the factors contributing to the simplicity and ease of simulation. As discussed in section 5.2.1,
          an important computational requirement that is present in the P2D model, but completely
          eliminated from the SPM is the requirement of discretisation. As reported in table 5.2, with

                                                                162


                                                                                                              [git] ·

                5.4 Desktop Simulation

           1.6

           1.4  313.15K

. (S m­1)  1.2
                                                                             298.15K

             1

           0.8  285.65K

           0.6

           0.4  258.15K

           0.2

           0
            0 200 400 600 800 1000 1200 1400 1600 1800 2000
                                              ce (mol m­3)

Figure 5.6 Electrolyte conductivity versus equilibrium concentration at various cell temper-

atures. At cell = 298.15 K, the maximum value of electrolyte conductivity corresponds to a salt
concentration of 1000 mol m-3.

          15 nodes per region along the axial direction and with 10 shells per electrode in the radial
          direction, the P2D model under simulation achieves mesh independence to a tolerance
          of 2 % for the range of C-rates considered. For higher C-rates, coupling a thermal model
          is of higher importance than incorporating further meshing refinements. The discretisation-
          related parameters are specific to the P2D model and are highlighted accordingly in table 5.2.

          Capacity Characterisation

          First, it must be established that incorporating the parameters presented in table 5.2 into
          the SPM model equations results in a cell with identical capacity as the DFN model. This is
          to ensure the validity of comparisons in further simulations. Using the values of per-layer
          C-rate as discussed in section 5.4.1, and the overall active surface area from table 5.2, the cell
          under simulation has a capacity of 60 Ah.

              Present literature in battery modelling, both for the DFN model and for the SPM, do not
          discuss any aspect of capacity characterisation. In particular, parameters such as the geometric
          surface area of cells and even their 1C-rate are often not listed in publications. This practice
          can be attributed to the fact that all one-dimensional and Pseudo Two-Dimensional models
          operate on a per-layer basis, using an applied current density. Many a time, researchers

                                                                163

                                                                                           5.4 Desktop Simulation

          assume a unit surface area for the cell. This implicit normalisation is amenable to those
          studies which strive to make numerical comparisons between models through simulation.
          However, it leads to a lack of clarity on the actual capacity of the cells being modelled.
          Furthermore, when comparing with experimental data from a real cell, such works resort
          to ad-hoc techniques such as empirical curve-fitting for obtaining the surface area. Often
          the source of such parametrisation is not made clear. Section 3.4.1 documents the details of
          obtaining the overall surface area of cells and arriving at the C-rate per layer of the specific
          cell under consideration. Since the DFN model does not explicitly model the cell capacity,
          a brief explanation is provided on how a simple numerical characterisation can be used for
          determining cell capacity given a complete parameter list.

              For experimental capacity characterisation of cells, the standard practice is to apply a
          very small discharge current beginning at 100 % SOC, logging the charge passed using a high-
          precision coulomb counter until the cell hits the voltage corresponding to 0 % SOC as specified
          in the manufacturer's datasheet. In order to decouple the effect of the cell's dynamics from
          its capacity, it is required to apply an infinitesimal bleeding current (tending towards, but not
          reaching 0 A).

              Current sensors in battery cycler equipment use high-precision (typically 15­18 bit)
          ADCs and are able to offer high Signal to Noise Ratios (SNRs) except at ultra-low currents.
          The main difficulty with using very low C-rates is that it drastically slows down the
          characterisation procedure. Using a discharge current of C/100 i.e., 0.6 A in this case, results
          in a characterisation time of 100 h or 41/4 days (excluding soak-times and other set-up related
          activities). Furthermore, for accurate coulomb-counting, a high data logging rate is needed,
          producing large file sizes and corresponding difficulties in post-processing them. Considering
          moderate buffer-sizes used in data logging modules of typical cell-cycler software (shared
          between channels), and to avoid excessively large wait-times for characterisation, discharge
          currents of C/20­C/25 are usually deemed sufficient.

              In order to validate that the choice of model parameters result in an intended capacity
          of 60 Ah, an analogous procedure is carried out by means of computer simulation. A
          characterisation simulation beginning at 100 % SOC with a discharge current of 0.6 A was

                                                                164

                                      5.4 Desktop Simulation

performed¶. If the assumed cell capacity is indeed consistent with the model parameters,
then this corresponds to a C-rate of 1/100. Therefore, both the P2D and SPM should run for
exactly 100 hours before cut-off due to charge depletion.

    Capacity validation through computer simulation is not bound by the limitations of
the experimental approach discussed earlier. Using 64-bit IEEE floating point arithmetic,
quantities as low as (10-16) can be safely computed, nullifying any SNR issues. Table 5.3
summarises the key data from this simulation run. For accurate coulomb counting, the data
logging interval is set to 50 ms. Both models ran close to 100 hours. The small deviations from
this expected termination time can be attributed to the fact that the current is not arbitrarily
small with the pragmatic goal of obtaining results in a reasonable time.

Table 5.3 Simulation data for capacity characterisation of P2D and SPM models. The P2D model
is considered as the reference benchmark. The modelling error is defined as  = cellp2d - cellspm

Parameter                      Value Units

Data-logging interval          50.00 ms

Combined CPU time with warm cache 12.22 min

Total RAM used                 603.90 MB

P2D run-time                   99.94  h

SPM run-time                   99.90  h

P2D discharge capacity         59.96 Ah

SPM discharge capacity         59.94 Ah

Worst case error, max          -94.30 mV
Mean error,                     -3.00 mV
RMS error,  RMS                  8.20 mV
MAE error,  MAE                  3.20 mV
Standard deviation of error,     7.60 mV

    As seen in table 5.3, even the combined CPU time to simulate both the P2D and SPM
models is two orders of magnitude lower than real-time. The only issue that remains to be
addressed is that of considerable memory and storage requirements due to high-rate data-
logging for accurate coulomb counting. For a standard computer workstation, this places
only a minor demand on its CPU. For comparable volume of data to be logged, the reliability
and ruggedness of a dedicated workstation far exceeds that of real-time cell cyclers, thereby

                 ¶All computations were performed on a 64-bit Hewlett-Packard Z840 workstation with a 16-core Intel®
            Xeon® E5-2640 v3 (Haswell) processor clocked at 2.60 GHz with 128 GB DDR4 RAM at 1866 MT/sec.

                                                                165

                                                       5.4 Desktop Simulation

establishing numerical simulation as an amenable method for characterisation of cell capacity.
A major disadvantage of simulation based capacity validation is its extreme sensitivity to
parameters such as the maximum concentration of the electrodes and their stoichiometries,
which are generally difficult to characterise. In this context, the experimental procedure of
high-precision coulomb counting assumes a practical significance as it requires no knowledge
of the cell's parameters other than the manufacturer's datasheet.

    Figure 5.7 shows the voltage response of the SPM and P2D models, which overlap almost
entirely. It is clear that both the P2D and SPM models achieve a run-time of 100 hours. This
represents the first visualisation of results produced by the SPM model equations discussed
in section 5.2.3 and its numerical implementation from section 5.3.

                        4.1                            P2d

                                                       SPM

                        3.9

Cell Voltage, cell (V)  3.7

                        3.5

                        3.3

                        3.1

                        2.9

                        2.7
                           0 10 20 30 40 50 60 70 80 90 100
                                                                    Time (hours)

Figure 5.7 Voltage response of P2D and SPM models to a discharge current input of 0.6 A. Both
models achieve their charge depletion point after 100 h confirming that their modelled capacities
match. Key simulation data for this characterisation run is shown in table 5.3.

The voltage error is defined as

                                  = cellp2d - cellspm                             (5.65)

The absolute maximum error is of  (100) mV, which occurs towards the end of discharge.
Although this represents the worst case upper bound on the error, this is not strictly
representative of the overall error behaviour as evidenced by the standard deviation of

                                                                166

                                                               5.4 Desktop Simulation

the error vector. The mean and Root Mean Square (RMS) error values indicate an accuracy
of  (10) mV. It should be noted that throughout the simulation, the voltage response of the
SPM remains slightly above that of P2D, thereby leading to a negative value for the mean
voltage error. For continuous quantities such as time-domain simulation outputs of physical
variables, the Mean Absolute Error (MAE) is a suitable error metric and is defined as

                                    MAE     =  =1||            (5.66)


Here, the numerical value of MAE is consistent with the order of magnitude of the RMS and
mean error metrics as well as with the standard deviation of the error vector.

    Thus, a common foundation for further simulations has been established by confirming
that the two models indeed simulate a cell with a capacity of 60 Ah. With the cell paramet-
risation discussed, simulation setup presented and capacities validated, the simulation results
are fully reproducible and are presented next in section 5.4.3.

5.4.3 Simulation Results

Constant current discharge

The left column of fig. 5.8 shows the time-domain voltage response of the basic SPM for
various constant discharge currents. The voltage response of the P2D model is also overlaid
on these plots and is used as a reference benchmark for comparisons. It is difficult to use
a common time-scale for the horizontal axes of the plots since the run-times differ by two
orders of magnitude for the C-rates considered.

    Since these comparisons have to be done across multiple C-rates, each yielding different
magnitudes in voltage responses, it is helpful to use a relative error metric such as the
percentage error, defined as

                               (%)  =  100  cellp2d - cellspm  (5.67)
                                                 cellp2d

                                                                167

                                                                             5.4 Desktop Simulation

           4.3                                                   0
                                                     P2d

Vcell (V)  3.85                     SPM                          ­5

           3.4                                            ^v(%)  ­10

           2.95 0.20 C    10000     15000 20000                  ­15 0.20 C  10000  15000  20000
            2.5                                                  ­20                       7500
                                           P2d                                             4000
                0 5000                     SPM                       0 5000                1500
            4.3                                                     0
           3.85
Vcell (V)                                                        ­5

           3.4                                            ^v(%)  ­10

           2.95 0.50 C                                           ­15 0.50 C

            2.5     1875 3750 5625 7500                          ­20    1875 3750 5625
                0                                                    0
                                                 P2d
            4.3                                  SPM                0
           3.85
Vcell (V)                                                        ­5

           3.4                                            ^v(%)  ­10

           2.95 1.00 C                                           ­15 1.00 C

           2.5 0    1000  2000      3000 4000                    ­20 0  1000 2000 3000
                                                                    0
           4.3                            P2d
                                          SPM
Vcell (V)  3.85                                                  ­5

           3.4                                            ^v(%)  ­10

           2.95 3.00 C                                           ­15 3.00 C

           2.5   0  375 750 1125 1500                            ­20    375 750 1125
                                                                     0          time (s)

                          time (s)

Figure 5.8 Voltage responses of the P2D and SPM models to various constant discharge
rates. The left column shows the time-domain voltage response of the SPM plotted against the
benchmark P2D response. The column on the right shows the percentage voltage error of the SPM
with respect to the P2D model. The performance of the SPM degrades considerably at discharge
currents above just 0.5C.

    It is to be noted that, in all cases, the P2D model terminates faster than the SPM either
due to hitting lower cut-offs of either terminal voltage or SOC (see fig. 5.9). Consequently,
the error vector is defined only for the common time-region before cut-off.

                                                                168

                                  5.4 Desktop Simulation

    In fig. 5.8, the column on the right shows the percentage error in the voltage response
of the SPM with respect to the P2D model. At very low C-rates below 0.5C, the voltage-
response performance of the SPM is acceptable. However, the performance degradation is
rapid above this C-rate. It is clear that the error in the SPM response is monotonic and
unidirectional. This indicates that the source of the error is due to unmodelled dynamics. In
particular, as discussed in the modelling assumptions of section 5.2.2, the SPM ignores the
electrolyte dynamics. Thus, the overpotential in the electrolyte is not modelled, which results
in the terminal voltage of the SPM being always higher than its P2D counterpart.

    Figure 5.9 shows the time-evolution of SOC computed by the P2D and the SPM models
for various discharge currents. Since the SOC of a cell is already a normalised quantity by
definition, the difference between the two models can be directly used for comparison across
C-rates. The SOC error is defined as

        soc = p2d - spm              (5.68)

and like the error in the terminal voltage, remains unidirectional over time, and defined only
until one of the models hits cut-off. Table 5.4 shows a summary of various error metrics used
to quantify the performance of the basic SPM for various discharge rates.

Table 5.4 Summary of error metrics of the basic SPM for terminal voltage and SOC in constant
current discharge simulations.

C-rate    (%)            soc (%)

        abs. max. MAE abs. max. MAE

0.2     6.64 0.49 0.02 0.02

0.5     8.49 1.17 0.05 0.05

1.0     11.00 2.95 0.10 0.10

3.0 56.53 9.22 0.31 0.30

    A quick perusal of table 5.4 reveals a discrepancy that invokes surprise at first glance.
Whilst the performance of the SPM is quite poor in terms of terminal voltage prediction, it
is worth noting that its SOC prediction capabilities remain quite accurate even at moderate
discharge currents of about 3C and therefore, warrants a brief explanation.

                                                                169

                                                                             5.4 Desktop Simulation

         100                                                     0.3
                                                    P2d

SOC (%)  75                      SPM

         50                                              soc(%)  0.2

          25 0.20 C    10000 15000 20000                         0.1 0.20 C  10000 15000 20000
           0                                                      0
                                         P2d                        0 5000
             0 5000                      SPM
         100                                                     0.3
          75
SOC (%)
         50                                              soc(%)  0.2

         25 0.50 C                                               0.1 0.50 C

         00      1875 3750 5625 7500                             00      1875 3750 5625 7500

         100                                                     0.3
                                                    P2d

SOC (%)  75                      SPM

         50                                              soc(%)  0.2

         25 1.00 C                                               0.1 1.00 C

         0    0  1000  2000      3000 4000                       0    0  1000 2000 3000 4000

         100                           P2d
                                       SPM
         75                                                      0.3

SOC (%)  50                                              soc(%)  0.2

         25 3.00 C                                               0.1 3.00 C

         0    0  375 750 1125 1500                               0    0  375 750 1125 1500

                       time (s)                                              time (s)

Figure 5.9 Plots in the left column depict the time evolution of SOC computed by the P2D and
SPM models for various constant discharge rates. The column on the right shows the error of the
SOC computed by the SPM with respect to that computed by the P2D model i.e., soc = p2d - spm.
The SPM remains quite accurate even at moderate currents such as 3C.

    Referring to eq. (5.18), it is seen that the SOC of the cell is directly proportional to the bulk
(average) concentration in the negative electrode. Hence the plots of fig. 5.9 also represent
the solid phase concentration with a constant scaling factor. As per the assumptions listed

                                                                170

                                                                                           5.4 Desktop Simulation

          in section 5.2.2, the only transport phenomena modelled in the SPM is solid phase diffusion.
          However, for computation of the terminal voltage, the electrolyte overpotential contribution
          has been omitted (see eqs. (5.26) and (5.27)). This explains why the voltage accuracy suffers,
          while the open-loop SOC computation remains accurate. The high accuracy of SOC (and
          hence, solid-phase concentration) computation also validates the usage of the 4th order
          polynomial approximation in the place of Fick's law for modelling solid-phase diffusion.

              However, the discrepancy in accuracies of terminal voltage and SOC computed by the
          basic SPM leads to an important implication. Even at moderate C-rates, the basic SPM cannot
          be effectively used in the design of SOC observers. This is because, the measured voltage
          maps to a vastly different operating point when using the SPM as the plant model, leading
          to strong deviations of the estimated SOC.

          Constant current charge

          The CCCV charging profile is a widely adopted standard charging strategy for charging
          lithium ion cells [3]. In the constant current phase, a charging rate of 1C is used as an accepted
          baseline, although faster charging strategies are presently being actively sought after.

              The top row of fig. 5.10 shows the evolution of terminal voltage and SOC of the P2D
          and SPM models under an applied charging current of 1C i.e., 60 A. The constant-voltage
          charging phase is not shown. The bottom row shows the corresponding errors of the SPM
          model with respect to the reference P2D benchmark. The corollary behaviour of the constant
          current discharge behaviour is observed here. The terminal voltage of the SPM remains
          below the P2D model throughout. This is expected since, to account for the electrolyte
          voltage drop modelled in the P2D dynamics, a higher terminal voltage needs to be applied.
          The voltage error is thus unidirectional and remains positive (opposite to that observed for
          the corresponding discharge case). Similarly, the SOC plots overlap very closely, thereby
          validating the underlying polynomial approximation of solid phase diffusion. It is striking to
          note that the error in SOC remains exactly around the same magnitude (0.1 %) in both the
          charging and discharging cases.

                                                                 171

            4.3                                  100            5.4 Desktop Simulation
           3.85
            3.4                                  75                                      P2d
           2.95                                                                          SPM
Vcell (V)   2.5 0                       SOC (%)  50       1000 2000 3000 4000

              3              P2d                 25

                             SPM

                   1000 2000 3000 4000           00

                                                 0

           2                            soc(%)­0.05

^v(%)              % |^v |max : 2.54                      % |^soc|max : 0.10

           1       % ^vmae : 2.05                ­0.1     % ^socmae : 0.10

           0  0    1000 2000 3000 4000        ­0.15    0  1000 2000 3000 4000

                   time (s)                               time (s)

Figure 5.10 Time evolution of voltage and SOC (top row) of the P2D and SPM models upon
charging with a constant current of 1C, i.e., 60 A starting at 0 % SOC. The bottom row shows the
percentage in terminal voltage and SOC respectively of the SPM with respect to the P2D model.

Dynamic input profile

For automotive applications, it is important to characterise the performance of the cell model
under dynamic load conditions. Several standard vehicular driveycles have been defined and
adopted by regulatory agencies across the world. These drivecycles describe the profile of
the vehicle's speed as a function of time. The profile of speed versus time of drivecycles is
typically available in intervals of 1 s, and is therefore consistent with the sample interval used
for the simulation (see table 5.2).

    The Urban Dynamometer Driving Schedule (UDDS) is one such well-known drivecycle,
originally introduced by the United States Environmental Protection Agency that represents
city driving conditions which can be applied to a typical mid-sized passenger vehicle. world.
Figure 5.11 shows the UDDS drivecycle wherein the vehicle's speed has been converted to
SI units for use in further computations. One complete drivecycle runs for 1369 s. As seen in
fig. 5.11, the UDDS profile is highly dynamic consisting of many sets of rapid acceleration

                                                                172

                                                           5.4 Desktop Simulation

and braking events. Hence, this drivecycle is chosen to provide representative results of the
model's performance to dynamic inputs.

                      30

              25

speed (ms­1)  20

              15

              10

              5

              00  200 400 600 800 1000 1200 1400

                  time (s)

                  Figure 5.11 The UDDS drivecycle profile

    In an all-electric drivetrain wherein lithium ion batteries provide the propulsion power,
the speed profile can be suitably converted to a corresponding current profile experienced
by the cell through the application of basic governing equations from vehicle dynamics
(see section 3.5.2). Therefore, from the cell's perspective, traversal of the drivecycle then
corresponds to the following events. During acceleration phases, the cell experiences a sharp
discharge spike of current. Similarly, assuming that regenerative braking is employed, each
deceleration event corresponds to a charging current. Thus a current versus time dynamic
load profile can be obtained. To briefly summarise the conversion process used here, the
computed power profile of the cell is divided by its nominal voltage and suitably scaled so
that the peak of the current profile corresponds to a discharge current of 3C. Considering that
all the braking energy cannot be recovered due to losses at the wheels, brake discs and other
mechanical components, a regenerative braking factor of 85 % (the fraction of recoverable
power) is assumed for the charging scenario.

    Figure 5.12 shows the simulation results obtained by applying the UDDS current input
profile (top row) to both the P2D and SPM models. The simulation is started at 50 % cell SOC.
This is representative of the median point for the operating window of SOC swing for both
BEVs and Plug-in Hybrid Electric Vehicles (PHEVs) [28]. Although regenerative braking is

                                                                173

                                5.4 Desktop Simulation

             200

             100

Current (A)  0

             ­100

Vcell (V)    ­200     200 400 600 800 1000 1200 1400
                   0                                                                 P2d
                                                                                     SPM
              3.95
               3.9    200 400 600 800 1000 1200 1400
              3.85                                                                   P2d
               3.8                                                                   SPM
              3.75
               3.7
              3.65 0
                50

                48

SOC (%)      46

             44

             42 0     200 400 600 800 1000 1200 1400

                      time (s)

Figure 5.12 Simulation results for a UDDS current profile. The voltage prediction performance
of the SPM to dynamic loads is poor while its SOC computation accuracy is high.

                                                                174

5.5 Towards Enhancing the Conventional SPM

employed, due to the reduced occurrence of braking events as well as considering efficiencies
of the drivetrain, as with any driveycle, the UDDS profile also results in a net-discharge. The
cell's SOC at the termination of the UDDS run is 6 % lower than its starting value.

    The voltage output from the models is plotted in the middle row of fig. 5.12. The bottom
row shows the evolution of the cell's SOC over time. Consistent with the error trends observed
in the constant current discharge and charge simulations, the error in terminal voltage is high
whereas that in SOC is low. In this work, the voltage error metrics are reported directly in
units of mV for the dynamic simulation run. Furthermore, it is a standard practice to report
the RMS error for such dynamic load profiles and is therefore included in the summary of
error metrics reported in table 5.5.

           Table 5.5 Summary of error metrics of the basic SPM with UDDS input profile.

Error metric   (mV)   soc (%)

Abs. max.      97.37    0.21
MAE            19.38    0.04
RMS            25.88    0.06

       5.5 Towards Enhancing the Conventional SPM

          As evidenced by the results of the constant current charge, discharge and dynamic simulation
          runs, the basic SPM suffers from a critical drawback. The lack of electrolyte dynamics in the
          conventional SPM results in poor voltage accuracy even at moderate C-rates. This renders the
          model unsuitable for observer design in SOC estimation applications since the output voltage
          from the model maps to a radically different SOC operating point. A number of candidate
          solutions have been proposed in literature that strive to mitigate this drawback. Merits and
          drawbacks of the salient attempts are briefly evaluated here.

              Even the earliest works which attempt to include electrolyte dynamics into the conven-
          tional SPM were published only within the present decade. Schmidt et al. [180] proposed an
          infinite-sum eigenfunction modal expansion paradigm to solve for the electrolyte concen-
          tration. It was claimed that by accounting for contribution from only the first two terms,
          sufficient accuracies may be achieved. Furthermore, a simple ODE was proposed for the
          rate of evolution of the first temporal mode. The solved electrolyte concentration is then

                                                                175

5.5 Towards Enhancing the Conventional SPM

substituted into an approximate analytical solution for the DFN model's charge conservation
Partial Differential Equation (PDE) (see eq. (1.5)) to obtain the electrolyte potential. However,
the presentation lacks depth in the explanation which hinders reproducibility. For instance,
the origin and explanation of the approximation terms in the electrolyte potential solution
is omitted. Derivations are performed from a rigorous mathematical perspective without
providing contextual reference to cell parameters or electrochemical quantities. Introducing
numerical examples would have been a redeeming factor to help keeping the mathematical
aspects tractable. This method has not seen further uptake for SPM modelling.

    Guo et al. [181] presented an empirical approach to account for the solution-phase
dynamics. Using standard curve-fitting techniques, a non-linear resistance as a function
of current and temperature was introduced. Thus, the equation for cell terminal voltage
presented in eq. (5.29) is modified as

cell = pos - neg + pos - neg -  eq  (5.69)

where eq is the equivalent resistance newly introduced. In the opinion of this thesis author,
this approach is too simplistic and does not generalise well. Even if giving up physics-
based model origins can be tolerated for one or two subsystems within the model, the
equivalent resistance is not just a minor correction term since it needs to account for a
large polarisation voltage of the order of tens of millivolts. Secondly, the current-dependence
introduced to account for the complex mass and charge transport within the electrolyte places
a disproportionately large weight on the accuracy of the curve-fitting process. Non-linear
fits as proposed in Guo et al. are inherently problematic as the optimisation routine may
simply converge to a local minimum. The specific form and nature e.g. the convexity of the
proposed hypothesis function is not discussed. It is also not guaranteed that the same fitting
function is applicable to a different cell with another set of parameters. Finally, the correction
term being resistive in nature is zeroth order i.e., cannot account for the frequency dependent
behaviour of the electrolyte's dynamics. This approach is more suited for small-scale static
corrections that do not depend on the current e.g. to account for a few tens of microvolts due
to a constant contact resistance of the current collectors.

    Di Domenico et al. [165] were the first to present a step-by-step derivation of the
approximate analytical solution to the electrolyte overpotential. The potential drop in the

                                                                 176

                                            5.5 Towards Enhancing the Conventional SPM

electrolyte is given by

                         e,pos  - e,neg  =  -     ( neg  +2  sep  +  pos )  (5.70)
                                               2    eff      eff     eff

and can be substituted into the subtraction operation involving eq. (5.26) and eq. (5.27)
in computing the overall overpotential of eq. (5.28) and hence the terminal voltage. The
effective conductivity of the electrolyte in a given region   {pos, sep, neg} within the cell,
is defined as eff () = () b rugg . As discussed in section 5.4.2, the intrinsic, and hence
the effective electrolyte conductivity is a function of the concentration of Li+ ions in the
electrolyte. Di Domenico et al. did not, however discuss the spatio-temporal calculation of
electrolyte concentration. It is likely that a constant electrolyte concentration at its initial
equilibrium value was used. As seen in fig. 5.13, significant spatial gradients in the electrolyte
are established even at low to moderate C-rates during the cell's operation. Sustained
application of a unidirectional current even leads to starvation of ions in the electrolyte,
particularly near the current collectors. This phenomenon is visualised in fig. 5.13 wherein
the electrolyte at the positive current collector is virtually depleted of ions at the end of
discharge. This ion-starvation process occurs earlier at higher C-rates and spreads throughout
the thickness of the electrode. Thus, the assumption of constant ionic concentration in the
electrolyte is not true. Neglecting mass transport due to diffusion implies that the terms in
eq. (5.70) constitute only a part of the expression for computing the electrolyte overpotential.
Furthermore, Di Domenico et al. do not present any results of applying dynamic current
profiles. Since the critical aspect of mass transport contribution to electrolyte overpotential
is omitted, this model cannot be viewed as a sufficient enhancement to the basic SPM.

    Although not presented in the context of incorporating into the SPM, Guduru et al. [182]
derived an analytical solution of the spatio-temporal evolution of electrolyte concentration
using the Separation of Variables (SoV) method. The SoV method was first applied to
modelling of lithium ion cells by Subramanian et al. [170] to solve for solid phase concentration
profiles in spherical electrode particles. Although the ionic concentration in the electrolyte
computed by the analytical expression in Guduru et al. seems like a feasible choice for
inclusion into the SPM, it is only applicable for galvanostatic boundary conditions i.e., when
the applied current is held constant over time. By natural extension, researchers could
hypothesise that this restriction may be removed by considering the input current as

                                                                 177

                      5.5 Towards Enhancing the Conventional SPM

ce (mol m­3)  1750
                                                                                                                       3571 s
                                                                                                                       1785 s

              1500
                                                                                                                       178 s

              1250
                                                                                                                       60 s

              1000

              750                        20 s

              500                        10 s

                                         5s

              250

              0    0  lpos  lpos + lsep                                                                                        ltot

Figure 5.13 Li+ ion concentration in electrolyte along cell thickness at various time-snapshots
during a 1C discharge simulation of the P2D model. A Quasi-Steady State (QSS) spatial profile with
inflection point at each separator interface begins to form at 60 s after discharge begins. However,
the ionic concentration in electrolyte exhibits a significantly different transient behaviour (zoomed
inset) possessing another inflection point that disrupts the monotonic trend. Depletion of ionic
concentration at positive current collector towards end of discharge is also seen (bottom left).

          piecewise constant over small sample intervals. Such a hypothesis could be reinforced by the
          fact that standard drivecycles are specified as discrete samples and the discrete-time SPM
          processes these input samples assuming ZOH behaviour. However, the analytical solution
          presented in Guduru et al. assumes a Quasi-Steady State (QSS) concentration profile. These
          authors consider a near-instantaneous establishment of this QSS and suggest a parameter-
          independent analysis through use of dimensionless concentrations and time-constants instead
          of absolute time.

              In the studies conducted by this thesis author, significantly different transient behaviour
          is exhibited by the electrolyte concentration profile. In particular, the time taken to establish
          the QSS profile is not negligible. This difference in behaviour could be attributed to the
          different parameter set used. Figure 5.13 shows the spatial profile of ionic concentration at
          various snapshots of time during a 1C constant current discharge. Starting at 100 % SOC,
          the discharge lasts 3571 s. It is seen that it takes nearly 60 s to establish the approximately
          parabolic shape assumed by the electrolyte concentration. After the initial transient has
          elapsed, the underlying structure of the mathematical equations can be assumed to be static.
          This is evidenced by the fact that at 1785 s i.e., after half of the discharge is completed, the

                                                                178

                                     5.5 Towards Enhancing the Conventional SPM

shape of the curve is nearly identical to the one towards end of discharge. These QSS curves
have their sole inflection points at their separator interfaces and remains monotonic within
their respective electrode regions. The difference in height for various times can be accounted
by the coefficients solved using the analytical modal solution proposed in Guduru et al..

    The axes in the inset of fig. 5.13 shows a zoomed-in view of the electrolyte concentration
during the transient phase, wherein the QSS has not yet been established. In particular, there
exist additional inflection points, one within the interior of each electrode, which render the
transient concentration profile mathematically incompatible with the monotonicity exhibited
by the QSS profile. Thus, in highly dynamic operating conditions with frequent reversals in
the direct of current, the QSS assumption for the galvanostatic analytical solution becomes
harder to uphold without introducing significant errors. Finally, the analytical solution profile
in Guduru et al. is not amenable to embedded implementation, since it consists of a set of
non-trivial trigonometric computations at each time-step.

    Prada et al. [183] were the first to provide a simplified expression for potential drop in the
electrolyte by including the terms representing ionic concentration gradient within the cell
thickness. Thus, eq. (5.70) gets modified as

e,pos  - e,neg  =  (1 -  +0)  2  ln  e,pos/cc  -     (   neg     +  2   sep     +   pos     )  (5.71)
                                     e,neg/cc     2     eff,neg        eff,sep     eff,pos

Although the complete expression for electrolyte overpotential was provided, it was presen-
ted in a cursory manner i.e., without detailing the spatio-temporal computation of ionic
concentration values at the current collector interfaces. Nevertheless, it is important to note
this contribution as eq. (5.71) is widely relied upon by subsequent literature and shall be used
in section 6.10.1.

    The pioneering work by Rahimian et al. [184] provided approximate expressions for
both charge transport and mass transport properties of the electrolyte specifically with
the focus on improving the basic SPM. These authors discuss the usage of a polynomial
approximation for electrolyte concentration and potentials. In particular, a cubic polynomial
was chosen for approximating the electrolyte concentration within the porous electrodes. This
necessitates the need to solve for eight coefficients for uniquely describing the electrolyte
concentration profile within the electrode regions. However, in the standard DFN model, the

                                                                179

                                                            5.5 Towards Enhancing the Conventional SPM

          number of electrolyte-specific PDEs and their corresponding boundary conditions describing
          charge and mass transport is insufficient to uniquely solve for all unknown coefficients of
          this polynomial approximation. A detailed explanation of this equation deficiency shall be
          discussed in section 6.1.1.

              To overcome the issue of equation deficiency, Rahimian et al. adopted a scheme wherein
          one additional spatial location in the interior of each electrode was also needed. The
          coefficients of the polynomial approximation were then obtained by iteratively solving
          a large coupled system of algebraic equations, embedding within them the additional
          equations evaluated at the interior points. A complicating issue that arises is regarding the
          optimal positioning of these additional interior points. An online numerical optimisation was
          performed to obtain the optimal placement of this interior node. In the opinion of this thesis
          author, these optimisation results could be sensitive to the thickness of the electrodes among
          other parameters. A discussion of the stability of the proposed routine and its robustness
          to parameter variations shall help in lending confidence in the proposed method. Although
          sufficient accuracy of the improved SPM was demonstrated for currents up to 5C, a notable
          omission is the discussion of the model's performance to dynamic input profiles. In conclusion,
          the author of this thesis opines that, although this method serves as a proof of concept towards
          implementing polynomial approximations for electrolyte dynamics, until the aforementioned
          gaps are addressed with clarity, it is not convincing for uptake by relevant stakeholders.

              Kemper and Kum [185] presented an approach wherein the spatial gradients of the
          electrolyte concentration are neglected. The time-evolution of average ionic concentration
          in each of the three cell regions viz. positive electrode, separator and negative electrode are
          described by a set of three ODEs. As established by the discussion thus far, the concentration
          gradients along the axial thickness of the cell is significant, even at moderate C-rates. Lending
          strength to doubts on the model's wider applicability is the fact that results from constant
          current inputs (which induce large concentration gradients in electrolyte) have not been
          reported in this work. Thus, this approach is deemed as not satisfactory enough to warrant
          further engagement.

              Luo et al. [186] derived a parabolic approximation of the electrolyte concentration
          distribution along the thickness of the cell. The derivation is obtained for the case of steady-
          state wherein the rate of change of concentration is zero. However, the author of this thesis

                                                                180

                                                            5.5 Towards Enhancing the Conventional SPM

          is sceptical about this since in the set of independent simulations conducted, there was no
          situation other than prior to application of current that this exact steady-state condition is
          satisfied. In the QSS profile concept discussion based on fig. 5.13, it is clear that only the spatial
          profile reaches a shape that can be potentially described by a mathematically invariant family
          of curves. The electrolyte concentration is still time-varying and therefore violates the static
          time-evolution assumption. Although Luo et al. [186] do not explicitly acknowledge this, they
          do provide an extension for general operating conditions by introducing two exponential
          scaling functions () and () while retaining the assumption of parabolic spatial behaviour.
          The computation of certain time-constants in these scaling functions are not elucidated nor
          are the procedural steps for determination of the aforementioned scaling functions provided.

              In a subsequent paper by the same authors i.e., Luo et al. [187], the electrolyte concentra-
          tion model together with a similarly-derived electrolyte potential model was incorporated
          into the conventional SPM to arrive at what the authors term as extended SPM. In the
          aforementioned work, the electrolyte potential is set to account for contribution from two
          terms -- a) ohmic drop due to bulk solution resistance, and b) polarisation potential due
          to concentration gradients Although it seeks to correctly account for the two causes of
          overpotential in the electrolyte, there is no detailed explanation on the computation of
          quantities such as time-constants involved in the polarisation potential term.

              A modified version of the electrolyte model proposed in Luo et al. [186] was used in
          Zou et al. [153] for observer design in an SOC estimation application. The modification
          essentially consists of truncating the complex expression in Luo et al. [186], which originally
          consisted of six coefficients 1 through 6 to just two, and elimination of the aforementioned
          time-constants. However, to the disappointment of the author of this thesis, the claim that
          truncation to  = 2 terms is sufficient to describe the dynamics proved to be optimistic for the
          parameter set considered. In my attempts to reproduce this work, an arbitrary scaling factor
          was needed to correct for the electrolyte potential drop and match the P2D simulations. The
          requirement for such scaling factors whose physical origins are not clearly identifiable lends
          to scepticism on the model's robustness. Furthermore, it was found that this value needed
          to be hand-tuned for each parameter-set. Until these gaps are addressed clearly, it is worth
          seeking other viable alternatives to model the electrolyte dynamics of the cell.

                                                                 181

                                                            5.5 Towards Enhancing the Conventional SPM

              After completing the simulations with the aforementioned scaling factors and continuing
          in the quest for other alternatives, the author of this thesis made an observation that
          other researchers have had to resort to similar techniques for describing the electrolyte
          overpotential. For instance, Han et al. [188] use a similar scaling factor  < 0 for the entire
          expression of eq. (5.71) representing the electrolyte overpotential using the polynomial
          approximation approach proposed by Rahimian et al. [184]. However, these unexplained
          scaling factors lower the confidence regarding the model's general applicability.

              Tanim et al. [189] accounted for electrolyte dynamics by deriving reduced order transfer
          functions for ionic concentration distribution and electrolyte overpotential using the Integral
          Method Approximation (IMA) technique. However, the coefficients of these transfer functions
          are excessively long and comprised of chained algebraic operations expressed in a high-
          entropy sum-of-products form in the appendix of the aforesaid article. For instance, ten
          coefficients are needed to describe the concentration profile while six coefficients are required
          for the electrolyte potential. The median length of each atomic sub-expression of these
          coefficients is sufficiently high to obfuscate their physical significance. A low-entropy form
          for the coefficients of these transfer functions similar to that pioneered by Middlebrook [190]
          and exemplified in the design-oriented analysis of electric circuits [191, 192] could have
          been helpful to aid the readers' understanding. The author of this thesis recognises that
          mathematical complexity should not be the sole basis to evaluate the merits of such proposed
          improvements. Although the presentation of these long coefficients have been judiciously
          moved to the appendix, their derivations -- essential to prove the model's validity -- is
          curiously omitted. The unwieldiness of the mathematical expressions presented therein
          increases the probabilities of introducing human errors during implementation.

              It is worth noting that Marcicki et al. [37] had independently proposed a similar approach
          viz. deriving a transcendental transfer function from electrolyte concentration to applied
          current, albeit for a cell of Lithium Iron Phosphate (LFP) chemistry. This transfer function
          consisted of a series of hyperbolic trigonometric functions which were later truncated by
          Padé approximation (see section 2.2.1 for a brief introduction to frequency domain Reduced
          Order Models (ROMs)). However, upon the trial of this approach for the LCO parameter set
          (see table 5.2) by this thesis' author, in order to obtain sufficient accuracy, the truncation order
          had to be raised to at least seven, similar in complexity to that of Tanim et al. [193]. In both

                                                                182

                                                            5.5 Towards Enhancing the Conventional SPM

          Marcicki et al. [37] and Tanim et al. [193], the electrolyte-specific enhancements to the SPM
          are in the frequency domain, placing further burden, particularly on industry stakeholders
          to accurately interpret and transform the coefficients to a time-domain implementation for
          deployment in an embedded BMS. Owing to this, as already stated in section 2.2.1, these
          models fall outside the scope of this thesis.

              Fan et al. [34] proposed an Extended SPM that includes electrolyte dynamics using
          the Galerkin Projection Method (GPM) which achieves an acceptable accuracy in terminal
          voltage performance. Although these authors claim that the GPM is computationally cheaper
          than other model order reduction techniques such as proper orthogonal decomposition
          and balanced truncation, this claim has not been substantiated. The sole comparison of
          CPU times presented in this work only compares the GPM against the classical Finite
          Difference Method (FDM). Although an impressive computational speed is achieved, it is
          unclear whether the model equations, particularly those involving solutions of non-linear
          integral expressions resulting from applying the Galerkin's method can be solved in real-
          time for embedded implementation. It appears that the GPM is more suitable for desktop
          simulations. In congruence with my scepticism, the authors of Fan et al. [34] have not claimed
          the suitability of their work for online/embedded application in a BMS. Therefore, as per this
          thesis authors' stance explained in section 2.2, models employing such methods are deemed
          to be not in alignment with the goals of this thesis.

              Moura et al. [152] proposed an improved SPM by simply augmenting the conventional
          SPM with a simplified form of electrolyte-specific equations of the original DFN model. The
          resulting model therefore has PDEs in it and therefore not easily amenable for embedded
          implementation. Lotfi et al. [194] presented an algebraic approximation for the spatial distri-
          bution of electrolyte concentration by modifying standard parabolic expressions with leading
          exponential coefficients. There are two main issues with this approach. It is not explained
          why that particular mathematical formulation was chosen. For instance, its superiority over
          other feasible family of curves is not discussed. Secondly, the aforesaid coefficients are to be
          determined through solution of equations obtained by applying continuity and flux boundary
          conditions from the DFN model for electrolyte concentrations at the electrode-separator
          interfaces. Since exponential-type expressions are assumed in the aforesaid mathematical

                                                                183

                                         5.6 Quadratic Approximation of Ionic Spatial Concentration

          formulations, the resulting set of equations are non-linear, the solving of which in the context
          of a resource-constrained environment is problematic.

              From my experience in trying to replicate the results from the literature presented in this
          section, the questionable elements in all such approximations can be attributed to inaccuracies
          in computing the spatio-temporal evolution of electrolyte concentration. Upon obtaining a
          good estimate of the electrolyte concentration profile, eq. (5.71) is deemed to be satisfactory
          for the electrolyte overpotential computation. Thus, it can be concluded that research efforts
          must be focused on solving for the electrolyte concentration profile.

              From the discussion of literature, it is clear that the proposed enhancements to the
          computing the ionic concentration in electrolyte falls into one of the following two categories

               · model description through physical principles followed by mathematical simplification
               · fitting of pre-assumed simplified mathematical structures to some physical phenomena

              In the author's view, it appears that using the former approach yields technically
          correct, yet mathematically convoluted expressions for overpotentials that are fraught with
          implementation difficulties. Although the latter approach looks promising in terms of ease of
          implementation, their sub-optimal performance and lack of wider-applicability leaves much to
          be desired. Among the latter class of models, owing to its simplicity, the quadratic (parabolic)
          approximation method for electrolyte concentration is an attractive option. It is therefore
          important to perform an in-depth analysis of this sub-class of models and understand their
          source of potential weaknesses. Such an analysis has yet not been performed in literature
          and is therefore presented next in section 5.6.

       5.6 Quadratic Approximation of Ionic Spatial Concentration

          In this section, the quadratic approximation of ionic spatial concentration that underpins the
          electrolyte model in many of the improved SPM formulations from section 5.5 is presented.
          The steps involved in deriving the quadratic approximation is detailed in section 5.6.1. Based
          on the results from applying this quadratic approximation scheme, an analysis of the weakness
          of this model is performed in section 5.6.2.

                  The mathematical derivations here represents the author's digested summary of literature, and is
            particularly based upon a portion of Deng et al. [82]

                                                                184

                              5.6 Quadratic Approximation of Ionic Spatial Concentration

5.6.1 Model derivation

The schematic in fig. 5.14 shows the definition of the co-ordinate systems used in de-
riving the polynomial approximation of the electrolyte concentration profile. The three
regions {neg, sep, pos} are abbreviated to {, , } respectively in all mathematical expressions.
The globally defined  co-ordinate starts at the negative current collector interface ( = 0)
and terminates at the positive current collector interface ( = tot, where tot = n + s + p).
Three local co-ordinate systems  valid only within their respective regions are also defined.
In particular, it must be noted that the direction of the local pos co-ordinate axis is opposite
to that of the other two local co-ordinate axes as well as the global co-ordinate axis.

Figure 5.14 Schematic diagram of the electrochemical sandwich consisting of a) negat-
ive electrode, b) separator, and c) positive electrode depicting the co-ordinate system used
in deriving the quadratic approximation profile. The global spatial co-ordinate is   {0, },
where  = tot = neg + sep + pos. Local co-ordinate systems  specific to each region are also
defined. It should be noted that the positive electrode's local co-ordinate axis direction is reversed
with respect to the global co-ordinate axis. Illustration reproduced from Deng et al. [82].

    A standard quadratic expression is chosen a priori for approximating the electrolyte
concentration profile within each region.

e,n(, ) = 2()2 + 1() + 0()  0    n  (5.72)
e,s(, ) = 5()2 + 4() + 3()  0    s  (5.73)
e,p(, ) = 8()2 + 7() + 6()  0    p  (5.74)

                                                                185

                                   5.6 Quadratic Approximation of Ionic Spatial Concentration

The time-dependent coefficient vector () = [ 0() 1() ... 8() ] is to be determined.
Applying boundary conditions of the electrolyte diffusion equation from the DFN model (refer
eq. (1.4)) to eqs. (5.72)­(5.74), it is clear that 1 = 0 and 7 = 0. Thus, eqs. (5.72)­(5.74) become

                                      e,n = 22 + 0                    0    n                                                             (5.75)
                                      e,s = 52 + 4 + 3                0    s                                                             (5.76)
                                      e,p = 82 + 6                    0    p                                                             (5.77)

with the coefficient vector being modified to  = [ 0 2 ... 6 8 ].

    Table 5.6 lists the equations and boundary conditions for phenomena describing electro-
lyte diffusion and charge balance within the separator domain.

  Table 5.6 Electrolyte-specific governing equations and boundary conditions of the Doyle-Fuller-
  Newman (DFN) model within the separator domain.

Region                Governing equations                                  Boundary conditions

                                                                           (neg  n, sep  s, pos  p)

                e  =  eff  2e                                  e  ||  =n-  =  e  ||,  =n+        effn(  e  )       =  eff(s    e  )      (5.78)
                             2
                                                                                                              =n-                   =n+

                                                               e  ||  =(n+=s)-e  ||,  =(n  +s)+  eff(s  e  )       +=s)-effp(  e  )

Separator                                                                                                     =(n                   =(n +s )+

       {sep}                  2e      2             2 ln e        ||             ||,                    e                      e
                                2                       2
                   =  eff  (       +     (+0  - 1)          )  e      =n-  =  e       =n+        effn(     )       =  eff(s       )      (5.79)

                                                                                                              =n-                   =n+

                                                               e  ||  =(n+=s)-e  ||,  =(n  +s)-  eff(s  e  )       +=s)-effp(  e  )

                                                                                                              =(n                   =(n +s )+

Equation (5.78) and eq. (5.79) are obtained by applying the pertinent electrolyte equations

of the DFN model (eq. (1.4) and eq. (1.5) respectively) to the separator region. Applying the

continuity and flux boundary conditions from eq. (5.78) at both separator interfaces,

                              2n2 + 0 = 3                      (continuity at neg/sep interface)                                         (5.80)
                                                                                                                                         (5.81)
                   5s2 + 4s + 3 = 8p2 + 6                      (continuity at sep/pos interface)

                          22neff = 4eff                        (flux b.c. at neg/sep interface)                                          (5.82)
                   (25s + 4) eff = -28peff                     (flux b.c. at sep/pos interface)                                          (5.83)

    Hereafter, the explicit time-dependence of the coefficients is omitted. Similarly, the spatio-temporal
dependence of the electrolyte concentration e, is also dropped from the notation.

                                                                186

                               5.6 Quadratic Approximation of Ionic Spatial Concentration

The negative sign in eq. (5.83) is due to the specific choice of the co-ordinate system used

for the positive electrode region (see fig. 5.14). Due to this, fluxes at the separator/positive
electrode interface have opposing directions. Let e,j denote the number of moles of Li+ ions
in the electrolyte per unit cross-sectional area within each region   {neg, sep, pos}. This

is computed as the product of a) the porosity and b) spatial integral of the concentration
function i.e., e,j =  0 e,() . Applying this to eqs. (5.75)­(5.77)

                                    e,n  =  n   1  2n3   +  0n)                 (5.84)
                                               (3                               (5.85)
                                                                                (5.86)
                                    e,s  =  s   1  5s3   +  1  4s2   +  3s)
                                               (3           2

                                    e,p  =  p   1  8p3   +  6p)
                                               (3

    At this stage, e,() are unknown. Since these are time-dependent functions, the
derivation naturally progresses towards seeking a set of ODEs that describe a relationship
for their time evolution. Transforming the 2nd order ODEs of eq. (1.4) (for electrodes) and
eq. (5.78) (for separator) to their respective local co-ordinates and integrate once along the
thickness of each region. Performing this sequence of steps for the negative electrode region

n    n       e,n(,   ))     =    n       (eff  e,n    )  +  (1  -  +0)s,nn)     transposing integration &
        (                           (                                           differentiation operations in
                                                                                the LHS
                                                                                apply time-derivative
    0                           0                                               operator to the whole LHS

   n      n  e,n(, )        =    n       (eff  e,n    )  +  (1  -  +0)s,nn)     apply integral to the RHS
                                    (
                                                                                                   (5.87)

         0                      0

   (n     n  e,n(, ) )      =    n       (eff  e,n    )  +  (1  -  +0)s,nn)
                                    (


         0                      0

                e,n ( )     =  eff  (  e,n  )+ (1  -  +0)s,n      n  n

                                            =n

                                                                 0

                                                                187

   5.6 Quadratic Approximation of Ionic Spatial Concentration

Performing the identical sequence of operations starting from (eq. (5.78)) for the separator
and (eq. (1.4)) for the positive electrode yields

   e,s ( )  =  eff  (   e,s  )                                         (5.88)
                                                                       (5.89)
                             =s

   e,p ( )  =  eff   (  e,p  )+ (1  -  +0)s,p     p  p

                             =p

                                                 0

    In order to evaluate the integral term in the RHS of eq. (5.87) and eq. (5.89), the solid phase
charge conservation equation (eq. (1.6)) is integrated along the local co-ordinate axis of the
negative electrode and positive electrode respectively.

                  n

                     n  = s,n                                          (5.90)
                                                                       (5.91)
                0

                  p              -

                     p  = s,p

                0

Substituting eqs. (5.90)­(5.91) into eqs. (5.87)­(5.89) respectively,

   e,s  =   eff    ( e,n   )- (1  -  +0)¨s¨,n                          (5.92)
                                                ¨s¨,n                  (5.93)
                           =n

   e,p  =   eff    ( e,p   )- (1  -  +0 ) s¨,p    -
                                                s¨,p
                           =p            ¨
                                                ¨

which leads to the general expressions for the cross-sectional molar density of Li+ ions in
each of the three regions as

        e,n    =  eff   (  e,n  )+ (1  -  +0)                          (5.94)
                                                                       (5.95)
                                =n                                     (5.96)

        e,s    =  eff   (  e,s  )

                                =s

        e,p    =  eff   ( e,p   )- (1  -  +0)

                                =p

                                                                188

5.6 Quadratic Approximation of Ionic Spatial Concentration

Substituting the assumed quadratic expressions for electrolyte concentrations in each of the
three regions eqs. (5.75)­(5.77) in the above system i.e., eqs. (5.94)­(5.96)

   e,n  =  22neff  +  (1  -  +0)                                                        (5.97)
                                                                                        (5.98)
                                                                                        (5.99)

 e,s = 25seff

   e,p  =  28peff  -  (1  -  +0)


The initial ionic concentration in the electrolyte is identical in all three regions of the cell,

assuming equilibrium starting conditions i.e., e,0 = e,0,   {n,s,p}. Hence the initial number
of moles of Li+ per unit area in each of the three regions is given by

           e,n(0) = ne,0n                                                               (5.100)

           e,s(0) = se,0s                                                               (5.101)

           e,p(0) = pe,0p                                                               (5.102)

and the initial coefficient vector which satisfies the system equations is obtained as

           0 e,0

           2       0


           3    e,0                                                                     (5.103)

           4 =  0

           5       0


           6    e,0


           8  0

    The system of three ODEs, (5.97)­(5.99) together with eqs. (5.100)­(5.102) representing
the initial conditions, form an IVP. Eqs. (5.80)­(5.86) represent a square system of seven linear
algebraic equations with seven unknown coefficients which must be solved at each time-step.
These algebraic constraints coupled with the aforementioned IVP form a DAE system.

    There are now two choices for proceeding with solution of the system. The naive
approach would be to solve the DAE using advanced DAE solvers specially designed to handle
index-1 semi-explicit systems such as DASSL [195] and DASPK [196]. For start-stop type of
input currents with discontinuities, the consistent initialisation of algebraic conditions and

                                                                189

                                         5.6 Quadratic Approximation of Ionic Spatial Concentration

          derivatives is numerically challenging. All DAE solvers typically use adaptive time-stepping
          algorithms. The feasibility of using such a complex scheme for real-time computation is
          questionable. On the other hand, the overall system can be viewed as composed of two
          numerical subsystems -- a) an independent ODE system, and b) an independent algebraic
          system. Each system is executed back to back in succession using solutions from the other
          system from the previous time-step.

              To clarify the sequence of operations, in order to bootstrap the model, it is required to
          compute e,() in all three regions. The ODE system is integrated for one time-step by
          retaining the coefficients at their initial value. The e,() thus solved is substituted into the
          algebraic system to yield the updated value of the coefficient vector ( = ). This new value
          of the coefficient vector is substituted back into the ODE system and the process continues.
          Although the continuous simulation of the overall DAE is not accomplished, this scheme is
          pragmatic from an engineering viewpoint. This is because, the periodic pauses needed to
          update the intertwined sub-systems translate naturally into fixed time-steps and is well-suited
          for a BMS controller operating at a fixed sample rate. This is also an effective workaround to
          mitigate the complexities of having to implement and solve DAEs in real time.

              The simulation results of the quadratic approximation scheme and the analysis of its
          strengths and weaknesses is presented next in section 5.6.2.

        5.6.2 Numerical implementation, simulation results and analysis

          Numerical implementation

          From an analysis point of view, the quadratic approximation model for computing the
          spatio-temporal evolution of electrolyte concentration can be simulated as an independent
          subsystem, and hence can be implemented numerically as a standalone module as shown in
          algorithm 5.3. In practice, this modular code is embedded as a subroutine within the main
          SPM loop (see algorithm 5.2).

          Simulation results

          Figure 5.15 shows the spatial distribution of Li+ ions in electrolyte along the thickness of
          the cell at various snapshots of time obtained by simulation of the P2D and the quadratic

                                                                190

                    5.6 Quadratic Approximation of Ionic Spatial Concentration

Algorithm 5.3 Quadratic approximation model for spatio-temporal electrolyte concentration

Require: Load profile                                                    e.g. a csv file of  vs. C-rate
Require: Electrolyte model parameter set                            e.g. stored in a struct ceparams
User data: f, sample rate , e,init

  1: function QuadraticElectrolyteModel

2: Set e,init as per eqs. (5.100)­(5.102)

3: [1] values from eq. (5.103)

4: cell[1]  ComputeCellVoltage(x[1],  [1], params)                  from direct feedthrough

5: for   2  max do

6:    []  interpolate from profile using ZOH

7:   Solve continuous-time state equations­eqs. (5.97)­(5.99)       Using [ - 1]

8:   e[] last time-entry vector of soln. matrix                     if using an adaptive solver

9:   [] solution of linear system of equations­eqs. (5.80)­(5.86)   Using e[ - 1]

10:  Compute e as per eqs. (5.75)­(5.77)       Quadratic polynomial expressions for concentration

11: end for
12: end function

approximation models using a 1C discharge current. The P2D model's response is considered
as the reference benchmark. During the initial transient phase, the concentration profile
within each electrode region exhibits a characteristic inflection point. During this phase,
the concentration profile computed by the parabolic profile exhibits a large deviation in
terms of percentage error at each spatial location. However, with the passage of time, as a
QSS is established, this inflection point flattens out, and the quadratic approximation becomes
closer to the true concentration value at each spatial location. Similar trends in behaviour is
exhibited for discharge and charging at higher C-rates and these results are therefore omitted
here in the interest of keeping the discussion succinct.

    It is important to note that while having a spatial concentration profile is useful, as seen
in eq. (5.71), it is the values of concentration at the current collector interfaces that are most
influential in computation of the electrolyte overpotential and hence, in the voltage accuracy
of the enhanced SPM. Thus, it is important to obtain this alternative perspective of time-
evolution of the electrolyte concentration at the two current collectors.

    Figure 5.16 shows the time evolution of ionic concentration in the electrolyte at the two
current collector interfaces computed by the P2D and quadratic approximation models for a

                                                                 191

                                  5.6 Quadratic Approximation of Ionic Spatial Concentration

ce (mol m­3)  1040                t=4s              ce (mol m­3)  1200                t = 18 s
              1020                                                1100
              1000     P2d                                        1000     P2d
               980     Quadratic                                   900     Quadratic
               960                                                 800
                                  ln ln + ls  ltot                                    ln ln + ls  ltot
                   0                                                   0

              2000                                                2000

ce (mol m­3)  1500                t = 357 s         ce (mol m­3)  1500                t = 1785 s

              1000                                                1000

              500      P2d                                        500      P2d

                       Quadratic                                           Quadratic

              0     0             ln ln + ls  ltot                0     0             ln ln + ls  ltot

              2000                                                2000

ce (mol m­3)  1500                t = 2677 s        ce (mol m­3)  1500                t = 3570 s

              1000                                                1000

              500      P2d                                        500      P2d

                       Quadratic                                           Quadratic

              0     0             ln ln + ls  ltot                0     0             ln ln + ls  ltot

Figure 5.15 Spatial distribution of ionic concentration in electrolyte along cell thickness at
various snapshots of time for a 1C discharge. The concentration profile obtained from simulating
the P2D model is used as the reference. The performance of the quadratic model is quite poor
during the initial transient duration, but improves over time as a quasi-steady state is reached.

1C discharge current. The concentration values computed by the P2D model is considered
as the reference benchmark. At the negative electrode­current collector interface, the ionic
concentration exhibits a few oscillations of small amplitude owing to the complex interactions
of the ionic phase with the porous electrode and the charge transfer process at the electrode-
electrolyte boundary. The concentration evolution predicted by the quadratic approximation
model is rather simplistic and is unable to capture this intricate time-evolution pattern. This
is because the governing equation predicting time evolution of concentration in the quadratic

                                                                192

                                       5.6 Quadratic Approximation of Ionic Spatial Concentration

                    2000                                                1000

ce(0, t) (mol m­3)          P2d                  ce(ltot, t) (mol m­3)           P2d

                    1750    Quadratic                                   750      Quadratic

                    1500                                                500

                    1250                                                250

                    1000    1000 2000 3000 4000                         0     0  1000 2000 3000 4000
                         0

                    400                                                 400

ce,negcc(mol m­3)   250                          ce,poscc (mol m­3)     250

                    100                                                 100

                    ­50                                                 ­50

­200 0                      1000 2000 3000 4000  ­200 0                          1000 2000 3000 4000
                                      time (s)                                             time (s)

Figure 5.16 Evolution of ionic concentration over time at the two current collector interfaces
for a 1C discharge (top row). The time evolution of the corresponding error variables is also shown
(bottom row).

approximation model is that given by the first-order ODE of eq. (5.97) (with a proportional
mapping from e,n to e(0, )). Following system theory, the step response of a first order
ODE is that of an exponential rise to a final settling value, which is exactly the shape seen in
the top-left plot of fig. 5.16.

    The ionic concentration evolution at the positive current collector does not exhibit major
oscillations and even has a subtle monotonicity to its response. However, the classical first
order response predicated by the quadratic approximation model falls short of representing
its complete dynamics. Errors of similar magnitude are present in the ionic concentration at
both current collector interfaces, with a maximum absolute error of 250 mol m-3.

    This chapter concludes with a view that, while the spatial accuracy of the quadratic
approximation model is acceptable, its temporal performance is lacklustre. The causal factors
for this mediocre performance is analysed in the context of the author's own attempts in
arriving at an enhanced electrolyte model and is presented next in chapter 6.

                                                                193

         6

     Implementing a New Electrolyte Model
           for Augmentation of the Basic SPM

              6.1 Performance Analysis: Quadratic Approximation Model . . . . . . . . . . . . . 195
              6.2 A New Electrolyte Model through System Identification . . . . . . . . . . . . . 199
              6.3 Brief Introduction to System Identification . . . . . . . . . . . . . . . . . . . . 202
              6.4 Overview of Black Box System Identification . . . . . . . . . . . . . . . . . . . 203
              6.5 Introduction to Electrolyte Time-Evolution Subsystems . . . . . . . . . . . . . 206
              6.6 Design of Persistent Excitations . . . . . . . . . . . . . . . . . . . . . . . . . . . 207
              6.7 Investigation of Linearity and Time Invariance . . . . . . . . . . . . . . . . . . 212
              6.8 Transfer Function Identification Procedure . . . . . . . . . . . . . . . . . . . . 219
              6.9 Performance Analysis of New Model: Ionic Concentration . . . . . . . . . . . 232
              6.10 Composite SPM Model with Electrolyte Dynamics . . . . . . . . . . . . . . . . 241

                                                                194

                                         6.1 Performance Analysis: Quadratic Approximation Model

   Based upon the insights gained from the extensive analyses performed in chapter 5,
                this chapter presents the thesis author's attempts to surpass the performance of the
          current pinnacle in modelling art through the development of a new electrolyte model. In
          particular, this chapter describes the attempts towards arriving at an accurate description
          of the spatio-temporal evolution of the electrolyte concentration in a lithium ion cell. The
          performance of the quadratic approximation model which was introduced in chapter 5 is
          analysed through the novel application of a symbolic regression framework. This helps to
          expose the issue of equation deficiency in the underlying Doyle-Fuller-Newman (DFN) model
          and questions its suitability for the purpose of reduced order modelling of the electrolyte
          concentration dynamics with a pre-assumed equation structure. Although this framework
          did not ultimately yield the desired outcomes, it did nevertheless facilitate a comprehensive
          analysis of the strengths and weaknesses of the quadratic approximation model which has
          not been performed in existing literature. Next, the author's unique contribution to the art
          of single particle modelling viz. a novel time-evolution model of electrolyte concentration
          evolutions through the technique of system identification is presented. The results of the
          new approach is compared against the baseline quadratic approximation model as well as
          the benchmark Pseudo Two-Dimensional (P2D) model. Finally, the new model equations are
          incorporated into an electrolyte-enhanced Single Particle Model (SPM) and the improved
          performance of the newly developed composite model is quantified.

       6.1 Performance Analysis: Quadratic Approximation Model

          In the author's analysis of the quadratic approximation model, the origin and nature of
          its sub-optimal performance can be explained as per the following rationale. The quadratic
          approximation model uses a bottom-up approach wherein the final simplified model structure
          is pre-assumed and then the physics are made to fit within this framework. Given that the
          top-down approach to electrolyte modelling i.e., accounting for all physical phenomena and
          then simplifying them yields mathematically intractable and overly complex models (see
          section 5.5 for a detailed discussion), this approach seems to be a pragmatic alternative to
          enhancing the SPM with electrolyte dynamics. However, a detailed look at this model from
          an alternate viewpoint is necessary for further analysis.

                                                                195

                                         6.1 Performance Analysis: Quadratic Approximation Model

        6.1.1 Symbolic regression using Multi-Gene Genetic Programming

          The question boils down to whether a quadratic approximation is indeed the best model
          structure that can be assumed a priori for the spatial profile of ionic concentration in the
          electrolyte. This author embarked on a journey to find suitable alternate model structures
          i.e., a single family of curves that can capture both the transient and Quasi-Steady State
          (QSS) behaviour exhibited by the ionic concentration. The open-source MATLAB toolbox
          GPTIPS2 [197] uses the state-of-the-art Multi-Gene Genetic Programming (MGGP) approach
          for symbolic data mining and is ideally suited for such symbolic regression tasks (fitting
          a mathematical equation structure, and not merely obtaining best-fit coefficients to a pre-
          assumed curve as in classical numerical regression, to a given data).

              In employing the MGGP approach, it is important to recognise that the key criteria that
          restricts a) the choice of gene-sequence depth, as well as b) the choice in number of parent
          mutations, is the total number of unknown symbolic coefficients required to be solved in
          the assumed model structure. There are a total of seven linear equations available from the
          physics of the DFN model (see eqs. (5.80)­(5.86)). Hence, in order to guarantee a solution the
          assumed family of curves cannot consist of more than seven coefficients. Furthermore, for
          a unique solution, the number of coefficients must be exactly seven. Yet another restriction
          on the choice of locus of feasible curves arises due to the fact that the behaviour of ionic
          concentration in the negative and positive electrode regions are similar in complexity, and
          hence need to be mathematically described by an identical family of curves.

              Upon a close inspection of the spatial concentration profile from the P2D simulation
          results shown in fig. 5.15, it is evident the electrolyte approximation functions within the
          electrode regions is of higher complexity than the approximation function suitable for use
          in the separator region. Based on the results of the quadratic model, it is clear that at least
          two coefficients are required within the electrode regions i.e., c,elec  2. There exists an
          inhibiting factor that prevents the use of a lower order function within the separator. As per
          the simulation results of the P2D model, the time-domain change of number of moles per
          square meter in the separator is non-zero. Since the time-derivative of a linear approximation

                  The concept of complexity of curves used here is not based on a precise mathematical definition such as
            that employed by Neumann-Coto and Arenas [198], but is loosely used to simply convey an empirical sense of
            their curvature. However, the analysis here applies to the more rigorous definition as well.

                                                                196

6.1 Performance Analysis: Quadratic Approximation Model

applied to eq. (5.98) is zero, this straight-line equation is immediately ruled out. Among
the non-polynomial mathematical curves tried (such as trigonometric, hyperbolic, power
series among others), none could obtain the relatively simple shape of the separator function
without being forced to reduce the contribution from one of the coefficients to below machine
precision. This necessitates the retention of the quadratic approximation function used thus
far (with no missing terms) i.e., c,sep = 3. Thus, the overall number of coefficients in the
best possible approximation shall be 2c,elec + c,sep = 2  2 + 3 = 7, which is the total number
of electrolyte-specific physical constraints available from the DFN model. Hence it can be
concluded that the quadratic approximation model does indeed make the best use of all
of the available physical equations. The final question remains to answer is, with these
coefficient limitations, whether the quadratic equation structure indeed the optimal one.
This was investigated through the MGGP approach described next.

    The GPTIPS2 toolbox uses a variety of heuristic algorithms from the theory of MGGP to
hypothesise a suitable equation structure for the data to be fitted. The dataset consisted of the
simulation results from the P2D model, in particular the values of electrolyte concentration at
the three different cell regions captured at various snapshots of time. Both transient and QSS
data were fed into this symbolic data mining process and a single all-encompassing family of
curves capable of capturing the electrolyte concentration behaviour was sought for. However,
the constraints in the number of coefficients that can be employed results in a restriction
of the depth of gene mutations as well as the number of parent/seed populations. The best
equation set (without strictly enforcing the aforementioned hard constraints, yet minimising
the distance to the constraint vector) that the symbolic regression approach yielded was

e,n(, ) = 2() cosh 2 + 1() sinh  + 0() 0    n  (6.1)

e,s(, ) = 5()2 + 4() + 3()  0    s             (6.2)

e,p(, ) = 8() cosh 2 + 7() sinh  + 6() 0    p  (6.3)

    Although eqs. (6.1)­(6.3) fit the transient and QSS profiles well, they violate the constraint
on the number of coefficients available resulting in an under-determined system of equations.
Both the least-squares and least-norm solution of this system were tried. However, the results
were inferior to that produced by the baseline quadratic approximation method.

                                                                197

6.1 Performance Analysis: Quadratic Approximation Model

    Next, an attempt was made to obtain different mathematical structures for the transient
phase and QSS phase both of which respect the constraint on number of coefficients allowed.
The symbolic regression outputs for this approach are shown in table 6.1.

  Table 6.1 Best fit expressions for the transient and Quasi-Steady State approximaton functions
  for the electrolyte functions obtained by the MGGP approach.

 Transient Function     Quasi-Steady State Function  Region
                          e,nQSS = 1 sinh 2 + 0
e,ntrans = 16 ln 6 + 0     e,sQSS = 42 + 3 + 2       0    n
e,strans = 42 + 3 + 2     e,pQSS = 6 sinh 2 + 5      0    s
e,ptrans = 66 ln 6 + 5                               0    p

    Although the equations from table 6.1 produced a markedly improved response during
the transient phase, the performance during the QSS phase was merely at par to the baseline
quadratic approximation model. This raised the prospect of employing a blended approach,
wherein a model changeover between the transient and QSS was contemplated. However,
since there is no precise definition of what constitutes the transient phase of the electrolyte
concentration response, this approach required some ad-hoc timing criteria for correctly
transitioning between the two MGGP equation sets. Further complications arise during
dynamic input conditions, wherein the concentration profiles are mostly in a state of flux
and could linger for longer durations at the contiguous boundary between transient-like
and QSS-like behaviours. In the interest of reproducibility across different cell-chemistries
and corresponding parameter sets, the proposed blended model transition approach was not
further pursued.

    Overall, the long and arduous process of symbolic regression was not a definitive success
in this case mainly due to the limitation of equation deficiency of physical constraints.
Perhaps if yet another Physics-Based Model (PBM) i.e., an alternative to the widely prevalent
DFN model, can be used as the baseline, a few more physical governing equations could
possibly be made available. This can perhaps result in a less restrictive gene-set for coefficient
determination and consequently pave the way for a successful implementation through this
hitherto unexplored route of MGGP-based equation synthesis.

    In conclusion, the quadratic model for electrolyte concentration approximation makes
the best use of the available physical equations. Given the constraints with respect to physical

                                                                198

                                          6.2 A New Electrolyte Model through System Identification

          equations discussed here, it is also deemed to be the optimum family of a priori chosen curves
          capable of modelling the spatial profile of ionic concentration. Notwithstanding these merits,
          the temporal performance of the quadratic approximation approach is sub-optimal as seen
          in fig. 5.16. The author of this thesis addresses this specific issue with a completely different
          approach that shall be discussed next in section 6.2.

       6.2 A New Electrolyte Model through System Identification

          Having performed a comprehensive analysis of the state of the art in SPM modelling with
          electrolyte dynamics, this section presents the author's unique contribution to the field. Firstly,
          the scope of the contribution is identified. The methodology adopted and corresponding
          results are presented thereafter.

        6.2.1 Scope and motivation

          This subsection is intended as a capstone summary helping to briefly recount the discussion
          so far and to provide a context for the author's work in the wider realm of the SPM modelling
          art. In the same vein as the discussion in section 5.5, the scope of the proposed enhancement to
          the SPM concerns entirely with improving the electrolyte subsystem since it has already been
          established in section 5.4.3 that the simplified representation of the solid-phase subsystem
          through a fourth order polynomial approximation method for diffusion of Li0 in the solid
          particle is of sufficiently high accuracy.

              Inspecting the electrolyte domain, the contribution of electrolyte overpotential to terminal
          voltage consists of a) diffusion overpotential b) time-dependent ohmic losses that originates
          from differential concentration gradients (that is indirectly dependent upon concentra-
          tion). Once electrolyte concentration at each time-step is available, eq. (5.71) proposed by
          Prada et al. [183] may be used for the electrolyte overpotential computation. Hence, the
          accurate determination of spatio-temporal values of electrolyte concentration merits focus.

              There exists a subtle detail in the use of eq. (5.71) which is discussed here upfront before
          proceeding ahead to the refined context of the author's work. The intrinsic conductivity
          of electrolyte  is a function of the ionic concentration (refer section 5.4.2). If the ionic
          concentration at the corresponding current collectors are used for evaluating neg and pos,

                                                                199

6.2 A New Electrolyte Model through System Identification

this would lead to a lopsided computation of the overpotential in electrolyte. Furthermore,
under this scheme, the computation of electrolyte conductivity shall be rendered ambiguous
since it is unclear which separator interface shall be chosen for the separator's ionic
concentration. Although this has not been discussed clearly in literature, the author of this
thesis chose to use the mean concentration within each cell region, defined as

e, ( )  =  1      e (, )   =  e, ( )  (6.4)



               0

though other measures of central tendency might be equally valid. Hence, the results
of this section have the associated variability in them depending on how the electrolyte
concentration computations are used in evaluating the intrinsic conductivity of electrolyte.

    As the ionic concentration has both a direct and indirect contribution in eq. (5.71), its
spatio-temporal computation is a critical aspect. As discussed in section 5.6, the quadratic
approximation is a widely used spatio-temporal model for electrolyte concentration which
makes the best use of available physical constraints. As established in the results of
section 5.6.2, while the spatial performance of the quadratic approximation approach is
acceptable, its time-domain performance, particularly at the crucial locations of the current
collector interfaces is mediocre at best.

    The scope of the author's work is to obtain suitable alternate expressions for improving
the computation of time evolution of the electrolyte concentration whilst retaining the
quadratic approximation approach for describing its spatial profile. Such an approach is
motivated by the keen observation that the baseline quadratic approximation model has a
natural `pause' in its model description. To clarify, eqs. (5.80)­(5.86) form a tightly coupled
square system i.e., a set of seven linear equations in seven unknowns. In this system, the time
evolution of e, are described through a separate system of first order Ordinary Differential
Equations (ODEs) given by eqs. (5.97)­(5.99). In a practical implementation, these ODEs are
solved independently in a decoupled manner i.e., by using the coefficients obtained from the
linear system of eqs. (5.80)­(5.86) in the previous time-step. The author's hypothesis is that by
taking advantage of the natural break in the operational sequence which involves two separate
computations between two nearly independent subsystems, it must be possible to replace the

                                                                200

                                          6.2 A New Electrolyte Model through System Identification

          under-performing time-evolution ODEs from the baseline quadratic approximation with a
          superior alternate model.

        6.2.2 Selection of Methodology -- Background and Rationale

          This section presents the background and thought process in systematically arriving at
          the choice of the methodology that was adopted for the new time-evolution model of the
          electrolyte concentration dynamics.

              Based upon the experience gained in dealing with the literature presented in section 5.5,
          it is the author's view that, owing to the complex behaviour of electrolyte, a naive top-down
          approach i.e., including all the physics upfront followed by a systematic simplification, might
          only yield a model that is mathematically intractable for adoption in an embedded Battery
          Management System (BMS) environment. The baseline quadratic approximation method has
          proven that a bottom-up approach i.e., pre-assuming a simplified structure for the final model
          and adapting its coefficients to physical constraints yields a viable candidate for describing
          electrolyte dynamics and for later inclusion in the conventional SPM.

              Upon a closer examination of the rubrics of the baseline quadratic approximation model, it
          comes to light that the natural `pause' discussed towards the end of section 6.2.1 permeates to
          a level more than merely having to operate sequentially on two pseudo-decoupled subsystems
         -- it goes to the extent of rendering the operating philosophy of fitting physical equations
          semi-void. To clarify this statement and to substantiate the claim, while there is no doubt
          that the linear algebraic equations of eqs. (5.80)­(5.86) do incorporate physical principles
          from the DFN model, the same does not hold true for the ODEs of eqs. (5.97)­(5.99). In fact,
          all the boundary conditions from the DFN model have been exhausted by this stage (refer
          section 5.6.2). Although eqs. (5.94)­(5.96) are derived from the DFN model, the coefficients of
          the diffusivities in the Right-Hand Side (RHS) of the next set of equations i.e., eqs. (5.97)­(5.99),
          merely involve substitutions of the spatial derivatives of the assumed quadratic expression.

              Herein lies the weakness of the baseline quadratic approach. Unlike the spatial algebraic
          equations, which are tightly bound by the continuity and flux boundary conditions at the
          separator interfaces, there is no equality constraint on the spatial derivative, which is free to
          grow or shrink without any explicitly imposed bounds. The onus of being accurate is therefore

                                                                201

                                                            6.3 Brief Introduction to System Identification

          on the spatial derivative evaluation which in-turn depends on the correctness of the quadratic
          functions (eqs. (5.75)­(5.77)) themselves. It is not feasible to quantify the magnitude of error
          introduced in the time-evolution of concentration given a small-signal perturbation in the
          coefficients of the quadratic spatial computation i.e., the implicit coupling between them is
          not transparent. Since the quadratic approximation itself is not perfect i.e., does not capture
          the spatial gradient exactly as the P2D model as seen in fig. 5.15, the internal coupling of
          coefficients leads to errors in time-evolution computation.

              The author's approach is to therefore break this detrimental coupling between spatial
          derivative of concentration and its temporal evolution counterpart. Inspired by the fact that
          the quadratic approximation model had almost achieved the desired goals with

             a) a bottoms-up approach i.e., assuming some model structure a priori, and

             b) not bound by any physical considerations due to the exhaustion of governing equations

          led the author to broach a suitable modelling concept that exhibits these common traits, yet
          of a completely different nature and hitherto unexplored in physics-based battery modelling
          in general and electrolyte modelling in particular -- black-box system identification.

       6.3 Brief Introduction to System Identification

          An in-depth coverage of the topic of system identification is well beyond the scope of this
          thesis. However, keeping in mind the interests of the battery modelling community who might
          not be familiar with this subject area, a brief overview of the core ideas that are essential for
          tackling the specific problem at hand is presented. For readers further interested in this topic,
          the author suggests the textbook by Ljung [199] for a comprehensive theoretical treatment
          of the foundation topics in system identification.

              System identification aims to provide a mathematical model of the input-output mapping
          of the system under consideration. The three categories of system identification are:

                 The precise definition of what constitutes a `system' is detailed in Ljung's textbook. However, for all
            practical purposes, in this thesis the word `system' stands for any unknown entity whose terminal behavioural
            model is being sought for -- primarily from input-output data.

                                                                202

              6.4 Overview of Black Box System Identification

a. White box  wherein underlying physical equations are completely known. The numerical
              value of coefficients of governing equations are then to be parametrised from
              input-output data.

b. Black box  wherein no governing equations are available for the system under consid-
              eration. The model formulation is facilitated by a rich set of system theory
              which proceeds by exciting the system with input waveforms with certain
              desirable properties and correlating characteristics from the response to draw
              conclusions about viable mathematical structures capable of emulating the
              terminal behaviour of the system under generalised inputs. Black box system
              identification was employed for the specific problem under consideration in
              this thesis and hence all future descriptions will pertain to this class.

c. Grey box   is a hybrid of the two approaches wherein a part of the model's governing
              physics is known a priori e.g. the structure of a well-defined subsystem that is
              part of a large, complex system may be known ahead of time, where the task
              is to characterise the full system. Grey box system identification tasks can
              often be reduced to a single sub-problem of black box system identification
              by removal of the known physics and tackling them separately.

6.4 Overview of Black Box System Identification

Black-box system identification techniques are composed of the following -- a) non-
parametric methods, and b) parametric methods.

6.4.1 Non-parametric methods

Non-parametric methods do not seek a pre-assumed mathematical structure for the system.
They aim to directly estimate the very kernel of what characterises every system viz. the
Markov parameters in the time-domain and the Frequency Response Function (FRF) in the
frequency domain, thereby requiring infinite number of data points for their representation.
Major non-parametric system identification methods include:

     · Identification in time domain

                                                                203

                                                         6.4 Overview of Black Box System Identification

                     ­ Direct estimation of the system's Markov parameters through statistical correla-
                        tion of its response to an unit-pulse input.

               · Identification in frequency domain i.e., of the FRF
                     1. Direct estimation through input-output statistical cross-correlation.
                    2. Empirical Transfer Function Estimate (ETFE) using Discrete Fourier Transforms
                        (DFTs) of input and output sequences.
                    3. Smoothed periodogram estimates using Welch's method.
                    4. Blackman-Tukey Estimate using standard filter windows in digital signal pro-
                        cessing (such as Hamming, Hanning, Bartlett, Boxcar etc.).

        6.4.2 Parametric methods

          Parametric methods aim to fit specific input-output data to some family of well-known
          mathematical constructs that are and widely applicable to a large variety of inputs. It
          is important to recognise that, in contrast to white-box system identification, the salient
          coefficients/properties of these mathematical structures do not, in any way correspond to
          physical properties of the system under consideration. Major parametric system identification
          methods use:

               · Transfer-function based frequency domain model structures
                     1. Output Error (OE) model
                    2. Auto Regressive with Exogenous Inputs (ARX) model
                    3. Auto Regressive with Moving Average and Exogenous Inputs (ARMAX) model
                    4. Box-Jenkins (BJ) model

               · State-space time-domain model structures
                     1. Ho-Kalman realisation
                    2. Eigensystem Realisation Algorithm (ERA) realisation
                    3. Deterministic and stochastic subspace structures

                                                                204

                                                         6.4 Overview of Black Box System Identification

        6.4.3 Investigation of suitable system identification methodology

          Among the various system identification techniques mentioned, the non-parametric methods
          have some serious drawbacks. As outlined in section 6.2.2, the author is inspired by the trait
          of having a pre-assumed model structure that brought the baseline quadratic approximation
          closer to a successful realisation. The non-parametric methods do not conform to this
          philosophy. Furthermore, the requirement of infinite number of data samples in order to
          fully quantify the system dampens its feasibility for implementation in resource constrained
          environments. The author is of the opinion that resorting to truncation of the characteristic
          sequence shall only yield a sub-optimal solution. Hence non-parametric methods are ruled
          out for applying to the task at hand.

              While parametric state-space identification is a feasible alternative, these methodologies
          are tedious and error-prone. For instance, applying the Ho-Kalman algorithm requires
          construction of large-sized Block-Hankel matrices followed by a Singular Value Decom-
          position (SVD) operation. The ERA uses the identical set of operations of the Ho-Kalman
          procedure, except that certain blocks in the Hankel matrices are chosen at random for deletion
          for obtaining better estimates in low Signal to Noise Ratio (SNR) environments and for
          capturing slowly decaying phenomena with long time constants. The subspace methods are
          mathematically involved, requiring a profound understanding of concepts from linear algebra
          such as projections to orthogonal subspaces. The system under consideration is presented in
          section 6.5 and after linearity considerations, refined in section 6.7.2. It is composed of two
          independent Single Input Single Output (SISO) subsystems. However, the inflection point
          in the complexity-performance trade-off in state-space identification is achieved only when
          dealing with Multi Input Multi Output (MIMO) systems that suggest strong cross-coupling
          among its internal states or at least some degree of coupling among the various inputs and
          outputs. Furthermore, the impulse responses of the system(s) under consideration do not
          have long tails since they are characterised by relatively short time constants. Owing to these
          reasons, it was decided that state space identification methods shall not be adopted here.

              Owing to a cornucopia of well-established technical know-how readily available in the
          systems engineers toolkit, transfer function based model structures are naturally amenable
          for control-oriented applications. However, there exists an apparent discrepancy to its usage
          for this case, that must be addressed first. Transfer function methods are a frequency domain

                                                                205

                                6.5 Introduction to Electrolyte Time-Evolution Subsystems

technique and hence, the resulting model descriptions have mathematical structures radically
different from the time-domain model equations of the conventional SPM within which they
are to be embedded. This conundrum is resolved by closely inspecting the model's scope and
its tractability for conversion to time domain as explained next.

    It is worth remembering that, as per section 2.2.1, for the reduced order modelling
of the entire cell, all frequency domain model groups were considered as out of scope of
this thesis specifically due to the overhead of conversion from frequency to time domain
for implementation and other associated difficulties. The blanket exclusion nature of this
statement is to be revisited considering the specific scope of the problem at hand. The body
of literature on frequency domain Reduced Order Models (ROMs) discuss obtaining physics-
based transcendental transfer functions for all electrochemical quantities of the coupled
Partial Differential Algebraic System (PDAE) system of table 1.1 through a top-down approach.
However, the frequency domain system identification methods are concerned with obtaining
standard rational transfer functions for a much narrower scope viz. the time-evolution
subsystem, through a bottom-up approach. Such rational transfer functions are to obtained for
SISO systems for which an approximation-free effortless conversion already exists in classical
control theory and is presented in section 6.8.7. In view of their overwhelming simplicity
and familiarity to control engineers, after considering these arguments that circumvent their
only apparent impediment to adoption, transfer function based system identification was
chosen for tackling the problem at hand. The steps leading to the identification procedure is
presented next.

6.5 Introduction to Electrolyte Time-Evolution Subsystems

The first order ODEs of eqs. (5.97)­(5.99) in the baseline quadratic approximation model for
electrolyte concentration describe the time-evolution of the overall number of moles of Li+ in

each of the three regions of the cell e,. Through system identification, the author seeks to

obtain the two rational transfer functions of e,neg and e,pos to the applied current  in the

frequency  domain  i.e.,  e,n()  and  e,p()  .  Based  on  the  DFN  model,  the  total  moles  of  Li+  per
                            ()          ()

unit area in the separator e,s is not a function of the exogenous applied current. Therefore,

the baseline quadratic approximation ODE is retained for computing its time-evolution.

                                                                206

                                                                           6.6 Design of Persistent Excitations

       6.6 Design of Persistent Excitations

          In order to successfully apply any system identification technique, the input signal must
          be carefully designed to be persistently exciting [199]. Narendra and Annaswamy [200, 201]
          were among the earliest researchers to provide a detailed treatment of the desirable properties
          of persistent excitation and their implication to the quality of the identification output. A
          practical method to achieve persistent excitation is to subject the system under consideration
          to a sequence of well-characterised input signals that are capable of exciting its hypothesised
          modes. For this task, the author of this thesis chose to use the data-quality guidance provided
          by The Mathworks Inc. [202] and performed an iterative refinement until the identification
          procedure resulted in a generalisable model.

              Before discussing the shape characteristics of the input sequence, its magnitude must be
          established. The various specially prepared input sequence families do not share a common
          definition for their magnitudes. A guiding principle in system identification is that it is
          important to have the input signal's magnitude to be representative of standard operating
          conditions. Although standardised drive cycle profiles are available, from which a speed
          to current mapping can be performed, it is impossible to predict a priori, the specific
          amplitudes of currents that the cell may undergo under real-life load conditions. Without
          further deterministic information, the author of this thesis chose to interpret magnitude as
          being the peak amplitude of the input current profile. As seen in fig. 5.12, the representative
          Urban Dynamometer Driving Schedule (UDDS) drivecycle input profile corresponds to a peak
          of 3C i.e., 180 A. Following the standard principles of system identification, it is desirable for
          the inputs to the system to lie along some measure of central tendency. This is to enable the
          identified system to generalise well i.e., not deviate too far from the truth when subject to
          inputs that are far away from the central measure. Yet another consideration is not to saturate
          the identified model by choosing input magnitude to be too close to the peak of the expected
          operating range. Taking into account all aforementioned considerations, the peak amplitude
          of the input current was fixed at 2C i.e., 2/3rd of the UDDS profile's peak current amplitude.

        6.6.1 Training current profile

          Since not much prior information is available about the poles and zeros of the electrolyte
          subsystem(s) in question, a wide variety of special waveforms with a sampling interval of 1 s

                                                                207

                                         6.6 Design of Persistent Excitations

were used for the current perturbation used in this system identification task. The specific
input sequence consisted of

    1. Random Binary Signal (RBS) (0­199 s)

    2. `Chirp' i.e., a swept cosine signal from 0­100 mHz (200­799 s)

    3. Periodic Random Binary Signal with a period of 200 s and 2 such periods (800­1199 s)

thereby helping to obtain a wide-sense persistent excitation. The swept cosine signal is
designed to excite the low frequency (DC) modes of the electrolyte subsystem and helps to
capture the system's response to constant and other systematically varying input profiles.
The two RBSs are intended to target the poles and zeros of the electrolyte subsystem that
would typically be excited by highly dynamic input profiles. The periodicity in one of the
RBSs was introduced to draw out any repeated real pole or complex conjugate poles in the
system that might otherwise appear to be a single real pole. The presence of both low and
high frequency spectra in the combined training set presents a high degree of confidence to
capture the relevant dynamics of the electrolyte subsystem. The input current profile used
for this system identification task is plotted in fig. 6.1.

                         RBS  Chirp           Periodic RBS

Itrain (A)   120
               80
               40
                0
             ­40
             ­80
            ­120

            100                          100

            0                            0

            ­100                         ­100
                 90 100 110 120 130 140      1000 1010 1020 1030 1040 1050

            0 100 200 300 400 500 600 700 800 900 1000 1100 1200
                                                               time (sec)

Figure 6.1 Input current profile used as the training set for system identification. The sequence
consists of a) a Random Binary Signal, b) a chirp or swept cosine signal (0­100 mHz), and c) a
periodic Random Binary Signal thereby covering both low and high frequency spectra while
incorporating the potential to excite any periodic modes in the system to be identified.

                                                                208

                                                                           6.6 Design of Persistent Excitations

        6.6.2 Validation current profile

          For the purposes of identification, the P2D model is considered as the true system. First, the
          current profile from the training set is applied to the P2D model. Its simulation results, in
          particular the numerically solved concentration values at each spatially discretised node in
          each of the three regions per time-step is integrated over the thickness of the respective
          regions and multiplied with their respective porosities to obtain the number of moles of Li+
          per unit area in each of the three regions e,. Only the quantities e,n and e,p are chosen
          as the outputs for system identification and a transfer function model is fitted as per the
          evaluation procedure discussed in section 6.8.

              As with any classical curve fitting (numerical regression) procedure, system identification
          is also prone to overfitting the training data. In general, the `best' transfer function that
          identifies the given system is the lowest order model that not only minimises the training
          error, but also minimises the error on a previously unseen validation dataset. In the absence
          of an independent validation dataset, the training error can be made arbitrarily small by
          increasing the number of poles and zeros of the transfer function models without any bounds.
          However, such a model shall not have truly identified the dynamics of the system and
          shall not generalise well to real-world datasets outside the training realm. Hence, having
          an independent validation current profile for the task at hand is of paramount importance.

              For the system identification task at hand, the characteristic waveforms of the validation
          profile were deliberately conjured to be differ vastly from that used in training the model.
          The validation profile consists of the following sequence

              1. Periodic Random Gaussian Signal (RGS) with 4 periods of 200 s each (0­799 s)

              2. Pseudorandom Binary Signal (PRBS) for emulating white noise i.e., with a flat power
                 spectra across the frequency spectrum (800­999 s)

              3. Multi-sine signal i.e., a signal consisting of sinusoids at various fundamental frequencies
                 added together (1000­1199 s)

              Overall, the validation profile has been designed to cover a wide range of frequencies akin
          to the training profile, but differing completely in its time-domain appearance. The specific
          validation current profile used in this system identification is shown in fig. 6.2.

                                                                209

                                                   6.6 Design of Persistent Excitations

                        RGS                  PRBS               Multisine

            120

            80

Itrain (A)  40

            0

            ­40

            ­80

            ­120

                  100                        100                100

                  0                          0                  0

                  ­100                       ­100               ­100

                        360 380 400 420 440        940 960 980  16801700172017401760

                  0 200 400 600 800 1000 1200 1400 1600 1800 2000 2200
                                                                     time (sec)

Figure 6.2 Input current profile used as the validation set for system identification. The
sequence consists of a) a Random Gaussian Signal, b) a Pseudorandom Binary Signal, and c) a
multisine waveform. The overall sequence is intended to emulate the flat power spectrum of white
noise (with the PRBS) and excite any poles and zeros within 3 spread of the RGS mean. The
multisine signal is swept is composed of sinusoids with fundamental frequencies from 100 mHz
up to the Nyquist frequency. Its amplitude variation across the frequency spectrum increases
the probability to capture the system's modes that were possibly missed by the preceding two
waveforms.

    MATLAB code that can be used to generate the training and validation input profiles is
shown in code snippet 6.1.

                                                                210

                                           6.6 Design of Persistent Excitations

% Needs matlab's system identification toolbox
clear; close all; clc; format short g;
warning('off','Ident:dataprocess:idinput7'); % suppress sysid warnings
I_1C = 60; % Amps
range = 2*[-I_1C I_1C]; % peak-peak swing is ±2C = 40 A
NumCh = 1; % no of channels (used by sysid toolbox for multichannel id)
Ts = 1; % sampling interval

%% Random Binary Input Signal (RBS)

N = 200; % samples per quantum of each waveform

u1 = idinput(N,'rbs',[],range); % 'idinput' from sysid toolbox

%% Chirp Signal (swept cosine)

t_chirp_start = 0;

t_chirp_end = 3*N*Ts; %

t              = linspace(t_chirp_start,t_chirp_end,3*N);

f0             = 0;

f1             = 1e-1; % 1 = 100 mHz is the max chirp frequency

u2             = max(range)*chirp(t,f0,t(end),f1)';

%% Periodic Random Binary Input Signal (Periodic RBS)

bin_seq_Period = N; % seconds

bin_seq_Period_N = ceil(bin_seq_Period/Ts); % samples

bin_NumPeriod = 2;

u3 = idinput([bin_seq_Period_N,NumCh,bin_NumPeriod],'rbs',[],range);

%% Random Guassian Signal (RGS)

rgs_Period           = N; % seconds

rgs_Period_samples = ceil(rgs_Period/Ts);

rgs_NumPeriod        = 4;

u4 = idinput([rgs_Period_samples,NumCh,rgs_NumPeriod],'rgs',[],range/2);

%% PseudoRandom Binary Signal (PRBS)

prbs_Period          = N; % seconds

prbs_Period_samples = ceil(prbs_Period/Ts);

u5                   = idinput(N,'prbs',[],range);

%% Multisine signal (sum of sines)

samples_per_Period = 2*N;

NumPeriod            = 3;

[u6,freq] = idinput([samples_per_Period 1 NumPeriod],'sine',[],range);

%% Split into training and validation data sets
I_load_train = [u1;u2;u3];
I_load_validate = [u4;u5;u6];

    Code snippet 6.1 Generation of training and validation input current profiles in MATLAB

                                                                 211

                                                      6.7 Investigation of Linearity and Time Invariance

       6.7 Investigation of Linearity and Time Invariance

          The transfer function identification techniques mentioned in section 6.4 are applicable only
          for Linear Time-Invariant (LTI) systems. At first glance, this seems to be overly restrictive for
          the system(s) at hand. When considered as a single macroscopic entity, a lithium ion battery,
          exhibits overall non-linear characteristics, particularly due to the strong non-linearities in
          a) the Butler-Volmer reaction kinetics (see eq. (1.7)), and b) the Open Circuit Potentials (OCPs)
          of the two electrodes (see eq. (5.58) and eq. (5.58)). However, we are dealing with a much
          narrower scope i.e., the systems under consideration are just the two sub-system entities (one
          per electrode) that transform the applied current at a particular time-step to the overall moles
          per unit area of Li+ ions in the corresponding electrode region of the electrolyte at that same
          instant. Therefore, it is the linearity and time-invariance of these subsystems that must be
          investigated.

        6.7.1 Time-invariance of the electrolyte time-evolution subsystems

          A test for time-invariance is prescribed in the lecture notes on system identification by
          Plett [203]. The steps involved therein are reproduced here after being suitably adapted
          to the notation of the subsystems at hand.

              1. Apply input 1() =  () to the system and measure the outputs e,n1() and e,p1().
              2. Apply a delayed version of the input by  seconds i.e., 2() =  ( -  ) to the system

                 and measure the outputs e,n2() and e,n2().
              3. If e,n2() = e,n1( -  ) and e,p2() = e,p1( -  ) for all possible delays , as well as for

                 all choice of input signals  (), then the systems are time-invariant.

              For the systems at hand, it is not strictly required to apply this prescriptive test. Unless
          a fundamental change in the underlying reaction phenomena/chemistry occur that alter the
          performance over time, these systems can be treated as time-invariant. Factors that induce
          time-dependent shift in the behaviour of lithium ion batteries are degradation phenomena
          such as thickening of Solid-Electrolyte Interphase (SEI) layer, dendrite growth or mechanical
          fatigue in electrodes which in-turn affect electrolytic diffusion and conductivity. Yet another
          cause of time-dependent behavioural change is the drift in parameter values. However, these

                                                                212

                                                      6.7 Investigation of Linearity and Time Invariance

          phenomena are typically one or mode orders of magnitude slower than the P2D dynamics.
          This separation of time-scales imply that, in practice they can be decoupled. Therefore,
          separate models can be identified for the faster and slower processes. A suitable model-
          blending approach can then be considered to cover all processes across time-scales. Although
          the concepts developed here for the fast electrolyte dynamics can be suitably adapted to such
          slow phenomena, their study falls outside the scope of this thesis and is left as an exercise for
          future work. Thus, the overall battery system, and hence by extension, the two subsystems
          considered are deemed to be time-invariant. However, in the interest of completeness, this
          author systematically applied the aforementioned test procedure with every combination
          arising from the choice of ten time-delay values and the following six current profiles --
          a) constant current 1C discharge, b) constant current 3C discharge, c) constant current
          1C charge, d) UDDS input profile with peak amplitude of 3C, e) training profile used in
          system identification (see fig. 6.1), and f ) validation profile used in system identification (see
          fig. 6.2). Finally, these tests were repeated for a choice of five different initial States of Charge
          (SOCs) -- 90 %, 70 %, 50 %, 30 % and 10 %.

              Figure 6.3 demonstrates the time-invariance of the subsystems considered at an initial
          SOC of 50 % for a time-delay of 130 s using the highly dynamic system identification training
          sequence that was synthesised by this thesis author (see fig. 6.1). The applied current
          profile 1() (top row of the central column) produces the outputs e,n1() and e,p1()
          shown in the top left and top right plots respectively. When the delayed version of this
          input sequence 2() = 1( -  ) (middle row, middle column) is applied, it results in the
          outputs e,n2() and e,p2() to its left and right respectively. Following the steps of the
          test procedure, subtracting these outputs from the correspondingly delayed versions of
          their original counterparts result in zero residuals, thereby proving time-invariance of these
          subsystems under these representative test conditions. The residual sequences in the bottom
          row of plots are of (10-15) and arise due to numerical roundoffs that occur when operating
          close to the noise floor of the machine's floating point units.

                 The number of moles of Li+ per unit area in the electrolyte does not depend on the electrode's SOC.
            However, different starting point of SOCs were considered to have a wide variety in the length of the recorded
            data until cut-offs were hit. e.g. starting at 90 % SOC could mean that for a current spike early in the profile,
            upper cut-off voltage shall be hit sooner leaving a smaller set of logged simulation data.

                                                                213

                                                      6.7 Investigation of Linearity and Time Invariance

                                                                   The systems on the
                                                                   left and right are
                                                                   both time-invariant

              Figure 6.3 Demonstration of time-invariance of the subsystems considered. The applied current
              profile 1() is the system identification training sequence from fig. 6.1 (top row of the central
              column). The top left plot shows the response e,n1(), while that on the top right shows e,p1().
             The second row of the middle column shows the same input sequence delayed by  = 130 s.
             Application of this current profile 2() = 1( -  ) results in the outputs e,n2() and e,p2()
              to its left and right respectively. Subtracting these from the correspondingly delayed versions of
              the original outputs result in zero residuals, thereby proving time-invariance of these subsystems.
             The jitter shown in the bottom row of plots is (10-15) in magnitude and are due to the numerical
              roundoffs that occur when operating close to the noise floor of the machine's floating point units.

                                                                214

                             6.7 Investigation of Linearity and Time Invariance

    Similar to the case demonstrated here, all tests for time-invariance for all permutations
of the chosen operating conditions passed successfully i.e., the delayed version of the
original output signals accurately matched with the responses to the corresponding delayed
input (down to machine precision), thereby confirming the time-variance of the subsystems
considered in the system identification problem, which enables us to proceed further.

6.7.2 Linearity analysis of the electrolyte time-evolution subsystems

De-biasing of input signals

In the analyses of linearity of systems, it is a recommended practice to de-bias the output
and input quantities about their mean operating conditions. The input signal in this case
is the applied load current  (), which can be both positive (during discharge) and negative
(during charge). The mean of the training profile is -1.167 A and that of the validation profile
is -0.3273 A. Clearly, the mean values are dependent upon the actual current profile used. The
appropriately de-biased signal i.e.,  ( ) =  () -  ( ) is to be used for training and validation
data sets in the system identification procedure. For the purpose of linearity analysis, it is a
standard practice to simply apply a step change in input (from zero) and measure the output
responses, thereby bypassing the de-biasing requirements.

    For the output signals, bias values can be pre-computed analytically and accounted for.
The overall number of moles of Li+ per unit area in any region within the cell cannot
be physically negative. Even though under high C-rates, ion depletion at localised spatial
locations (such as the current collectors) is certainly possible, the entire thickness of any
region cannot become devoid of ions at any point in time since the cell shall instantaneously
cease to work. Thus, for a typical well-designed cell operating within the manufacturer
prescribed C-rate limits, the output signals under consideration operate in a small window
about their initial values. In the author's simulations, even at ±5C, the overall number of
moles of Li+ in any cell region exhibited a maximum change of less than 15 % from its initial
value. Thus, the de-biased output variables for system identification e,() can be obtained by
subtracting their respective initial values e,(0) (see eq. (5.100) and eq. (5.102)) from e,().

                             e,n() = e,n() - e,n(0)  (6.5)

                             e,p() = e,p() - e,p(0)  (6.6)

                                                                215

                                       6.7 Investigation of Linearity and Time Invariance

which  implies  that  the  transfer  functions  to  be  identified  have  to  be  modified  to  be  e,n()    and
                                                                                                      ( )

e,p()  respectively.  This  does  not  affect  the  time-invariance  proved       in  section  6.7.1  since  the
  ( )

initial values e,(0) are merely constants and hence not time-dependent.

Test for linearity

Similar to the test for time invariance described in section 6.7.1, a test for linearity is also
prescribed in the lecture notes on system identification by Plett [203]. The steps involved
therein are reproduced here after being suitably adapted to the notation of the subsystems at
hand. This is essentially a recipe for testing the superposition principle.

    1. Apply input profile 1() to the system and obtain outputs e,n1() and e,p1().
    2. Apply a different profile 2() to the system and obtain outputs e,n2() and e,n2().

    3. Now apply an input profile 3() = 1() + 2() and obtain a corresponding set of
       outputs e,n3() and e,n3().

    4. If e,n3() =  e,n1() +  e,n2() and e,p3() =  e,p1() +  e,p2() for all pos-
       sible {, } as well as for choice of input signals {1(), 2()}, then the systems are
       linear.

    As in the time-invariance test, the same set of five different initial SOCs -- 90 %, 70 %,
50 %, 30 % and 10 %, was retained for these linearity tests. For each test run, a pseudo-random
number generator was used to select the values of {, } from the set of real numbers  (not
restricted to the set of integers ) in the closed interval spanning [-1.25, 1.25]. Negative values
are acceptable for both the scaling coefficients since the resulting composite input 3() can
be either positive or negative. The composite signal 3() was obtained by taking a random
combination of any two of the following current profiles -- a) step input with a constant
current 1C discharge, b) step input with a constant current discharge at C/5, c) step input
with a constant current 1C charge, d) step input with a constant current charge at C/5,

    The scaling factors  and  were restricted to the range [-1.25, 1.25] in consideration of
limiting the peak applied current to within a ±3C window -- the operating condition for most
Battery Electric Vehicles (BEVs), so that the isothermal assumption for the model shall remain
valid. This peak current corner case occurs when the pseudo-random generator chooses both

                                                                216

                                                      6.7 Investigation of Linearity and Time Invariance

          scaling factors at the selected range's limits for the 1C constant current discharge or charging
          cases. The limited range of the scaling factors are also motivated by the fact that most real-
          world systems remain linear only within a certain operating window. In particular, care must
          be taken to ensure that the cell's SOC during the linearity test remains within its physical
          limits for any initial SOC. Furthermore, localised saturation or depletion of ions for extended
          durations must be avoided. Hence it can be concluded that, with the chosen range for the
          scaling factors, if the two subsystems under consideration remain linear everywhere below a
          peak current of ±3C in the isothermal case, then the linearity tests are considered as passed.
          Future extensions to undertake a temperature-dependent system identification exercise can
          potentially use a first-order Taylor expansion about this operating window. The discussion
          thus far has fully established all the conditions for conducting the test for linearity.

              Figure 6.4 illustrates one instance of a linearity test wherein constant currents and integer
          scaling factors are used for the sake of illustration. The plots in the left column deal with
          the electrolyte time-evolution subsystem in the negative electrode region. Similarly, the plots
          in the right column deal with the corresponding subsystem in the positive electrode region.
          A discharge current of 1C i.e., 60 A is first applied and the corresponding outputs e,n1 and
          e,p1 are obtained. Secondly, a discharge current of C/5 i.e., is applied and the corresponding
          outputs e,n2 and e,p2 are obtained. These set of responses are plotted in the top row of
          fig. 6.4. Now, a third value of input current 3, computed as a linear combination of the
          previous input currents i.e., 3 = 1 + 2 is applied. For illustrative purposes, the integer
          set (, ) = (1, -2) was chosen for the scaling coefficients, which implies 3 = 12 A. The
          corresponding outputs e,n3 and e,p3 are plotted in the middle row. As per the test for
          linearity, if these signals are equal to the signal generated by manually computing the linear
          combination of the preceding two outputs, then the system is linear.

              The plots in the third row show e,n3 and e,p3 overlaid with their respective linear
          combination signals. In the case of the subsystem in the negative electrode region, the
          transient performance matches precisely until 450 s, whereas that in the positive electrode
          region exhibits a good matching for approximately the first 250 s. However, for the horizon
          considered the two overlaid plots do not overlap exactly. Hence, the systems are not truly
          linear. However, the exhibited behaviour is quite close to linearity, with the maximum absolute
          error in each region, even outside the initial transient, being (10-4) -- an order of magnitude

                                                                217

                                                      6.7 Investigation of Linearity and Time Invariance

              Figure 6.4 Illustration of one instance of linearity tests for the subsystems under consideration.
              For this visualisation, constant current inputs are used throughout. The top row of plots shows e,n
              and e,p for two step inputs 1() = 60 A and 2() = 12 A i.e., discharge with 1C and C/5 currents
              respectively. The second row of plots shows e,n3 and e,p3 for 3 = 36 A, where 3 = 1 + 2
             with (, ) = (1, -2). The last row of plots overlays these quantities with the manually computed
              linear combination of their two preceding responses. Had these sequences overlapped exactly,
              the systems would have been exactly linear. Despite exhibiting deviations over the considered
              horizon, the transient responses in both electrode regions do follow the superposition principle.
              Even past the transient, maximum error in both cases is an order of magnitude lower than the
              individual outputs. Hence, the two systems are deemed to be approximately linear.

                                                                218

                                                 6.8 Transfer Function Identification Procedure

lower than its individual components. This behaviour was exhibited for all test instances
considered. Considering that for dynamic simulation runs, the transient performance is
paramount to the good performance of the model, in conjunction with the aforementioned
low error metric, these subsystems can be considered to be approximately linear.

    Based on the analysis presented here, LTI behaviour for the two subsystems is assumed,
which facilitates in proceeding with the actual system identification procedure.

6.8 Transfer Function Identification Procedure§

6.8.1 The transfer operator and its model form

In a classical system identification task, the discrete-time transfer functions for the systems
under consideration need to be determined. These discrete-time transfer functions are
based on Z-transforms in the frequency domain. However, for the purpose of working in
time-domain, an analogous linear operator  that performs a forward shift on its input
i.e., []  [ + 1]. Similarly, applying the backward shift operator -1 on the input
yields its value at the previous time-step i.e., -1[]  [ - 1].

    In a generic LTI system wherein measurements are corrupted by noise, The system
dynamics are represented by the transfer operator ()¶ that acts on the applied input [],
whereas the noise dynamics are represented by the disturbance operator  () that acts to
filter (or shape) an assumed white noise input [].

Assuming linearity and time-invariance throughout, the overall output can be written as

the linear combination

                                [] = ()[] +  ()[]                                    (6.7)

where  ()  =  ()  and    ()  =   ()  are  the  transfer  operators  describing  the  dynamics of  the
              ()                ()

system and disturbance respectively.

                 §The early stages of this section presents this author's digested summary of the theoretical framework
            adapted from a subset of content from the lecture notes on system identification by Plett [203­205].

                 ¶The term transfer operator in the time domain mathematically corresponds to the term transfer function
            in the frequency domain. Mathematically, () = ()||.=

                                                                219

           6.8 Transfer Function Identification Procedure

    (), (), () and () are rational polynomials in . The two transfer operators ()
and  () can be represented by

()   =  -  1  1-1 +  +  -                                                   (6.8)
              + 1-1 +  +  -

 ()  =  -  1  1-1 +  +  -                                                   (6.9)
              + 1-1 +  +  -

where (, ) represent the number of transport delay samples, (, ) the number of
feedforward coefficients and (, ), the number of feedback coefficients in () and  ()
respectively.

    In this system identification task at hand, the output measurements are collected from a
noise-free simulation of the P2D model i.e., the disturbance transfer operator in eq. (6.7) is
zero

                                                                    0       (6.10)
                                     [] = ()[] + ¨(¨ B) []                  (6.11)

                                                                         ¨

Hence, the time-domain output reduces to
                                     [] = ()[]

    Thus, the system identification task becomes one that of estimating

    1. The number of transport delay samples .
   2. The number of feedforward coefficients (zeros) .
   3. The zeros themselves 1, 2, ...  .
   4. The number of feedback coefficients (poles) .
    5. The pole locations 1, 2 ...  .
for each of the two transfer operators 1() and 2() i.e., the electrolyte time-evolution
subsystems in the negative and positive electrode region respectively.

                                                                220

                                                           6.8 Transfer Function Identification Procedure

        6.8.2 Estimation of transport delay

          The transport delay  can be estimated visually by inspecting the step response of the
          systems under consideration.

              In fig. 6.4, step inputs of 1 = 60 A, 2 = 12 A, and 3 = 36 A were applied to the two
          subsystems. Inspecting closely all the responses i.e., e,n1 , e,n2 and e,n3 in the negative
          electrode region, and e,p1 , e,p2 and e,p3 in the positive electrode region, it is clear that all
          these outputs start exactly at zero. Therefore, there is no delay term to be considered for the
          transfer operators i.e.,  = 0 for both subsystems.

        6.8.3 Choice of model structure

          Among the transfer-function model structures mentioned in section 6.4.2, the ARX model
          structure is too simplistic to consider. Despite the fact that its numerical computation involves
          only basic linear algebra operations, that can be efficiently handled on modern computing
          systems, it is considered to produce poor estimates of the system's poles and zeros. In the
          absence of contributions from the noise-term, the all-encompassing model structure used by
          the Box-Jenkins approach is deemed to be unnecessary for the problem at hand. Therefore,
          the two model structures considered were ARMAX and OE for the coefficient determination.

        6.8.4 Starting guesses for coefficient orders

          At first, the training profile of fig. 6.1 is de-biased (through mean removal) and applied as
          the input current profile in a P2D simulation. The outputs of this simulation are suitably
          post-processed as per the following sequence of steps.

              1. The concentrations solved at various node locations within each electrode are numer-
                 ically integrated over the corresponding electrode thicknesses using trapezoidal rule.

              2. The resulting integral value is multiplied with the porosity of the corresponding
                 electrode region to obtain e,ntrain () and e,ptrain ().

              3. These quantities are then de-biased by subtracting their initial values to obtain
                 e,ntrain () and e,ptrain ().

                                                                221

                                           6.8 Transfer Function Identification Procedure

    The same procedure is repeated for the validation current profile of fig. 6.2 to obtain
e,nval () and e,nval (). These data sets are used for all subsequent sub-tasks involved in this
system identification exercise.

    In order to reduce the search window for the coefficient determination in the parametric
transfer function methods, the hand-estimation of coefficient order through non-parametric
methods may be performed. This coarse estimate can act as a feeder to help in the faster
convergence of the non-linear optimisation algorithms used in the parametric methods. In
this case, a basic spectral analysis using a Hanning window implemented using the MATLAB
command spa.m is applied to the time-domain data to transform it into frequency response
data.

                        |Qe,ntrain |                                                         |Qe,pval |
­90                                                                  ­80

­96                                                                  ­88

­102                                                                 ­96

dB
                                                                 dB

­108                                                                 ­104

­114                                                                 ­112

­120  10­1                                 101                       ­120  10­1                          100  101
10­2                                  100                            10­2

      Frequency,  (rad/s)                                                  Frequency,  (rad/s)

Figure 6.5 Bode magnitude plots showing the estimated frequency response for the two
subsystems under consideration. The frequency response data was obtained through a spectral
analysis i.e., by computing the ratios of spectra of the de-biased input and output sequences. The
sequences were smoothed using a Hanning window before computing the ratio.

              Figure 6.5 shows the Bode magnitude plot of the frequency response for a) the training
          set in the negative electrode region, and b) the validation set in the positive electrode region.
          In the plots, a broad combination of the two data sets in the two electrode region is depicted
          to achieve a compact representation of all possible permutations and to avoid redundancies
          by plotting visually similar information. It is important to note that these Bode diagrams
          obtained by such non-parametric methods only represent a crude approximation of the
          physical dynamics intended to help in initial estimates of the system behaviour.

                                                                222

                                                           6.8 Transfer Function Identification Procedure

              Some preliminary understanding of the various characteristics of the system can be
          gleaned from these Bode diagrams. The first visually striking feature is the similarity in the
          approximate frequency characteristics in the negative and positive electrode regions, even
          when excited by completely different data in the time domain. This confirms the author's
          assumptions of equal `complexity' in the symbolic regression search discussed in section 6.1.1.
          This is also congruent with the physical behaviour of the electrolyte in these two regions.

          Finite DC gain

          By visual extension of the frequency responses towards lower frequencies, it is clear that
          the DC gains of both the systems are finite and below unity. This behaviour can clearly be
          seen in the time-domain responses of fig. 6.4. For the plotted time-horizon, this effect is most
          visible for the case of the 12 A constant current input, wherein the responses of both regions
          settle to a finite value after an initial transient.

              There is 10 dB variability in the low frequency gain between the two Bode plots in fig. 6.5.
          This can be attributed to the following factors. A compromise with the spectral estimation
          method is that using a higher number of frequency bins results in lower resolution per bin
          and vice-versa. By varying the number of frequency bins and focusing on the low frequency
          range, the resolution of the DC gain can be improved. The rest of the variability can be
          attributed to the fact that the training and test profiles behave differently and do not excite
          the same dynamics. In particular, the swept frequency cosine (chirp) signal in the training
          set was specifically designed to draw out the low frequency dynamics with a high fidelity.
          Finally, the small range of variation in the DC gain could also be due to the intrinsic small-
          scale variations of the electrolyte behaviour in these two regions. Although on a macroscopic
          frequency scale the two regions behave similarly, the differences in electrode thicknesses and
          porosities could contribute to the small difference in the DC gain. This helps to confirm that
          two non-identical transfer functions are being sought for -- one for each electrode region.

              Finally, the finiteness of the DC gain helps to narrow down the search window for the
          parametric model structures. In particular, this fact indicates that the model structures to be
          trialled must not have any integrator terms (or poles at the origin of the complex plane).

                                                                223

                                                           6.8 Transfer Function Identification Procedure

          Resonance and model order

          First order transfer functions do not exhibit characteristic peaks or resonances in their
          frequency responses. However, for the Bode plot on the left of fig. 6.5, a pronounced resonance
          around 0.15 rad s-1 is observable. This has an enormous impact -- it presents an important
          clue that the first order time-evolution ODEs of eq. (5.97) and eq. (5.99) are inadequate to
          represent the system dynamics.

              An apparent contradiction to the first-order inadequacy claim stems from the Bode plot
          on the right hand side in fig. 6.5. In this case, there are no resonances in the magnitude
          response indicating that a first order model description is sufficient. However, a vital aspect
          to be noted here is the nature of the validation current profile when compared to that of the
          training current profile. The coarse frequency response data obtained by the spectral method
          is sensitive to the actual input sequence employed. From systems theory, the resonances
          at a frequency occur due to the presence of lightly damped complex conjugate poles at
          that frequency. The periodic RGS was explicitly designed in the training set and is however
          absent in the validation set. The unique characteristics of the validation set and its influence
          on coefficient order is discussed next.

              As per the arguments presented in the preceding discussions, there exists an implicit
          constraint that the behaviour of the time-evolution subsystems in the two electrode regions
          are expected to be of similar `complexity'. Therefore, based on the presence of the resonance
          in the Bode magnitude plot for the response to training profile in the negative electrode
          region, it has to be concluded that the two subsystems are at-least of second order.

          Estimation of number of poles and zeros

          The high-frequency roll-off in the slopes of the Bode magnitude plots in fig. 6.5 provide clues
          on the number of poles in the system. The corner frequency c in both cases appear to be
          around 0.15 rad s-1. The high-frequency slope of both systems is 20 dB per decade, which
          implies that they have at-least one more pole than the number of zeros if using a continuous
          time transfer function. For the corresponding z-domain transfer function, this implies that
            .

                                                                224

                                                 6.8 Transfer Function Identification Procedure

    In the aspect of estimating the number and locations of zeros, the validation profile
outshines the training profile. While the Bode plot obtained with the training profile does
not indicate the presence of zeros in the systems, the plateau in 0.3­0.4 Hz range for the
Bode plot of the validation profile clearly contradicts this. Once again, hypothesising that
the two systems (in the two electrode regions) have fundamentally identical behaviour with
only small differences owing to differences in their parameter values, there exists at-least
one zero in these continuous-time systems around this frequency range. The discrete-time
discretisation process adds an additional zero to the system.

    Based on this preliminary analysis, the estimates are  = 0,   2,   3. Only
asymptotic approximations to corner frequencies can be estimated from the Bode plots.
Furthermore, the estimated locations are not used in the parametric system identification
algorithms and is of much less importance than the model order estimates. With this initial
understanding, the parametric system identification procedure is carried out.

6.8.5 Refinement of coefficient orders using deterministic criteria

The initial estimate of coefficient orders in section 6.8.4 was performed based only on a visual
inspection of the Bode magnitude plots. Owing to the fact that the frequency response data
is the result of a crude ratio of spectra, there is a high probability of missing vital information
on the number and locations of poles and zeros. Hence only a lower bound on the coefficient
orders are available until this point. Next, a set of deterministic criteria is used to widen and
refine the coefficient order range.

    Although the ARX structure is deemed to be too simplistic (see section 6.8.3), owing to the
fact that only linear algebra operations are involved, as opposed to numerical optimisation
routines employed in the OE, ARMAX and Box-Jenkins structures, certain deterministic
criteria for coefficient order selection can be incorporated for coefficient order selection.
This can serve as a refinement of the initial number of coefficients guessed from the Bode
magnitude plots discussed in.

    For any model structure used, its error can be defined as

[] = [] - m[]  (6.12)

                                                                225

6.8 Transfer Function Identification Procedure

where [] are true measurements and                                     (eq. (6.11) revisited)
                                           m[] = ()[]

are the model outputs obtained by the assumed transfer operator () (which is to be
determined).

    The number of numerator and denominator coefficients in () as well as their values are
to be determined. This set of unknowns can be collected into a parameter vector . Thus, as
per eq. (6.12), the error sequence is parametrised by , and its notation is amended to [; ].

    For an input-output data set consisting of  samples, a generic cost function that may be
applied for all the four model structures viz. ARX, ARMAX, OE and Box-Jenkins is

                                                                       (6.13)

                                           () =   ( [; ])

                                                                   =1

where () is a postive-valued scalar loss function.

In a typical system identification task, the sum of squares of the error sequence is used as the
typical loss function, thereby yielding

                                                                       (6.14)
                                                                       (6.15)
                                          () =  2[; ]

                                                                   =1

The vector  that minimises this cost function is desired

                                                 = arg min()

    For the ARX model structure, eq. (6.14) reduces to a standard quadratic optimisation
problem which may be solved analytically using least squares linear algebra. However, for
robustness against estimation bias, instead of the standard Ordinary Least Squares (OLS)
estimates, the Instrumental Variable (IV) estimation method [199] was used for this model
order selection task. Applying this to the ARX model structure, two deterministic model
order criteria have been defined -- a) Akaike's Information Criterion (AIC), and b) Rissanen's
Minimum Description Length (MDL) [199].

                                                                226

       6.8 Transfer Function Identification Procedure

    In the AIC, the optimal number of parameters  in  is obtained by minimising the
modified log likelihood cost function

                             2                                                   (6.16)
 ,mod() = ln () +  ,

In the MDL criterion, this cost function is modified to

                              ln                                                 (6.17)
 ,mod() = () (1 +  )

    For the two subsystems at hand, both criteria converged to the same choices for the
coefficient orders, yielding  = 4,  = 4 and  = 0. Therefore, these values were used as the
starting points for the non-linear optimisation algorithms used in determining the exact pole
and zero locations for the discrete-time transfer functions which is described next.

6.8.6 Final transfer function coefficients -- Nonlinear optimisation

For the ARMAX and Box-Jenkins model structures, eq. (6.14) results in a non-linear cost
function which is minimised iteratively using quasi-Newton approaches. The theoretical
foundation of standard non-linear optimisation methods such as L-BFGS and Levenberg-
Marquardt are well established whose detailed explanation is out of the scope of this thesis.
Although state of the art methods are not covered, the interested reader may consult the
textbook by Scales [206] for an introductory overview of this topic.

    The final model structures (for both the positive electrode and negative electrode time-
evolution subsystems) in the z-domain are given by

()  =    1-1 +  +  -                                                             (6.18)
       1 + 1-1 +  +  -

wherein the coefficients in the numerator and denominator are to be determined.

    The number of coefficients obtained from section 6.8.5 was used as the initial guess
for the coefficient orders in the non-linear optimisation. For the initial guesses for the
numerical values of the coefficients (1, 2, ...  ) and (1, 2, ... ,  ), a randomised multi-
start algorithm was used. For the two transfer functions identified, no distinction is made

                                                                227

                            6.8 Transfer Function Identification Procedure

between whether the ARMAX structure or Box-Jenkins structure was used to arrive at the
coefficients. Since the output magnitudes of e,n and e,p are of 10-3, a constant scaling
factor of  = 1000 is used to bring the order of magnitude of output data values to unity.
A well-chosen scaling factor is often vital to the convergence of non-linear optimisation
algorithms. Since the system is linear, this constant gain shall not fundamentally change
the dynamics of the system and can be accounted for by using the reciprocal scaling factor
of 0.001 in numerical implementations. The identification procedure was carried out using
MATLAB's System Identification Toolbox [207].

Table 6.2 A sample of results showing four discrete-time transfer functions identified for the
electrolyte time-evolution subsystem in the negative electrode region. Only those models that
yielded similar errors (within 0.5 %) across both input datasets were retained. The fourth order
model from case C (shaded in grey) performed the best across both training and validation profiles
and is chosen as the final model.

         Numerator             Denominator                  Training  Validation
                                                            accuracy  accuracy
Case  1  2        3      4  1  2          3            4
                                                               (%)        (%)
A 0.0026 -0.0025            -1.922 0.923             0.612
                                                     0.907   95.11      95.13
B 0.0028 -0.0052 0.0025     -2.833 2.669 -0.836              99.14      98.54
                                                             99.73      99.28
C 0.0028 -0.0075 0.0066 -0.0019 -3.577 4.767 -2.801          95.12      95.14

D 0.0026 0.0026 -0.0024 -0.0024 0.060 -1.906 -0.058

    Table 6.2 shows the results obtained by applying the aforementioned non-linear iden-
tification routines to the time-evolution subsystems in the negative electrode region. The
coefficient orders tried in the system identification procedure were informed by the inferences
from the bode magnitude plots as well as that obtained by applying the deterministic AIC
and MDL criteria. Only those models that yielded similar errors (within 0.5 %) across both
input datasets were retained.

    As discussed in section 6.8.4, a first order transfer function cannot capture all the dynamics
of the subsystems under consideration. Therefore, the lowest order tried in the identification
procedure was two (case A in table 6.2). As higher order models were tried, the system
accuracy improves steadily as seen in cases B and C. However in order to avoid overfitting,
the lowest order model that produces the highest matched accuracy across both training and
validation profiles must be chosen.

                                                                228

          6.8 Transfer Function Identification Procedure

    Case D illustrates the importance of the initial values used in the non-linear optimisation
algorithms. Despite using an identical number of coefficients as case C, the optimisation
algorithm converges to a radically different set of zeros and poles resulting in a percentage
error comparable to that of the simple second order case. The fourth order model from case C
(shaded grey in table 6.2) performs the best across both training and validation profiles and is
chosen as the final model. The number of numerators and denominators match exactly that
predicted by the deterministic criteria given in section 6.8.5. A similar selection procedure
was applied for the identification of the transfer function corresponding to e,p in the positive
electrode region.

The final identified transfer functions (for the scaled output) are

e,n()  =  0.002842-1 - 0.00753-2 + 0.006595-3 - 0.001906-4           (6.19)
  ( )         1 - 3.577-1 + 4.767-2 - 2.801-3 + 0.6118-4             (6.20)

e,p()  =  -0.002809-1 + 0.007139-2 - 0.005944-3 + 0.001614-4
  ( )            1 - 3.464-1 + 4.444-2 - 2.495-3 + 0.515-4

              Figure 6.6 shows a comparison of the e,n output for a) the P2D model, and b) the identified
          transfer function of eq. (6.19) using the training current profile of fig. 6.1. The transfer function
          of eq. (6.19) was obtained by scaling the output of the training profile to be of order (1) by a
          factor of 1000. Therefore, for final implementation and comparison purposes, the raw output
          produced by applying the transfer function needs to be scaled back by its reciprocal. If the
          system is linear, then this scaling factor shall have no impact on the frequency-dependent
          dynamics of the subsystem. The output predicted by the identified transfer function is
          virtually indistinguishable from the `true' output computed by post-processing the P2D
          model with an RMS error of 5.70 × 10-6 mol m-2 and a MAE of 19.19 × 10-6 mol m-2. This
          high accuracy of the transfer function prediction justifies the linearity assumption for the
          subsystem. Figure 6.7 presents the same comparison using the validation input profile for the
          subsystem in the positive electrode region. The accuracy of the identified transfer function
          for this independent data set is clearly illustrated.

              The poles of eq. (6.19) lie very close to their corresponding counterparts of eq. (6.20) in
          the stable region of the Z-domain i.e., within the unit circle. This confirms the hypothesis
          that the time-evolution subsystems in these two regions exhibit similar dynamics. The

                                                                229

                           6.8 Transfer Function Identification Procedure

               ×10­3               Qe,ntrain (t)
         8.00
                                                            P2D
         4.50                                               SysID

mol m­2  1.00

         ­2.50        ­0.90 ×10­3
         ­6.00        ­1.00
                      ­1.10
               0
                           290     295            300

                      300          600                 900         1200

                                   time (s)

Figure 6.6 Time-evolution of e,n computed using the P2D model and the identified transfer
function of eq. (6.19) (scaled by 0.001) with the synthetic training input profile of fig. 6.1.

The output predicted by the identified transfer function closely matches the `true' output
obtained by a high-fidelity P2D simulation with an RMS error of 5.70 × 10-6 mol m-2 and a MAE
of 19.19 × 10-6 mol m-2. Note that the transfer function in eq. (6.19) was originally obtained by

scaling the output by 1000. The transfer function output is multiplied by the reciprocal of the

same scaling factor to obtain the predicted response shown here, thereby once again justifying

the linearity assumption for this subsystem.

slight differences in the pole locations could be attributed to the variations in the physical
parameters pertaining to the two electrode regions. The numerator coefficients of eq. (6.19)
and eq. (6.20) are also close to each other except that their signs are opposite to each other.
This is to be expected, since as seen in the step response plots of fig. 6.4, e,n and e,p evolve
in time in opposite directions. This is also explained by the fact that, for a given applied
current, a decrease in the number of ions in the negative electrode has to be accompanied
by an increase in the positive electrode and vice-versa (the values of the changes are not
exactly equal owing to the presence of the separator). The identified transfer functions are
thus consistent and deemed to be suitable for representing the electrolyte time-evolution in
these regions.

        6.8.7 Numerical implementation of identified transfer functions

          The concept of deploying a Z-domain transfer function may seem incongruous to the one
          of the major goals of this thesis viz. time-domain implementation of ROMs in an embedded

                                                                230

                                6.8 Transfer Function Identification Procedure

               ×10­3                        Qe,pval (t )
         4.00
                                                                        P2D
                                                                        SysID

         2.00

mol m­2  0.00

         ­2.00     ­2.20 ×10­3
         ­4.00     ­2.30
                   ­2.40

                       1110 1112 1114

                0     300  600         900            1200  1500  1800         2100

                                            time (s)

Figure 6.7 Time-evolution of e,p computed using the P2D model and the identified transfer
function of eq. (6.20) (scaled by 0.001) with the synthetic validation input profile of fig. 6.2.

The output predicted by the identified transfer function closely matches the `true' output
obtained by a high-fidelity P2D simulation with an RMS error of 12.07 × 10-6 mol m-2 and a MAE
of 31.59 × 10-6 mol m-2. Note that the transfer function in eq. (6.20) was originally obtained by

scaling the output by 1000. The transfer function output is multiplied by the reciprocal of the

same scaling factor to obtain the predicted response shown here, thereby once again confirming

the linearity of this subsystem.

environment such as a BMS. While the majority of the models is derived and implemented
entirely in time-domain, only the two time-evolution subsystems of the electrolyte seems
to deviate from this trajectory. However, an explanation for this is provided in section 6.4.3.
In particular, it was mentioned that an approximation-free conversion to time-domain from
Z-domain exists, that mitigates this perceived drawback for these two sub-systems. This
conversion is amenable for discrete-time implementation without any other modifications.

    Starting from the generic structure of the identified transfer functions (see eq. (6.11)),

                                                                231

6.9 Performance Analysis of New Model: Ionic Concentration

()  =  1  1-1 +  +  -                           Replace with analogous
          + 1-1 +  +  -                         transfer operator  =
                                                in time domain
()  =  1  1-1 +  +  -
          + 1-1 +  +  -                         Apply the definition
                                                of () on the LHS
[]  =  1  1-1 +  +  -
[]        + 1-1 +  +  -                         Cross-multiply

(1 + 1-1 +  +  - ) [] = (1-1 +  +  - ) []

                                                Expand on both sides

[] + 1-1[] +  +  - [] = 1-1[] +  +  - []        Apply the definition

[] + 1[ - 1] +  +  [ - ] = 1[ - 1] +  +  [ - ]  -[] = [ - ]
                                                Rearrange to obtain

                                                                           the final expression

[] = -1[ - 1] -  -  [ - ]

          + 1[ - 1] +  +  [ - ]                                                                  (6.21)

    We thus obtain a simple algebraic expression (a difference equation) that computes the
output at the given time-step given past inputs and outputs. This is a highly memory-efficient
implementation since, at any given time-step, only the previous  (four) output samples
and  (four) input samples need to be `remembered' (stored). This concludes all the aspects
(derivation and implementation) of this author's new model for the electrolyte time-evolution
subsystem. The performance of this model for computation of electrolyte concentration needs
to be evaluated, which is performed next.

6.9 Performance Analysis of New Model: Ionic Concentra-
       tion

To demonstrate that a suitable advancement of the field has indeed been achieved through
this system identification exercise, a comparison with the existing state of the art in reduced
order electrolyte modelling is warranted. Secondly, to comprehend its extent of validity and
performance boundaries, the newly developed ROM must also be pitted against the full-order

                                                                232

                                       6.9 Performance Analysis of New Model: Ionic Concentration

          P2D model. This section aims to provide such a comparative discussion for two types of
          inputs -- a) constant current inputs b) dynamic load profiles

        6.9.1 Constant current inputs

          Figure 6.8 shows the spatial distribution of ionic concentration in the electrolyte along cell
          thickness for a 1C discharge beginning at 100 % SOC. The spatial concentration computed by
          each of the three approaches -- i) the P2D model, ii) the quadratic approximation model and
          iii) the newly developed system identification model(s).

              During the initial phase of discharge, the P2D model exhibits a characteristic inflection
          point near the separator interfaces that diffuses out over time until a QSS. This is due to the fact
          the reaction front is initially established close to the separator, and as surface concentration
          of lithium in particles near separator is depleted, the reaction starts moves further into the
          electrode thickness. Neither of the two ROMs under consideration here could successfully
          capture this characteristic inflection. This is explained by the fact that both of them use the
          standard quadratic approximation profile for the spatial profile, which means that only one
          apex point is possible per electrode, which is pinned to their separator interfaces by design.

              During the transient portion of discharge (approximately up to 357 s as shown in fig. 6.8),
          the locus of the concentration profile computed by the newly developed system identification
          model(s) clearly lies much closer to the P2D model than that computed by the quadratic
          approximation model. After the initial transition phase, it appears that the concentration
          profile predicted by both the ROMs converge to the P2D model's concentration profile.

              To obtain a quantifiable perspective on the accuracy of the newly developed model,
          it is desirable to plot the temporal evolution of the concentration, particularly at the two
          current collector interfaces. The behaviour of the baseline quadratic approximation model
          in this regard was established in section 5.6.2. Therefore it is important to ascertain whether
          a noteworthy improvement was achieved using the model arrived at using the system
          identification procedure.

              Figure 6.9 shows the time-evolution of the ionic concentrations at the current collector
          interfaces of the negative and positive electrodes for a 1C discharge. The concentration profiles
          computed by the three approaches -- i) P2D model, ii) quadratic approximation model and

                                                                233

                              6.9 Performance Analysis of New Model: Ionic Concentration

ce (mol m­3)  1040                t=4s              ce (mol m­3)  1200                t = 18 s
              1020                                                1100
              1000     P2d                                        1000     P2d
               980     Quadratic                                   900     Quadratic
               960     SysID                                       800     SysID

                   0              ln ln + ls  ltot                     0              ln ln + ls  ltot

              2000                                                2000

ce (mol m­3)  1500                t = 357 s         ce (mol m­3)  1500                t = 1785 s

              1000                                                1000

                       P2d                                                 P2d

              500      Quadratic                                  500      Quadratic

                       SysID                                               SysID

              0     0             ln ln + ls  ltot                0     0             ln ln + ls  ltot

              2000                                                2000

ce (mol m­3)  1500                t = 2677 s        ce (mol m­3)  1500                t = 3570 s

              1000                                                1000

                       P2d                                                 P2d

              500      Quadratic                                  500      Quadratic

                       SysID                                               SysID

              0     0             ln ln + ls  ltot                0     0             ln ln + ls  ltot

Figure 6.8 Spatial distribution of ionic concentration in electrolyte along cell thickness at
various snapshots of time computed by each of the three models for a 1C discharge. The
concentration profile computed by the P2D model is used as the benchmark reference. The system
identification model performs noticeably better than the quadratic approximation model during
the initial transient while delivering a similar performance as a QSS is reached.

                                                                234

                       6.9 Performance Analysis of New Model: Ionic Concentration

         2250          ce(0, t)                           1000          ce(ltot, t)
         2000                                              800
mol m­3  1750                       P2d          mol m­3   600                       P2d
         1500                       Quadratic              400                       Quadratic
         1250                       SysID                  200                       SysID
         1000
                 1000    2000       3000 4000                 0   1000    2000       3000 4000
              0        |ce,negcc |                             0        |ce,poscc |
                                      Quadratic                                        Quadratic
          350                         SysID                350                         SysID
          280                                              280
mol m­3   210                                    mol m­3   210
          140                                              140
           70    1000 2000 3000 4000                        70    1000 2000 3000 4000
                           time (s)                                         time (s)
             0                                                0
              0                                                0

Figure 6.9 Evolution of ionic concentration over time at the two current collector interfaces
for a 1C discharge for i) the P2D model, ii) the quadratic approximation model and iii) the newly
developed system identification model(s) (top row). For the quadratic approximation and system
identification models, the time evolution of their absolute error relative to the P2D benchmark
is also shown (bottom row). At both current collectors, the transient performance of the system
identification model is superior to the quadratic approximation model. At QSS, the quadratic
approximation model is slightly more accurate than the system identification model.

the iii) newly developed system identification model(s) are overlaid in the top row of plots,
wherein the left hand side corresponds to the current collector interface at the negative
electrode while the right hand side corresponds to that at the positive electrode. The plots
in the bottom row of fig. 6.9 show the time-evolution of the absolute value of their errors.
The concentration error of each of the two ROMs is defined with respect to the benchmark
P2D model i.e., e,() = e,ROM - e,p2d (). The absolute value of the error is plotted so that
the magnitude of the error can be visualised better, aiding immediate comparisons based on
the plots.

    For both current collectors, the newly developed system identification model outperforms
the quadratic approximation model during the transient phase. At the negative electrode/cur-
rent collector interface, the error of the system identification model remains strictly below that

                                                                235

        6.9 Performance Analysis of New Model: Ionic Concentration

of the quadratic approximation model until 650 s and remains comparable to it until 1600 s.
Beyond this time, the quadratic approximation model has a slightly better accuracy, although
the system identification model still remains at a comparable distance from it. After 2000 s,
both models yield the same response shape. For the positive electrode/current collector
interface, the error of the system identification model remains below that of the quadratic
approximation model until 3300 s.

1800    ce(0, t)                                                          1000  ce(ltot, t)
1600                                                                       750
                  P2d                                                                        P2d
                  Quadratic                                                                  Quadratic
                  SysID                                                                      SysID

1400mol m­3                                                               500
                                                                 mol m­3

1200                                                                      250

1000    60 120 180 240 300                                                0
     0             time (s)                                                0 60 120 180 240 300
                                                                                               time (s)

Figure 6.10 Transient phase of the temporal evolution of ionic concentration at the two
current collector interfaces for a 1C discharge as computed by -- i) the P2D model, ii) the
quadratic approximation model, and iii) the newly developed system identification model(s). The
significantly improved accuracy of the system identification model(s) relative to the state of the
art quadratic approximation model is clearly demonstrated.

    Figure 6.10 shows a zoomed version of the time-evolution of the ionic concentration
at the two current collectors, wherein the first 300 s after application of the load current
is plotted. The significant improvement in accuracy achieved by the newly developed
system identification model(s) is clearly demonstrated. At both the current collectors, the
concentration computed by the system identification model(s) closely track that of the
benchmark P2D model.

    The loss of fidelity exhibited past the initial transient phase warrants an explanation.
It should be recalled that the natural decoupling of the temporal and spatial systems were
taken advantage of in developing the system identification technique. This means that, for
the spatial profile, the system identification model reverts to the same quadratic profile
as the baseline quadratic approximation model. This explains why the two models have

                                                                236

                                       6.9 Performance Analysis of New Model: Ionic Concentration

          similar shape past the initial transient. During the transient phase when the QSS behaviour
          is yet to be established, it is reasonable to assume that the temporal dynamics are of
          paramount importance in governing the concentration profile evolution. After a QSS has
          been established with the reaction front diffusing out and a steady stream of ion-electron
          separation/recombination in place, it is hypothesised that the temporal dynamics have settled
          and the spatial configuration assumes importance.

              With a sustained application of constant current past the initial transient, strong spatial
          gradients in the ionic concentration are established within the cell i.e., the concentrations
          are far from the initial equilibrium value. This precisely exposes the realm where the
          system identification model exhibits its natural weakness. By following the theory of system
          identification, which necessitates bias removal, the training and validation profiles of fig. 6.1
          and fig. 6.2 had nearly zero mean. This means that the currents were as equally positive as
          negative leading to a small-signal perturbation around the equilibrium value of the electrolyte
          concentration. While this profile is ideally suited to excite the system's dynamics, it fails to
          capture the large signal behaviour. As a topic of future research, perhaps a spatially-coupled
          system identification could be attempted to handle this issue.

              The main implication of these results is that the identified models are primarily suitable for
          transient i.e., dynamic load profiles, which is typical of a real-life scenario in an electric/hybrid
          electric vehicular operation. Such a model is less suitable for sustained constant current
          application. This implies that a BMS in a vehicle undergoing a Constant Current Constant
          Voltage (CCCV) charging cannot rely on these identified electrolyte models. However, this
          exclusion does not seriously hamper the model's wider applicability since a simple coulomb-
          counting approach with a high-precision Analog to Digital Converter (ADC) is much more
          accurate than any other PBM in this particular scenario.

              Although constant current discharge is not a practical use-case for vehicular batteries,
          performing this benchmark evaluation has helped in understanding the limits of the newly
          developed model. This study has also helped in providing a glimpse of its potential strength
          viz. significantly improved accuracy under dynamic load conditions, which is presented next.

                                                                237

                                       6.9 Performance Analysis of New Model: Ionic Concentration

        6.9.2 Dynamic current inputs

          To characterise the performance of the newly developed system identification electrolyte
          concentration model(s) under dynamic load conditions, the UDDS drivecycle was used. The
          details of this drivecycle such as its speed versus time data and its highly dynamic nature
          was discussed in section 5.4.3. The peak of the applied load current used corresponds to a
          discharge current of 180 A i.e., 3C. A plot of this current profile was shown in the top row of
          fig. 5.12. This load profile was applied to the three models under consideration -- a) P2D model,
          b) quadratic approximation model, and c) newly developed system identification model(s) --
          and the spatio-temporal evolution of ionic concentration in electrolyte computed by each of
          them was studied.

              Since the load current is highly dynamic and continuously alternating between charging
          and discharging at various magnitudes throughout the profile duration, it is difficult to discern
          a specific pattern or trend within the spatial thickness of the cell. Hence, unlike the case
          of prolonged unidirectional current application wherein a clear reaction front that diffuses
          gradually out can be visualised (see fig. 6.8), little information can be gained from visualisation
          of spatial concentration profiles. Since the ionic concentrations at the two current collectors
          have a direct (and two-pronged) influence on the electrolyte overpotential (see eq. (5.71)), it
          is particularly important to characterise the accuracy at these two critical spatial locations.

              Since a direct correspondence between the time-dependent dynamics of the load profile
          and that of the electrolyte concentration can be intuitively visualised, its values at the two
          current collector interfaces are examined. The plots in the top row of fig. 6.11 shows the
          time evolution of the ionic concentration at the two current collector locations for the UDDS
          current profile computed by each of the three models under consideration. The plots to the
          left pertain to the negative current collector location while that to the right correspond to
          the positive current collector location. The bottom row of plots show the absolute value
          of concentration error of the quadratic and system identification models relative to the
          P2D reference benchmark. As seen in fig. 6.11, the absolute error of the newly developed
          system identification models remain below that of the baseline quadratic approximation
          model throughout the drivecycle.

                                                                238

                 6.9 Performance Analysis of New Model: Ionic Concentration

         1400    ce(0, t)                                 1550   ce(ltot, t)
         1300                                             1250
mol m­3  1200                 P2d                mol m­3   950                P2d
                              Quadratic                                       Quadratic
                              SysID                                           SysID

         1100                                             650

         1000    200 400 600 800 1000 1200 1400           350    200 400 600 800 1000 1200 1400
              0                                               0
                 |ce,negcc |                                     |ce,poscc |
          300                                             300
          225                 Quadratic                   225                 Quadratic
                              SysID                                           SysID

mol m­3  150                                     mol m­3  150

         75                                               75

         0                                                0
          0 200 400 600 800 1000 1200 1400                 0 200 400 600 800 1000 1200 1400
                              time (s)                                         time (s)

Figure 6.11 Evolution of ionic concentration over time at the two current collector interfaces
with a UDDS input profile (see topmost plot of fig. 5.12) as computed by i) the P2D model,
ii) the quadratic approximation model and iii) the newly developed system identification model(s)
(top row). The plots on the left pertain to the negative electrode/current collector interface,
while that on the right corresponds to the positive electrode/current collector interface. For the
quadratic approximation and system identification models, their absolute error relative to the P2D
benchmark is also shown (bottom row). The system identification model is considerably more
accurate than the quadratic approximation model for the entire time horizon of the drivecycle.

    Based on the conclusions from the constant current input study of section 6.9.1, it is to
be expected that the system identification model(s) exhibit a superior performance during
the transient phase of the simulation. As seen in the initial duration of fig. 6.11, the absolute
error of the system identification model is indeed lower than that of the baseline quadratic
approximation model. Particular, when a sudden current spike is applied at 200 s, the
quadratic approximation model is unable to cope and its absolute error deviates far away from
its mean value. The absolute error of system identification model remains well controlled
and even with this instantaneous load demand, its standard deviation is remarkably close to
its median value as shown in table 6.3.

                                                                239

6.9 Performance Analysis of New Model: Ionic Concentration

Table 6.3 Summary of error statistics for the quadratic approximation and system identification
models. The metric used is the absolute value of the concentration difference with respect to the
P2D model at the two current collector interfaces.

Error statistic     ||e || at Neg/CC  ||e || at Pos/CC
  (mol m-3)
                    Quadratic SysID Quadratic SysID

Max                 307.27  190.04    292.20  114.44
Mean                 66.38   54.98     55.15  25.02
Median               49.65   47.12     40.39  20.93
Standard Deviation   66.80   37.18     60.50  20.17

    While the superior accuracy of the newly developed model during the transient phase
was not surprising, the fact that its performance remains consistent throughout the entire
time horizon is noteworthy. Despite being subject to incessant changes in load demands, the
system identification model responds better than the quadratic approximation model well
past the initial transient. Figure 6.12 shows a zoomed view of the ionic concentration in the
electrolyte at the two current collector interfaces. To prove the improved performance of
the developed model well into the operation of the cell, a 50 s window beginning at 60 %
of the overall profile duration is examined in detail. Although it exhibits some oscillations,
the system identification model(s) reasonably track the `true' concentrations computed by
the P2D model. However, the baseline quadratic approximation model seems to suffer from
a large bias with respect to the P2D model. It should also be noted that nearly every `kink' in
the two ROMs is identical. This could be attributed to the fact the spatial profile used in both
of them is identical. Hence, it must be concluded that the difference in their amplitude arises
from the improved calculation of coefficients () in eq. (5.72) and eq. (5.74) through the
usage of more accurate e,n and e,p in the Left-Hand Side (LHS) of eq. (5.84) and eq. (5.86)
respectively. Detailed error metrics of the two ROMs is shown in table 6.3.

    Based on the evidence presented thus far, it can be concluded that the time-evolution sub-
system model(s) developed here using the system identification technique indeed represent
an advancement of the field of reduced order electrolyte modelling. With this aspect thus
tackled, it is imperative to explore the potential benefits of incorporating the discrete-time
model(s) thus obtained into the conventional SPM and is discussed next.

                                                                240

                6.10 Composite SPM Model with Electrolyte Dynamics

1140  ce(0, t)                                                          875  ce(ltot, t)
1127
1114            P2d                                                                       P2d
                                                                                          Quadratic
                Quadratic                                               857               SysID

                SysID

mol m­3                                                                 839
                                                               mol m­3
1101                                                                    821

1088                                                                    803

1075                                                                    785
    850 860 870 880 890 900                                                850 860 870 880 890 900
                          time (s)                                                               time (s)

Figure 6.12 A zoomed view of the ionic concentration (showing a 50 s window beginning at
60 % of the overall profile duration) in the electrolyte at the two current collector interfaces for
the UDDS profile of fig. 5.12 as computed by -- i) the P2D model, ii) the quadratic approximation
model, and iii) the newly developed system identification model(s). At both current collector
interfaces, the system identification model(s) exhibits a reasonable tracking of the concentration
profile computed by the benchmark P2D. The profile computed by the quadratic approximation
model seems to suffer from offsets/bias issues that adversely affects its accuracy.

6.10 Composite SPM Model with Electrolyte Dynamics

At this stage, it must be recalled that the purpose of developing the system identification
electrolyte model was to mitigate the poor performance of the basic SPM at C-rates above 0.5C
(see section 5.4.3). This sub-optimal performance was attributed to the lack of electrolyte
dynamics in the basic SPM. The performance of the newly developed system identification
model has been proved to be superior to the current state of the art. The next step is to embed
this electrolyte model into the basic SPM so as to obtain a composite SPM. The performance of
this composite model is evaluated to ascertain its suitability towards online implementation.

6.10.1 Computation of electrolyte overpotential

The missing component in the terminal voltage computation of the basic SPM is the
contribution from the electrolyte overpotential term. This is the potential difference in the
entire electrolyte i.e., the electrolyte potential at the positive current collector interface with
respect to that at the negative current collector interface.

                                                                241

                        6.10 Composite SPM Model with Electrolyte Dynamics

    As discussed in section 5.5, using the equation proposed by Prada et al. [183], the
overpotential in the electrolyte is computed as

e,pos  -  e,neg  =  (1  -  +0)  2  ln    e,pos/cc
                                         e,neg/cc

                    -      (     neg     +  2   sep     +   pos     )  (eq. (5.71) revisited)
                        2       eff,neg        eff,sep     eff,pos

    Equation (5.71) consists of two distinct terms -- i) a diffusion overpotential due to
concentration gradient in the electrolyte, and ii) an ohmic resistance term that is dependent
upon a) the instantaneous value of applied current, b) the thicknesses of the three cell regions,
and c) the effective ionic conductivity in each of the three regions.

    The ohmic loss term of eq. (5.71) needs to be examined in closer detail. The dependence
of this term on instantaneous load current and cell thicknesses can be accounted in a
straightforward manner. However, there are ambiguities in computing the effective ionic
conductivity in each of the three cell regions. The effective value of ionic conductivity in
the electrolyte depends on its intrinsic conductivity, the Bruggeman constants and porosities
of each of the three regions. The intrinsic electrolyte conductivity in-turn depends on the
electrolyte concentration.

    Ambiguities arise in interpreting the value of ionic concentration to be used for computa-
tion of electrolyte concentration. Since eq. (5.71) deals with overall potential drop across the
entire length of the cell, the concentration used for computing electrolyte conductivity could,
for example be that at the respective current collectors. This concept however introduces
inconsistencies with the separator term. Using the separator concentration from one of
the electrode interfaces introduces unequal weighting in this computation. If the ionic
concentration at the midpoint of the separator is used, this scheme becomes inconsistent with
that at the two current collectors. Another possibility for computing the effective conductivity
in a cell region is to use the mean of the concentration in that region. However, since the
mean is nothing but a simple statistical first moment is equally influenced by the entire
concentration profile within each cell region. This is questionable given that the electrolyte
overpotential across the entire cell thickness is most likely governed by the conductivities at
the two current collector interfaces. Some form of weighted mean could be conjured, wherein

                                                                242

                                   6.10 Composite SPM Model with Electrolyte Dynamics

the current collector locations are given the highest weight and the separator locations
the least weight. However, finding the weights becomes yet another exercise and from
the engineering perspective of computing these in real-time, seems to be in the realm of
diminishing returns.

    In published literature, only a cursory treatment has been accorded to the aforementioned
ambiguities. In Prada et al. [183], the usage of initial concentrations is used to only introduce
the concept of ohmic resistance in that article. However, the author of this thesis wishes to
extend this concept further. In the simulations conducted by this thesis author, it became clear
that the dependence on applied current was required in order to obtain reasonable accuracies.
Computing mean of concentrations in cell regions for calculation of ionic conductivities led
to a biased computation of overpotentials. Therefore, this author decided to use the value
of initial concentration for the computation of ionic conductivities in the current-dependent
contribution to electrolyte overpotential throughout the entire time horizon considered.

Hence, as per the adopted scheme eq. (5.71) gets modified as

e,pos ( )  -  e,neg ( )  =  (1  -  +0)  2  ln  e,pos/cc( )
                                               e,neg/cc( )

                            -      (          neg   (0))  +  2        sep   (0))  +        pos   (0)) )  (6.22)
                                2       eff,neg (e              eff,sep (e           eff,pos (e

wherein the time-dependent terms are explicitly shown in the notation.

    Using eq. (6.22) for electrolyte overpotential computation has an important implication.
The two-pronged influence of the time-dependent electrolyte concentration on the electrolyte
overpotential viz. a) a direct influence in the form of concentration dependent diffusion
polarisation, and b) an indirect influence through its use in ionic conductivity calculations
has now been reduced to just one. This implies the results from the system identification
model are now required only in the first term of eq. (6.22).

    In the light of the decision of use the (constant) initial concentration for the ohmic term, it
is natural to question the gains from the circuitous route of the system identification exercise
that was undertaken to obtain the improved electrolyte model. Therefore, it is imperative to
quantify the relative weight of the concentration dependent diffusion resistance compared
to the bulk solution resistance.

                                                                243

         6.10 Composite SPM Model with Electrolyte Dynamics

0

  ­0.04  Ohmic Loss in Bulk Solution
         Concentration Polarisation
  ­0.08  Overall e(t) in Electrolyte
V

  ­0.12

  ­0.16

­0.2 0   500 1000 1500 2000 2500 3000 3500 4000
                                      time (s)

Figure 6.13 Contribution to the overpotential in the electrolyte from each of the two terms in
eq. (6.22) for a 1C discharge. The bulk solution resistance is approximated as a constant value
determined by the equilibrium initial concentration. The concentration dependent polarisation
term governs the dynamic behaviour of the overall overpotential. Furthermore, this gradient-
induced diffusion resistance has a strong contribution to the steady state, higher than the bulk
solution resistance and cannot be neglected without introducing significant errors.

    Figure 6.13 shows the contribution to the overall potential drop e,pos and e,neg in the
electrolyte from each of the two terms in eq. (6.22) for a 1C discharge. The bulk solution
resistance is constant owing to the fact that the initial electrolyte concentration is used
in computing the effective ionic conductivities in the three regions of the cell. The gradient
induced diffusion polarisation term, however has a stronger contribution in both the transient
and steady state. The entire dynamics of the overall potential drop during the transient phase
is governed by this concentration-dependent term, while its steady state contribution is in-
fact higher than the bulk solution resistance. The constant ohmic resistance term merely
provides a non-zero offset for the electrolyte solution overpotential. In questioning whether
the system identification exercise was indeed worthwhile, if the concentrations in the two
current collectors had not been computed at each time-step, then this diffusion polarisation
term would become zero. This is because, the numerator and denominator in eq. (6.22) would
have to be retained at the initial concentration, leading to a unit ratio whose natural logarithm
is zero. Therefore, it is clear that computing the concentrations at the two current collectors
through system identification has indeed helped in improving the modelling accuracy.

                                                                244

           6.10 Composite SPM Model with Electrolyte Dynamics

    Having established the relative importance of computing the diffusion-dependent polar-
isation overpotential, the next question that arises is whether the constant approximation for
the bulk solution resistance is indeed appropriate. It also remains to be seen if the accurate
computation of the ionic concentration through system identification (see section 6.9) has
translated into a similarly accurate computation of electrolyte overpotential. This is answered
by a comparing the electrolyte overpotential computed by the system identification model
with that obtained from the P2D model.

                                                    e(t) = e,poscc(t) ­ e,negcc(t)
                       0.00

    ­0.08       P2d model
                SysID model
    ­0.16
V

    ­0.24

­0.32

­0.40      800  1600            2400  3200  4000
      0

                      time (s)

Figure 6.14 Comparison of electrolyte overpotential computed by the P2D model and the
system identification model (using eq. (6.22)) for a 1C discharge. During the transient phase, the
profile obtained by the system identification model closely matches that of the P2D model. The
mismatch in the initial overpotential does not arise to the use of a constant concentration for the
bulk resistance contribution, since at equilibrium this value is exact and not an approximation. Past
the initial transient, accuracy of the system identification model degrades. This can be explained by
its analogous behaviour for concentration computation in the Quasi-Steady State (see section 6.9.1)
for constant current inputs.

              Figure 6.14 shows a comparison of the electrolyte overpotential computed by the P2D
          and system identification models for a 1C discharge. There is a discrepancy in the initial
          offset of the overpotential value. However, this cannot be attributed to the use of the
          constant concentration approximation in the computation of ionic conductivities in eq. (6.22).
          This is because, at equilibrium the concentration used is exactly the initial concentration.
          Furthermore, at the instant of applying the current, diffusion gradients in the electrolyte have
          not yet been established. Hence, the contribution from the diffusion overpotential is zero,

                                                                245

             6.10 Composite SPM Model with Electrolyte Dynamics

which can also be seen in fig. 6.13. Thus, it can be concluded that this initial mismatch is due
to the presence of some other unmodelled phenomena that affects the DC offset of electrolyte
overpotential, and is not arising due to the approximations used by this author.

    In fig. 6.14, the shape of the transient profile of overpotential computed by the system
identification model closely matches that of the P2D model. This validates that the newly
developed model does indeed capture the electrolyte dynamics sufficiently well during the
initial transient. However, past the initial transient, the model's accuracy degrades and the
resulting profile does not track the P2D model. This behaviour in overpotential is analogous
to that exhibited in the spatio-temporal concentration study discussed in section 6.9.1 for
constant current inputs, wherein it was deemed that this newly developed model is more
suitable for dynamic loads. The same conclusion for electrolyte overpotential accuracy is
reached from this constant current study. Nevertheless, even for constant current loads, using
the newly developed model is better than having no electrolyte model whatsoever as in the
basic SPM.

                   e(t) = e,poscc(t) ­ e,negcc(t)

             0.10                                        P2d

                                                         SysID

             0.00

             600 620 640 660 680 700

V 0.20       300   600            900              1200         1500
     0.12
     0.04

    ­0.04
    ­0.12
    ­0.20 0

                        time (s)

Figure 6.15 Comparison of electrolyte overpotential computed by the P2D model and the
system identification model (using eq. (6.22)) for a UDDS load profile. The overpotential profile
computed by the system identification model reasonably matches the profile obtained by the
P2D model with a Mean Absolute Error (MAE) of 15.88 mV and a Root Mean Square (RMS) error
of 24.11 mV.

              Figure 6.15 shows a comparison of the electrolyte overpotential computed by the P2D
          and system identification models for a UDDS load profile. The input current corresponding

                                                                246

6.10 Composite SPM Model with Electrolyte Dynamics

to this load profile is shown in the top row of fig. 5.12. The system identification model is
able to reasonably track the overpotential profile computed by the P2D model. Unlike the
case of sustained unidirectional current input, the error in this case remains well-contained.
The Mean Absolute Error (MAE) obtained for this profile was 15.88 mV with an Root Mean
Square (RMS) error of 24.11 mV. This corresponds to 8.19 % and 12.44 % of the peak magnitude
of the overpotential (193.86 mV).

    Hence, it can be concluded that the electrolyte overpotential computation using the
system identification model provides an acceptable performance for dynamic load profiles.
The next step is to incorporate this electrolyte overpotential calculation into the basic SPM
and to quantify the voltage accuracy of the resulting composite SPM.

6.10.2 Terminal voltage computation of composite SPM

In section 5.4.3, it was shown that in the basic SPM, the computation of the cell's SOC is of
sufficient accuracy. However, its terminal voltage strongly deviates from the true value as
computed by a P2D model. This mismatch between SOC and terminal voltage hinders the
suitability of the basic SPM as the plant model in online state estimation applications. The
discrepancy in terminal voltage is due to the lack of electrolyte overpotential contribution in
its computation. Having obtained a suitable methodology to compute this (see section 6.10.1),
it is now possible to refine the computation of the cell's terminal voltage.

    Referring to eq. (5.26) and eq. (5.27), the reaction overpotential in each of the two porous
electrode regions is given by

pos = s,pos - e,pos - pos                              (6.23)
neg = s,neg - e,neg - neg                              (6.24)

wherein the contribution from the electrolyte potential terms e,pos and e,neg are no longer
to be neglected.

    Subtracting eq. (6.24) from eq. (6.23)

pos - neg = s,po s - s,neg -e,pos + e,neg - pos + neg  (6.25)

                            cell

                                                                247

                                6.10 Composite SPM Model with Electrolyte Dynamics

whose rearrangement yields                                                                              (6.26)

                              cell = pos - neg + e,po s - e,neg +pos - neg

                                                                            e

    Substituting for e from eq. (6.22) in into eq. (6.26), and expanding each of its terms
(see derivation of eq. (5.40) for details), the final expression for the cell's terminal voltage is
obtained as

             2  sinh-1                            - ()

cell ( )  =

                          2pos  s,pos    rpos  e  s,surfpos  (  )  (s,maxpos  -  s,surfpos  (  ))

          -  2  sinh-1                                     ()


                          2  negs,neg rneg es,surfneg ()           (s,maxneg  -   s,surfneg  (  ))

          +(1-+0)  2    ln  e,pos/cc() -   (        neg   (0))  +  2        sep   (0))  +         pos   (0)) )
                            e,neg/cc() 2      eff,neg (e              eff,sep (e            eff,pos (e

                                               + pos (s,surfpos ()) - neg (s,surfneg ()) (6.27)

    All other expressions and computations of the basic SPM remain unchanged (see
section 5.2 for the complete set of equations constituting the model). The final step is to
show that the composite SPM thus obtained has an improved performance especially in those
scenarios that the basic SPM performed poorly.

        6.10.3 Validation of composite SPM: Terminal voltage accuracy

          The final step in this model development effort is the validation phase. In particular, the
          voltage accuracy of the composite SPM is compared against the P2D model for standard
          input conditions. In order to compare and contrast the gains achieved by the composite SPM,
          the terminal voltage output of the basic SPM is also considered here.

          Constant Current Inputs

          The voltage accuracy of the newly developed composite SPM is first evaluated for the standard
          test case of 1C discharge current starting from a cell SOC of 100 %.

                                                                248

                                                6.10 Composite SPM Model with Electrolyte Dynamics

              Figure 6.16 Voltage output of various SPMs for a 1C discharge beginning at 100 % SOC (top
              plot). Since it does not account for electrolyte overpotentials, the voltage profile computed by the
              basic SPM lies above that of the benchmark P2D model. On the other hand, the composite SPM
              tends to over correct for the electrolyte overpotential so that its terminal voltage lies below the
              P2D output. Since the two ROMs have outputs on either side of the P2D model, it is convenient
              to use the absolute error to compare them. In the bottom plot, the percentage deviation of the
              absolute error of the two ROMs is shown. The composite SPM performs significantly better with
              a peak absolute error of 4 % in contrast to nearly 11 % for the basic SPM.

                                                                249

6.10 Composite SPM Model with Electrolyte Dynamics

    Figure 6.16 shows the terminal voltage output of various SPMs for a 1C discharge
beginning at 100 % SOC (top plot). Since it does not account for electrolyte overpotentials,
the voltage profile computed by the basic SPM lies above that of the benchmark P2D model.
On the other hand, the composite SPM tends to over correct for the electrolyte overpotential
so that its terminal voltage lies below the P2D output. Since the output of the two ROMs lie
on either side of the P2D model, it is appropriate to use the absolute value of their errors with
respect to the P2D benchmark to compare them. In the bottom plot, the percentage deviation
of the absolute error of the two ROMs is shown. The statistics of this deviation is quantified
in table 6.4.

  Table 6.4 Summary of statistics for the percentage absolute error in terminal voltage for the
  basic SPM and the composite SPM in constant current 1C discharge simulations.

Error Statistic  Basic  Composite
   for %| |      SPM       SPM

Worst Case       10.67      4.05
Mean              2.92      1.54
RMS               3.27      1.65

              In each of the error statistic considered, the composite SPM performs significantly better
          than the basic SPM for the 1C discharge case.

              One of the biggest drawbacks of the conventional SPM was its poor voltage accuracy at
          moderate C-rates above 0.5C (see table 5.4). The high accuracy achieved for the 1C rate seems
          to indicate that the composite SPM is indeed a viable solution for all high C-rates, especially
          given the backdrop of its methodical derivation steeped in systems theory.

              However, there exists a fundamental flaw in all models that use a priori assumptions of
          simplified spatial profiles for ionic concentration in the electrolyte. In the case of both the
          baseline quadratic and the system identification models, a parabolic profile spanning the
          entire thickness of each region within the cell was chosen a priori. However, no attempt to
          modify the profile upon encountering an ion starvation event at any spatial location.

              This critical flaw is exposed by the sustained application of any higher current that
          induces an ion starvation at one of the electrodes during operation.Figure 6.17 depicts the
          ionic concentration in the electrolyte over time at both current collectors for a 2C discharge.

                                                                250

                                                6.10 Composite SPM Model with Electrolyte Dynamics

          The profiles computed by both the P2D and system identification models are plotted. For
          the system identification model, the current collector interface at the positive electrode
          experiences an ion starvation event at 150 s. The quadratic spatial profile used by this model
          does not account for such a reduction in the effective electrode thickness. All the boundary
          conditions and coefficients were formulated using the original electrode thickness. Therefore,
          beyond 150 s, the concentration becomes negative which is not physically meaningful. The
          author of this thesis has implemented a saturation mechanism in the code that detects an ion
          depletion event and prevents the concentrations from becoming negative.

              Implementing this hard lower bound of zero for the ion concentration does not mit-
          igate the problems associated with computing the electrolyte overpotential. Specifically,
          computational difficulties are encountered when computing the concentration dependent
          diffusion overpotential eq. (6.22). In the case of ion depletion at the positive current
          collector, the argument of the logarithmic term becomes zero which leads to a non-feasible
          computation (-). Ion depletion at the negative current collector is equally detrimental to
          the computation. However, this scenario has a lower probability owing to the low C-rates
          during charging operation (see section 5.4.2). Furthermore, in the absence of the lower bound
          of zero for the concentrations, complex numbers are obtained from the logarithmic term,
          which lead to physically erroneous overpotential calculations. An alternative is to simply
          omit the diffusion impedance term. However, since this term is responsible for the large-
          signal dynamics of the overpotential (see fig. 6.13), omitting this and reverting to a simple
          ohmic resistance contribution shall lead to significant errors in the electrolyte overpotential,
          and consequently in the terminal voltage. Finally, setting the diffusion impedance to zero at
          the transition boundary of ion starvation is also not a feasible solution. This is because, the
          sudden inflection in the trajectory of the terminal voltage shall induce large errors in any
          state estimation algorithms that depend on the composite SPM as the plant model.

              The difficulties encountered in electrolyte overpotential computations for ion depletion
          scenarios have not yet been discussed in the literature by the research community that
          use such quadratic approximation models. This thesis author therefore assumes that such a
          scenario had not been previously encountered for the parameter set and C-rate combinations
          used by those researchers. Despite the fact that this phenomenon might be an artefact of
          the idiosyncrasies of the parameter set used here, it is nevertheless questionable to not have

                                                                251

                        6.10 Composite SPM Model with Electrolyte Dynamics

mathematically adapted the parabolic profile to such events. The aspect of rendering the
model robust to such vagaries is currently an open problem in the field and can be the subject
of future research. It can therefore be concluded that this composite SPM is unsuitable in
its present form for sustained constant current discharge at higher C-rates. Despite this
setback due to deficiencies in the mathematical formulation of the underlying spatial profile,
the superior performance of the system identification model in the computation of ionic
concentrations and overpotentials for dynamic conditions warrant such a study for the
composite SPM.

            ce(0, t)                                                                   ce(ltot, t)

2000                                                                      1000

                        P2d                                                                         P2d

                        SysID                                                                       SysID

1750                                                                      750

1500mol m­3                                                               500
                                                                 mol m­3

1250                                                                      250

1000    50  100 150 200                                                   0     0  50  100 150 200
     0

            time (sec)                                                                 time (sec)

Figure 6.17 Time evolution of ionic concentration in electrolyte computed by the P2D and
system identification models at -- a) negative current collector interface (left plot), and b) positive
current collector interface (right plot) for a constant current discharge at 120 A i.e., 2C. In the
system identification mode, ion starvation occurs at the positive current collector interface
at 150 s. The quadratic spatial profile used by the system identification model spans the
entire electrode region and does not account for ion depletion scenarios. In this thesis, the
author has implemented a saturation mechanism in the computer code to prevent the ionic
concentration from becoming negative. Despite this mitigating action, the computation of
electrolyte overpotential using eq. (6.22) is problematic in such scenarios.

Dynamic Load Conditions

In order to evaluate the performance of the composite SPM to dynamic inputs, the input
profile corresponding to the UDDS drivecycle profile in fig. 5.12 with a peak current of 180 A
i.e., 3C was used.

                                                                252

6.10 Composite SPM Model with Electrolyte Dynamics

    Figure 6.18 shows the voltage output of the composite SPM for a UDDS input profile
with a peak magnitude of 180 A i.e., 3C (see fig. 5.12). The voltage profiles computed by the
basic SPM and the benchmark P2D model is also overlaid (top plot). The percentage absolute
error of the two ROMs relative to the P2D model is shown in the bottom plot. Clearly, it
is seen that the terminal voltage of the composite SPM is significantly more accurate than
the basic SPM (see table 6.5). For instance, the voltage profile computed by composite SPM
matches the complex shape characteristics of the P2D model while remaining very close to
it in magnitude.

Table 6.5 Summary of statistics for the percentage absolute error in terminal voltage for the
basic SPM and the composite SPM with UDDS input profile.

Error Statistic  Basic  Composite
   for %| |      SPM       SPM

Worst Case        2.59      0.72
Mean              0.51      0.11
RMS               0.68      0.16

    In summary, while the newly developed composite SPM is not considered robust for use
in sustained discharge at high C-rates, it is indeed a suitable option for dynamic load profiles,
even for those with high peak magnitudes of instantaneous charge or discharge. Such load
profiles are typically encountered in vehicular applications, particularly in hybrid electric
vehicles. Thus, a suitable time-domain ROM that can be directly implemented in discrete-
time has been developed through system identification and its strengths and weaknesses have
been quantified. The applicability of this model has been proven for real-life scenarios using
a highly dynamic load cycle. Thus, this author concludes that the composite SPM developed
here does indeed represent an advancement to the present modelling art. This model may
now be used as the plant model in state estimation and control applications in a vehicular
BMS. This concludes the chapter as well as all the implementation aspects of physics-based
battery modelling discussed in this thesis.

                                                                253

               6.10 Composite SPM Model with Electrolyte Dynamics

               3.9                  P2d
                                    Basic SPM
               3.85                 Composite SPM

               3.8

      3.95           500  520

      3.88           375  750       1125           1500
Vcell 3.80
(V)

      3.73

      3.65

            0

3

                                    Basic SPM
                                    Composite SPM

      2.25
|^v |

       1.5
(%)

      0.75

0           0        375  750       1125           1500

                          time (s)

Figure 6.18 Voltage output of the composite SPM for a UDDS input profile with a peak
magnitude of 180 A i.e., 3C (see fig. 5.12). The voltage profiles computed by the basic SPM and the
benchmark P2D model is also overlaid (top plot). The percentage absolute error of the two ROMs
relative to the P2D model is shown in the bottom plot. The terminal voltage of the composite
SPM is significantly more accurate than the basic SPM (see table 6.5).

                                                                254

         7

                                          Conclusions

              7.1 Physics-Based Models as a Design Tool . . . . . . . . . . . . . . . . . . . . . . 256
              7.2 Analysis of Salient Physics-based Reduced Order Models . . . . . . . . . . . . 259
              7.3 Implementation Aspects of Basic and Composite SPM . . . . . . . . . . . . . . 264
              7.4 Closing Remarks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 265

   In this thesis, the deployment of physics-based computational modelling of lithium
             ion cells for electric vehicle applications has been rigorously examined with a three-
          pronged strategy viz. through their analysis, design and implementation. The Pseudo
          Two-Dimensional (P2D) implementation of the Doyle-Fuller-Newman (DFN) model was used
          as the backbone of all modelling efforts. Salient conclusions drawn from each of these aspects
          are presented in this chapter. Based upon the invaluable experience gained during the course
          of this research, and particularly from the findings presented herein, key areas in physics-
          based modelling that can benefit from further study in the future are also identified.

                                                                255

                                                                  7.1 Physics-Based Models as a Design Tool

       7.1 Physics-Based Models as a Design Tool

        7.1.1 Conclusions from the model-based design study

          Chapter 3 presented a computational framework to optimise the number of electrochemical
          layers within a pouch cell so as to maximise its usable energy while meeting specific power
          demands. In particular, this helped to construct a model-based deterministic approach to
          optimally design cells that can be subjected to fast-charging without the concerns of plating.
          In the context of electric vehicle applications, using this approach has the potential to alleviate
          the two immediate concerns of consumers viz. range anxiety and long charging times.

              To facilitate immediate adoption by relevant stakeholders, the concepts developed in
          the optimisation framework of chapter 3 was realised in computer code and presented in
          the form of an open-source design toolbox, Battery Optimal Layer Design (BOLD). This
          toolbox was applied to the optimal layer design of an example cell from literature to obtain
          two sets of power-dependent optimal layer configurations for two drivetrains -- a Battery
          Electric Vehicle (BEV) and a Plug-in Hybrid Electric Vehicle (PHEV). By suitably adapting the
          numerical values of parameters to a real-world cell, model-based cell designs can be obtained,
          which can potentially help to eliminate the current trend of over-engineering of cells using
          conservative empirical layer choices.

              From a perspective of technical advancements to the underlying Physics-Based Model
          (PBM), the standard form of the P2D model has been suitably modified to facilitate a
          direct application of input power densities. This was achieved through reformulation of
          the boundary conditions on the solid-phase potential Partial Differential Equation (PDE).
          Although this innate power input capability has been claimed as purportedly developed in
          extant literature, its independent derivation and accessible documentation provided herein
          shall help other researchers to apply this in a straight-forward manner for vehicle drivecycles,
          acceleration tests and power-based charging protocols.

              This investigation also revealed that the fast charging process determines the optimal
          layer configuration instead of either acceleration runs or drivecycle requirements. This may
          help to counter the current trend in publications which often rely primarily upon a drivecycle-
          based dynamic input current profile to evaluate various aspects of cell modelling such as

                                                                256

                                                                  7.1 Physics-Based Models as a Design Tool

          predicting degradation and for advanced control and estimation algorithms. While validation
          against such a dynamic input profile is certainly vital, for future advancements dealing with
          aspects of cell design or plating-related degradation, validation against fast-charging power
          profiles is deemed to be absolutely essential.

              The study also provided important guidelines about the role of thermal environment on
          cell performance. It became clear that at very low temperatures, a high number of layers was
          required for satisfying a specific charging power level relative to that needed at moderate
          thermal environments such as room temperatures. A practical takeaway from this conclusion
          is that it suffices to use a low number of layers in vehicles to be sold in territories with
          perennial moderate temperature conditions.

              Finally, this design study revealed that the speed at which lithium intercalates into the
          negative electrode during charging limits the charge-addition rate to the cell. Lowering the
          charging times of electric vehicles requires the use of higher charging powers. However, this
          necessitates a high number of layers to absorb the overpotentials and to provide adequate
          number of thermal conduction pathways (owing to the higher number of current collectors)
          to dissipate the additional heat generated. Consequently, this has a detrimental effect on the
          capacity and hence, the All-Electric Range (AER) of the vehicle.

        7.1.2 Future work informed by the optimal layer design framework

          As a direct inference of the final conclusion in section 7.1.1, assuming that the electric grid
          infrastructure is adequately equipped to cope with the surge in future power demands for
          charging of electric vehicles, the solid state diffusion at the negative electrode becomes the
          bottleneck. It is therefore important for future research to focus on the development of new
          materials for the negative electrode possessing much higher solid phase diffusion coefficients,
          particularly at low temperatures.

              From a perspective of improving the framework itself, at the outset, it is clear that the
          plating threshold assessment can be made more accurate by incorporating the solid phase
          diffusion coefficient as function of State of Charge (SOC). In the interest of simplicity and to
          lay the foundation for such model-based cell designs, the scope of this work was intentionally
          narrowed down to solely focus on changing the layer configurations within cells. In doing

                                                                257

                                                                  7.1 Physics-Based Models as a Design Tool

          so, certain assumptions were made that might have to be revisited and potentially relaxed
          before its application to real-world cell designs.

              For instance, adherence to the specific type of cooling phenomena used i.e., tab cooling, is
          one of the stronger assumptions used in this work. In this work, the benefits of employing this
          cooling mechanism has been enumerated, and it is desirable that future pack designs adopt
          it. However, the vast majority of the current generation of battery packs use surface-cooled
          designs. This means that temperature for all layers within the pouch shall not be the same,
          which further implies that it longer suffices to simulate just a single layer. Therefore, the
          framework needs to be suitably modified to handle multiple layer choices concurrently.

              Furthermore, using surface cooling shall invalidate the assumption of small thermal
          gradients along the planar axis of the cell. This means that the lumped thermal model shall no
          longer be accurate to model the temperature evolution of the cell. Furthermore, the differential
          temperature evolution along the cross-sectional direction shall influence the transport and
          kinetic properties of the cell. This electrochemical-thermal coupling along the planar direction
          shall necessitate adding another spatial dimension to the underlying PBM, thereby rendering
          the presently used P2D model ineffective. With the aim of minimising the optimising run-
          times, future research may focus on how to suitably adapt the computational infrastructure
          that was proposed in this thesis to account for these considerations.

              For real-world cell designs, it is prudent to examine the examine the role of variable
          porosities to achieve the balancing of active materials per layer. Since the computational
          framework developed in this thesis uses a modular approach, in the future the constant
          volume-fractions used in the methodology could simply be replaced by values informed by
          optimal porosity computations. For this purpose, researchers could investigate the feasibility
          of adapting a suitable scheme from the available pool of literature that have focussed
          on using model-based porosity optimisation [Xue2014a, 26, 208]. Finally, experimental
          prototyping is an important step in any cell design and it is no exception here either.
          Therefore, experimentally applying the desired power levels to confirm the optimal layer
          choices predicted by the framework is an important step to be undertaken before its large-
          scale deployment.

                                                                258

                                         7.2 Analysis of Salient Physics-based Reduced Order Models

       7.2 Analysis of Salient Physics-based Reduced Order Models

          Chapters 4 and 5 of this thesis primarily focussed on performing an in-depth analysis of
          two distinct Reduced Order Models (ROMs) from two distinct perspectives. In chapter 4, the
          hybrid ROM obtained by using the Discrete-Time Realisation Algorithm (DRA) is analysed
          to investigate its computational bottlenecks. In chapter 5, an in-depth analysis of a niche
          selection of candidate models from the family of Single Particle Models (SPMs) is presented
          from the perspective of modelling accuracy i.e., their ability to faithfully compute the system-
          level quantities of the cell such as its SOC and terminal voltage. Finally, the early portions
          of chapter 6 provides a thorough analysis of the bottlenecks of the quadratic approximation
          model for computing the spatial profile of ionic concentration in the electrolyte. The
          conclusions drawn from all aforementioned analyses are presented next. Topics that may
          be of interest to future researchers engaging with these ROMs are also proposed.

        7.2.1 Conclusions from analysis of the DRA-based state-space ROM

          In chapter 4, Singular Value Decomposition (SVD) of a large Block-Hankel matrix is identified
          as a key computational bottleneck in applying the classical DRA procedure for the hybrid
          ROM discussed therein. It is concluded that this bottleneck arises due to the slow dynamics
          of solid phase diffusion which leads to the aforesaid large sized Block-Hankel matrices.

              To mitigate this bottleneck, an improved DRA scheme was presented, whose centrepiece is
          an iterative SVD algorithm. This algorithm was obtained as a combination of the Golyandina-
          Usevich and Lanczos algorithms discussed in chapter 4. The results of applying the improved
          DRA scheme demonstrate a significant performance improvement achieved by using the
          new method without trading-off model fidelity. At a single operating point of SOC and
          temperature, for a Hankel block size of 8000, the ROM workflow incorporating the improved
          DRA is approximately 100 times faster than that employing the classical DRA. On a standard
          computer workstation whose specifications are given in chapter 4, for 100 operating points
          (combinations of 10 SOC and temperature values), obtaining the ROM required only 6 hours
          using the improved DRA, whereas the classical DRA consumed 666 hours (27 days).
          Furthermore, for the same block-size, the improved DRA is demonstrated to be superior
          in terms of memory efficiency, drastically reducing the memory requirements from 112 GB

                                                                259

                                         7.2 Analysis of Salient Physics-based Reduced Order Models

          down to 2 GB. Finally, the improved DRA demonstrates improved modelling accuracy even
          in moderately equipped computing environments such as standard consumer-grade laptops.

        7.2.2 Future outlook for the DRA-based hybrid state-space ROM

          The improved DRA method proposed in chapter 4 opens up the possibility of applying the
          hybrid ROM modelling procedure to physical quantities in other locations within the cell's
          geometry e.g. in the middle of the electrode region, without being hindered by computational
          limitations that would have otherwise rendered it intractable. Furthermore, high sample-rate
          ROMs capable of handling highly dynamic load profiles can be deployed in future Battery
          Management System (BMS) applications. The proposed scheme also empowers the ROM
          framework to tackle other cell chemistries with slower diffusion coefficients or even those
          with completely different rate-limiting mechanisms, and therefore prima facie, appears to be
          promising.

              Despite the aforementioned euphoric possibilities facilitated by the streamlining of the
          reduced order modelling workflow through the improved DRA, there exists a fundamental
          deficiency in this hybrid modelling approach that impede its near-term adoption in state
          estimation tasks. This aspect was already discussed in chapter 2 and is reiterated here. The
          entries in the matrices of the final state space model depend on the linearisation point of
          SOC and temperature. This linearisation requirement adversely affects the usability of the
          model for state estimation tasks, wherein the SOC is in fact an unknown quantity and
          is to be estimated. This cyclic dependency between the linearisation point and the state-
          estimation entity renders this model questionable for use in a demanding application such
          as in embedded BMSs on-board electric vehicles. Therefore, the immediate future step is to
          analyse the stability of this internal feedback loop. Once this has been performed, researchers
          may consider to engage in the process of adapting the derivation of this hybrid state-space
          ROM approach to higher C-rates, in conjunction with the numerical benefits afforded by the
          improved DRA developed here.

        7.2.3 Conclusions from analysis of the SPM family of models

          Based upon the holistic evaluation of various ROMs in chapter 2, owing to its simplicity, the
          SPM family of models was identified as the most promising modelling candidate from an

                                                                260

                                         7.2 Analysis of Salient Physics-based Reduced Order Models

          implementation perspective. Chapter 5 provided an in-depth analysis of the strengths and
          drawbacks of this modelling family.

              Results from simulation of the basic SPM revealed that two contrasting aspects. Firstly, the
          SOC computation of the SPM was of acceptable accuracy even at moderate C-rates thereby
          validating the fourth order polynomial approximation approach for capturing solid phase
          diffusion dynamics. However, the basic SPM suffers from severe inaccuracies in computing the
          cell's terminal voltage at currents above 0.5C. This dichotomous behaviour, revealed through
          this analysis, has not been explicitly commented upon in present literature. In particular,
          despite its overarching simplicity, it can be concluded that it is this contrasting aspect that
          renders the model unusable as the plant model for state estimation tasks. This is because, the
          voltage measured from the model in a feedback estimator shall map to a radically distant SOC
          operating point requiring excessively strong gain factors for correcting it adversely affecting
          the stability of estimators.

              Several research efforts from literature that have attempted to tackle the voltage inac-
          curacies of the basic SPM through inclusion of electrolyte dynamics were also presented
          in chapter 5. A critical evaluation of each of the salient efforts revealed that a suitable
          approach that can successfully handle all possible operational scenarios is yet to be devised.
          In particular, the existing modelling approaches for electrolyte inclusion either made far-
          fetched assumptions that were easily violated or presented nearly intractable mathematical
          expressions that pushed the SPM closer in computational complexity to the P2D dynamics.
          My analysis of pertinent literature also revealed the possibility of re-using certain portions of
          existing work e.g. the electrolyte overpotential expression, whilst also arguing the need for a
          fresh approach to model other aspects of electrolyte dynamics such as the ionic concentration
          profile within the cell's thickness.

              The final section of chapter 5 presented the assumptions and governing equations of the
          popular quadratic approximation model for the spatial profile of ionic concentration. The
          results obtained by simulating this model reveal that while its spatial profile computation for
          a galvanostatic operation is of acceptable accuracy, the temporal performance of the model
          is mediocre. Particularly, the time evolution of ionic concentration at the current collector
          interfaces computed by the model fail to capture the intricacies in the temporal evolution
          exhibited by the P2D model's profile. Furthermore, the spatial profile uses the Quasi-Steady

                                                                261

                                         7.2 Analysis of Salient Physics-based Reduced Order Models

          State (QSS) approximation which is violated during the initial transient. Hence, the most
          impactful conclusion from the foregoing analysis is that the basic quadratic approximation
          model is unsuitable for dynamic loads, thereby ruling it out for deployment in vehicular
          applications.

              The initial portions of chapter 6 analysed the causal factor contributing to the mediocre
          performance of the quadratic approximation model. For this analysis, a genetic programming
          approach was employed to synthesise suitable alternative reduced order equations for
          modelling the spatial profile of the electrolyte concentration. The foregoing analysis helped
          to reveal that given the constraints and interior-point boundary conditions of the underlying
          DFN model at the separator interfaces, the number of coefficients used in the quadratic spatial
          profile does indeed make the best use of all available equations. The genetic programming
          approach being able to synthesise suitable mathematical structures that can potentially
          capture the spatial profile accurately during both transient and steady state conditions.
          However, there is a shortfall in the number of equations in order to uniquely solve for these
          extra coefficients. The final conclusion that stems from this fact is that, by decoupling the
          spatial and temporal profiles of the electrolyte concentration dynamics, the performance of
          the present state of the art can indeed be improved upon.

        7.2.4 Proposed analysis routes for the SPM modelling family

          Albeit extensive, the analyses of SPMs performed in this thesis is by no means complete. It is
          more appropriate to say that this author chose to analyse SPMs from their implementation
          perspective, particularly their voltage and SOC accuracies in an open-loop implementation.
          However, a holistic evaluation covering other aspects are necessary before their deployment
          in a vehicular BMS can be considered. For instance, the observability of models must be proven
          before they can be employed in the feedback path of a state estimator. Even within the broad
          stream of observability analysis, there are several details that need to be meticulously handled
          of which some avenues for future exploration are identified.

              In the simplification of the state-vector of the basic SPM proposed by Di Domenico [165],
          the bulk concentration in the two electrodes was assumed to be equal (see section 5.2.3). This
          allowed to eliminate the bulk concentrations of one of the two electrodes, thereby reducing
          the state vector to 3×1. This assumption hinges on the assumption that there is no loss of

                                                                262

                                         7.2 Analysis of Salient Physics-based Reduced Order Models

          cycleable lithium. However, such an assumption is valid only for a brand new cell. As the
          cell ages, owing to various phenomena such as parasitic side reactions and decomposition of
          the solid conductive matrix, this assumption shall no longer hold true. Therefore, analysis
          of models obtained by augmenting the basic or electrolyte-enhanced SPMs with equations
          describing degradation shall become critical. Not only does this force to retain both bulk
          concentrations in the state vector, the states from the degradation rate-equations appear in
          it, thereby enlarging it. In future studies, the effect of these augmented state variables on the
          observability of the system needs to be quantified.

              In this thesis, only an isothermal analysis of various SPMs have been performed. While
          this is an important initial step to analyse the strengths and weaknesses of the state of the
          art incumbent SPM models by isolating the purely electrochemical aspects, the effect of
          temperature cannot be underplayed. It is well-known that the thermal conditions of the
          cell affects its electrochemical and vice-versa. Therefore, future works shall benefit from
          performing comprehensive analyses of coupled electrochemical-thermal SPMs. Considering
          the simplicity of SPMs, the lumped thermal model might be a suitable candidate for it be
          paired with. Finally, in addition to its influence on the accuracy of open-loop terminal voltage
          and SOC, the effect of temperature on the observability of the holistic model needs to be
          evaluated. Since the cell temperature is available as an additional measurement, it is likely to
          improve the model's observability. However, there is a trade-off since this comes at the cost
          of increased size of the state vector. It is also worthwhile to explore the inflection point of
          this trade-off to limit the model's fidelity at a sufficient level whilst reaping the maximum
          gains out of the additional temperature measurement.

              Based upon the conclusion that the performance of any reduced order spatial profile model
          is hamstrung by the equation deficiencies in the underlying DFN model, it is worthwhile to
          reproduce the Multi-Gene Genetic Programming (MGGP) approach with a different PBM.
          For this future task, it is imperative to choose a model that provides additional interior-
          point conditions i.e., not just at the separator, but perhaps a second order condition within
          an interior location at each electrode. Once such a suitable PBM has been identified, this
          thesis author is confident that the genetic programming approach shall indeed synthesise an
          accurate description of the electrolyte's spatio-temporal dynamics.

                                                                263

                                             7.3 Implementation Aspects of Basic and Composite SPM

       7.3 Implementation Aspects of Basic and Composite SPM

          A driving impetus behind this thesis is to deliver ROMs amenable to embedded implement-
          ation. Large portions of chapter 5 and nearly the entirety of chapter 6 were devoted to this
          study. The conclusions that emerged from these implementation efforts are summarised here.
          Future areas of research are also identified in-line.

              In chapter 5, the aspects of discrete-time implementation in a microcontroller were dis-
          cussed. In particular, the computation of the discrete-time system and input matrices through
          the matrix exponential approach is presented. A straightforward conclusion from the discrete-
          time implementation is that they run orders of magnitude faster than their continuous-time
          counterparts. This is owing to the fact that adaptive time-stepping integrators are not required
          and can be replaced by a simple matrix-vector multiplication scheme. This implementation
          detail provides necessary starting point for battery researchers to start coding the ROMs
          discussed herein. Future work in this direction shall benefit from including various real-
          world issues such as accounting for sample delays as well as implementing a progressive
          update scheme for the matrix entries to account for degradation effects. Important aspects
          of numerical implementation arise during the design of state estimators. Having a robust
          open-loop implementation of a discrete-time plant model shall facilitate easy implementation
          of such feedback algorithms.

              Chapter 6 discussed the implementation aspects of ROM from a different perspective --
          that of formulating a new electrolyte enhanced composite SPM for embedded implementation.
          The temporal evolution of electrolyte dynamics in the two electrode regions were character-
          ised through system identification techniques that have never been tried before in literature.
          The identified model structures are presented in the final form as discrete-time difference
          equations that can be readily incorporated into the discrete-time equations developed in
          chapter 5 for the basic SPM. The salient conclusion from this modelling effort is that, system
          identification is indeed a viable candidate for the derivation of ROMs of lithium ion batteries.
          The improved accuracy of electrolyte concentration dynamics relative to the state of the art
          quadratic approximation model corroborates the success of this strategy. Nevertheless, before
          widespread adoption of this technique can be advocated, certain aspects of this approach must
          be examined carefully. For instance, the assumptions of linearity and time-invariance must

                                                                264

                                                                                               7.4 Closing Remarks

          be revisited for higher magnitudes of charge and discharge currents. Thermal effects must
          also be incorporated into the overall system identification approach. Machine learning and
          system identification are two complementary approaches to the same task i.e., identification
          of internal dynamics from terminal measurements. Future research could also explore this
          possibility and perhaps a combined system identification/machine learning strategy might
          metamorphose into the approach that powers future generation of surrogate ROMs for electric
          vehicle applications.

       7.4 Closing Remarks

          The feasibility of bringing PBMs of lithium batteries into electrified transportation has been
          studied in this thesis from a multi-dimensional perspective. Yet, there exists a common
          underpinning that connects these seemingly different routes to enhancement of our extant
          knowledge -- that of parametrising the underlying PBM. The number of parameters in any
          PBM is excessively large to the point of detracting potential adopters. Even without consider-
          ing degradation effects, obtaining the physical, geometric, transport and kinetic parameters
          of a cell shall require access to specialised laboratory equipment that are sometimes exclusive
          to large scale research organisations. The studies discussed here shall assume real-world
          significance only upon a successful demonstration of a cost-effective parametrisation strategy.
          The author's contributions to an optimal `Design of Experiments (DoE)' numerical procedure
          for identifying the parameters of an SPM is detailed in [209]. However, the broader task of
          parametrising a full-order PBM is well beyond the scope of this thesis or indeed any single
          researcher, and needs the concerted effort of the community as a whole to tackle it.

              The next task in the journey to real-world implementation of the advancements brought
          about by this thesis is to experimentally validate them. However, this is contingent upon
          obtaining a successful parametrisation strategy, and should be embarked upon as soon as
          a robust procedure to identify the physical parameters is made available. Nevertheless, this
          author hopes that through the three-pronged approach to cell modelling presented in this
          thesis, the goal of bringing physics-based battery models to electrified transportation has
          been brought a step closer to realisation.

                                                                265

                                            References

              [1] Martin Weiss, Pierre Bonnel, Rudolf Hummel, Alessio Provenza and Urbano Manfredi. `On-
                     Road Emissions of Light-Duty Vehicles in Europe'. Environmental Science & Technology 45.19
                     (Oct. 2011), pp. 8575­8581. issn: 0013-936X. doi: 10.1021/es2008424 [cited on page 25].

              [2] H. Ibrahim, A. Ilinca and J. Perron. `Energy storage systems--Characteristics and comparisons'.
                     Renewable and Sustainable Energy Reviews 12.5 (June 2008), pp. 1221­1250. issn: 1364-0321. doi:
                     10.1016/J.RSER.2007.01.023 [cited on page 25].

              [3] Davide Andrea. Battery management systems for large lithium-ion battery packs. Boston :
                     Artech House, 2010, p. 290. isbn: 9781608071050 [cited on pages 25, 70, 145, 171].

              [4] Thomas B. Reddy and David Linden. Linden's handbook of batteries. 4th ed. New York: McGraw-
                     Hill, 2011, p. 1457. isbn: 9780071624213 [cited on pages 25, 27, 138].

              [5] Gregory L. Plett. Battery Management Systems, Volume I: Battery Modeling. 1st ed. Norwood,
                     Massachusetts: Artech House, 2015, p. 346. isbn: 978-1630810238 [cited on pages 25, 26, 28, 29,
                     31, 110].

              [6] D. Grazioli, M. Magri and A. Salvadori. `Computational modeling of Li-ion batteries'. Compu-
                     tational Mechanics 58.6 (Dec. 2016), pp. 889­909. issn: 0178-7675. doi: 10.1007/s00466-016-
                     1325-8 [cited on page 28].

              [7] Krishnan S. Hariharan, Piyush Tagade and Sanoop Ramachandran. Mathematical Modeling of
                     Lithium Batteries : From Electrochemical Models to State Estimator Algorithms. Green Energy
                     and Technology. Cham: Springer International Publishing, 2017. isbn: 9783319035277. doi:
                     10.1007/978-3-319-03527-7 [cited on page 28].

              [8] Christopher D. Rahn and Chao-Yang Wang. Battery Systems Engineering. Oxford, UK: John
                     Wiley & Sons Ltd, Feb. 2013. isbn: 9781118517048. doi: 10.1002/9781118517048 [cited on
                     pages 28, 52, 59, 138].

              [9] Henk J. Bergveld, Wanda S. Kruijt and Peter H. Notten. Battery Management Systems : Design
                     by Modelling. Dordrecht : Springer Netherlands, 2002, p. 295. isbn: 9789401708432. doi: 10.
                     1007/978-94-017-0843-2 [cited on page 28].

             [10] Aden Seaman, Thanh-Son Dao and John McPhee. `A survey of mathematics-based equivalent-
                     circuit and electrochemical battery models for hybrid and electric vehicle simulation'. Journal
                     of Power Sources 256 (June 2014), pp. 410­423. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.
                     2014.01.057 [cited on page 29].

                                                                266

                                                                                                        REFERENCES

             [11] Gregory L. Plett. `Sigma-point Kalman filtering for battery management systems of LiPB-based
                     HEV battery packs: Part 1: Introduction and state estimation'. Journal of Power Sources 161.2
                     (Oct. 2006), pp. 1356­1368. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2006.06.003 [cited
                     on pages 29, 143].

             [12] Fengchun Sun, Xiaosong Hu, Yuan Zou and Siguang Li. `Adaptive unscented Kalman filtering
                     for state of charge estimation of a lithium-ion battery for electric vehicles'. Energy 36.5 (May
                     2011), pp. 3531­3540. issn: 0360-5442. doi: 10.1016/J.ENERGY.2011.03.059 [cited on
                     page 29].

             [13] Gregory L. Plett. Battery Management Systems, Volume II: Equivalent-Circuit Methods. Nor-
                     wood, Massachusetts: Artech House, 2016. isbn: 978-1-63081-027-6 [cited on pages 29, 79, 147].

             [14] M. Ecker, T.K.D. Tran, P. Dechent, S. Kabitz, A. Warnecke and Dirk U. Sauer. `Parameterization
                     of a Physico-Chemical Model of a Lithium-Ion Battery: I. Determination of Parameters'.
                     Journal of the Electrochemical Society 162.9 (June 2015), A1836­A1848. issn: 0013-4651. doi:
                     10.1149/2.0551509jes [cited on pages 30, 138].

             [15] Marc Doyle, Thomas F. Fuller and John S. Newman. `Modeling of Galvanostatic Charge and
                     Discharge of the Lithium/Polymer/Insertion Cell'. Journal of The Electrochemical Society 140.6
                     (June 1993), pp. 1526­1533. issn: 00134651. doi: 10.1149/1.2221597 [cited on pages 31, 135].

             [16] Thomas F. Fuller, Marc Doyle and John S. Newman. `Simulation and Optimization of the Dual
                     Lithium Ion Insertion Cell'. Journal of The Electrochemical Society 141.1 (Jan. 1994), p. 1. issn:
                     00134651. doi: 10.1149/1.2054684 [cited on pages 31, 111, 121, 135].

             [17] Stefan H. Thomke. `Simulation, learning and R&D performance: Evidence from automotive
                     development'. Research Policy 27.1 (May 1998), pp. 55­74. issn: 00487333. doi: 10.1016/S0048-
                     7333(98)00024-9 [cited on page 36].

             [18] Markus C. Becker, Pasquale Salvatore and Francesco Zirpoli. `The impact of virtual simulation
                     tools on problem-solving and new product development organization'. Research Policy 34.9
                     (Nov. 2005), pp. 1305­1321. issn: 00487333. doi: 10.1016/j.respol.2005.03.016 [cited on
                     page 36].

             [19] Robert M. Spotnitz. `Battery modeling'. The Electrochemical Society Interface (2005), pp. 39­42.
                     issn: 10648208. doi: 10.1109/MC.2003.1250886 [cited on page 36].

            [20] M S. Islam and Craig A. J. Fisher. `Lithium and sodium battery cathode materials: computa-
                     tional insights into voltage, diffusion and nanostructural properties'. Chemical Society Reviews
                     43.1 (Dec. 2014), pp. 185­204. issn: 0306-0012. doi: 10.1039/C3CS60199D [cited on page 37].

             [21] Ying S. Meng and M E. Arroyo-de Dompablo. `First principles computational materials design
                     for energy storage materials in lithium ion batteries'. Energy & Environmental Science 2.6 (June
                     2009), p. 589. issn: 1754-5692. doi: 10.1039/b901825e [cited on page 37].

            [22] Austin D. Sendek, Qian Yang, Ekin D. Cubuk, Karel-Alexander N. Duerloo, Yi Cui and Evan
                     J. Reed. `Holistic computational structure screening of more than 12 000 candidates for solid
                     lithium-ion conductor materials'. Energy & Environmental Science 10.1 (2017), pp. 306­320.
                     issn: 1754-5692. doi: 10.1039/C6EE02697D [cited on page 37].

                                                                267

                                                                                                        REFERENCES

            [23] Venkatasailanathan Ramadesigan, Paul W. Northrop, Sumitava De, Shriram Santhanagopalan,
                     Richard D. Braatz and V. R. Subramanian. `Modeling and Simulation of Lithium-Ion Batteries
                     from a Systems Engineering Perspective'. Journal of the Electrochemical Society 159.3 (Jan.
                     2012), R31­R45. issn: 0013-4651. doi: 10.1149/2.018203jes [cited on pages 38, 59, 60, 95,
                     96].

            [24] John S. Newman. `Optimization of Porosity and Thickness of a Battery Electrode by Means of a
                     Reaction-Zone Model'. Journal of The Electrochemical Society 142.1 (1995), p. 97. issn: 00134651.
                     doi: 10.1149/1.2043956 [cited on pages 38, 62].

            [25] Pankaj Arora, Marc Doyle and Ralph E. White. `Mathematical Modeling of the Lithium
                     Deposition Overcharge Reaction in Lithium-Ion Batteries Using Carbon-Based Negative
                     Electrodes'. Journal of The Electrochemical Society 146.10 (Oct. 1999), p. 3543. issn: 00134651.
                     doi: 10.1149/1.1392512 [cited on pages 39, 142].

            [26] Nansi Xue, Wenbo Du, Amit Gupta, Wei Shyy, Ann Marie Sastry and Joaquim R. Martins.
                    `Optimization of a Single Lithium-Ion Battery Cell with a Gradient-Based Algorithm'. Journal
                     of The Electrochemical Society 160.8 (May 2013), A1071­A1078. issn: 0013-4651. doi: 10.1149/
                     2.036308jes [cited on pages 39, 258].

            [27] Nansi Xue, Wenbo Du, Thomas A. Greszler, Wei Shyy and Joaquim R. Martins. `Design of a
                     lithium-ion battery pack for PHEV using a hybrid optimization method'. Applied Energy 115
                     (Feb. 2014), pp. 591­602. issn: 03062619. doi: 10.1016/j.apenergy.2013.10.044 [cited on
                     pages 39, 40].

            [28] Dragan Maksimovic. Course Notes ECEN5017: Power Electronics for Electric Drive Vehicles. 2012.
                     url: http://ecee.colorado.edu/%7B~%7Decen5017/ [cited on pages 40, 67, 75, 88, 103,
                     173].

            [29] Changhong Liu and Lin Liu. `Optimal Design of Li-Ion Batteries through Multi-Physics
                     Modeling and Multi-Objective Optimization'. Journal of The Electrochemical Society 164.11
                     (2017), E3254­E3264. issn: 0013-4651. doi: 10.1149/2.0291711jes [cited on page 40].

            [30] Ali Jokar, Barzin Rajabloo, Martin Désilets and Marcel Lacroix. `Review of simplified Pseudo-
                     two-Dimensional models of lithium-ion batteries'. Journal of Power Sources 327 (Sept. 2016),
                     pp. 44­55. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2016.07.036 [cited on pages 41, 42,
                     48].

             [31] Guodong Fan, Ke Pan and Marcello Canova. `A comparison of model order reduction
                     techniques for electrochemical characterization of Lithium-ion batteries'. 54th IEEE Conference
                     on Decision and Control (CDC). IEEE, Dec. 2015, pp. 3922­3931. doi: 10.1109/CDC.2015.
                     7402829 [cited on pages 41, 42, 48].

            [32] Kandler Smith and Chao-Yang Wang. `Solid-state diffusion limitations on pulse operation
                     of a lithium ion cell for hybrid electric vehicles'. Journal of Power Sources 161.1 (Oct. 2006),
                     pp. 628­639. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2006.03.050 [cited on pages 43,
                     131].

            [33] T S. Dao, C P. Vyasarayani and J McPhee. `Simplification and order reduction of lithium-
                     ion battery model based on porous-electrode theory'. Journal of Power Sources (2012). url:
                     http://www.sciencedirect.com/science/article/pii/S0378775311018052 [cited
                     on page 43].

                                                                268

                                                                                                        REFERENCES

            [34] Guodong Fan, Ke Pan, Marcello Canova, James Marcicki and Xiao G. Yang. `Modeling of Li-
                     Ion Cells for Fast Simulation of High C-Rate and Low Temperature Operations'. Journal of
                     The Electrochemical Society 163.5 (Feb. 2016), A666­A676. issn: 0013-4651. doi: 10.1149/2.
                     0761605jes [cited on pages 43, 183].

            [35] Guodong Fan, Xiaoyu Li and Marcello Canova. `A reduced-order electrochemical model of li-
                     ion batteries for control and estimation applications'. IEEE Transactions on Vehicular Technology
                     67.1 (2018), pp. 76­91. issn: 00189545. doi: 10.1109/TVT.2017.2738780 [cited on page 43].

            [36] Joel C. Forman, Saeid Bashash, Jeffrey L. Stein and Hosam K. Fathy. `Reduction of an
                     Electrochemistry-Based Li-Ion Battery Model via Quasi-Linearization and Padé Approxim-
                     ation'. Journal of The Electrochemical Society 158.2 (Feb. 2011), A93. issn: 00134651. doi: 10.
                     1149/1.3519059 [cited on page 43].

            [37] James Marcicki, Marcello Canova, A. Terrence Conlisk and Giorgio Rizzoni. `Design and
                     parametrization analysis of a reduced-order electrochemical model of graphite/LiFePO4 cells
                     for SOC/SOH estimation'. Journal of Power Sources 237 (Sept. 2013), pp. 310­324. issn: 0378-
                     7753. doi: 10.1016/J.JPOWSOUR.2012.12.120 [cited on pages 43, 182, 183].

            [38] Saeid Bashash, Scott J. Moura and Hosam K. Fathy. `Charge trajectory optimization of plug-in
                     hybrid electric vehicles for energy cost reduction and battery health enhancement'. Proceedings
                     of the 2010 American Control Conference. IEEE, June 2010, pp. 5824­5831. isbn: 978-1-4244-7427-
                     1. doi: 10.1109/ACC.2010.5530497 [cited on page 43].

            [39] Hector Perez, Niloofar Shahmohammadhamedani and Scott J. Moura. `Enhanced Performance
                     of Li-Ion Batteries via Modified Reference Governors and Electrochemical Models'. IEEE/ASME
                     Transactions on Mechatronics 20.4 (Aug. 2015), pp. 1511­1520. issn: 1083-4435. doi: 10.1109/
                     TMECH.2014.2379695 [cited on page 43].

            [40] Scott J. Moura, Miroslav Krstic and Nalin A. Chaturvedi. `Adaptive PDE Observer for Battery
                     SOC/SOH Estimation'. Volume 1: Adaptive Control; Advanced Vehicle Propulsion Systems;
                     Aerospace Systems; Autonomous Systems; Battery Modeling; Biochemical Systems; Control Over
                     Networks; Control Systems Design; Cooperativ. ASME, Oct. 2012, pp. 101­110. isbn: 978-0-7918-
                     4529-5. doi: 10.1115/DSCC2012-MOVIC2012-8800 [cited on pages 43, 130, 296].

             [41] Githin K. Prasad and Christopher D. Rahn. `Model based identification of aging parameters
                     in lithium ion batteries'. Journal of Power Sources 232 (June 2013), pp. 79­85. issn: 0378-7753.
                     doi: 10.1016/J.JPOWSOUR.2013.01.041 [cited on pages 43, 49].

            [42] Shifei Yuan, Lei Jiang, Chengliang Yin, Hongjie Wu and Xi Zhang. `A transfer function type of
                     simplified electrochemical model with modified boundary conditions and Padé approximation
                     for Li-ion battery: Part 1. lithium concentration estimation'. Journal of Power Sources 352 (June
                     2017), pp. 245­257. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.03.060 [cited on
                     page 44].

            [43] Shifei Yuan, Lei Jiang, Chengliang Yin, Hongjie Wu and Xi Zhang. `A transfer function type of
                     simplified electrochemical model with modified boundary conditions and Padé approximation
                     for Li-ion battery: Part 2. Modeling and parameter estimation'. Journal of Power Sources 352
                     (June 2017), pp. 258­271. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.03.061 [cited
                     on page 44].

                                                                269

                                                                                                        REFERENCES

            [44] Kandler A. Smith, Christopher D. Rahn and Chao-Yang Wang. `Control oriented 1D electro-
                     chemical model of lithium ion battery'. Energy Conversion and Management 48.9 (Sept. 2007),
                     pp. 2565­2578. issn: 0196-8904. doi: 10.1016/J.ENCONMAN.2007.03.015 [cited on pages 44,
                     110].

            [45] James L. Lee, Andrew Chemistruck and Gregory L. Plett. `One-dimensional physics-based
                     reduced-order model of lithium-ion dynamics'. Journal of Power Sources 220 (Dec. 2012),
                     pp. 430­448. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2012.07.075 [cited on pages 45,
                     46, 52, 110, 111, 113, 121, 124, 126].

            [46] James L. Lee. `Reduced-order physics-based model of lithium-ion batteries'. PhD thesis.
                     University of Colorado Colorado Springs, 2012, p. 150. url: http : / / hdl . handle . net /
                     10976/250 [cited on pages 45, 46, 52, 110].

            [47] James L. Lee, Lukas L. Aldrich, Kirk D. Stetzel and Gregory L. Plett. `Extended operating
                     range for reduced-order model of lithium-ion cells'. Journal of Power Sources 255 (June 2014),
                     pp. 85­100. issn: 03787753. doi: 10.1016/j.jpowsour.2013.12.134 [cited on pages 46­48].

            [48] Krishnakumar Gopalakrishnan, Teng Zhang and Gregory J. Offer. `A Fast, Memory-Efficient
                     Discrete-Time Realization Algorithm for Reduced-Order Li-Ion Battery Models'. Journal of
                     Electrochemical Energy Conversion and Storage 14.1 (Feb. 2017), p. 011001. issn: 2381-6872. doi:
                     10.1115/1.4035526 [cited on pages 46, 109, 296].

            [49] Albert Rodríguez, Gregory L. Plett and M. Scott Trimboli. `Fast computation of the electrolyte-
                     concentration transfer function of a lithium-ion cell model'. Journal of Power Sources 360 (Aug.
                     2017), pp. 642­645. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.06.025 [cited on
                     page 47].

            [50] Meng Guo, Xinfang Jin and Ralph E. White. `Nonlinear State-Variable Method for Solving
                     Physics-Based Li-Ion Cell Model with High-Frequency Inputs'. Journal of The Electrochemical
                     Society 164.11 (2017), E3001­E3015. issn: 0013-4651. doi: 10.1149/2.0021711jes [cited on
                     page 48].

             [51] Githin K. Prasad and Christopher D. Rahn. `Development of a First Principles Equivalent
                     Circuit Model for a Lithium Ion Battery'. Volume 2: Legged Locomotion; Mechatronic Systems;
                     Mechatronics; Mechatronics for Aquatic Environments; MEMS Control; Model Predictive Control;
                     Modeling and Model-Based Control of Advanced IC Engines; ASME, Oct. 2012, p. 369. isbn:
                     978-0-7918-4530-1. doi: 10.1115/DSCC2012-MOVIC2012-8607 [cited on page 48].

            [52] Githin K. Prasad and Christopher D. Rahn. `Reduced Order Impedance Models of Lithium Ion
                     Batteries'. Journal of Dynamic Systems, Measurement, and Control 136.4 (Apr. 2014), p. 041012.
                     issn: 0022-0434. doi: 10.1115/1.4026652 [cited on pages 48, 49].

            [53] Xi Zhang, Jinling Lu, Shifei Yuan, Jun Yang and Xuan Zhou. `A novel method for identification
                     of lithium-ion battery equivalent circuit model parameters considering electrochemical
                     properties'. Journal of Power Sources 345 (Mar. 2017), pp. 21­29. issn: 0378-7753. doi: 10 .
                     1016/J.JPOWSOUR.2017.01.126 [cited on pages 48, 49].

            [54] Si Cheng, Yong Zhang, Xu-Feng Cheng and Xi Zhang. `State estimation using physics-based
                     equivalent circuit models of a Li-ion cell and Kalman filter'. IECON 2017 - 43rd Annual
                     Conference of the IEEE Industrial Electronics Society. IEEE, Oct. 2017, pp. 5280­5286. isbn:
                     978-1-5386-1127-2. doi: 10.1109/IECON.2017.8216914 [cited on page 48].

                                                                270

                                                                                                        REFERENCES

            [55] Yu Merla, Billy Wu, Vladimir Yufit, Ricardo F. Martinez-Botas and Gregory J. Offer. `An easy-to-
                     parameterise physics-informed battery model and its application towards lithium-ion battery
                     cell design, diagnosis, and degradation'. Journal of Power Sources 384 (Apr. 2018), pp. 66­79.
                     issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2018.02.065 [cited on pages 48, 49].

            [56] J. E. B. Randles. `Kinetics of rapid electrode reactions'. Discussions of the Faraday Society 1 (Jan.
                     1947), p. 11. issn: 0366-9033. doi: 10.1039/df9470100011 [cited on page 49].

             [57] Xiaoyu Li, Guodong Fan, Giorgio Rizzoni, Marcello Canova, Chunbo Zhu and Guo Wei. `A
                     simplified multi-particle model for lithium ion batteries via a predictor-corrector strategy and
                     quasi-linearization'. Energy 116 (Dec. 2016), pp. 154­169. issn: 0360-5442. doi: 10.1016/J.
                     ENERGY.2016.09.099 [cited on page 50].

            [58] Xing Xu, Wei Wang and Long Chen. `Order Reduction of Lithium-Ion Battery Model Based on
                     Solid State Diffusion Dynamics via Large Scale Systems Theory'. Journal of The Electrochemical
                     Society 163.7 (May 2016), A1429­A1441. issn: 0013-4651. doi: 10.1149/2.1251607jes [cited
                     on page 50].

            [59] Matteo Corno, Nimitt Bhatt, Sergio M. Savaresi and Michel Verhaegen. `Electrochemical
                     model-based state of charge estimation for li-ion cells'. IEEE Transactions on Control Systems
                     Technology 23.1 (2015), pp. 117­127. issn: 10636536. doi: 10.1109/TCST.2014.2314333 [cited
                     on page 50].

            [60] Jocelyn Sabatier, Mathieu Merveillaut, Junior M. Francisco, Franck Guillemard and Denis
                     Porcelatto. `Lithium-ion batteries modeling involving fractional differentiation'. Journal of
                     Power Sources 262 (Sept. 2014), pp. 36­43. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2014.
                     02.071 [cited on page 50].

             [61] Jocelyn Sabatier, Junior M. Francisco, Franck Guillemard, Loic Lavigne, Mathieu Moze and
                     Mathieu Merveillaut. `Lithium-ion batteries modeling: A simple fractional differentiation
                     based model and its associated parameters estimation method'. Signal Processing 107 (Feb.
                     2015), pp. 290­301. issn: 0165-1684. doi: 10 . 1016 / J . SIGPRO . 2014 . 06 . 008 [cited on
                     page 50].

            [62] Xiaoyu Li, Guodong Fan, Ke Pan, Guo Wei, Chunbo Zhu, Giorgio Rizzoni and Marcello Canova.
                    `A physics-based fractional order model and state of energy estimation for lithium ion batteries.
                     Part I: Model development and observability analysis'. Journal of Power Sources 367 (Nov. 2017),
                     pp. 187­201. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2017.09.049 [cited on page 50].

            [63] Hao Mu, Rui Xiong, Hongfei Zheng, Yuhua Chang and Zeyu Chen. `A novel fractional order
                     model based state-of-charge estimation method for lithium-ion battery'. Applied Energy 207
                     (Dec. 2017), pp. 384­393. issn: 0306-2619. doi: 10.1016/J.APENERGY.2017.07.003 [cited
                     on page 50].

            [64] Baojin Wang, Zhiyuan Liu, Shengbo E. Li, Scott J. Moura and Huei Peng. `State-of-Charge
                     Estimation for Lithium-Ion Batteries Based on a Nonlinear Fractional Model'. IEEE Transactions
                     on Control Systems Technology 25.1 (2017), pp. 3­11. issn: 10636536. doi: 10.1109/TCST.2016.
                     2557221 [cited on page 50].

            [65] Chris Manzie, Changfu Zou and Dragan Nesic. `Simplification techniques for PDE-based Li-
                     Ion battery models'. 2015 54th IEEE Conference on Decision and Control (CDC). IEEE, Dec. 2015,
                     pp. 3913­3921. isbn: 978-1-4799-7886-1. doi: 10.1109/CDC.2015.7402828 [cited on page 51].

                                                                271

                                                                                                        REFERENCES

            [66] Adolph Fick. `On liquid diffusion'. Journal of Membrane Science 100.1 (Mar. 1995), pp. 33­38.
                     issn: 0376-7388. doi: 10.1016/0376-7388(94)00230-V [cited on pages 51, 132, 135].

            [67] Noble B. Ferguson. `Orthogonal collocation as a method of analysis in chemical reaction
                     engineering'. Dissertation. UNiversity of Washingron, 1971, p. 201. url: https://digital.
                     lib . washington . edu / researchworks / bitstream / handle / 1773 / 9876 / 7207350 .
                     pdf?sequence=1 [cited on page 52].

            [68] Lloyd N. Trefethen. Spectral methods in MATLAB. Society for Industrial and Applied Mathem-
                     atics (SIAM, 3600 Market Street, Floor 6, Philadelphia, PA 19104), 2000, p. 165. isbn: 0898719593
                     [cited on pages 52, 84, 85].

            [69] John P. Boyd. Chebyshev and Fourier spectral methods. Dover Publications, 2001, p. 668. isbn:
                     0486411834 [cited on page 52].

             [70] Bernie D. Shizgal. Spectral methods in chemistry and physics : applications to kinetic theory and
                     quantum mechanics. 2015, p. 415. isbn: 9789401794541 [cited on page 52].

             [71] Denys Dutykh. `A brief introduction to pseudo-spectral methods: application to diffusion
                     problems'. June 2016. url: http://arxiv.org/abs/1606.05432 [cited on page 52].

            [72] Paul W. C. Northrop, Venkatasailanathan Ramadesigan, Sumitava De and Venkat R. Sub-
                     ramanian. `Coordinate Transformation , Orthogonal Collocation , Model Reformulation and
                     Simulation of Electrochemical-Thermal Behavior of Lithium-Ion Battery Stacks'. Journal of
                     The Electrochemical Society 158.12 (2011), A1461­A1477. doi: 10.1149/2.058112jes [cited on
                     pages 52, 76, 96, 97, 101, 155, 160, 295].

            [73] B Suthar, P W. C. Northrop, R D. Braatz and V R. Subramanian. `Optimal Charging Profiles with
                     Minimal Intercalation-Induced Stresses for Lithium-Ion Batteries Using Reformulated Pseudo
                     2-Dimensional Models'. Journal of the Electrochemical Society 161.11 (Oct. 2014), F3144­F3155.
                     issn: 0013-4651. doi: 10.1149/2.0211411jes [cited on page 52].

            [74] Adrien M. Bizeray, Shi Zhao, Stephen R. Duncan and David A. Howey. `Lithium-ion battery
                     thermal-electrochemical model-based state estimation using orthogonal collocation and a
                     modified extended Kalman filter'. Journal of Power Sources 296 (Nov. 2015), pp. 400­412. issn:
                     0378-7753. doi: 10.1016/J.JPOWSOUR.2015.07.019 [cited on pages 52, 84].

             [75] Ian D. Campbell, Krishnakumar Gopalakrishnan, Monica Marinescu, Marcello Torchio,
                     Gregory J. Offer and Davide M. Raimondo. `Optimising lithium-ion cell design for plug-in
                     hybrid and battery electric vehicles'. Journal of Energy Storage (Submitted) (2018) [cited on
                     page 52].

             [76] Venkat R. Subramanian, Deepak Tapriyal and Ralph E. White. `A Boundary Condition for
                     Porous Electrodes'. Electrochemical and Solid-State Letters 7.9 (Sept. 2004), A259. issn: 10990062.
                     doi: 10.1149/1.1773751 [cited on page 53].

             [77] Venkat R. Subramanian, Vinten D. Diwakar and Deepak Tapriyal. `Efficient Macro-Micro
                     Scale Coupled Modeling of Batteries'. Journal of The Electrochemical Society 152.10 (Oct. 2005),
                     A2002. issn: 00134651. doi: 10.1149/1.2032427 [cited on pages 53, 135­137].

            [78] Venkat R. Subramanian, Vijayasekaran Boovaragavan and Vinten D. Diwakar. `Toward Real-
                     Time Simulation of Physics Based Lithium-Ion Battery Models'. Electrochemical and Solid-State
                     Letters 10.11 (Nov. 2007), A255. issn: 10990062. doi: 10.1149/1.2776128 [cited on page 53].

                                                                272

                                                                                                        REFERENCES

            [79] Horatio S. Carslaw and John C. Jaeger. Conduction of heat in solids. 1st ed. Oxford: Clarendon
                     Press, 1947, p. 386 [cited on page 54].

            [80] Shengyi Liu. `An analytical solution to Li/Li+ insertion into a porous electrode'. Solid State
                     Ionics 177.1-2 (Jan. 2006), pp. 53­58. issn: 0167-2738. doi: 10.1016/J.SSI.2005.09.053
                     [cited on pages 54, 135].

             [81] Meng Guo and Ralph E. White. `An approximate solution for solid-phase diffusion in a
                     spherical particle in physics-based Li-ion cell models'. Journal of Power Sources 198 (Jan. 2012),
                     pp. 322­328. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2011.08.096 [cited on page 54].

            [82] Zhongwei Deng, Lin Yang, Hao Deng, Yishan Cai and Dongdong Li. `Polynomial approx-
                     imation pseudo-two-dimensional battery model for online application in embedded battery
                     management system'. Energy 142 (Jan. 2018), pp. 838­850. issn: 0360-5442. doi: 10.1016/J.
                     ENERGY.2017.10.097 [cited on pages 54, 184, 185, 296].

            [83] Mohammed Farag, Matthias Fleckenstein and Saeid Habibi. `Continuous piecewise-linear,
                     reduced-order electrochemical model for lithium-ion batteries in real-time applications'.
                     Journal of Power Sources 342 (2017), pp. 351­362. issn: 03787753. doi: 10.1016/j.jpowsour.
                     2016.12.044 [cited on page 55].

            [84] Bala S. Haran, Branko N. Popov and Ralph E. White. `Determination of the hydrogen diffusion
                     coefficient in metal hydrides by impedance spectroscopy'. Journal of Power Sources 75.1 (Sept.
                     1998), pp. 56­63. issn: 0378-7753. doi: 10.1016/S0378-7753(98)00092-5 [cited on pages 55,
                     128].

            [85] Gang Ning and Branko N. Popov. `Cycle Life Modeling of Lithium-Ion Batteries'. Journal of The
                     Electrochemical Society 151.10 (Oct. 2004), A1584. issn: 00134651. doi: 10.1149/1.1787631
                     [cited on pages 55, 128].

            [86] Marie-Therese von Srbik. `Advanced Lithium-Ion Battery Modelling for Automotive Applica-
                     tions'. PhD thesis. Imperial College London, 2015, p. 162. url: https://spiral.imperial.
                     ac.uk/handle/10044/1/51498 [cited on pages 63, 294].

            [87] Carolyn R. Pals and John S. Newman. `Thermal Modeling of the Lithium/Polymer Battery'.
                     Journal of The Electrochemical Society 142.10 (1995), p. 3282. issn: 00134651. doi: 10.1149/1.
                     2049975 [cited on pages 63, 72].

            [88] Ian A. Hunt, Yan Zhao, Yatish Patel and J Offer. `Surface Cooling Causes Accelerated Degrad-
                     ation Compared to Tab Cooling for Lithium-Ion Pouch Cells'. Journal of The Electrochemical
                     Society 163.9 (2016), A1846­A1852. issn: 0013-4651. doi: 10.1149/2.0361609jes [cited on
                     page 71].

            [89] Jinming Liu, Mohammad Anwar, Peter Chiang, Shawn Hawkins, Youngsoo Jeong, Faizul
                     Momen, Stephen Poulos and Seunghan Song. `Design of the Chevrolet Bolt EV Propulsion
                     System'. SAE International Journal of Alternative Powertrains 5.1 (2016), pp. 1153­2016. issn:
                     2167-4205. doi: 10.4271/2016-01-1153 [cited on pages 75, 102].

            [90] Venkat R. Subramanian, Vijayasekaran Boovaragavan, Venkatasailanathan Ramadesigan and
                     Mounika Arabandi. `Mathematical Model Reformulation for Lithium-Ion Battery Simulations :
                     Galvanostatic Boundary Conditions'. Journal of the Electrochemical Society 156.4 (2009), A260­
                     A271. doi: 10.1149/1.3065083 [cited on pages 76, 101, 155, 156, 158, 159].

                                                                273

                                                                                                        REFERENCES

             [91] General Motors. Drive Unit and Battery at the Heart of Chevrolet Bolt EV. 2016. url: https:
                     / / media . chevrolet . com / media / us / en / chevrolet / home . detail . html / content /
                     Pages / news / us / en / 2016 / Jan / naias / chevy / 0111 - bolt - du . html (visited on
                     18/07/2017) [cited on pages 76, 101].

            [92] Oliver Gröger, Hubert a. Gasteiger and Jens-Peter Suchsland. `Review--Electromobility:
                     Batteries or Fuel Cells?' Journal of The Electrochemical Society 162.14 (2015), A2605­A2622.
                     issn: 0013-4651. doi: 10.1149/2.0211514jes [cited on pages 76, 77, 101].

            [93] Dennis W. Dees, Vincent S. Battaglia and Andre Belanger. `Electrochemical modeling of lithium
                     polymer batteries'. Journal of Power Sources 110.2 (2002), pp. 310­320. issn: 0378-7753. doi:
                     10.1016/S0378-7753(02)00193-3 [cited on page 80].

            [94] Marcello Torchio, Lalo Magni, R B. Gopaluni, Richard D. Braatz and Davide M. Raimondo.
                    `LIONSIMBA: A Matlab Framework Based on a Finite Volume Model Suitable for Li-Ion Battery
                     Design, Simulation, and Control'. Journal of The Electrochemical Society 163.7 (2016), A1192­
                     A1205. issn: 0013-4651. doi: 10.1149/2.0291607jes [cited on pages 81, 100, 294].

            [95] Alan C. Hindmarsh, Peter N. Brown, Keith E. Grant, Steven L. Lee, Radu Serban, Dan E.
                     Shumaker and Carol S. Woodward. `SUNDIALS: Suite of nonlinear and differential/algebraic
                     equation solvers'. ACM Transactions on Mathematical Software (TOMS) 31.3 (2005), pp. 363­396
                     [cited on page 83].

            [96] Shriram Santhanagopalan, Qingzhi Guo, Premanand Ramadass and Ralph E. White. `Review of
                     models for predicting the cycling performance of lithium ion batteries'. Journal of Power Sources
                     156.2 (2006), pp. 620­628. issn: 0378-7753. doi: DOI:10.1016/j.jpowsour.2005.05.070
                     [cited on pages 83, 128, 129].

            [97] Joel Andersson. `Faculty of Engineering Science A General-Purpose Software Framework
                     for Dynamic Optimization'. PhD thesis. Arenberg Doctoral School, KU Leuven, 2013. isbn:
                     9789460187506 [cited on page 84].

            [98] Society of Automotive Engineers. `Surface vehicle recommended practice : SAE electric vehicle
                     and plug in hybrid electric vehicle conductive charge coupler' (2010), p. 116. url: https :
                     //saemobilus.sae.org/content/j1772%7B%5C_%7D201710 [cited on pages 86, 101, 103].

            [99] Song Y. Choe, Xueyan Li and Meng Xiao. `Fast charging method based on estimation of
                     ion concentrations using a reduced order of electrochemical thermal model for lithium ion
                     polymer battery'. World Electric Vehicle Journal 6.3 (2013), pp. 782­792. issn: 20326653. doi:
                     10.1109/EVS.2013.6914966 [cited on page 90].

           [100] Thomas H. Cormen. Introduction to algorithms. 3rd ed. Cambridge Mass.: MIT Press, 2009,
                     p. 1292. isbn: 9780262270830 [cited on page 92].

            [101] Toby Bond, Jigang Zhou and Jeffrey Cutler. `Electrode Stack Geometry Changes during Gas
                     Evolution in Pouch-Cell-Type Lithium Ion Batteries'. Journal of The Electrochemical Society
                     164.1 (Nov. 2017), A6158­A6162. issn: 0013-4651. doi: 10 . 1149 / 2 . 0241701jes [cited on
                     pages 95, 158, 294].

           [102] Riza Kizilel, Rami Sabbah, J R. Selman and Said Al-Hallaj. `An alternative cooling system
                     to enhance the safety of Li-ion battery packs'. Journal of Power Sources 194.2 (Dec. 2009),
                     pp. 1105­1112. issn: 03787753. doi: 10.1016/j.jpowsour.2009.06.074 [cited on page 101].

                                                                274

            REFERENCES

[103] Pontus Svens, Maria H. Kjell, Carl Tengstedt, Göran Flodberg and Göran Lindbergh. `Li-ion
         pouch cells for vehicle applications-studies of water transmission and packing materials'.
         Energies 6 (2013), pp. 400­410. issn: 19961073. doi: 10.3390/en6010400 [cited on page 101].

[104] S C. Chen, C C. Wan and Y Y. Wang. `Thermal analysis of lithium-ion batteries'. Journal of
         Power Sources 140.1 (2005), pp. 111­124. issn: 0378-7753. doi: 10.1016/j.jpowsour.2004.
         05.064 [cited on page 101].

[105] W Martienssen and Hans Warlimont. Springer Handbook of Condensed Matter and Materials
         Data. Berlin: Springer Berlin Heidelberg, 2005, p. 1119. isbn: 978-3-540-44376-6. doi: 10.1007/
         3-540-30437-1 [cited on page 101].

[106]  Guifang Guo, Bo Long, Bo Cheng, Shiqiong Zhou, Peng Xu and Binggang Cao. `Three-
       dimensional thermal finite element modeling of lithium-ion battery in thermal abuse
       application'. Journal of Power Sources 195.8 (2010), pp. 2393­2398. issn: 0378-7753. doi: 10.
       1016/j.jpowsour.2009.10.090 [cited on page 101].

[107] Dong H. Jeon and Seung M. Baek. `Thermal modeling of cylindrical lithium ion battery during
         discharge cycle'. Energy Conversion and Management 52.8-9 (2011), pp. 2973­2981. issn: 0196-
         8904. doi: 10.1016/j.enconman.2011.04.013 [cited on page 101].

[108]  Daniel Worwood, Quirin Kellner, Elham Hosseinzadeh, David Mullen, David Greenwood,
       James Marco, Ryan McGlen and Kevin Lynn. `Thermal Analysis of Fin Cooling Large Format
       Automotive Lithium-Ion Pouch Cells'. 2017 IEEE Vehicle Power and Propulsion Conference
       (VPPC). IEEE, Dec. 2017, pp. 1­6. isbn: 978-1-5386-1317-7. doi: 10.1109/VPPC.2017.8330874
       [cited on page 101].

[109] Li Song and James W. Evans. `Electrochemical-Thermal Model of Lithium Polymer Batteries'.
         Journal of The Electrochemical Society 147.6 (June 2000), p. 2086. issn: 00134651. doi: 10.1149/
         1.1393490 [cited on page 101].

[110] Ui S. Kim, Chee B. Shin and Chi S. Kim. `Modeling for the scale-up of a lithium-ion polymer
         battery'. Journal of Power Sources 189.1 (2009), pp. 841­846. issn: 03787753. doi: 10.1016/j.
         jpowsour.2008.10.019 [cited on page 101].

[111] The Mathworks Inc. MATLAB. Natick, 2017. url: https://www.mathworks.com/products/
        matlab.html [cited on page 100].

[112] Paul Albertus and John S. Newman. FORTRAN Programs for the Simulation of Electrochemical
         Systems. 2007. url: http://www.cchem.berkeley.edu/jsngrp/fortran.html [cited on
         page 100].

[113] Nisewanger; Jeff. 2017 Chevy Bolt EV Is Less of a Drag Than Originally Believed. 2017. url:
         http : / / www . hybridcars . com / 2017 - chevy - bolt - ev - is - less - of - a - drag - than -
         originally-believed/ [cited on page 102].

[114] Chevrolet Bolt Features - Dimensions. url: http : / / www . chevrolet . com / byo - vc /
         client / en / US / chevrolet / bolt - ev / 2017 / bolt - ev / features / trims / ?section =
         Highlights % 7B % 5C& % 7Dsection = Exterior % 7B % 5C& % 7Dsection = Dimensions % 7B %
         5C&%7DstyleOne=388584 [cited on page 102].

[115] Society of Automotive Engineers. SAE Standard J1666 "Hybrid Electric Vehicle Acceleration,
         Gradeability, and Deceleration Test Procedure". Tech. rep. Society of Automotive Engineers,
         2004, p. 25 [cited on page 102].

       275

       REFERENCES

[116] Chevrolet Bolt - Overview. url: http : / / www . chevrolet . com / bolt - ev - electric -
         vehicle-2 [cited on page 102].

[117] Mehrdad Ehsani, Yimin Gao and Ali Emadi. Modern Electric , Hybrid Electric , and Fuel Cell
        Vehicles. Fundamentals, Theory and Design. Second. Boca Raton: CRC Press. Taylor & Francis
        Group, 2010. isbn: 9781420053982 [cited on pages 102, 103].

[118] Murat Yilmaz and Philip T. Krein. `Review of charging power levels and infrastructure for
         plug-in electric and hybrid vehicles'. 2012 IEEE International Electric Vehicle Conference, IEVC
         2012 28.5 (2012), pp. 2151­2169. issn: 08858993. doi: 10.1109/IEVC.2012.6183208 [cited on
         page 103].

[119] Ratil H. Ashique, Zainal Salam, Mohd J. Bin Abdul Aziz and Abdul R. Bhatti. `Integrated
         photovoltaic-grid dc fast charging system for electric vehicle: A review of the architecture and
         control'. Renewable and Sustainable Energy Reviews 69.May 2016 (2017), pp. 1243­1257. issn:
         18790690. doi: 10.1016/j.rser.2016.11.245 [cited on page 103].

[120]  Srdjan Srdic, Chi Zhang, Xinyu Liang, Wensong Yu and Srdjan Lukic. `A SiC-based Power
       Converter Module for Medium- Voltage Fast Charger for Plug-in Electric Vehicles'. Proceedings
       of the 2016 IEEE Applied Power Electronics Conference and Exposition (APEC). Long Beach, CA,
       IEEE, 2016, pp. 2714­2719. isbn: 9781467395502. doi: 10.1109/APEC.2016.7468247 [cited
       on page 103].

[121] Chevrolet Bolt EV Specifications. url: http : / / media . chevrolet . com / media / us / en /
         chevrolet/vehicles/bolt-ev/2017.tab1.html [cited on page 103].

[122] Frank Markus. General Motors Details New Modular I-3, I-4 Engines. 2014. url: http : / /
         www.motortrend.com/news/gm-introduces-extra-small-block-ecotec-engine-
         family/ [cited on page 103].

[123] SAE Hybrid Committee. SAE Charging Configurations and Ratings Terminology. 2011. url:
         http://www.sae.org/smartgrid/chargingspeeds.pdf [cited on page 103].

[124] John D. Pryce. Numerical solution of Sturm-Liouville problems. Oxford: Clarendon Press, 1993,
         p. 322. isbn: 9780198534150 [cited on page 110].

[125] Marc Doyle, Thomas F. Fuller and John Newman. `Modeling of Galvanostatic Charge and
         Discharge of the Lithium/Polymer/Insertion Cell'. Journal of The Electrochemical Society 140.6
         (June 1993), p. 1526. issn: 00134651. doi: 10.1149/1.2221597 [cited on page 111].

[126]  James L. Lee, Andrew Chemistruck and Gregory L. Plett. `Discrete-time realization of
       transcendental impedance models, with application to modeling spherical solid diffusion'.
       Journal of Power Sources 206 (May 2012), pp. 367­377. issn: 0378-7753. doi: 10 . 1016 / J .
       JPOWSOUR.2012.01.134 [cited on page 111].

[127] . L. Ho and Rudolph E. Kalman. `Effective construction of linear state-variable models from
         input/output functions'. Automatisierungstechnik 14.1-12 (Jan. 1966), pp. 545­548. issn: 2196-
         677X. doi: 10.1524/auto.1966.14.112.545 [cited on page 111].

[128] Lennart Ljung. `System Identification'. Ed. by Alex Procházka, Jan Uhlí, P.W.J. Rayner and N.G.
         Kingsbury. Birkhäuser, Boston, MA, 1998. Chap. Signal Ide, pp. 163­173. isbn: 978-1-4612-1768-8.
         doi: 10.1007/978-1-4612-1768-8_11 [cited on page 111].

                                                                276

            REFERENCES

[129]  G. H. Golub. Matrix computations. Fourth edi. Baltimore: Johns Hopkins University Press,
       2013, p. 756. isbn: 9781421407944. url: http://imperialcollegelondon.worldcat.org/
       title/matrix-computations/oclc/824733531?referer=br%7B%5C&%7Dht=edition
       [cited on pages 114, 117].

[130]  E. Anderson, Z. Bai, C. Bischof, S Blackford, J. Demmel, J. Dongarra, J. Du Croz, A. Greenbaum,
       S. Hammarling, A. McKenney, D. Sorensen, L. S. Blackford, J. Demmel, J. Dongarra, J. Du Croz,
       A. Greenbaum, S. Hammarling, A. McKenney and D. Sorensen. {LAPACK} Users' Guide. 3rd
       editio. Philadelphia: Society for Industrial and Applied Mathematics, Jan. 1999, p. 407. isbn:
       0-89871-447-8 (paperback). doi: 10.1137/1.9780898719604 [cited on pages 114, 117].

[131] Ichitaro Yamazaki, Kesheng Wu and Horst Simon. nu-TRLan User Guide Version 1.0: A High-
         Performance Software Package for Large-Scale Harmitian Eigenvalue Problems. Tech. rep.
         Berkeley, CA: Lawrence Berkeley National Laboratory (LBNL), Oct. 2008. doi: 10 . 2172 /
         944532 [cited on page 117].

[132]  R. B. (Richard B. Lehoucq, D. C. (Danny C. Sorensen, C. (Chao) Yang and Society for Industrial
       and Applied Mathematics. ARPACK users' guide : solution of large-scale eigenvalue problems
       with implicitly restarted Arnoldi methods. Philadelphia: Society for Industrial and Applied
       Mathematics (SIAM, 3600 Market Street, Floor 6, Philadelphia, PA 19104), 1998, p. 142. isbn:
       9780898719628. doi: 10.1137/1.9780898719628 [cited on page 117].

[133] Rasmus M. Larsen. PROPACK-software for large and sparse SVD calculations. url: http://
         sun.stanford.edu/%7B~%7Drmunk/PROPACK/ [cited on page 117].

[134] Rasmus M. Larsen. `Lanczos Bidiagonalization With Partial Reorthogonalization'. DAIMI
         Report Series 27.537 (Dec. 1998), p. 101. issn: 2245-9316. doi: 10.7146/dpb.v27i537.7070
         [cited on page 117].

[135] Å. Björck. `Numerics of Gram-Schmidt orthogonalization'. Linear Algebra and its Applications
         197-198 (Jan. 1994), pp. 297­316. issn: 0024-3795. doi: 10.1016/0024-3795(94)90493-6
         [cited on page 118].

[136] James B. Elsner and Anastasios A. Tsonis. Singular Spectrum Analysis: A New Tool in Time
         Series Analysis. Boston, MA: Springer US, 1996, p. 164. isbn: 0306454726. doi: 10.1007/978-
         1-4757-2514-8 [cited on page 118].

[137] Anton Korobeynikov. `Computation- and space-efficient implementation of SSA'. Statistics
         and Its Interface 3.3 (2010), pp. 357­368. issn: 19387989. doi: 10.4310/SII.2010.v3.n3.a9
         [cited on page 118].

[138]  Nina E. Golyandina and Konstantin D. Usevitch. `2D-Extension of Singular Spectrum Analyis
       : Algorithm and elements of theory'. Matrix Methods: Theory, Algorithms and Applications. Ed.
       by Vadim Olshevsky and Eugene Tyrtyshnikov. WORLD SCIENTIFIC, Apr. 2014, pp. 449­473.
       isbn: 978-981-4469-55-5. doi: 10.1142/9789812836021_0029 [cited on page 118].

[139]  Nina E. Golyandina, Anton Korobeynikov, Alex Shlemov and Konstantin D. Usevich. `Mul-
       tivariate and 2D Extensions of Singular Spectrum Analysis with the Rssa Package'. Journal of
       Statistical Software 67.2 (Oct. 2015), pp. 1­78. issn: 1548-7660. doi: 10.18637/jss.v067.i02
       [cited on pages 118­120].

[140] COMSOL Inc. COMSOL Multiphysics. Burlington, MA, 2012. url: https://www.comsol.
         com/ [cited on page 124].

       277

            REFERENCES

[141] Shriram Santhanagopalan and Ralph E. White. `Online estimation of the state of charge of a
         lithium ion cell'. Journal of Power Sources 161.2 (Oct. 2006), pp. 1346­1355. issn: 03787753. doi:
         10.1016/j.jpowsour.2006.04.146 [cited on pages 128, 129].

[142] Shriram Santhanagopalan and Ralph E. White. `State of charge estimation for electrical vehicle
         batteries'. 2008 IEEE International Conference on Control Applications. IEEE, 2008, pp. 690­695.
         isbn: 978-1-4244-2222-7. doi: 10.1109/CCA.2008.4629656 [cited on page 128].

[143] Shriram Santhanagopalan, Qingzhi Guo and Ralph E. White. `Parameter Estimation and Model
         Discrimination for a Lithium-Ion Cell'. Journal of The Electrochemical Society 154.3 (Mar. 2007),
         A198. issn: 00134651. doi: 10.1149/1.2422896 [cited on page 128].

[144] Shriram Santhanagopalan, Qi Zhang, Karthikeyan Kumaresan and Ralph E. White. `Parameter
         Estimation and Life Modeling of Lithium-Ion Cells'. Journal of The Electrochemical Society
         155.4 (Apr. 2008), A345. issn: 00134651. doi: 10.1149/1.2839630 [cited on page 128].

[145] M. Safari, Mathieu Morcrette, A. Teyssot and Charles Delacourt. `Multimodal Physics-Based
         Aging Model for Life Prediction of Li-Ion Batteries'. Journal of The Electrochemical Society
         156.3 (Mar. 2009), A145. issn: 00134651. doi: 10.1149/1.3043429 [cited on page 128].

[146]  Nalin A. Chaturvedi, Reinhardt Klein, Jake Christensen, Jasim Ahmed and Aleksandar
       Kojic. `Algorithms for Advanced Battery-Management Systems: Modeling, estimation, and
       control challenges for lithium-ion batteries'. IEEE Control Systems 30.3 (2010), pp. 49­68. issn:
       1066033X. doi: 10.1109/MCS.2010.936293 [cited on page 128].

[147]  J. Li, Nima Lotfi, Robert G. Landers and Jonghyun Park. `A Single Particle Model for
       Lithium-Ion Batteries with Electrolyte and Stress-Enhanced Diffusion Physics'. Journal of
       The Electrochemical Society 164.4 (2017), A874­A883. issn: 0013-4651. doi: 10 . 1149 / 2 .
       1541704jes [cited on page 128].

[148]  J. Li, K. Adewuyi, Nima Lotfi, Robert G. Landers and Jonghyun Park. `A single particle model
       with chemical/mechanical degradation physics for lithium ion battery State of Health (SOH)
       estimation'. Applied Energy 212 (Feb. 2018), pp. 1178­1190. issn: 0306-2619. doi: 10.1016/J.
       APENERGY.2018.01.011 [cited on page 128].

[149]  Yuan Chaochun, Bingjian. Wang, Zhang Houzhong, Chen. Long and Li Huanhuan. `State-of-
       Charge Estimation of Lithium-ion Battery Based on a Novel Reduced Order Electrochemical
       Model'. International Journal of Electrochemical Science (Jan. 2018), pp. 1131­1146. issn: 14523981.
       doi: 10.20964/2018.01.133 [cited on page 128].

[150] Cheng Lin, Jilei Xing and Aihua Tang. `Lithium-ion Battery State of Charge/State of Health
         Estimation Using SMO for EVs'. Energy Procedia 105 (May 2017), pp. 4383­4388. issn: 1876-6102.
         doi: 10.1016/J.EGYPRO.2017.03.931 [cited on page 128].

[151] Ngoc T. Tran, Mahinda Vilathgamuwa, Yang Li, Troy Farrell, San S. Choi and Joseph Teague.
        `State of charge estimation of lithium ion batteries using an extended single particle model
         and sigma-point Kalman filter'. 2017 IEEE Southern Power Electronics Conference (SPEC). IEEE,
         Dec. 2017, pp. 1­6. isbn: 978-1-5090-6425-0. doi: 10.1109/SPEC.2017.8333564 [cited on
         page 128].

[152]  Scott J. Moura, Federico B. Argomedo, Reinhardt Klein, Anahita Mirtabatabaei and Miroslav
       Krstic. `Battery State Estimation for a Single Particle Model with Electrolyte Dynamics'. IEEE
       Transactions on Control Systems Technology 25.2 (Mar. 2017), pp. 453­468. issn: 10636536. doi:
       10.1109/TCST.2016.2571663 [cited on pages 128, 183].

       278

            REFERENCES

[153] Changfu Zou, Chris Manzie, Dragan Nesi and Abhijit G. Kallapur. `Multi-time-scale observer
         design for state-of-charge and state-of-health of a lithium-ion battery'. Journal of Power Sources
         335.October 2016 (Dec. 2016), pp. 121­130. issn: 03787753. doi: 10.1016/j.jpowsour.2016.
         10.040 [cited on pages 128, 181].

[154]  H. E. Perez, S. Dey, X. Hu and S. J. Moura. `Optimal Charging of Li-Ion Batteries via a Single
       Particle Model with Electrolyte and Thermal Dynamics'. Journal of The Electrochemical Society
       164.7 (June 2017), A1679­A1687. issn: 0013-4651. doi: 10 . 1149 / 2 . 1301707jes [cited on
       page 128].

[155] H. E. Perez, X. Hu and S. J. Moura. `Optimal charging of batteries via a single particle
         model with electrolyte and thermal dynamics'. Proceedings of the American Control Conference.
         Vol. 2016-July. 7. 2016, pp. 4000­4005. isbn: 9781467386821. doi: 10 . 1109 / ACC . 2016 .
         7525538 [cited on page 128].

[156]  Leonardo K. Maia, Zeynep Güven, Fabio La Mantia and Edwin Zondervan. `Model-based
       Optimization of Battery Energy Storage Systems'. Computer Aided Chemical Engineering 40
       (Jan. 2017), pp. 2563­2568. issn: 1570-7946. doi: 10.1016/B978-0-444-63965-3.50429-3
       [cited on page 129].

[157] Yang Li, D. Mahinda Vilathgamuwa, Troy W. Farrell, San Shing Choi and Ngoc T. Tran. `An
         equivalent circuit model of li-ion battery based on electrochemical principles used in grid-
         connected energy storage applications'. 2017 IEEE 3rd International Future Energy Electronics
         Conference and ECCE Asia (IFEEC 2017 - ECCE Asia). IEEE, June 2017, pp. 959­964. isbn: 978-1-
         5090-5157-1. doi: 10.1109/IFEEC.2017.7992170 [cited on page 129].

[158]  Junfu Li, Lixin Wang, Chao Lyu, Enhui Liu, Yinjiao Xing and Michael Pecht. `A parameter
       estimation method for a simplified electrochemical model for Li-ion batteries'. Electrochimica
       Acta (Apr. 2018). issn: 00134686. doi: 10 . 1016 / j . electacta . 2018 . 04 . 098 [cited on
       page 129].

[159]  Barzin Rajabloo, Ali Jokar, Martin Désilets and Marcel Lacroix. `An Inverse Method for Estim-
       ating the Electrochemical Parameters of Lithium-Ion Batteries'. Journal of The Electrochemical
       Society 164.2 (Dec. 2017), A99­A105. issn: 0013-4651. doi: 10.1149/2.0221702jes [cited on
       page 129].

[160]  Adrien M. Bizeray, Jin-Ho Kim, Stephen R. Duncan and David A. Howey. `Identifiability and
       parameter estimation of the single particle lithium-ion battery model'. IEEE Transactions on
       Control Systems Technology PP (Feb. 2017), pp. 1­16. doi: 10.1109/TCST.2018.2838097
       [cited on page 129].

[161] Emil Namor, Dimitri Torregrossa, Rachid Cherkaoui and Mario Paolone. `Parameter identifica-
         tion of a lithium-ion cell single-particle model through non-invasive testing'. Journal of Energy
         Storage 12 (Aug. 2017), pp. 138­148. issn: 2352-152X. doi: 10.1016/J.EST.2017.04.008
         [cited on page 129].

[162] Donald J. Docimo and Hosam K. Fathy. `Analysis and Control of Charge and Temperature Im-
         balance Within a Lithium-Ion Battery Pack'. IEEE Transactions on Control Systems Technology
         (2018), pp. 1­14 [cited on page 129].

[163] Pedro Ascencio, Alessandro Astolfi and Thomas Parisini. `Backstepping PDE-based adaptive
         observer for a Single Particle Model of Lithium-Ion Batteries'. 55th Conference on Decision and
         Control Cdc (2016), pp. 5623­5628. doi: 10.1109/CDC.2016.7799133 [cited on page 129].

       279

            REFERENCES

[164] Alexander P. Bartlett. Electrochemical Model-Based State of Charge and State of Health
         Estimation of Lithium-Ion Batteries. 2015. url: http://rave.ohiolink.edu/etdc/view?
         acc%7B%5C_%7Dnum=osu1432640190 [cited on page 129].

[165]  Domenico Di Domenico, Anna Stefanopoulou and Giovanni Fiengo. `Lithium-Ion Battery
       State of Charge and Critical Surface Charge Estimation Using an Electrochemical Model-
       Based Extended Kalman Filter'. Journal of Dynamic Systems, Measurement, and Control 132.6
       (2010), p. 061302. issn: 00220434. doi: 10.1115/1.4002475 [cited on pages 129, 134, 141, 176,
       262].

[166] John S. Newman and Charles W. Tobias. `Theoretical Analysis of Current Distribution in
         Porous Electrodes'. Journal of The Electrochemical Society 109.12 (Dec. 1962), p. 1183. issn:
         00134651. doi: 10.1149/1.2425269 [cited on page 131].

[167] Qi Zhang and Ralph E. White. `Comparison of approximate solution methods for the solid
         phase diffusion equation in a porous electrode model'. Journal of Power Sources 165.2 (Mar.
         2007), pp. 880­886. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2006.12.056 [cited on
         page 135].

[168] Chao-Yang Wang, W. B. Gu and B. Y. Liaw. `Micro-Macroscopic Coupled Modeling of Batteries
         and Fuel Cells'. Journal of The Electrochemical Society 145.10 (Oct. 1998), p. 3407. issn: 00134651.
         doi: 10.1149/1.1838820 [cited on page 135].

[169]  Chao-Yang Wang and Venkat Srinivasan. `Computational battery dynamics (CBD)--electro-
       chemical/thermal coupled modeling and multi-scale modeling'. Journal of Power Sources 110.2
       (Aug. 2002), pp. 364­376. issn: 0378-7753. doi: 10.1016/S0378-7753(02)00199-4 [cited
       on page 135].

[170] Venkat R. Subramanian, James A. Ritter and Ralph E. White. `Approximate Solutions for
         Galvanostatic Discharge of Spherical Particles I. Constant Diffusion Coefficient'. Journal of
         The Electrochemical Society 148.11 (Nov. 2001), E444. issn: 00134651. doi: 10.1149/1.1409397
         [cited on pages 135, 177].

[171] Christophe R. Birkl, E. McTurk, M. R. Roberts, Peter G. Bruce and David A. Howey. `A Para-
        metric Open Circuit Voltage Model for Lithium Ion Batteries'. Journal of The Electrochemical
        Society 162.12 (Sept. 2015), A2271­A2280. issn: 0013-4651. doi: 10 . 1149 / 2 . 0331512jes
        [cited on page 138].

[172] Gregory L. Plett. `High-Performance Battery-Pack Power Estimation Using a Dynamic Cell
         Model'. IEEE Transactions on Vehicular Technology 53.5 (Sept. 2004), pp. 1586­1593. issn: 0018-
         9545. doi: 10.1109/TVT.2004.832408 [cited on page 143].

[173] Gregory L. Plett. `Extended Kalman filtering for battery management systems of LiPB-based
         HEV battery packs: Part 1. Background'. Journal of Power Sources 134.2 (Aug. 2004), pp. 262­276.
         issn: 0378-7753. doi: 10.1016/j.jpowsour.2004.02.032 [cited on page 143].

[174]  Gregory L. Plett. `Extended Kalman filtering for battery management systems of LiPB-based
       HEV battery packs: Part 2. Modeling and identification'. Journal of Power Sources 134.2 (Aug.
       2004), pp. 262­276. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2004.02.032 [cited on
       page 143].

[175] Cleve Moler and Charles Van Loan. `Nineteen Dubious Ways to Compute the Exponential of
         a Matrix, Twenty-Five Years Later'. SIAM Review 45.1 (Jan. 2003), pp. 3­49. issn: 0036-1445.
         doi: 10.1137/S00361445024180 [cited on page 144].

       280

       REFERENCES

[176] Steve C. Southward. ME5506 Advanced Control Engineering: Lecture Notes 03, Spring 2011.
         Blacksburg, VA [cited on pages 148, 296].

[177] Gregory L. Plett. Lecture Notes 02: ECE 4540/5540- Digital Control Systems. Colorado Springs,
         2017. url: http : / / mocha - java . uccs . edu / ECE5540 / ECE5540 - CH02 . pdf [cited on
         pages 149, 296].

[178] Uri M. Ascher and Linda R. Petzold. Computer Methods for Ordinary Differential Equations and
         Differential-Algebraic Equations. Philadelphia: Society for Industrial and Applied Mathematics,
         1997, p. 332. isbn: 0898714125 [cited on page 152].

[179] Lars O. Valoe n and Jan N. Reimers. `Transport Properties of LiPF[sub 6]-Based Li-Ion Battery
         Electrolytes'. Journal of The Electrochemical Society 152.5 (May 2005), A882. issn: 00134651.
         doi: 10.1149/1.1872737 [cited on pages 155, 156, 161].

[180]  Alexander P. Schmidt, Matthias Bitzer, Árpád W. Imre and Lino Guzzella. `Experiment-driven
       electrochemical modeling and systematic parameterization for a lithium-ion battery cell'.
       Journal of Power Sources 195.15 (2010), pp. 5071­5080. issn: 03787753. doi: 10 . 1016 / j .
       jpowsour.2010.02.029 [cited on page 175].

[181] Meng Guo, Godfrey Sikha and Ralph E. White. `Single-Particle Model for a Lithium-Ion Cell:
        Thermal Behavior'. Journal of The Electrochemical Society 158.2 (Feb. 2011), A122. issn: 00134651.
         doi: 10.1149/1.3521314 [cited on page 176].

[182]  Anupama Guduru, Paul W. Northrop, Shruti Jain, Andrew C. Crothers, T. R. Marchant and
       Venkat R. Subramanian. `Analytical solution for electrolyte concentration distribution in
       lithium-ion batteries'. Journal of Applied Electrochemistry 42.4 (Apr. 2012), pp. 189­199. issn:
       0021-891X. doi: 10.1007/s10800-012-0394-4 [cited on page 177].

[183]  Eric Prada, Domenico Di Domenico, Y. Creff, J. Bernard, V. Sauvant-Moynot and F. Huet.
       `Simplified Electrochemical and Thermal Model of LiFePO4-Graphite Li-Ion Batteries for Fast
       Charge Applications'. Journal of the Electrochemical Society 159.9 (Aug. 2012), A1508­A1519.
       issn: 0013-4651. doi: 10.1149/2.064209jes [cited on pages 179, 199, 242, 243].

[184]  Saeed K. Rahimian, Sean Rayman and Ralph E. White. `Extension of physics-based single
       particle model for higher charge­discharge rates'. Journal of Power Sources 224 (Feb. 2013),
       pp. 180­194. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2012.09.084 [cited on pages 179,
       182].

[185] Paulo Kemper and Dongsuk Kum. `Extended Single Particle Model of Li-Ion Batteries Towards
         High Current Applications'. 2013 IEEE Vehicle Power and Propulsion Conference (VPPC) (2013),
         pp. 1­6. doi: 10.1109/VPPC.2013.6671682 [cited on page 180].

[186]  Weilin Luo, Chao Lyu, Lixin Wang and Liqiang Zhang. `An approximate solution for elec-
       trolyte concentration distribution in physics-based lithium-ion cell models'. Microelectronics
       Reliability 53.6 (2013), pp. 797­804. issn: 00262714. doi: 10.1016/j.microrel.2012.11.002
       [cited on pages 180, 181].

[187] Weilin Luo, Chao Lyu, Lixin Wang and Liqiang Zhang. `A new extension of physics-based
         single particle model for higher charge­discharge rates'. Journal of Power Sources 241 (Nov.
         2013), pp. 295­310. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2013.04.129 [cited on
         page 181].

                                                                281

                                                                              REFERENCES

[188]  Xuebing Han, Minggao Ouyang, Languang Lu and Jianqiu Li. `Simplification of physics-based
       electrochemical model for lithium ion battery on electric vehicle. Part II: Pseudo-two-
       dimensional model simplification and state of charge estimation'. Journal of Power Sources 278
       (Mar. 2015), pp. 814­825. issn: 0378-7753. doi: 10.1016/J.JPOWSOUR.2014.08.089 [cited
       on page 182].

[189]  Tanvir R. Tanim, Christopher D. Rahn and Chao-Yang Wang. `A Temperature Dependent,
       Single Particle, Lithium Ion Cell Model Including Electrolyte Diffusion'. Journal of Dynamic
       Systems, Measurement, and Control 137.1 (2014), p. 011005. issn: 0022-0434. doi: 10.1115/1.
       4028154 [cited on page 182].

[190]  Robert D. Middlebrook. `Low-entropy expressions: the key to design-oriented analysis'.
       Proceedings Frontiers in Education Twenty-First Annual Conference. Engineering Education
       in a New World Order. West Lafayette: IEEE, 1991, pp. 399­403. isbn: 0-7803-0222-2. doi:
       10.1109/FIE.1991.187513 [cited on page 182].

[191] Robert D. Middlebrook, Vatche Vorperian and John Lindal. `The N Extra Element Theorem'.
         IEEE Transactions on Circuits and Systems I: Fundamental Theory and Applications 45.9 (1998),
         pp. 919­935. issn: 10577122. doi: 10.1109/81.721258 [cited on page 182].

[192] Vatché Vorpérian. Fast analytical techniques for electrical and electronic circuits. Cambridge
         University Press, 2002, p. 476. isbn: 0521624428 [cited on page 182].

[193]  Tanvir R. Tanim, Christopher D. Rahn and Chao-Yang Wang. `A reduced order electrolyte
       enhanced single particle lithium ion cell model for hybrid vehicle applications'. Proceedings
       of the American Control Conference. 2. 2014, pp. 141­146. doi: 10.1109/ACC.2014.6858617
       [cited on pages 182, 183].

[194]  Nima Lotfi, J. Li, Robert G. Landers and Jonghyun Park. `Li-ion Battery State of Health
       Estimation based on an improved Single Particle model'. 2017 American Control Conference
       (ACC). IEEE, May 2017, pp. 86­91. isbn: 978-1-5090-5992-8. doi: 10 . 23919 / ACC . 2017 .
       7962935 [cited on page 183].

[195] Linda R. Petzold. DASSL code. Livermore, CA, 1989 [cited on page 189].

[196]  P. E. Van Keken, D. A. Yuen and L. R. Petzold. `DASPK: A new high order and adaptive time-
       integration technique with applications to mantle convection with strongly temperature-and
       pressure-dependent rheology'. Geophysical & Astrophysical Fluid Dynamics 80.1-2 (Sept. 1995),
       pp. 57­74. issn: 0309-1929. doi: 10.1080/03091929508229763 [cited on page 189].

[197] Dominic P. Searson. `GPTIPS 2: An Open-Source Software Platform for Symbolic Data Mining'.
         Handbook of Genetic Programming Applications. Cham: Springer International Publishing, 2015,
         pp. 551­573. doi: 10.1007/978-3-319-20883-1_22 [cited on page 196].

[198] Max Neumann-Coto and Macarena C. R. Arenas. `Measuring complexity of curves on surfaces'
         (Dec. 2017). url: http://arxiv.org/abs/1712.06671 [cited on page 196].

[199] Lennart. Ljung. System identification : theory for the user. 2nd ed. Upper Saddle River N.J.
         ;;London: Prentice Hall PTR, 1999, p. 609. isbn: 9780136566953 [cited on pages 202, 207, 226].

[200] Kumpati S. Narendra and Anuradha M. Annaswamy. `Persistent Excitation in Dynamical
         Systems'. 1984 American Control Conference. IEEE, July 1984, pp. 336­338. doi: 10.23919/
         ACC.1984.4788399 [cited on page 207].

                                                                282

       REFERENCES

[201] Kumpati S. Narendra and Anuradha M. Annaswamy. `Persistent excitation in adaptive systems'.
         International Journal of Control 45.1 (Jan. 1987), pp. 127­160. issn: 0020-7179. doi: 10.1080/
         00207178708933715 [cited on page 207].

[202] The Mathworks Inc. System Identification Overview - MATLAB & Simulink - MathWorks
         United Kingdom. url: https://uk.mathworks.com/help/ident/gs/about-system-
         identification.html%7B%5C#%7Dbsguh6g-1 (visited on 13/07/2018) [cited on page 207].

[203] Gregory L. Plett. Lecture Notes 02: ECE5560-System Identification. Colorado Springs, 2015. url:
         http://mocha-java.uccs.edu/ECE5560/ECE5560-Notes02.pdf [cited on pages 212,
         216, 219].

[204] Gregory L. Plett. Lecture Notes 03: ECE5560 - System Identification. Colorado Springs, 2015. url:
         http://mocha-java.uccs.edu/ECE5560/ECE5560-Notes03.pdf [cited on page 219].

[205] Gregory L. Plett. Lecture Notes 04: ECE5560 - System Identification. Colorado Springs, 2015. url:
         http://mocha-java.uccs.edu/ECE5560/ECE5560-Notes04.pdf [cited on page 219].

[206] L. E. Scales. Introduction to non-linear optimization. Springer-Verlag, 1985, p. 243. isbn:
         0387912525. url: https://dl.acm.org/citation.cfm?id=2973 [cited on page 227].

[207] The Mathworks Inc. System Identification Toolbox. Natick, 2017 [cited on page 228].

[208] John Christensen, Venkat Srinivasan and John Newman. `Optimization of Lithium Titanate
         Electrodes for High-Power Cells'. Journal of The Electrochemical Society 153.3 (Mar. 2006),
         A560. issn: 00134651. doi: 10.1149/1.2172535 [cited on page 258].

[209]  Andrea Pozzi, Gabriele Ciaramella, Krishnakumar Gopalakrishnan, Stefan Volkwein and
       Davide M. Raimondo. `Optimal Design of Experiment for Parameter Estimation of a Single
       Particle Model for Lithium-Ion Batteries'. 57th IEEE Conference on Decision and Control (CDC).
       Ed. by Amir G. Aghdam. Miami Beach, FL: IEEE, 2018, WeB22.2. url: https://cdc2018.
       ieeecss.org/ [cited on page 265].

                                                                283

        A

                  Full Listing of Program Codes

              A.1 MATLAB codes for continuous-time SPM . . . . . . . . . . . . . . . . . . . . . 285
              A.2 MATLAB codes for discrete-time SPM . . . . . . . . . . . . . . . . . . . . . . . 288

                                                                284

                                                 A.1 MATLAB codes for continuous-time SPM

    Listing A.1 MATLAB code for simulation of continuous time SPM

1 % Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu>

2 % Author: Gopalakrishnan, Krishnakumar <krishnak@vt.edu>

3

4 clear;clc; format short g; format compact; close all;

5

6 %% User-entered data

7 % case-sensitive string descriptive of cell to be simulated.

8 cellIdentifier = 'Northrop';

9

10 % string describing starting soc% and csv filename of load profile (time vs current through

      external circuit)

11 load_profile_name = 'cnst_dischg'; % a) 'cnst_dischg' b) 'cnst_chg' c) 'udds' etc

12

13 % Input CSV-profile setup. Note: Offsets use a 0-base numbering system

14 soc_col              = 1; % The starting SOC is in this column of top row

15 profile_row_offset = 2; % Load profile input data begins only from this row

16

17 Ts       = 0.5; % sec (how often are results needed?)

18 tf_user = 1.5; % sec (user-entered desired simulation end-time)

19 % Simulation might prematurely end if voltage/soc cutoffs are hit

20

21 termination_choice = 'max'; % valid choices are 'max' and 'min'

22 % The 'min' choice is helpful for trials. Whilst retaining the characteristics

23 % of the load profile, the user may do a short time trial simulation.

24

25 %% Pre-Process user data

26 profile_filename = [load_profile_name,'.csv'];

27

28 % Note: a positive C-rate implies discharge and vice-versa for charge

29 try

30       C_rate_profile = csvread(profile_filename,profile_row_offset,0);

31 catch

32       error('Invalid load profile specified. Quitting simulation ...');

33 end

34

35 % Compute expected end-time for allocation of storage & maximum loop indices

36 if strcmp(termination_choice,'max')

37       t_finish = max(tf_user,C_rate_profile(end,1)); % longer of the two prevails

38       % If the last time-entry in the input csv file is shorter than user-entered

39       % value, then the last C-rate from the csv file is held for rest of the

40       % simulation.

41 elseif strcmp(termination_choice,'min')

42       t_finish = min(tf_user,C_rate_profile(end,1)); % longer of the two prevails

43 else

44       error("Invalid termination choice. Valid strings are: 'max' or 'min'.");

45 end

46

47 % Starting SoC percentage

48 soc_init_pct = csvread(profile_filename,0,soc_col,[0 soc_col 0 soc_col]);

49

50 % struct of cell parameters

51 spm_params = parameters_spm_basic(soc_init_pct,cellIdentifier);

52

53 I_1C = spm_params.I_1C;

54 clear tf_user profile_row_offset soc_col profile_filename termination_choice;

55

56 %% Define the State-eqn and Output equation for simulation

57 stateEqn = @spm_cts_stateEqn_three_states;

58 outputEqn = @spm_three_states_battery_voltage;

59

60 %% Allocate storage for simulated quantities

61 num_iterations = ceil(t_finish/Ts) + 1; % max no. of steps (assuming no cutoff)

                                                                285

                                                 A.1 MATLAB codes for continuous-time SPM

62

63 spm_sim_time_vector         = nan(num_iterations,1);

64 load_current_vector         = nan(num_iterations,1);

65 v_cell_sim_results_spm      = nan(num_iterations,1);

66 soc_pct_results_spm         = nan(num_iterations,1);

67 cs_avg_neg_sim_results_spm = nan(num_iterations,1);

68 q_pos_sim_results_spm       = nan(num_iterations,1);

69 q_neg_sim_results_spm       = nan(num_iterations,1);

70

71 %% Initialise SPM state vector and all other simulated quantities

72 spm_sim_time_vector(1)       = 0;

73 soc_pct_results_spm(1)       = soc_init_pct;

74 cs_avg_neg_sim_results_spm(1) = spm_params.cs_n_init;

75 q_pos_sim_results_spm(1)     = 0;

76 q_neg_sim_results_spm(1)     = 0;

77

78 % load current applied at t = t0

79 load_current_vector(1) = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim_time_vecto

     r(1),'previous','extrap');

80

81 x_spm_init = [q_pos_sim_results_spm(1); ...

82                q_neg_sim_results_spm(1); ...

83                cs_avg_neg_sim_results_spm(1)];

84

85 v_cell_sim_results_spm(1) = outputEqn(x_spm_init,load_current_vector(1),spm_params);

86

87 t_local_start        = 0;

88 t_local_finish       = Ts;

89 x_spm_local_finish = x_spm_init;

90

91 clear x_init t_finish q_pos_init q_neg_init;

92

93 %% Simulate the SPM

94 progressbarText(0);

95

96 for k = 2:num_iterations % Need solution at k-th time-step

97   load_current_vector(k)          = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim

      _time_vector(1),'previous','extrap'); % load current that was held constant from (k-1)

      to (k)

98   t_span                          = [t_local_start t_local_finish];

99   [~,x_spm_local_finish_matrix] = ode45(@(t,x_spm_local_finish)

      stateEqn(x_spm_local_finish,load_current_vector(k),spm_params), t_span,

      x_spm_local_finish);

100  x_spm_local_finish              = x_spm_local_finish_matrix(end,:)';

101

102  q_pos_sim_results_spm(k)        = x_spm_local_finish(1);

103  q_neg_sim_results_spm(k)        = x_spm_local_finish(2);

104  cs_avg_neg_sim_results_spm(k) = x_spm_local_finish(3);

105

106  soc_pct_results_spm(k)          = 100*((cs_avg_neg_sim_results_spm(k)/spm_params.cs_max_n) -

      spm_params.theta_min_neg)/(spm_params.theta_max_neg - spm_params.theta_min_neg);

107  v_cell_sim_results_spm(k)       =

      outputEqn(x_spm_local_finish,load_current_vector(k),spm_params);

108

109  overall_exit_status =

      check_termination(soc_pct_results_spm(k),v_cell_sim_results_spm(k),spm_params);

110  if overall_exit_status ~= 0 % check for violation of cut-off conditions

111       k = k - 1; % Values in the last simulated index are incorrect.

112       fprintf('Exiting simulation ...\n');

113       break;

114  end

115

116  spm_sim_time_vector(k) = t_local_finish;

117  t_local_start             = t_local_finish;

                                                                286

                                                 A.1 MATLAB codes for continuous-time SPM

118      t_local_finish         = t_local_start + Ts;

119      progressbarText((k-1)/num_iterations);

120 end

121 fprintf('\n');

122

123 spm_sim_time_vector         = spm_sim_time_vector(1:k);

124 load_current_vector         = load_current_vector(1:k);

125 q_pos_sim_results_spm       = q_pos_sim_results_spm(1:k);

126 q_neg_sim_results_spm       = q_neg_sim_results_spm(1:k);

127 cs_avg_neg_sim_results_spm = cs_avg_neg_sim_results_spm(1:k);

128 soc_pct_results_spm         = soc_pct_results_spm(1:k);

129 v_cell_sim_results_spm      = v_cell_sim_results_spm(1:k);

130

131 %% Save results to disk

132 if exist('spm_results','dir')==0

133      mkdir('spm_results');

134 end

135

136 % Replace decimal point chars in soc% string with 'p' (stands for point)

137 soc_init_pct_savestr = strrep(num2str(soc_init_pct),'.','p');

138

139 % clear A_disc B_disc; % potentially useful varibles. comment out for debugging

140 clear soc_init_pct C_rate_profile I_1C k num_iterations; % redundant info

141 clear x_spm_init x_spm_local_finish t_local_finish t_local_start;

142 save(['spm_results/cts_sim_', cellIdentifier, '_', load_profile_name, ...

143       '_initial_soc_', soc_init_pct_savestr, 'pct', ...

144       datestr(now, '_mmm_dd_yyyy_HH_MM_SS')]); % save workspace to file

145

146 %% Plot results

147 close all;

148 figure(1);

149 h1 = subplot(211);

150 plot(spm_sim_time_vector,load_current_vector,'-');
151 ylabel('Current');

152 ylim([min(load_current_vector)-5 max(load_current_vector)+5]);

153

154 h2 = subplot(212);

155 plot(spm_sim_time_vector,v_cell_sim_results_spm,'m');

156 ylim([spm_params.CutoffVoltage spm_params.CutoverVoltage]);

157 ylabel('Cell Voltage [V]');

158

159 linkaxes([h1 h2],'x');

160 xlim([spm_sim_time_vector(1) spm_sim_time_vector(end)]);

161 xlabel('Time [sec]');

162

163

164 figure(2);

165 h1 = subplot(211);

166 plot(spm_sim_time_vector,load_current_vector,'-');
167 ylabel('Current');

168 ylim([min(load_current_vector)-5 max(load_current_vector)+5]);

169

170 h2 = subplot(212);

171 plot(spm_sim_time_vector,soc_pct_results_spm,'r');
172 ylabel('SOC [%]');

173

174 linkaxes([h1 h2],'x');

175 xlim([spm_sim_time_vector(1) spm_sim_time_vector(end)]);

176 xlabel('Time [sec]');

177

178 clear h1 h2;

179 figure(1);

180 shg;

                                                                287

                                                   A.2 MATLAB codes for discrete-time SPM

    Listing A.2 MATLAB code for simulation of discrete time SPM

1 % Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu>

2 % Author: Gopalakrishnan, Krishnakumar <krishnak@vt.edu>

3

4 clear;clc; format short g; format compact; close all;

5

6 %% User-entered data

7 % case-sensitive string descriptive of cell to be simulated.

8 cellIdentifier = 'Northrop';

9

10 % string describing starting soc% and csv filename of load profile

11 % (time vs current through external circuit)

12 % a) 'cnst_dischg_soc_100_1C' b) 'cnst_chg_soc_100_1C' c) 'udds_soc_50' etc.

13 load_profile_name = 'cnst_dischg_soc_100_2C';

14

15 % Input CSV-profile setup. Note: Offsets use a 0-base numbering system

16 soc_col              = 1; % The starting SOC is in this column of top row

17 profile_row_offset = 2; % Load profile input data begins only from this row

18

19 Ts       = 1; % sec (how often are results needed?)

20 tf_user = 100; % sec (user-entered desired simulation end-time)

21 % Simulation might prematurely end if voltage/soc cutoffs are hit

22

23 termination_choice = 'max'; % valid choices are 'max' and 'min'

24 % The 'min' choice is helpful for trials. Whilst retaining the characteristics

25 % of the load profile, the user may do a short time trial simulation.

26

27 %% Pre-Process user data

28 profile_filename = [load_profile_name,'.csv'];

29

30 % Note: a positive C-rate implies discharge and vice-versa for charge

31 try

32       C_rate_profile = csvread(profile_filename,profile_row_offset,0);

33 catch

34       error('a) Error in specified file, OR b)the load profile is not in PATH. Quitting

          simulation ...');

35 end

36

37 % Compute expected end-time for allocation of storage & maximum loop indices

38 if strcmp(termination_choice,'max')

39       t_finish = max(tf_user,C_rate_profile(end,1)); % longer of the two prevails

40       % If the last time-entry in the input csv file is shorter than user-entered

41       % value, then the last C-rate from the csv file is held for rest of the

42       % simulation.

43 elseif strcmp(termination_choice,'min')

44       t_finish = min(tf_user,C_rate_profile(end,1)); % longer of the two prevails

45 else

46       error("Invalid termination choice. Valid strings are: 'max' or 'min'.");

47 end

48

49 % Starting SoC percentage

50 soc_init_pct = csvread(profile_filename,0,soc_col,[0 soc_col 0 soc_col]);

51

52 % struct of cell parameters

53 spm_params = parameters_spm_basic(soc_init_pct,cellIdentifier);

54

55 I_1C = spm_params.I_1C;

56 clear tf_user profile_row_offset soc_col profile_filename termination_choice;

57

58 %% Pre-Compute the System and Input Matrices

59 clc;

60

61 F = param.F;

                                                                288

                                                    A.2 MATLAB codes for discrete-time SPM

62 A = param.A;

63

64 R_pos = param.R_p;

65 R_neg = param.R_n;

66

67 Ds_pos = param.D_p;

68 Ds_neg = param.D_n;

69

70 a_pos = param.a_p;

71 a_neg = param.a_n;

72

73 L_pos = param.len_p;

74 L_neg = param.len_n;

75

76 %% System & Input matrices for continuous and discrete-time implementations

77

78 A_cts = [-30*Ds_pos/(R_pos^2),                   0, 0; ...

79   0, -30*Ds_neg/(R_neg^2), 0; ...

80   0,                       0, 0];

81

82 A_disc = expm(A_cts*Ts);

83

84 B_cts = [ (45/2)/(R_pos^2*a_pos*L_pos*F*A); ...

85   (-45/2)/(R_neg^2*a_neg*L_neg*F*A); ...

86   (-3/(R_neg*a_neg*L_neg*F*A))];

87

88 B_disc = nan(size(B_cts));

89 B_disc(1) = B_cts(1)*(exp(A_cts(1,1)*Ts)-1)/A_cts(1,1);

90 B_disc(2) = B_cts(2)*(exp(A_cts(2,2)*Ts)-1)/A_cts(2,2);

91 B_disc(3) = B_cts(3)*Ts;

92

93 % Through built-in 'c2d' command by the dummy system-method (tricking MATLAB

94 % to believe we have an LTI system). The output matrix,C is chosen so that the

95 % states-themselves are the outputs with no feed-through term involved.

96

97 C_dummy = [1, 1, 1]; D_dummy = 0;

98 sys_cts = ss(A_cts,B_cts,C_dummy,D_dummy);

99 sys_disc = c2d(sys_cts,Ts);

100

101 outputEqn = @spm_three_states_battery_voltage;

102

103 %% Allocate storage for simulated quantities

104 num_iterations = ceil(t_finish/Ts) + 1; % max no. of steps (assuming no cutoff)

105

106 spm_sim_time_vector         = nan(num_iterations,1);

107 load_current_vector         = nan(num_iterations,1);

108 v_cell_sim_results_spm      = nan(num_iterations,1);

109 soc_pct_results_spm         = nan(num_iterations,1);

110 cs_avg_neg_sim_results_spm = nan(num_iterations,1);

111 q_pos_sim_results_spm       = nan(num_iterations,1);

112 q_neg_sim_results_spm       = nan(num_iterations,1);

113

114 %% Initialise SPM state vector and all other simulated quantities

115 spm_sim_time_vector(1)      = 0;

116 soc_pct_results_spm(1)      = soc_init_pct;

117 cs_avg_neg_sim_results_spm(1) = spm_params.cs_n_init;

118 q_pos_sim_results_spm(1)       = 0;

119 q_neg_sim_results_spm(1)       = 0;

120

121 % load current applied at t = t0

122 load_current_vector(1) = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim_time_vecto

      r(1),'previous','extrap');

123

124 x_spm_init = [q_pos_sim_results_spm(1); ...

                                                                289

                                                        A.2 MATLAB codes for discrete-time SPM

125      q_neg_sim_results_spm(1); ...

126      cs_avg_neg_sim_results_spm(1)];

127

128 v_cell_sim_results_spm(1) = outputEqn(x_spm_init,load_current_vector(1),spm_params);

129

130 t_local_finish       = Ts;

131 x_spm_local_finish = x_spm_init;

132

133 clear x_init q_pos_init q_neg_init;

134

135 %% Simulate the SPM

136 progressbarText(0);

137

138 for k = 2:num_iterations % Need solution at k-th time-step

139      load_current_vector(k)         = I_1C*interp1(C_rate_profile(:,1),C_rate_profile(:,2),spm_sim

          _time_vector(k-1),'previous','extrap'); % load current that was held constant from (k-1)

          to (k)

140      x_spm_local_finish             = A_disc*x_spm_local_finish + B_disc*load_current_vector(k);

141

142      q_pos_sim_results_spm(k)       = x_spm_local_finish(1);

143      q_neg_sim_results_spm(k)       = x_spm_local_finish(2);

144      cs_avg_neg_sim_results_spm(k) = x_spm_local_finish(3);

145

146      soc_pct_results_spm(k)         = 100*((cs_avg_neg_sim_results_spm(k)/spm_params.cs_max_n) -

          spm_params.theta_min_neg)/(spm_params.theta_max_neg - spm_params.theta_min_neg);

147      v_cell_sim_results_spm(k)      =

          outputEqn(x_spm_local_finish,load_current_vector(k),spm_params);

148

149      overall_exit_status =

          check_termination(soc_pct_results_spm(k),v_cell_sim_results_spm(k),spm_params);

150      if overall_exit_status ~= 0 % check for violation of cut-off conditions

151           k = k - 1; % Values in the last simulated index are incorrect.

152           fprintf('Exiting simulation ...\n');

153           break;

154      end

155

156      spm_sim_time_vector(k) = t_local_finish;

157      t_local_start           = t_local_finish;

158      t_local_finish          = t_local_start + Ts;

159      progressbarText((k-1)/num_iterations);

160 end

161 fprintf('\n');

162

163 spm_sim_time_vector           = spm_sim_time_vector(1:k);

164 load_current_vector           = load_current_vector(1:k);

165 q_pos_sim_results_spm         = q_pos_sim_results_spm(1:k);

166 q_neg_sim_results_spm         = q_neg_sim_results_spm(1:k);

167 cs_avg_neg_sim_results_spm = cs_avg_neg_sim_results_spm(1:k);

168 soc_pct_results_spm           = soc_pct_results_spm(1:k);

169 v_cell_sim_results_spm        = v_cell_sim_results_spm(1:k);

170

171 %% Save results to disk

172 save_foldername = ['spm_results/', cellIdentifier, '/', load_profile_name];
173 if exist(save_foldername,'dir')==0

174      mkdir(save_foldername);

175 end

176

177 % Replace decimal point chars in soc% string with 'p' (stands for point)

178 soc_init_pct_savestr = strrep(num2str(soc_init_pct),'.','p');

179

180 clear soc_init_pct C_rate_profile I_1C k num_iterations; % redundant info

181 clear x_spm_init x_spm_local_finish t_local_finish t_local_start;

182 save([save_foldername, '/disc_sim_', ...

183      datestr(now, 'mmm_dd_yyyy_HH_MM_SS')]); % save workspace to file

                                                                290

                                                 A.2 MATLAB codes for discrete-time SPM

184

185 function v_cell = spm_three_states_battery_voltage(x,u,param)

186  % returns v_cell given the vector x and input u at any given time-step

187  % x(1) = q_pos, x(2) = q_neg, x(3) = cs_avg_neg

188  % u = load current (A). Positive implies discharge.

189

190  % Copyright (c) 2018 Gopalakrishnan, Krishnakumar <krishnak@vt.edu>

191  % Author: Gopalakrishnan, Krishnakumar <krishnak@vt.edu>

192

193  R   = param.R;

194  T   = param.Tref;

195  F   = param.F;

196

197  R_pos = param.R_p;

198  R_neg = param.R_n;

199

200  Ds_pos = param.D_p;

201  Ds_neg = param.D_n;

202

203  a_pos = param.a_p;

204  a_neg = param.a_n;

205

206  L_pos = param.len_p;

207  L_neg = param.len_n;

208

209  k_p = param.k_p;

210  k_n = param.k_n;

211

212  ce  = param.ce_init;

213  A   = param.A;

214

215  cs_max_n = param.cs_max_n;

216  cs_max_p = param.cs_max_p;

217

218  theta_min_neg = param.theta_min_neg;

219  theta_min_pos = param.theta_min_pos;

220  theta_max_neg = param.theta_max_neg;

221  theta_max_pos = param.theta_max_pos;

222

223  % Extract permissible bounds for solid concentrations

224  cs_surf_pos_lb = param.theta_max_pos*param.cs_max_p;

225  cs_surf_pos_ub = param.theta_min_pos*param.cs_max_p;

226  cs_surf_neg_lb = param.theta_min_neg*param.cs_max_n;

227  cs_surf_neg_ub = param.theta_max_neg*param.cs_max_n;

228

229  % Extract the function handles for Uocp_pos and Uocp_neg

230  compute_Uocp_pos = param.compute_Uocp_pos;

231  compute_Uocp_neg = param.compute_Uocp_neg;

232

233  %% Compute surface concentrations

234  cs_surf_neg = x(3) + (8*R_neg/35)*x(2) - (R_neg/(35*Ds_neg*a_neg*L_neg*F*A))*u;

235  cs_surf_neg = min(cs_surf_neg_ub, max(cs_surf_neg_lb, cs_surf_neg)); % saturation

236

237  cs_avg_pos = cs_max_p*(theta_min_pos + ((x(3) - theta_min_neg*cs_max_n)./((theta_max_neg -

      theta_min_neg)*cs_max_n))*(theta_max_pos - theta_min_pos)); % average concentration in

      pos electrodue (analytical expn using conservation of Li)

238  cs_surf_pos = cs_avg_pos + (8*R_pos/35)*x(1) + (R_pos/(35*Ds_pos*a_pos*L_pos*F*A))*u; %

      surface concentration of pos electrode

239  cs_surf_pos = min(cs_surf_pos_ub, max(cs_surf_pos_lb, cs_surf_pos)); % saturation

240

241  %% Compute overpotentials

242  eta_p = (2*R*T/F)*asinh(-u/(2*A*F*a_pos*L_pos*k_p*sqrt(ce*cs_surf_pos*(cs_max_p -

      cs_surf_pos))));

                                                                291

                                                     A.2 MATLAB codes for discrete-time SPM

243      eta_n = (2*R*T/F)*asinh(u/(2*A*F*a_neg*L_neg*k_n*sqrt(ce*cs_surf_neg*(cs_max_n -

          cs_surf_neg))));

244

245      %% Compute OCPs

246      surf_theta_p = cs_surf_pos/param.cs_max_p;

247      surf_theta_n = cs_surf_neg/param.cs_max_n;

248

249      U_p = compute_Uocp_pos(surf_theta_p);

250      U_n = compute_Uocp_neg(surf_theta_n);

251

252      phi_pos = eta_p + U_p;

253      phi_neg = eta_n + U_n;

254

255      v_cell = phi_pos - phi_neg;

256

257 end

258

259 function U_p = compute_Uocp_pos(theta_p)

260

261      U_p = (-4.656+88.669*theta_p.^2 - 401.119*theta_p.^4 + 342.909*theta_p.^6 -

      462.471*theta_p.^8 + 433.434*theta_p.^10);

262      U_p = U_p./(-1+18.933*theta_p.^2-79.532*theta_p.^4+37.311*theta_p.^6-73.083*theta_p.^8+95.96

          *theta_p.^10);

263

264 end

265

266 function U_n = compute_Uocp_neg(theta_n)

267

268      U_n = 0.7222 + 0.1387*theta_n + 0.029*theta_n.^0.5 - 0.0172./theta_n +

      0.0019./theta_n.^1.5 + 0.2808*exp(0.9-15*theta_n)-0.7984*exp(0.4465*theta_n - 0.4108);

269

270 end

                                                                292

        B

                            Permissions Summary

              B.1 Summary of Copyright Permissions . . . . . . . . . . . . . . . . . . . . . . . . 293
              B.2 Copyright Permissions for reuse of Figure 3.4 . . . . . . . . . . . . . . . . . . . 297
              B.3 Copyright Permissions for reuse of Figure 3.7 . . . . . . . . . . . . . . . . . . . 299
              B.4 Copyright Permissions for reuse of text, figures and tables of Chapter 4 . . . . 301
              B.5 Copyright Permissions for reuse of Figure 5.1 . . . . . . . . . . . . . . . . . . . 304
              B.6 Copyright Permissions for reuse of Figure 5.3 . . . . . . . . . . . . . . . . . . . 308
              B.7 Copyright Permissions for reuse of Figure 5.4 . . . . . . . . . . . . . . . . . . . 309
              B.8 Copyright Permissions for reuse of Figure 5.14 . . . . . . . . . . . . . . . . . . 310

                                                                293

                                                                                                                                                                                           B.1 Summary of Copyright PermissionsTable B.1 Summary of permissions for reuse of third-party copyrighted material

             294Page Usage inSource                                                Copyright holder &                                                                                                                          Date of last  Have  Permission

Page 63  Figure 3.1  Marie-Therese von Srbik. `Advanced Lithium-Ion Battery        Marie-Therese von Srbik                                                                                                                         N/A       Yes   CC-BY-
                     Modelling for Automotive Applications'. PhD thesis. Im-                                                                                                                                                    05/01/2019
                     perial College London, 2015, p. 162                                                                                                                                                                       (manuscript         NC-ND
                                                                                                                                                                                                                                accepted)
Page 65  Figure 3.2  Ian D. Campbell, Krishnakumar Gopalakrishnan, Mon-            Pending transfer to Elsevier                                                                                                                              No    Pending
                     ica Marinescu, Marcello Torchio, Gregory J. Offer and         by Ian D. Campbell                                                                                                                          27/09/2018
                     Davide M. Raimondo. `Optimising lithium-ion cell design       permissions@elsevier.com                                                                                                                                        publication
                     for plug-in hybrid and battery electric vehicles'. Journal                                                                                                                                                    N/A
                     of Energy Storage (Accepted) (Jan. 2019). The highlighted
                     authors are joint first authors with equal contributions.

Page 81  Figure 3.4  Marcello Torchio, Lalo Magni, R B. Gopaluni, Richard D.       The Electrochemical Society                                                                                                                               Yes   `Rightslink'
                     Braatz and Davide M. Raimondo. `LIONSIMBA: A Matlab           copyright@electrochem.org
                     Framework Based on a Finite Volume Model Suitable for                                                                                                                                                                         agreement
                     Li-Ion Battery Design, Simulation, and Control'. Journal of
                     The Electrochemical Society 163.7 (2016), A1192­A1205. issn:                                                                                                                                                                  attached
                     0013-4651
                                                                                                                                                                                                                                                   (see B.2)

Page 95  Figure 3.6  Toby Bond, Jigang Zhou and Jeffrey Cutler. `Elec-             Bond, Zhou and Cutler                                                                                                                                     Yes   CC-BY
                     trode Stack Geometry Changes during Gas Evolution in
                     Pouch-Cell-Type Lithium Ion Batteries'. Journal of The Elec-
                     trochemical Society 164.1 (Nov. 2017), A6158­A6162. issn:
                     0013-4651

                                                                                                                                                                                                                                             Continued on next page
                                                                                                                                                                                           B.1 Summary of Copyright PermissionsTable B.1 -- continued from previous page

             295Page Usage inSource                                                Copyright holder &                                                                                                                          Date of last  Have  Permission

Page 97   Figure 3.7   Paul W. C. Northrop, Venkatasailanathan Ramadesigan,        The Electrochemical Society                                                                                                                 27/09/2018    Yes   `Rightslink'
                       Sumitava De and Venkat R. Subramanian. `Coordinate          copyright@electrochem.org
                       Transformation , Orthogonal Collocation , Model Re-                                                                                                                                                      05/01/2019         agreement
                       formulation and Simulation of Electrochemical-Thermal                                                                                                                                                   (manuscript
                       Behavior of Lithium-Ion Battery Stacks'. Journal of The                                                                                                                                                                     attached
                       Electrochemical Society 158.12 (2011), A1461­A1477                                                                                                                                                       accepted)
                                                                                                                                                                                                                                                   (see B.3)
                                                                                                                                                                                                                                05/01/2019
Page 106 Figure 3.8    Ian D. Campbell, Krishnakumar Gopalakrishnan, Mon-          Pending transfer to Elsevier                                                                                                                (manuscript   No    Pending
                       ica Marinescu, Marcello Torchio, Gregory J. Offer and       by Ian D. Campbell
                       Davide M. Raimondo. `Optimising lithium-ion cell design     permissions@elsevier.com                                                                                                                     accepted)          publication
                       for plug-in hybrid and battery electric vehicles'. Journal
                       of Energy Storage (Accepted) (Jan. 2019). The highlighted                                                                                                                                                05/01/2019
                       authors are joint first authors with equal contributions.                                                                                                                                               (manuscript

Page 106 Figure 3.9    Ian D. Campbell, Krishnakumar Gopalakrishnan, Mon-          Pending transfer to Elsevier                                                                                                                 accepted)    No    Pending
                       ica Marinescu, Marcello Torchio, Gregory J. Offer and       by Ian D. Campbell
                       Davide M. Raimondo. `Optimising lithium-ion cell design     permissions@elsevier.com                                                                                                                                        publication
                       for plug-in hybrid and battery electric vehicles'. Journal
                       of Energy Storage (Accepted) (Jan. 2019). The highlighted
                       authors are joint first authors with equal contributions.

Page 107  Figure 3.10  Ian D. Campbell, Krishnakumar Gopalakrishnan, Mon-          Pending transfer to Elsevier                                                                                                                              No    Pending
                       ica Marinescu, Marcello Torchio, Gregory J. Offer and       by Ian D. Campbell
                       Davide M. Raimondo. `Optimising lithium-ion cell design     permissions@elsevier.com                                                                                                                                        publication
                       for plug-in hybrid and battery electric vehicles'. Journal
                       of Energy Storage (Accepted) (Jan. 2019). The highlighted
                       authors are joint first authors with equal contributions.

                                                                                                                                                                                                                                             Continued on next page
                                                                                                                                                                                           B.1 Summary of Copyright PermissionsTable B.1 -- continued from previous page

             296Page Usage inSource                                                 Copyright holder &         Date of last  Have  Permission

Page 109  All figures,  Krishnakumar Gopalakrishnan, Teng Zhang and Gregory         The American Society       18/04/2016    Yes   Copyright
          tables and    J. Offer. `A Fast, Memory-Efficient Discrete-Time Realiza-  of Mechanical Engineers    02/10/2018
          captions of   tion Algorithm for Reduced-Order Li-Ion Battery Models'.    (ASME)                     09/10/2018          agreement
          chapter 4     Journal of Electrochemical Energy Conversion and Storage    journalcopyright@asme.org
                        14.1 (Feb. 2017), p. 011001. issn: 2381-6872                                                               attached

                                                                                                                                   (see B.4)

Page 130 Figure 5.1     Scott J. Moura, Miroslav Krstic and Nalin A. Chaturvedi.    The American Society                     Yes   `Rightslink'
                        `Adaptive PDE Observer for Battery SOC/SOH Estimation'.     of Mechanical Engineers
                        Volume 1: Adaptive Control; Advanced Vehicle Propulsion     (ASME)                                         agreement
                        Systems; Aerospace Systems; Autonomous Systems; Battery     journalcopyright@asme.org
                        Modeling; Biochemical Systems; Control Over Networks; Con-                                                 attached
                        trol Systems Design; Cooperativ. ASME, Oct. 2012, pp. 101­
                        110. isbn: 978-0-7918-4529-5                                                                               (see B.5)

Page 148 Figure 5.3     Steve C. Southward. ME5506 Advanced Control Engineering: Steve C. Southward                          Yes   Granted
                        Lecture Notes 03, Spring 2011. Blacksburg, VA
                                                                                                                                   via email

                                                                                                                                   (see B.6)

Page 149 Figure 5.4 Gregory L. Plett. Lecture Notes 02: ECE 4540/5540- Digital Gregory L. Plett                28/09/2018    Yes   Granted
                                Control Systems. Colorado Springs, 2017
                                                                                                                                   via email

                                                                                                                                   (see B.7)

Page 185  Figure 5.14   Zhongwei Deng, Lin Yang, Hao Deng, Yishan Cai and           Elsevier                   27/09/2018    Yes   Elsevier
                        Dongdong Li. `Polynomial approximation pseudo-two-          permissions@elsevier.com
                        dimensional battery model for online application in                                                        license
                        embedded battery management system'. Energy 142 (Jan.
                        2018), pp. 838­850. issn: 0360-5442                                                                        attached

                                                                                                                                   (see B.8)
                                                       B.2 Copyright Permissions for reuse of Figure 3.4

                                                               297

                                                       B.2 Copyright Permissions for reuse of Figure 3.4

                                                               298

                                                       B.3 Copyright Permissions for reuse of Figure 3.7

                                                               299

                                                       B.3 Copyright Permissions for reuse of Figure 3.7

                                                               300

             B.4 Copyright Permissions for reuse of text, figures and tables of Chapter 4

COPYRIGHT AGREEMENT                           (as of February2010)

                   · TWO Park Avenue · New    NY

For

For                                    peg

Before publicatlon o' yo.r paper In a conference proceedings or Journal, ASME must receive a signed Copyright Agreement.

conference papers, this form should be received by the deadline Indicated by the Conference. Other forms may NOT be

suhtitut.d for this form, nor may any         on the form be changed,

PAPERNUMBER                                 papers):JEECS-16·1050

AUTHOR(s):                                          EnergyConversionand Storage

CONFERENCE NAME:

JOURNALNAME; danrnalrd

ASME requesb that authors/copyright owners assign copyright to ASME in ardor for a conforønce or Journal paper to be

pubished by ASME. Authors exempt from this request are direct employees or the U.S. Government. whereby papers are

not subject to copyright protection in the u.S., or non·u.S. government employees, Whose governments hold the copyright

to tie paper. Otherwise, the author/ copyright owner(s) Of the Paper should sign this form as instructed below. please refer

to the section below ·Who Should Sign' and also to ASME'S                 for more hrormation regarding copyr·t ownership

and the copyright

WHO SHOULD SIGN

Only the copyright owner(s) or the Paper, or an authorized representative. can sign Otis rorrn. If ono or he ronawing apples.

you may own the copyright to paper, or you may not be authorized to                    this          and you guy need to have

the appropriate copyright owner(s) or organizauon representative this Agreement:

(l) You creaEd tie paper within tho scope Of your employment,             your empbyeris the copyright owner

(2) You created the Paper under an hdependent contractor agreement"

(3) You received a grant that hjnded        Paper.

Pkase review yotr mmpMY policies regarding copy#t. and if you are not authorized to son this agreernent. please forward

to rue appropriate organization               Ptease review applicable company. institutional, and grant policies and your

employment,qndependent contrætor agreement to determine who holds the rights to your Paper. For rmre information, please

        the

"Note to U.S. Gavemment Contractors: Wyou                                 Paper under        With the US. Government. e.g,, U.S.

Government hbs, the paper may be subject to copyright, and you or your employer may own the copyright. Please review

your companyinstitutional policies and your contractor agreement. Your Paper may also require a               acknowledghg

contract in%rmation and also the fogowi·g staternene

·The          StaB Governrnent re*s, and by acepting tle atEIe pLHiGtbn, tie pu&her æknowledges tlat he LJr&d

States             rebins, a non-exclusrv·e,                 irrevoæble,   Itense b puÜ.h or                  the pubßhed

Of tlis work. or äNOWothers to do for United States Government purpose ·

It is your         to ensure that the         PDF            of he paper submit includes necßsary             and

            under  contract

COPYRIGHT          ASSIGNMENT                 to             l. 2. 3.                  45
The                      Of copyright

The undersiW1ed hereby assigns irrevocably to ASME all worldwße rights under copyright        Paper.

Authors retain an proprietary rfihts in any idea.            procedure. articles of manuEure described in tie Paper.

includhg the       to seek             protection for them.  may perform,              teæh, cmduct           research display

                                                     Searchab3l0e1PDF created by OCR.space (Free Version)

B.4 Copyright Permissions for reuse of text, figures and tables of Chapter 4

or pert Of Paper, and create            works in print or elecb·onicforrnaL Authors may reproduce and distribute tho Paper

for non-commercial purposes                         applies only to the sale Of the paper per se. For all coples of Paper

made by Authors, Authors must acknowledge ASME as original publisher and Include the names Of                    the

publk:ation title, and an appropriate copyright notEe that identifies ASME as the copyr"ht holder.

PLEASE READ THE IEBMHNQ-GQNQII.IQNS WHICH ARE FULLY INCORPORATED IN THIS AGREEMENT.

PAPERS OWNED BY ONE AUTHOR OR JOINT AUTHORS; DESIGNATED AUTHORS (For jolnuy                         works. au

authors should submit e signed Agreement, or one Designated Author may sign on behalf of the other authors, but ONLY IF

deslgnated author has secured written authorization to do so trom all other authors, Tho desbnated author must be able

to produce su@'written authorization if mquested,)

AuthM, Co.Aufror, or Deslgnated Author

Name:Krishnakumar Gopalakrishnan

                                                    TWO:  Student

                                                                                                    United K  m

(App·n.d  you                     Other)

                                                     Searchab3l0e2PDF created by OCR.space (Free Version)

                B.4 Copyright Permissions for reuse of text, figures and tables of Chapter 4

ASME COPYRIGHT                     FORM TERMS AND CONDITIONS

                          and           are inmrporated                          Form,

REPRESENTATIONS, OBLIGATIONS. ACKNOWLEDGEMENTS, AND INDEMNIFICATION

       rvesent and                 hat:

(A) This                                                                    the              of an                Of                          a

o'          as                     by

(B) You have the r"ht to           into this Copy*t          end to nuke                 of         to ASME. the        contains excerpts

ether              mat"al (hck'ding without limitatbn ony                                           taxi). you have acquired writing an

ri*üs             partho                                 in     and have                              credl that third-patty rmterial                or

            are         this Form boh any                                                    have                                      from a'
       aumors                       holdersto make this ass"nrnent r·ts to ASME.

(D) TOthe best Ofthe authM's               au StatenmtS cnMained in the                      to b'            are or support«i by

scientific          the Paper not u»ntalnany deramatMYor I&bus material aruldws not infringe any third pørtys cgMight. *nt.

trat% secret. Ottw prtvdetwy rights anddoes not violate me right 01                  or pWicny o' my third party              violate any other

                  furthermore elat to the best Of            you are resp-üBiWøfor ensuing the                of y-m_r·seÜch           p

(E)               was              in the            an       envloyment by. mntractual                       wÄh, ttw u.s. Federal or State

                                           materi* it has been awopriawy cleMed for publc r&ase and such Is

(F) Tho          is Su*t any                                                and not                      for puMlcatbn

(G) You have                   Od                                                                             in the Paper's         aspe&.

(H) ASME is                        my                        errors or           by

(I) All pru·üand                   of the P»er                   to ASME         ASMEs *tysu                      of whetter not A
                                                             to mJblBhyour       (sn ttw Tertwnation
mibUshestle Paper. and thatASME is not                                                                            i' your              not

(J) ASME is                    for any          expenses i ncurred in                    prepar"g me                    methgs prent It.
     ASEE pay you any
                                   cmpensatÉn if ptnlshes               Papa.

(k) Su*t            to                  extent                  law. agree                                    ASMEfromanydanuge
                                                             warranbes
relaW to a breachof any ot the

TERMINATION

If       decø-- not to             yow P»er, ns FM"',           all of                   ymr papÜ.                            thereafterfree to

                    pub--iM elsewtwe.

GENERAL          PROVISIONS

This                       Terms &                                                           the                                            ASME.

and supMse&s a' gior or ament                                           and repres*ltations, Whettw Oral or Written, between you md A9dE

            the Paper.

This Agreenwnt is              by. md stould be constt_æd in                     wit'. the laws the State 01  York, United States of America

            to             made md perforrned Tiete, except to                   that pur mstitution is       Sy law from entering contracts

            by New York        in                    this Agreement is governed by , and Should                               With,              Of

ji_risdictior, which your              is       Any          dispute. action or proceedng relatingto this Agreernent be brought only in

applÉ±k                                in the State and Cwnty of New             aM you      mnsent to persmal W·nsdicihnand venue in any

                                                     Searchab3l0e3PDF created by OCR.space (Free Version)

                                                       B.5 Copyright Permissions for reuse of Figure 5.1

                                                               304

                                                       B.5 Copyright Permissions for reuse of Figure 5.1

                                                               305

                                                       B.5 Copyright Permissions for reuse of Figure 5.1

                                                               306

                                                       B.5 Copyright Permissions for reuse of Figure 5.1

                                                               307

                              B.6 Copyright Permissions for reuse of Figure 5.3

Go alakrishnan. Krishnakumar

       Southward, Steve       ·exchange.vtedu>

Sent:  09 October 2018 1741
To:
       Gopalakrishnan, Krishnakumar

       Re:Requestfor permissionto adapta schematicfrom your lecturenotesfor thesis

Hi Krishna,

SorryforthedelayInrespondingY. ouarewelcometo usemyslidewithcitationasyouhavedone.Goodluckl

Dr. Southward

          On Sep 26, 2018, at 2:55 PM, Gopalakrishnan, Krishnakumar <

           Dear prof Southward,

           Greetings'

          Hopeyou rememberme from our previousinteractions.I am KrishnakumarGopalakrishnan
         (Krishna)w, howasregisteredat VirginiaTechfrom Fall2009throughFall2011asanM.Engstudent
         Inthe Electricaal ndComputerEngineering(ECEd)epartment.InSpring2011,t hadregisteredfor

        andcompletedthecredit-bearincgourse'MES50--6AdvanceCd ontroEl ngineeringta, ughtbyyou.I

         am therefore in possessionof the electronicPDFSof the lecture notesamongother associated

             material for this course.

         Forusein my PhDthesis(non-profit CC-BY-NC-NuDse),I'd liketo adapt a schematicfrom L03Of
         your coursenotesthat presentsthe timing diagramof a real-timecontrol/software loop.
          I shallof coursecite the sourceof the originalschematicin the figure caption.

        I haveattachedmyadaptedversionherewithfor yourperusal.I hopeyouan accordmewithyour

            permissions for thesis reuse.

           Best Regards,

              Krishna

                                                                 Searchable PDF created by OCR.space (Free Version)

                                                               308

                                                       B.7 Copyright Permissions for reuse of Figure 5.4

              Go lakrishnan, Krishnakumar
                                                            Gregory Plett
                                                                28 September 2018 2028
                                                                Gopalakrishnan, Krishnakumar

                                                     Re:Requesftor permissionto reusea schematifcromyourlecturenotesin my PhD

                                                                                 thesis

            Yes,youarewelcometo use/adapthe figure.I'msureI Stoleit fromsomewheremyself.

              Congratulations for reaching this pointl
               Dr. Gregory L prett
             professor,Departmentof Electricaland ComputerEngineering

            Director,GATECenterOfExcellencien InnovativeDrivetrainsin ElectricAutomotiveTechnologyEducation

              University of Colorado Colorado Springs
              1420 Austin Bluffs parkway, Colorado Springs,CO80918

                   p:

                        On Sep 28, 2018, at 10:13 AM, Gopalakrishnan, Krishnakumar

                            Dear prof Plett,

                       Greetings'Howareyou doing?I am about to submit the thesisOfmy thesis(hopefullyearly next

                       ForuseIn my PhDthesis(non-profit, non-commericalCC-BY-NC-NuDse),I'd liketo adapt a
                     schematicfrom Lecture2 of ECE554n0otesthatdepictsa cartoonrepresentationof the timing
                       diagramof a real-timecontrol/software loop. I shallof coursecite the sourceof the original

                          schematic in the caption.

                       I haveattachedthe relevantschematicherewith for your perusal. I hopeyou canaccordme with

                            your permissions for thesis reuse.
                            Best Regards,

                                 Krishna

                                                                 Searchable PDF created by OCR.space (Free Version)

                                                               309

                                                     B.8 Copyright Permissions for reuse of Figure 5.14

                                                                310

                                                     B.8 Copyright Permissions for reuse of Figure 5.14

                                                                311

                                                     B.8 Copyright Permissions for reuse of Figure 5.14

                                                                312

                                                     B.8 Copyright Permissions for reuse of Figure 5.14

                                                                313

                                                     B.8 Copyright Permissions for reuse of Figure 5.14

                                                                314


