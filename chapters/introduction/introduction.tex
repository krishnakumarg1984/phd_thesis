% -*- root: ../../main.tex -*-
%!TEX root = ../../main.tex
% vim:textwidth=80 fo=cqt

% \clearpage
% \graphicspath{{chapters/introduction/figures/}}
\chapter{Introduction}\label{ch:intro}

% need a symbol Nomenclature

\capolettera{T}{ightening} emissions  regulations in various  industrial sectors
have led  to a renewed interest  in sustainable energy sources  in recent years.
In  particular,  the  burgeoning  demand  for  clean  energy  has  prompted  the
automotive and  consumer electronics industries  to explore advanced  methods of
energy storage~\cite{Weiss2011}. Li-ion batteries\footnote{The term(s) `cell(s)'
and  `battery(ies)' are  used interchangeably  in this  thesis. Technically,  an
electrochemical cell is the smallest  self-contained unit (housed in a packaging
with terminal connectors) that is capable of both storing and delivering energy.
A battery (also referred to as a battery  `pack') is made up of a group of cells
arranged  in  a  custom  configuration to  meet  certain  system-level  voltage,
current and  power demands.  The focal  point of  this thesis  is a  single cell
(a  discussion of  what  this  entails is  provided  shortly hereafter,  thereby
narrowing  down the  geometrical scope  of large  portions of  this thesis  to a
precisely defined unit). Scaling of various  quantities from the pack level down
to  the  cell  level  is  discussed  wherever  appropriate.}  are  seen  as  key
enablers  in this  quest due  to  the attractiveness  of their  high energy  and
power  densities compared  to  other competing  non-conventional energy  storage
technologies~\cite{Ibrahim2008}.  However, with  this  surge  in energy  storage
demands  comes  stricter  requirements  for  cell  longevity,  performance,  and
adhesion  to  safety  requirements,  particularly  for  adoption  in  mainstream
transport  electrification~\cite{Andrea2010}.  In  contrast to  other  incumbent
technologies,  lithium-ion cells  have several  advantages such  as high  energy
density,  long life-cycles,  low internal  resistance, low  self-discharge, long
cycle life,  fast charge  and discharge  cycles~\cite{Reddy2011,Plett2015}. This
makes them the preferred choice for storage and on-demand retrieval of energy in
modern consumer electronics and~\glspl{xeV}.

% Different type of cells - Prismatic,  pouch and cylindrical. How pouch cells are
% used in automotive industry acknowledge Tesla, but cite counter citations. Layer
% photos etc

% Precise definition of cell unit
% \section{Geomtery}
% C-rate definition

\section{Working Principle}\label{subsec:liionchemistry}

This section  provides a  brief overview of  the essential  chemistry principles
that  helps  to  describe the  working  principle  of  a  lithium ion  cell  and
represents the author's digested summary  of the introductory concepts presented
in Plett~\cite{Plett2015}.

\Cref{fig:chargetransferprocess} depicts the construction of one electrochemical
layer of a lithium ion cell. The positive electrode consists of porous particles
of  Lithium-Transition  Metal  Oxide  (MO)  compounds.  The  negative  electrode
typically employs some variant of microporous graphite. The porous nature of the
electrodes provide pathways for lithium  ion conduction through the electrolyte.
Due  to  the  special  construction  of the  electrode  structure,  there  exist
interstitial  sites  which act  as  intercalation  spots for  lithium  shuttling
between the two electrodes. The electrolyte, which floods the cell, helps in the
conduction of \ch{Li^+}~ions. The separator membrane allows the passage of these
ions  between  the  two  electrodes,  but  prevents  internal  short-circuit  by
inhibiting electronic  conduction through it. The  current collectors facilitate
passage of electrons generated during the charge transfer at particle surface to
the external circuit.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{chapters/introduction/figures/cropped_cell_sandwich_for_thesis}
    \caption[Illustration of a lithium ion cell]{Schematic depicting the basic construction of a lithium ion cell.}
    \label{fig:chargetransferprocess}
\end{figure}

At the fully charged condition, the majority  of lithium in the system is stored
within the negative electrode  microstructure. During discharge, \ch{Li^0}~atoms
diffuse out of  deep interstitial sites towards the surface  of the particles in
the  negative  electrode.  At  the  surface  (electrode-electrolyte  interface),
a  charge-transfer  process  takes  place according  to  Butler-Volmer  kinetics
(see  \cref{eq:butlervolmer}), leading  to the  formation of  \ch{Li^+}~ions and
electrons. The electrons are passed to  the external circuit through the \ch{Cu}
current collectors  onto which  the conductive matrix  composed of  the negative
electrode material and binders is  coated. The \ch{Li^+}~ions travel through the
electrolyte phase,  crossing the  separator membrane  to the  positive electrode
where they  encounter an  electron influx  from the  external circuit.  A charge
transfer  reaction  takes  place  at  the  surface  of  the  positive  electrode
particles, leading to the formation of neutral \ch{Li^0}~atoms that diffuse into
the positive electrode microstructure.

During  the   charging  process,  the   reverse  phenomena  occur.   Lithium  is
de-intercalated  from  the  positive  electrode and  a  similar  charge-transfer
happens  at  the surface,  leading  to  the  formation of  \ch{Li^+}~ions  which
reach  the  negative  electrode  by   passing  through  the  separator.  At  the
surface of  the negative electrode  particles, these ions absorb  electrons from
the  external  circuit,  leading  to the  formation  of  neutral~\ch{Li^0}  that
diffuses  into  interior  vacant  spaces  in  the  layered  graphite  electrode.
\Cref{eq:NegElectrodeRxn,eq:PosElectrodeRxn} summarise the  reactions during the
charging and discharging process at the surfaces of both electrode materials.
\begin{align}
    \ch{Li_{$x$} C                            &<=>[\tiny{discharge}][\tiny{charge}] C + $x$ Li^+ + $x$ e^-}\label{eq:NegElectrodeRxn}\\
    \ch{Li_{1-$x$} M O2 + $x$ Li^+  + $x$ e^- &<=>[\tiny{discharge}][\tiny{charge}] LiMO2}\label{eq:PosElectrodeRxn}
\end{align}
where    \ch{M}~represents    a    transition   metal    compound   such    as
\ch{Ni_{1/3}Co_{1/3}Mn_{1/3}}~(NMC),   \ch{Ni_{0.8}Co_{0.15}Al_{0.05}}~(NCA)
amongst other  choices~\cite{Reddy2011}. Assuming  no loss of  cycleable lithium
due to  parasitic side  reactions or  through other  mechanisms, the  process is
fully reversible.


The electrochemical potential at each electrode  is dependent upon the extent of
its  lithiation. An  empirical  relationship of  each  electrode's potential  as
a  function  of  its  stoichiometry  can be  obtained,  and  is  dependent  upon
the  specific design  and  material  properties of  each  active material  under
consideration. Finally, the \gls{ocv} of the cell is obtained by subtracting the
negative electrode potential from its positive electrode counterpart.


\section{Battery Modelling}

Through accurate model representations  of the electrochemical-thermal behaviour
of  the cell,  advanced monitoring  and control  strategies can  be deployed  to
tackle  the current  research  topics  in Li-ion  batteries  such as  increasing
cycle-life,  improving  operational   safety  and  performance~\cite{Plett2015}.
Over  the past  two  decades, efforts  have  been made  to  construct models  to
describe  the physical,  electrical, thermal,  electrochemical and  system-level
performance  of  Li-ion cells,  leading  to  modelling strategies  with  various
levels  of   sophistication.  For   the  interested   reader,  the   article  by
Grazioli~\etal~\cite{Grazioli2016a} provides  a broad introduction to  the topic
of computational  modelling of  lithium ion batteries.  Large in-roads  into the
depth of the modelling  art can be made by perusing  comprehensive books on this
topic such  as those by  Plett~\cite{Plett2015}, Hariharan~\cite{Hariharan2017},
and Rahn and Wang~\cite{Rahn2013}.

The  need  to  address  the  operational challenges  of  lithium  ion  batteries
in   an   embedded   environment   such  as   on-board   an   electric   vehicle
has   led   to  an   increased   impetus   on   the  development   of   advanced
\glspl{bms}~\cite{Bergveld2002}. In vehicular  applications, the only measurable
quantities  of  a  lithium  ion  cell are  its  terminal  voltage,  current  and
temperature. This implies  that several internal states of the  cell such as its
\gls{soc}, whose  real-time computation is  vital to the optimal  performance of
the cell, need to be estimated from these available measurements. Therefore, the
performance  of  a \gls{bms}  for  tasks  such  as  online state  estimation  is
dependent upon the  fidelity of the underlying cell  model. Sophisticated models
of  the  cell enable  these  quantities  to  be  estimated more  accurately  and
facilitate the implementation  of advanced control algorithms.  Therefore, it is
imperative  that  the cell  model  used  is suitable  for  being  embedded in  a
real-time \gls{bms}.

Most battery  models have the primary  goal of accurately predicting  the cell's
terminal  voltage  at each  time-step.  This  is so  that  the  output from  the
predictor routine  can be compared  to the  measured voltage and  the difference
between  them may  be used  in a  suitable corrector  routine to  improve future
predictions. The  combined information  from the model  and measurement  is then
blended in a suitable way to estimate the cell's \gls{soc}.

More   advanced  models   strive   to  provide   insight   into  various   other
physico-chemical quantities  that could affect  the cell's health. The  field of
Li-ion battery modelling can be classified into two broad categories
---
\begin{enumerate*}[label=\roman*)]
    \item empirical/ad-hoc \glspl{ecm}, and
    \item detailed  \glspl{pbm} that are based  upon first principles.
\end{enumerate*}
A  comprehensive summary  of  various models  that  belong to  each  of the  two
categories  is  discussed  in Seaman~\etal~\cite{Seaman2014}.  A  characteristic
aspect that contrasts  them is the fact that they  are typically
at loggerheads with each other in terms of their computational complexity.

\subsection{\glsfmtlong{ecm}s}\label{subsec:ecms}

\glspl{ecm}  employ circuit  elements  such as  voltage  sources, resistors  and
capacitors to  model the behaviour  of batteries at their  electrical terminals.
The cell's  thermal subsystem may  also be  modelled by an  analogous electrical
circuit. The  parameters of the  circuit are  typically functions of  the cell's
current, \gls{soc} and  temperature. These can be incorporated as  a lookup table by
curve-fitting  the model  to experimental  data. Using  such equivalent  circuit
models, two simple methods are available to compute the cell's \gls{soc} ---
\begin{enumerate*}[label=\itshape\alph*\upshape)]
    \item by using manufacturer-supplied  lookup table or graph of \gls{ocv} versus \gls{soc}, and
    \item by numerically integrating the charge passed in and out of the cell over time (commonly referred to as coulomb counting).
\end{enumerate*}
Both methods are computationally  amenable for small-scale embedded applications
such as  consumer electronics; however, neither  one is robust enough  to handle
the stringent demands in performance imposed by modern vehicular applications.

Advanced state estimation algorithms such  as nonlinear Kalman filters may still
be able to use \glspl{ecm} as the plant model and obtain reasonable estimates of
the  cell's  \gls{soc}~\cite{Plett2006,  Sun2011}. However,  the  usefulness  of
\glspl{ecm} is limited by the fact that their parameters are derived essentially
by a  curve-fitting process using a  standard set of training  data. Since these
models are  not based on  any physical phenomena,  their ability to  predict the
cell's general behaviour  is extremely poor especially when  subject to current
profiles well  outside their training  realm. Another important  disadvantage of
equivalent circuit  models is that they  do not allow insights  into the various
internal states of the cell.

\glspl{ecm}  of  lithium  ion  batteries   have  been  extensively  studied  and
are  widely  applied.  However,  the aforementioned  difficulties  render  their
reliability and  accuracy questionable,  especially under highly  demanding load
profiles  experienced by  the battery  packs in  \glspl{xeV}. The  boundaries of
their  performance have  been well-quantified  (see~\cite{Plett2015,Plett2016}).
Although  various estimation  and control  algorithms continue  to be  developed
around them, the  \glspl{ecm} themselves are no longer the  subject of extensive
research. Hence, this thesis does not discuss them further.

\subsection{\glsfmtlong{pbm}s}\label{subsec:pbms}

\glsreset{pbm}

\glspl{pbm} consist of  governing equations that construct a  realisation of the
behaviour of the cell based  upon electrochemical principles such as equilibrium
thermodynamics,  material  diffusion  and  reaction  kinetics.  The  fundamental
advantage  to this  modelling approach  is that  it is  possible to  compute the
evolution of  internal states of  the cell  for arbitrary current  profiles. The
difficulty with  the physics-based  modelling approach  lies with  obtaining the
values  of all  the physical,  geometric, electrochemical,  thermal and  kinetic
parameters  of the  cell. Usually,  these parameters  are closely  guarded trade
secrets by cell manufacturers.

In  some  cases, it  may  be  possible to  obtain  a  subset of  these  physical
parameters   by  dissecting   cells  in   an  inert   environment  followed   by
further  characterisation   using  specialised  lab  equipment.   For  instance,
Ecker~\etal~\cite{Ecker2015}   demonstrate   the    reverse-engineering   of   a
\SI{7.5}{\amphour} pouch  cell by Kokam  Ltd.\ in  order to obtain  its physical
parameters. Nevertheless,  this is a tedious  process and is feasible  only with
access  to  such sophisticated  lab  equipment.  Furthermore, the  results  from
these  experiments are  susceptible to  characterisation  errors as  well as  to
cell-to-cell variations due to production spread. Therefore, some form of system
identification method  needs to be employed  for estimating the majority  of the
physical  parameters required  for  a  \gls{pbm}. Furthermore,  it  is a  common
practice to  rely on published  data for the  values of certain  cell parameters
that do  not depend on physical  construction, especially for those  that remain
universally true for a particular Li-ion chemistry.

The challenges involved  in model parametrisation is a research  exercise of its
own merit and  is not addressed in  this thesis. A redeeming factor  is that the
task of  parametrisation is a  one-off problem that  appears early in  the model
deployment  stage,  after which  the  rewards  of  superior performance  of  the
\glspl{pbm} can be reaped. Once  the model parameters are available, \glspl{pbm}
can be used in  aiding a deeper understanding of the working of  the cell and in
answering research  questions that could  otherwise not be answered  with simple
\glspl{ecm}. One area  of focus of this  thesis is to broach  a less-probed area
--- exploring  the possibility  of using  a \gls{pbm}  for the  \emph{design} of
pouch  cells  used  in  automotive  applications which  shall  be  presented  in
\cref{ch:modelbaseddesign}.

A major disadvantage of \glspl{pbm} from an implementation point of view is that
solving for  the model's field  variables is time-consuming. In  particular, the
more  sophisticated  \glspl{pbm}  require  the use  of  multi-physics  \gls{pde}
solvers  and  hence  are  not  typically  suitable  for  embedded  applications.
Nevertheless,  for   high  performance   applications  such  as   in  automotive
\glspl{bms}  wherein   state-of-health  monitoring  is  crucial,   there  is  an
overwhelming  demand for  obtaining insight  into internal  cell variables.  For
instance, the real-time computation of surface concentration of \ch{Li^0} in the
solid particles enable the \gls{bms} to regulate  power flow into and out of the
cell to proactively avoid plating and degradation of the cell.

In view of this consideration, model  order reduction techniques are seen as key
enablers that facilitate in porting the first-principles based predictive powers
of \glspl{pbm}  into a  real-time microcontroller.  This thesis  shall therefore
have  a  strong  focus  on  both the  analysis  and  implementation  aspects  of
\glspl{rom}.

\section{The \glsfmtlong{dfn} model}\label{sec:dfnmodel}

Doyle,  Fuller and  Newman~\cite{Doyle1993,Fuller1994}  developed an  isothermal
physics-based  porous electrode  model of  the  cell capable  of describing  its
internal variables such as
\begin{enumerate*}[label=\itshape\alph*\upshape)]
    \item potential on the solid particles~$\phi_\text{s}$,
    \item potential in the electrolyte solution~$\phi_\text{e}$,
    \item concentration of \ch{Li^0} in the solid particles~$c_\text{s}$,
    \item ionic concentration in the electrolyte solution~$c_\text{e}$, and
    \item molar flux density of lithium at the solid-electrolyte boundary~$j$.
\end{enumerate*}
The most popular computational implementation  of the \gls{dfn} equations is the
\gls{p2d}  model~\cite{Plett2015}. In  the \gls{p2d}  implementation, all  field
variables  of  the  \gls{dfn}  model  are  computed  at  each  spatial  location
along  the axial  thickness of  the cell.  However, the  solid concentration  in
spherical electrode particles  is solved in a radial co-ordinate  system that is
perpendicular to  the axial  direction of  the cell's  thickness. The  axial and
radial dimensions are coupled at each  particle's surface through the molar flux
density  describing the  rate of  pore-wall flux  that crosses  from solid  into
electrolyte  or  vice-versa.  The  equations and  boundary  conditions  for  the
\gls{p2d} implementation of the \gls{dfn} model is shown in \cref{tbl:dfneqns}.

\input{chapters/introduction/dfn_equation_table}

In  this  thesis,  this  \gls{p2d}  implementation of  the  \gls{dfn}  model  is
considered as  the reference (and  only) \gls{pbm}. Although  thermal dependence
of  parameters  such  as  electrolyte  conductivity  and  diffusivity  is  shown
in \cref{tbl:dfneqns}, a sophisticated description  of detailed thermal dynamics
\ie~a description  of spatio-temporal evolution of cell's  temperature using a
set of ordinary/partial  differential equations is not considered  in this work.

For those aspects of this thesis dealing with the analysis and implementation of
various  \glspl{rom} and  the  improvements  imparted herein  to  them, only  an
\emph{isothermal}  implementation  (at  \SI{298.15}{\kelvin}) of  the  \gls{p2d}
equations  is  considered.  The  performance  of  the  various  \glspl{rom}  are
compared  against this  reference benchmark.  In consideration  of the  relative
sparsity of  such detailed analysis  of \glspl{rom} in existing  literature (see
\cref{ch:littreview}),  the  author  of  this  thesis  considers  that  such  an
analysis, albeit isothermal, is  the need of the hour and  is imperative to gain
a  deeper  understanding  of  the  performance  boundaries  of  various  popular
\glspl{rom}.

% Further  extensions to  the  analysis  presented here  to  include various thermal effects can be considered for future research.

Since temperature  plays a crucial  role in the  operation of cells  and battery
packs in \glspl{xeV},  an isothermal model is unsuitable for  design purposes. A
model-based design that does not consider thermal effects is likely to stray far
from the operating regimen and fail  spectacularly. On the other hand, including
a sophisticated thermally coupled model  is unlikely to yield significant gains.
Firstly, running  fully coupled electrochemical-thermal model  based simulations
over the entire design space  is computationally expensive. Secondly, the design
results  of the  model have  to  be anyway  verified using  a reasonable  number
of  experimental prototypes.  Taking  into account  these  considerations it  is
deemed  that, for  the design  aspect  of this  thesis, a  lumped thermal  model
suffices.  This  simplified thermal  model  is  bidirectionally coupled  to  the
\gls{p2d} equations  (see \cref{tbl:dfneqns})  of the electrochemical  model and
is  used as  the  \gls{pbm}  underpinning the  model-based  design discussed  in
\cref{ch:modelbaseddesign}.

The rest of the thesis is organised as follows. \Cref{ch:littreview} presents an
overview of pertinent modelling art.  The literature on model-based design shall
be  evaluated  here and  the  present  shortcomings  identified. The  survey  of
literature  also  considers the  advancements  in  the  field of  reduced  order
modelling from  their analysis and implementation  perspectives. A computational
framework  for  optimising the  number  of  layers  within an  automotive  pouch
cell  is  presented  in  \cref{ch:modelbaseddesign}.  In  \cref{ch:improveddra},
the  computational   bottlenecks  in   a  specific  \gls{rom}   method  \viz~the
\gls{dra} is  analysed in  detail and  an improved  alternative is  proposed. In
\Cref{ch:spmanalysis},  the simplest  time-domain  \gls{pbm},  the \gls{spm}  is
introduced  and  its  performance  is analysed.  Salient  advancements  made  to
the  basic \gls{spm}  in the  literature  are presented  and their  shortcomings
analysed. A  discrete-time formulation focusing on  the numerical implementation
aspects is  also presented. In \cref{ch:newelectrolytemodel},  the causal factor
for  the lacklustre  performance  of  a state  of  the art  electrolyte-enhanced
\gls{spm} is  unearthed. Additionally, \cref{ch:newelectrolytemodel}  proposes a
new  electrolyte  model which  represents  a  novel  application of  the  system
identification technique. The superior  performance of this electrolyte-enhanced
composite \gls{spm}  is demonstrated. Finally,  \cref{ch:conclusions} highlights
the salient  conclusions that can be  drawn from the findings  presented in this
thesis and paves  the way for future research by  identifying key unsolved tasks
in physics-based battery modelling for such automotive applications.

% need a symbol Nomenclature

% \subsection{Organisation of Thesis}

% nice figure here (with Bohr model of atom)
% \Cref{ch:improveddra} analyses a critical weakness in a sophisticated \gls{rom}
% and proposes a numerical method to circumvent it.
% different \glspl{rom} shall be performed in

% \cite{Seaman2014} provide a comprehensive survey  of the wide range of battery
% models out there.

% This  thesis  strives to  represent  all  physical  quantities in  the  standard
% International  System  of Units  (SI-Units).  However,  there are  some  notable
% exceptions \eg~for the capacity of a  Li-ion cell, which is represented in the
% practical units  of Ampere  hours (\SI{}Ah),  rather than the  base SI  Units of
% Coulombs (\SI{}{\coulomb}).  Such exceptions  are made  taking into  account the
% prevalent conventions in standard literature.

% \fxnote{Where does  this paragraph go? End  of this section/end of  chapter or
% even  last  chapter?}  The  identification of  individual  parameters  of  the
% \gls{dfn} model  remains a  key area  in battery  modelling that  remains only
% partially  explored. Nevertheless,  this effort  is critical  to ensure  rapid
% adoption  of any  physics-based  model and  sophisticated control  algorithms.
% The  state of  the  art in  this  area, the  challenges  involved and  current
% efforts  in  this  direction are  explored  in \cref{ch:futurework}.  Although
% sensitivity  analysis  of  the  \gls{dfn} parameters  has  been  performed  in
% literature, \fxnote{citation here} the extent to which parameter uncertainties
% influence  the   numerical  values  in  the   $A,  B,  C$  and   $D$  matrices
% of \cref{eq:LTIstatespace} has not yet been attempted. In continuation of this
% research aspect, the order of magnitude  shift in eigen/singular values of the
% relevant system matrix also need to be quantified to enable an informed choice
% about stability of such models for real-time implementations.

% need a symbol Nomenclature
