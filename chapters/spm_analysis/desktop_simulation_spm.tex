% -*- root: ../../main.tex -*-
%!TEX root = ../../main.tex
% this file is called up by main.tex
% content in this file will be fed into the main document
% vim:textwidth=80 fo=cqt

In this  section, the performance  of the  basic \gls{spm} is  discussed through
desktop  simulation and  by comparison  against a  standard \gls{dfn}  benchmark
model incorporating the full \gls{p2d} dynamics.

% \footnote{In  this   thesis,  the  terms   \gls{p2d}  and  \gls{dfn}   are  used
% synonymously.  This   is  because,   although  the  \gls{dfn}   model  equations
% are  originally  derived  and  is  applicable  in  three  dimensions,  its  most
% common  implementation  is  the  pseudo-two dimensional  case  wherein  dynamics
% of  all  variables  other  than  solid concentration  are  evaluated  along  the
% through-thickness  direction of  the  cell (direction  of  the most  significant
% charge  transport). The  solid diffusion  equation  is computed  in a  spherical
% co-ordinate system on a separate pseudo-dimension  and is coupled with the axial
% co-ordinates through the boundary flux at the surface of each particle.}

\subsection[Cell   Parametrisation]{Cell   Parametrisation\protect\footnote{Some
contents    in   this    section   overlap    with   \cref{sec:p2daugmentations}
and      represents     a      joint     effort      with     \mbox{Ian      D.\
Campbell}.}}\label{subsec:spmp2dparametrisation}

\input{chapters/spm_analysis/cell_params_table}

\Cref{tbl:lcoSimParamsSPMp2d} lists  the simulation  parameters of  an \gls{lco}
cell  whose positive  and negative  electrodes are  \ch{LiCoO_2} and  \ch{LiC_6}
respectively.  The  electrolyte in  this  system  consists of  \ch{LiPF_6}  salt
in  a   solution  of   \gls{ec}/\gls{dmc}/\gls{emc}  in   a  1:1:1   ratio.  The
standard  set  of  \gls{dfn}  parameters have  been  extensively  described  and
documented  in  literature.  The   detailed  characterisation  of  the  physical
properties  of  lithium-ion  cells  falls  outside the  scope  of  this  thesis.
Here,  the vast  majority of  electrochemical parameters  \viz~the  geometric,
thermodynamic, kinetic  and transport properties  of the cell have  been sourced
from  Subramanian~\etal{}~\cite{Subramanian2009}. The  significance  of each  of
the  parameters  in  the  context  of the  modelling  assumptions  discussed  in
\cref{subsec:basicspmassumptions} is examined.

The simulation parameters that are applicable exclusively to the \gls{p2d} model
are shown as  highlighted text in \cref{tbl:lcoSimParamsSPMp2d}. It  can be seen
that only a  subset of the isothermal \gls{dfn} model's  parameters are required
for the \gls{spm}. In particular, there is no requirement to estimate any of the
electrolyte-related  parameters  in  each  electrode  region.  Furthermore,  the
properties of the separator material which  are necessary in the \gls{dfn} model
are also  not considered in the  \gls{spm} computations. A brief  enumeration of
the additional  \gls{p2d}-specific parameters in the  context of parametrisation
requirements is provided here.

\begin{enumdescriptnum}[leftmargin=!,itemsep=1ex,labelwidth=\widthof{$\symbf{\text{brugg}_j}\ \scriptstyle (\times 3)$abc}
    ,partopsep=0pt
    ,topsep=0pt
    ]

    \customenum{\text{brugg}_j}{3}  The  empirical Bruggeman  coefficient  helps
    to   define   the  effective   values   of   conductivity  and   diffusivity
    of   the  electrolyte.   Although  an   identical  value~(4)   is  used   in
    \cref{tbl:lcoSimParamsSPMp2d},  in  principle  all three  regions  can  have
    different values of brugg and need to be parametrised separately.

    \customenum{D}{1}  The  intrinsic  electrolyte   diffusivity  of  a  typical
    electrolyte  consisting  of  \ch{LiPF_6}  salt in  an  organic  solvent  was
    experimentally  characterised   and  provided  as  a   table  of  polynomial
    coefficients  by  Valøen  and  Reimers~\cite{Valoen2005}.  Evaluating  this
    polynomial  at a  cell  temperature of  \SI{298.15}{\kelvin}  results in  an
    intrinsic  diffusivity  of~\SI{3.22e-10}{\meter\squared\per\second}.  Since
    this is  a material property independent  of the region within  the cell, it
    needs to be parametrised only once.

    \customenum{\scalebox{1.35}{$\kappa$}}{1}   Like    the   diffusivity,   the
    intrinsic electrolyte conductivity is also a material property and its value
    is independent  of the region within  the cell. Unlike the  diffusivity, the
    electrolyte conductivity  is a strong  function of its  ionic concentration.
    Thus, the polynomial proposed by Valøen and Reimers~\cite{Valoen2005} needs
    to  be evaluated  at~$T_\text{cell}= \SI{298.15}{\kelvin}$  and  has to  be
    updated during the  simulation as salt concentration  within the electrolyte
    changes over time. A discussion on the choice of initial concentration is
    provided in \cref{subsec:basicspmsimsetup}.

    \customenum{\scalebox{1.25}{$t$}_+^0}{1}  The  cationic transference  number
    measures the relative  mobility of the \ch{Li^+}~ion in  the organic solvent
    and is  independent of  the region  within the  cell. Hence,  this intrinsic
    property is to be parametrised only once (per solvent).

    \customenum{\scalebox{1.25}{$\sigma$}_j}{2}  The  intrinsic conductivity  of
    the  solid phase  depends on  the material  used in  the porous  electrodes.
    Although a simplified  assumption of equal conductivity is used  for the two
    electrodes, in practice, this property needs to be characterised for each of
    the two electrodes.

\end{enumdescriptnum}

\sisetup{detect-weight=true}  Neglecting  Arrhenius-type temperature  dependence
of  physical  properties  and   their  corresponding  activation  energies,  the
basic  \gls{spm}  facilitates  the  ability to  afford  physics-based  modelling
capabilities with  \emph{eight} fewer parameters than  the equivalent isothermal
\gls{p2d} model. With  the naive assumption of equal  parametrisation effort per
physical property, this  implies a \textbf{\SI{20}{\textbf{\percent}}} reduction
in  parametrisation  requirements  for  the basic  \gls{spm}  when  compared  to
its  \gls{dfn} counterpart.  However,  considering the  fact that  parametrising
the  electrolyte's transport  properties requires  apparatus and  infrastructure
typically  available only  in specialised  chemical/materials~science labs,  the
reduction in parametrisation overhead  for system-level engineering stakeholders
is more pronounced.

Prima~facie, it may seem that electrolyte porosities and filler volume fractions
do  not  influence the  \gls{spm}  model.  However,  they  do have  an  indirect
bearing  on  arriving  at  a  critical parameter  \viz~the  solid  phase  volume
fraction~$\varepsilon_\sj$. This  parameter is required to  compute the specific
interfacial surface  area of the electrodes~$a_\sj$  \ie~the effective electrode
area  exposed to  reaction and  is an  important entity  in the  \gls{spm} model
equations  presented  in  \cref{subsec:basicspmgoverningeqns}. The  solid  phase
volume fractions  are also required in  simulating the \gls{p2d} model  owing to
the need for computing the effective electronic conductivities of the electrodes
(see \cref{eq:solidchargeconserve}). They are calculated as
\begin{equation}\label{eq:volumefraccalc}
    \varepsilon_\sj = 1 - \varepsilon_j - \varepsilon_{\text{fi}_j}
\end{equation}
where~$\varepsilon_j$  and~$\varepsilon_{\text{fi}_j}$  are the  electrolyte and
filler  volume-fraction  within  the  respective electrode  regions.  Using  the
values from \cref{tbl:lcoSimParamsSPMp2d} results in~${\varepsilon_\spos =
0.590}$
and  ${\varepsilon_\sneg  =  0.482}$~for the  positive  and  negative  electrodes
respectively. The specific interfacial surface areas are then calculated as
\begin{equation}\label{eq:specificsurfarea}
    a_\sj = \varepsilon_\sj \frac{4 \pi R_\pj^2}{\frac{4}{3} \pi R_\pj^3} = \frac{3\varepsilon_\sj}{R_\pj}
\end{equation}

As   discussed  in   the   assumptions  made   during   model  derivation   (see
\cref{subsec:basicspmassumptions})  and   consistent  with  the   assumed  model
geometry,  the  parameters  not  covered  by  the  \gls{spm}  pertain  to  those
describing electrolyte dynamics and distribution  of electronic charge along the
axial  thickness  direction  of  the  cell. Properties  such  as  the  intrinsic
diffusivities and conductivities of the  electrolyte as well as the transference
number of  \ch{Li^+} in the  organic solvent  are thus completely  redundant for
\gls{spm}  simulation.  The  assumption  of uniform  charge  density  along  the
through-thickness length of each electrode implies that the intrinsic electronic
conductivities of the two electrodes do not play any role in the model dynamics.
The porosities and Bruggeman coefficients in \cref{tbl:lcoSimParamsSPMp2d} serve
as  modifying factors  of the  intrinsic conductivities  and diffusivities  (see
\cref{tbl:dfneqns})  leading to  an effective  value within  each region  of the
electrochemical  layer. Thus,  their relevance  is  also rendered  void for  the
basic  \gls{spm}  simulation.  The  thickness of  the  separator  material  only
plays  a role  in  electrolyte behaviour.  By the  model  geometry presented  in
\cref{subsec:basicspmgeometry}, this  parameter also falls outside  the scope of
the basic \gls{spm}.

The  thicknesses  of the  electrodes  are  optimised  for equal  loading  \ie~to
achieve   a  balance   in   their  individual   capacities   to  store   \ch{Li}
atoms.  The  thickness  of  the  positive  electrode  is  chosen  as  the  value
from~Subramanian~\etal{}~\cite{Subramanian2009}. The  thickness of  the negative
electrode region  is then  computed with  the goal of  equalising the  volume of
active material  in each electrode  for every  electrochemical layer in  a pouch
cell.
\begin{equation}\label{eq:basiccapacitybalance}
    A_{\text{elec}_\text{pos}}\varepsilon_\spos l_\text{pos} = A_{\text{elec}_\text{neg}}\varepsilon_\sneg l_\text{neg}
\end{equation}

In a  lithium-ion pouch cell, the  electrodes are designed such  that the layers
can be  overlaid on  top of  one another  and finally  encapsulated in  a pouch.
Geometrical considerations  then imply  that the  cross-sectional area  (or face
area) of the two electrodes must be  the same. However, due to the consideration
of  avoiding  plating  at  the  edges  due  to  microscopic  malformations,  the
design  is done  such as  to have  a small  overhang of  the negative  electrode
layer~${(<  \SI{2}{\milli\meter})}$  with  respect  to  the  positive  electrode
layer~\cite{Bond2017} (see \cref{fig:anodeoverhangpouchcell}). Nevertheless, the
active surface area is just the  common overlap area between the two electrodes,
and hence $A_\text{elec}$~is  equal to the cross-sectional area  of the positive
electrode.

Thus, \cref{eq:basiccapacitybalance} reduces to~${\frac{l_\text{neg}}{l_\text{pos}} =
\frac{\varepsilon_\text{pos}}{\varepsilon_\text{neg}} = 1.22}$,~yielding~${l_\text{neg} = \SI{72}{\micro\meter}}$.

At  first,  it may  be  surprising  to note  that  the  values of  the  particle
radius~$R_\pj$  used  in both  the  \gls{p2d}  and \gls{spm}  remain  identical.
However, it is  important to note that the \gls{p2d}  equations of the \gls{dfn}
model  are cast  in a  normalised form  \ie~already set  up to  account for  the
overall capacity of  the cell under consideration implicitly through  usage of a
current density (per  unit area) for its simulation.  Furthermore, this explains
why increasing the number of discretisation nodes does not increase the modelled
capacity, but instead merely serves to improves the simulation accuracy owing to
the enhanced spatial resolution.

The  overall  active  surface  area~${A  = n  A_\text{elec}}$  is  the  combined
cross-sectional area of  all layers ($n$~is the number  of electrochemical (pos,
sep,  neg)  triplets)  stacked  into  the pouch  cell.  In  both  the  \gls{p2d}
and  \gls{spm}  models,  this  parameter  serves  to  scale  the  external  load
current  down  to  the  current  density  experienced  by  each  electrochemical
layer.  A   value  of  \approx\SI{30}{\ampere\per\meter\squared}   was  reported
in  the  results  section  of  Subramanian~\etal{}~\cite{Subramanian2009}.  When
considering a  \SI{60}{\amphour} pouch cell with  \SI{10}{\milli\meter} exterior
thickness   and  using   the   parameters  reported   in~\cite{Subramanian2009},
this  results  in  a  cross-sectional area  of  \SI{2.053}{\meter\squared}  (see
\cref{sec:p2daugmentations}). Considering the  equalisation of capacity loading,
with the  newly chosen thickness  value of  the negative electrode,  the 1C-rate
capacity of the cell has been revised to~\SI{29.23}{\ampere\per\meter\squared}.

On  simulating  the \gls{p2d}  model  with  a  trickle bleeding  type  discharge
corresponding   to   a  current   of   C/500   and   logging  the   data   every
\SI{1}{\milli\second}, after reaching \SI{2.7}{\volt}\footnote{From manufacturer
datasheets  for \protect{\gls{lco}}  chemistries,  this value  is considered  to
correspond to~\SI{0}{\percent} \protect{\gls{soc}}.}, the remnant concentrations
in  the two  electrodes  were noted.  The  corresponding residual  stoichiometry
values are reported in \cref{tbl:lcoSimParamsSPMp2d}.

% and is  consistent with  typical values reported  in literature  for \gls{lco}
% chemistries.\fxnote{citation needed here.} This validation is important, since
% below certain  stoichiometry thresholds,  the spinel/olivine structure  of the
% electrodes can become unstable and collapse\fxnote{citation needed?}.

Since      only      isothermal      cell     behaviour      is      considered,
\cref{tbl:lcoSimParamsSPMp2d}    omits     the    activation     energies    for
the    various   diffusivities    and   conductivities    of   materials    (see
\cref{subsec:basicspmsimsetup}  for further  thermal  considerations). For  this
reason, \cref{tbl:lcoSimParamsSPMp2d} does not include other material properties
such as specific heats, and thermal conductivities. No properties of the current
collectors appear in  the isothermal model equations for both  the \gls{p2d} and
\gls{spm} models  and hence are  omitted. All other  electrochemical properties,
\viz~stoichiometries  at \SI{100}{\percent}  \gls{soc}, maximum  concentrations,
diffusivities, reaction  rate coefficients and  \gls{ocp} of the  two electrodes
remain invariant between the \gls{p2d} and \gls{spm} models.

\subsection{Simulation Setup}\label{subsec:basicspmsimsetup}

For  reproducibility of  results, it  is important  to discuss  the system-level
parameters influencing simulation setup.

The lower  cut-off voltage  of the  cell is chosen  to be~\SI{2.5}{\volt}. This
is  deliberately  kept  lower  than  the voltage  corresponding  to  the  cell's
\SI{0}{\percent}~\ie~\SI{2.7}{\volt}.  If set  above  \SI{2.7}{\volt}  even
at  infinitesimally small  discharge  currents, the  cell  would cut-off  before
achieving complete discharge. Choosing a value lower than \SI{2.7}{V} means that
the cell gets a chance to recover its terminal voltage, despite spikes in highly
dynamic  load  currents  that  might  bring the  voltage  below  this  threshold
momentarily. If a low-enough value is  not chosen, a system-level shutdown shall
be  initiated  despite possessing  the  ability  to  continue to  operate  after
recovery  of terminal  voltage.  In this  case, choosing  a  cut-off voltage  of
\SI{2.5}{\volt} does  not damage the cell  since checks are in  place to monitor
the  \gls{soc}  and trigger  cut-off  in  the  event  of charge  depletion  (see
\cref{alg:ctstimespm,alg:disctimespm}).  Northrop~\etal~\cite{Northrop2011}  use
this value, although no specific explanation is given for this choice.

The  upper   cut-off  voltage   of  the  cell   is  chosen   at  \SI{4.3}{\volt}
\ie~\approx\SI{100}{\milli\volt} higher  than  the  equilibrium \gls{ocp}  at~\SI{100}{\percent} \gls{soc}. There are several  reasons for this smaller margin
at the upper end of the voltage spectrum.
\begin{description}[leftmargin=!,labelwidth=\widthof{\bfseries low
    probabilities},itemsep=1ex]

\item[safety] li-ion  cells are less  tolerant to overcharging and  can pose
    fire hazards.

\item[degradation]  overcharging  li-ion  cells  can  lead  to  plating  and
    accelerate other degradation mechanisms.

\item[low  C-rates]  charging C-rates  are  typically  lower than  discharge
    C-rates.

\item[CCCV charging]  For on-board  chargers, taper charging  (such as  in a
    \gls{cccv} profile) is activated, which  ensures that charging current drops
    off  rapidly, leading  to a  lower overvoltage  towards the  upper \gls{soc}
    range.

\item[low probabilities] The only charging event when an electrified vehicle
    is in motion is during regenerative braking. The vehicular \gls{bms} manages
    the operating window such that the starting \gls{soc} is much lower than the
    overvoltage  that  could  be  caused due  to  braking.  Furthermore,  during
    operation, net discharge events  occur more frequently than regenerative
    braking events.

\end{description}

For  both the  \gls{p2d} model  and the  \gls{spm} model,  the cell  temperature
is   kept   constant   at   its   initial   value   of   \SI{25}{\degreeCelsius}
(\SI{298.15}{\kelvin}). This might imply to the reader that the operation of the
lithium ion cell is assumed to be isothermal. While this is not true in general,
for  the C-rates  considered  here  (<5C), typical  in  a \gls{bev}  application
particularly for the  short-duration transient loads studied, it  is certainly a
valid  zeroth  order  coarse  approximation of  the  cell's  thermal  condition.
Detailed modelling of  thermal dynamics is not within the  scope of this thesis,
as  the primary  goal is  to  obtain a  \gls{pbm} incorporating  electrochemical
principles amenable for  embedded application. Hence, the  thermal dependence of
parameters through an Arrhenius-type relationship is also not considered. Future
work could  include performing thermally coupled  simulations, \ie~incorporating
thermally dependent parameters and  simplified heat generation expressions \eg~a
lumped thermal model could be employed  for both the \gls{spm} and \gls{p2d} and
their performances may be compared.

To  understand  the parametrisation  of  initial  concentration, the  expression
for   electrolyte   conductivity   needs    to   be   examined.   As   discussed
in \cref{subsec:spmp2dparametrisation}, the intrinsic conductivity of a specific
type  of  electrolyte  is  a  material   property  that  depends  on  the  local
concentration of \ch{Li^+}~ions and  temperature. In the characterisation of the
electrolyte by Valøen and  Reimers~\cite{Valoen2005}, the polynomial expression
in \cref{eq:kappavsCeandT} was obtained for the electrolyte conductivity.
\begin{multline}\label{eq:kappavsCeandT}
    \kappa_j(c_\text{e},T)(x,t) =  10^{-4} c_\text{e}(x,t) \bigl(-10.5 + \num{0.668e-3} c_\text{e}(x,t) + \num{0.494e-6}  c_\text{e}{(x,t)}^2\\
    + (0.074 - \num{1.78e-5}) c_\text{e}(x,t) - \num{8.86e-10} c_\text{e}{(x,t)}^2 \bigr)T(t)\\
	+ \left(\num{-6.96e-5} + \num{2.8e-8} c_\text{e}{(x,t)})T(t)^2\right)^2
\end{multline}

\begin{figure}[!htbp]
    \centering
    \includegraphics{m2t_kappa_ce_T.pdf}
    \caption[Surface plot of electrolyte conductivity]
    {Electrolyte conductivity as a function of cell temperature and initial concentration.
        % The variation of conductivity versus these factors is a smooth function.
    }%
    \label{fig:kappavsCeandT}
\end{figure}

\Cref{fig:kappavsCeandT}   shows    a   surface   plot   of    the   electrolyte
conductivity  as a  function  of initial  concentration~$c_\text{e,0}$ and  cell
temperature~$T_\text{cell}$. For the modelling task at hand, relevant aspects of
this  material property  can be  better understood  through the  simplifications
afforded by the simulation conditions applicable here \ie{}
\begin{enumerate}%[label=\emph{\alph*})]
    \item At  equilibrium  initial condition ($t=0$), $c_\text{e}$~is uniform over the axial space~$x$, and
    \item only isothermal cell behaviour is considered \ie~${T(t) = T_\text{cell}(0)= T_\text{cell}}$.
\end{enumerate}
Hence, \cref{eq:kappavsCeandT} reduces to
\begin{multline}\label{eq:kappavsCeinitandTcell}
    \kappa_j =  10^{-4} c_\text{e,0} \bigl(-10.5 + \num{0.668e-3} c_\text{e,0} + \num{0.494e-6}  c_\text{e,0}^2\\
        + (0.074 - \num{1.78e-5}) c_\text{e,0} - \num{8.86e-10}
    c_\text{e,0}^2 \bigr)T_\text{cell}\\
	+ \left(\num{-6.96e-5} + \num{2.8e-8} c_\text{e,0})T_\text{cell}^2\right)^2
\end{multline}

As inferred from \cref{fig:kappavsCeandT}, the electrolyte conductivity~$\kappa$
is    a    smooth    function    of~$c_\text{e}$    and~$T_\text{cell}$.    Thus
\cref{eq:kappavsCeinitandTcell}   can  be   effectively  visualised   through  a
parametric  plot of  $\kappa$ versus  $c_\text{e}$ with  $T_\text{cell}$ as  the
variable parameter  as seen in \cref{fig:kappavsce}.  From \cref{fig:kappavsce},
it  is  evident   that  at~${T_\text{cell}=\SI{298.15}{\kelvin}}$,  the  maximum
value   of    electrolyte   conductivity    is   attained    at~${c_\text{e}   =
\SI{1000}{\mole\per\meter\cubed}}$.  It  is  advantageous to  operate  the  cell
around  this   salt  concentration  so   as  to  minimise  the   cell's  overall
resistance.  Hence, the  initial  concentration~$c_\text{e,0}$ is  chosen to  be~\SI{1000}{\mole\per\meter\cubed}. It should be  noted that while the electrolyte
concentration  in  the  \gls{p2d}  model  exhibits  both  spatial  and  temporal
variations during  the simulation, in  the \gls{spm} model, it  remains constant
throughout.

\begin{figure}[!htbp]
    \centering
    \includegraphics{m2t_kappa_ce_parametric_T.pdf}
    \caption[Electrolyte conductivity versus concentration at various cell
    temperatures]{Electrolyte conductivity versus equilibrium concentration at
        various cell temperatures. At~${T_\text{cell} = \SI{298.15}{\kelvin}}$,
        the maximum value of electrolyte conductivity corresponds to a salt
    concentration of~\SI{1000}{\mol\per\meter\cubed}.}
    \label{fig:kappavsce}
\end{figure}

The     reduction    in     parametrisation     requirements    discussed     in
\cref{subsec:spmp2dparametrisation}    is    only    one    of    the    factors
contributing  to  the  simplicity  and  ease  of  simulation.  As  discussed  in
\cref{subsec:basicspmgeometry}, an  important computational requirement  that is
present in the \gls{p2d} model, but  completely eliminated from the \gls{spm} is
the requirement of discretisation. As reported in \cref{tbl:lcoSimParamsSPMp2d},
with  15~nodes per  region  along the  axial direction  and  with 10~shells  per
electrode in the radial direction, the \gls{p2d} model under simulation achieves
mesh  independence  to  a  tolerance of~\approx\SI{2}{\percent}  for  the  range
of  C-rates  considered.  For  higher  C-rates,  coupling  a  thermal  model  is
of  higher  importance  than  incorporating  further  meshing  refinements.  The
discretisation-related parameters  are specific to  the \gls{p2d} model  and are
highlighted accordingly in \cref{tbl:lcoSimParamsSPMp2d}.

\subsubsection*{Capacity Characterisation}\label{subsubsec:capcharspmp2d}

First, it  must be  established that incorporating  the parameters  presented in
\cref{tbl:lcoSimParamsSPMp2d} into  the \gls{spm}  model equations results  in a
cell with  \emph{identical} capacity as the  \gls{dfn} model. This is  to ensure
the  validity  of  comparisons  in  further simulations.  Using  the  values  of
per-layer C-rate  as discussed  in \cref{subsec:spmp2dparametrisation},  and the
overall active  surface area from \cref{tbl:lcoSimParamsSPMp2d},  the cell under
simulation has a capacity of~\SI{60}{\amphour}.

Present literature  in battery modelling, both  for the \gls{dfn} model  and for
the  \gls{spm}, do  not  discuss  any aspect  of  capacity characterisation.  In
particular,  parameters  such  as  the  geometric  surface  area  of  cells  and
even  their 1C-rate  are often  not listed  in publications.  This practice  can
be  attributed  to  the  fact  that  all  one-dimensional  and  \glsfmtlong{p2d}
models operate  on a per-layer  basis, using an applied  current \emph{density}.
Many  a  time,  researchers assume  a  unit  surface  area  for the  cell.  This
implicit  normalisation  is amenable  to  those  studies  which strive  to  make
numerical comparisons  between models through  simulation. However, it  leads to
a  lack  of  clarity  on  the  actual capacity  of  the  cells  being  modelled.
Furthermore, when comparing with experimental data  from a real cell, such works
resort to  ad-hoc techniques such  as empirical curve-fitting for  obtaining the
surface  area. Often  the  source of  such parametrisation  is  not made  clear.
\Cref{sec:p2daugmentations}  documents  the  details of  obtaining  the  overall
surface area  of cells  and arriving  at the  C-rate per  layer of  the specific
cell  under  consideration.  Since  the  \gls{dfn}  model  does  not  explicitly
model  the cell  capacity,  a brief  explanation  is provided  on  how a  simple
\emph{numerical}  characterisation can  be  used for  determining cell  capacity
given a \emph{complete} parameter list.

%\fxnote{citations needed for each accusation.}

For experimental capacity characterisation of cells, the standard practice is to
apply a very small discharge  current beginning at \SI{100}{\percent} \gls{soc},
logging the charge passed using a  high-precision coulomb counter until the cell
hits the voltage corresponding to \SI{0}{\percent} \gls{soc} as specified in the
manufacturer's datasheet. In order to decouple the effect of the cell's dynamics
from its  capacity, it is  required to  apply an infinitesimal  bleeding current
(tending towards, but not reaching \SI{0}{\ampere}).

Current sensors in battery cycler equipment use high-precision (typically 15--18
bit) \glspl{adc}  and are  able to  offer high  \glspl{snr} except  at ultra-low
currents. The main difficulty with using very low C-rates is that it drastically
slows down  the characterisation procedure.  Using a discharge  current of~C/100
\ie~\SI{0.6}{\ampere}  in  this case,  results  in  a characterisation  time  of
\SI{100}{\hour} or \mbox{\approx 4$\sfrac{1}{4}$}~days (excluding soak-times and
other set-up related activities).  Furthermore, for accurate coulomb-counting, a
high data logging  rate is needed, producing large file  sizes and corresponding
difficulties in post-processing them.  Considering moderate buffer-sizes used in
data logging modules of typical  cell-cycler software (shared between channels),
and  to  avoid  excessively  large wait-times  for  characterisation,  discharge
currents of C/20--C/25 are usually deemed sufficient.

In    order   to    validate    that   the    choice    of   model    parameters
result   in   an   intended   capacity  of   \SI{60}{\amphour},   an   analogous
procedure   is    carried   out   by    means   of   computer    simulation.   A
characterisation  simulation  beginning  at  \SI{100}{\percent}  \gls{soc}  with
a   discharge   current    of   \SI{0.6}{\ampere}   was   performed\footnote{All
computations  were  performed  on   a  64-bit  Hewlett-Packard~Z840  workstation
with   a   \mbox{16-core}   \mbox{\text{Intel}\textsuperscript{\textregistered}}
\mbox{Xeon\textsuperscript{\textregistered}}     \mbox{E5-2640~v3}     (Haswell)
processor clocked  at \SI{2.60}{\giga\hertz} with  \SI{128}{\giga\byte} DDR4~RAM
at 1866~MT/sec.}.  If the assumed  cell capacity  is indeed consistent  with the
model parameters,  then this corresponds to  a C-rate of~1/100.  Therefore, both
the \gls{p2d} and \gls{spm} should run  for exactly 100~hours before cut-off due
to charge depletion.


Capacity validation through computer simulation  is not bound by the limitations
of the experimental approach discussed earlier. Using 64-bit IEEE floating point
arithmetic,  quantities  as  low  as  ${\mathcal{O}(10^{-16})}$  can  be  safely
computed, nullifying  any \gls{snr} issues.  \Cref{tbl:charSimspmp2d} summarises
the key data  from this simulation run. For accurate  coulomb counting, the data
logging  interval  is set  to~\SI{50}{\milli\second}.  Both the  \gls{p2d}  and
\gls{spm} model ran close to 100~hours.  The small deviations from this expected
termination  time  can  be attributed  to  the  fact  that  the current  is  not
arbitrarily small with  the pragmatic goal of obtaining results  in a reasonable
time. As seen in \cref{tbl:charSimspmp2d},  even the \emph{combined} CPU time to
simulate both  the \gls{p2d}  and \gls{spm}  models is  two orders  of magnitude
lower than  real-time. The only  issue that remains to  be addressed is  that of
considerable memory and  storage requirements due to  high-rate data-logging for
accurate coulomb counting. For a standard computer workstation, this places only
a minor  demand on  its CPU.  For comparable volume  of data  to be  logged, the
reliability  and ruggedness  of  a  dedicated workstation  far  exceeds that  of
real-time cell cyclers, thereby establishing numerical simulation as an amenable
method for characterisation of cell capacity. A major disadvantage of simulation
based capacity validation  is its extreme sensitivity to parameters  such as the
maximum concentration  of the  electrodes and  their stoichiometries,  which are
generally difficult to characterise. In this context, the experimental procedure
of  high-precision  coulomb counting  assumes  a  practical significance  as  it
requires no  knowledge of  the cell's parameters  other than  the manufacturer's
datasheet.

\input{chapters/spm_analysis/char_sim_table.tex}

\begin{figure}[!htbp]
    \centering
    \includegraphics{capacity_match_spm_p2d.pdf}
    \caption[Voltage response of \glsfmtshort{spm} and \glsfmtshort{p2d} models
    for capacity validation]{Voltage response of \gls{p2d} and \gls{spm} models
        to a discharge current input of~\SI{0.6}{A}. Both models achieve their
        charge depletion point after \approx\SI{100}{\hour} confirming that
        their modelled capacities match. Key simulation data for this
    characterisation run is shown in \cref{tbl:charSimspmp2d}.}
    \label{fig:capcharspmp2d}
\end{figure}

\Cref{fig:capcharspmp2d}  shows  the  voltage  response  of  the  \gls{spm}  and
\gls{p2d}  models,  which   overlap.  It  is  clear  that   both  the  \gls{p2d}
and  \gls{spm}  models   achieve  a  run-time  of   100~hours.  This  represents
the   first  visualisation   of  results   produced  by   the  \gls{spm}   model
equations  discussed  in \cref{subsec:basicspmgoverningeqns} and  its  numerical
implementation  from \cref{sec:numericalimplementation}.  The voltage  error  is
defined as
\begin{equation}
    \varepsilon_v = V_{\text{cell}_\text{p2d}} - V_{\text{cell}_\text{spm}}
\end{equation}
The absolute maximum  error is of~$\mathcal{O}\left(100\right)\si{\milli\volt}$,
which  occurs  towards  the  end  of discharge.  Although  this  represents  the
worst  case upper  bound  on  the error,  this  is  not strictly  representative
of  the  overall  error  behaviour   as  evidenced  by  the  standard  deviation
of  the  error  vector.  The  mean   and  \gls{rms}  error  values  indicate  an
accuracy of~${\mathcal{O}\left(10\right)\si{\milli\volt}}$.  It should  be noted
that throughout  the simulation, the  voltage response of the  \gls{spm} remains
above  that of  \gls{p2d}, thereby  leading  to a  negative value  for the  mean
voltage error. For continuous quantities  such as time-domain simulation outputs
of physical variables, the \gls{mae} is a suitable error metric and is
defined as  \begin{equation} \varepsilon_\text{\scriptsize  \glsfmtshort{mae}} =
\frac{\Sigma_{i=1}^{n}\abs{\varepsilon_i}}{n}  \end{equation} and  is consistent
with the order of  magnitude of the \gls{rms} and mean error  metrics as well as
with the standard deviation of the error vector.

Thus,  a common  foundation  for  further simulations  has  been established  by
confirming  that  the  two  models  indeed  simulate  a  cell  with  a  capacity
of~\SI{60}{\amphour}.  With  the  cell  parametrisation  discussed,  simulation
setup  presented and  capacities  validated, the  simulation  results are  fully
reproducible and are presented next in \cref{subsec:simresultsbasicspm}.

\subsection{Simulation Results}\label{subsec:simresultsbasicspm}

\subsubsection*{Constant current discharge}\label{subsubsec:cnstcurrdischgsim}

The  left  column  of \cref{fig:cnstdischgspmp2dvoltage} shows  the  time-domain
voltage response of the basic \gls{spm} for various constant discharge currents.
The voltage response of the \gls{p2d} model  is also overlaid on these plots and
is used  as a  reference benchmark  for comparisons.  It is  difficult to  use a
common  time-scale for  the horizontal  axes of  the plots  since the  run-times
differ by two orders of magnitude for the C-rates considered.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{const_curr_dischg_voltage.pdf}
    \caption[Voltage responses of \glsfmtshort{p2d} and \glsfmtshort{spm} to
    constant current discharge]{Voltage responses of the \glsfmtshort{p2d} and
        \glsfmtshort{spm} models to various constant discharge rates. The left
        column column shows the time-domain voltage response of the \gls{spm}
        plotted against the benchmark \gls{p2d} response. The column on the
        right shows the percentage voltage error of the \glsfmtshort{spm} with
        respect to the \glsfmtshort{p2d} model. The performance of the
        \glsfmtshort{spm} degrades considerably at discharge currents above~0.5C.}
    \label{fig:cnstdischgspmp2dvoltage}
\end{figure}

Since these comparisons  have to be done across multiple  C-rates, each yielding
different magnitudes in voltage responses, it is helpful to use a relative error
metric such as the percentage error, defined as
\begin{equation}
    \hat{\varepsilon}_v\,(\si{\percent}) = 100\frac{V_{\text{cell}_\text{p2d}} - V_{\text{cell}_\text{spm}}}{V_{\text{cell}_\text{p2d}}}
\end{equation}

It is to be noted that, in all cases, the \gls{p2d} model terminates faster than
the \gls{spm} either due to hitting lower cut-offs of either terminal voltage or
\gls{soc} (see \cref{fig:cnstdischgspmp2dsoc}).  Consequently, the  error vector
is defined only for the common time-region before cut-off.

In  \cref{fig:cnstdischgspmp2dvoltage},  the  column  on  the  right  shows  the
percentage error  in the voltage response  of the \gls{spm} with  respect to the
\gls{p2d} model.  At very  low C-rates  below \approx0.5C,  the voltage-response
performance of the \gls{spm} is acceptable. However, the performance degradation
is rapid above this C-rate. It is clear that the error in the \gls{spm} response
is monotonic and unidirectional. This indicates  that the source of the error is
due  to  unmodelled dynamics.  In  particular,  as  discussed in  the  modelling
assumptions  of  \cref{subsec:basicspmassumptions},  the \gls{spm}  ignores  the
electrolyte  dynamics.  Thus,  the  overpotential  in  the  electrolyte  is  not
modelled, which  results in the terminal  voltage of the \gls{spm}  being always
higher than its \gls{p2d} counterpart.

\begin{figure}[!htb]
    \centering
    \includegraphics[width=\textwidth]{const_curr_dischg_soc.pdf}
    \caption[\glsfmtshort{soc} computed by \glsfmtshort{p2d} and
    \glsfmtshort{spm} models for constant current discharge]{Plots in the left
        column depict the time evolution of \glsfmtshort{soc} computed by the
        \glsfmtshort{p2d} and \glsfmtshort{spm} models for various constant
        discharge rates. The column on the right shows the error of the
        \glsfmtshort{soc} computed by the \glsfmtshort{spm} with respect to that
        computed by the \glsfmtshort{p2d} model \ie~$ \varepsilon_\text{soc}
        = {z_\text{p2d}} - z_\text{spm} $. The \glsfmtshort{spm} remains quite
    accurate even at moderate currents such as~3C.}
    \label{fig:cnstdischgspmp2dsoc}
\end{figure}

\Cref{fig:cnstdischgspmp2dsoc}  shows  the  time-evolution  of~\glsfmtshort{soc}
computed by the  \glsfmtshort{p2d} and the \glsfmtshort{spm}  models for various
discharge  currents. Since  the  \gls{soc} of  a cell  is  already a  normalised
quantity by  definition, the difference between  the two models can  be directly
used for comparison across C-rates. The \gls{soc} error is defined as
\begin{equation}
    \varepsilon_\text{soc} = {z_\text{p2d}} - z_\text{spm}
\end{equation}
and   like  the   error  in   the  terminal   voltage,  remains   unidirectional
over  time,   and  defined  only   until  one   of  the  models   hits  cut-off.
\Cref{tbl:errorsummarycntcurrdischgspmp2d}  shows  a  summary of  various  error
metrics used  to quantify  the performance  of the  basic \gls{spm}  for various
discharge rates.

\input{chapters/spm_analysis/dischg_errs_spm_p2d_table.tex}

A   quick   perusal  of \cref{tbl:errorsummarycntcurrdischgspmp2d}   reveals   a
discrepancy that invokes surprise at first glance. Whilst the performance of the
\gls{spm} is  quite poor in  terms of terminal  voltage prediction, it  is worth
noting that its \gls{soc} prediction  capabilities remain quite accurate even at
moderate  discharge  currents  of  about~3C and  therefore,  warrants  a  brief
explanation.

Referring to \cref{eq:soccomputation}, it is  seen that the \glsfmtshort{soc} of
the cell  is directly proportional  to the  bulk (average) concentration  in the
negative  electrode.  Hence  the  plots  of \cref{fig:cnstdischgspmp2dsoc}  also
represent the solid  phase concentration with a constant scaling  factor. As per
the assumptions listed  in \cref{subsec:basicspmassumptions}, the only transport
phenomena  modelled in  the \gls{spm}  is  solid phase  diffusion. However,  for
computation of the terminal  voltage, the electrolyte overpotential contribution
has  been   omitted  (see \cref{eq:posoverpotential,eq:negoverpotential}).  This
explains  why  the  voltage  accuracy  suffers  while  the  open-loop  \gls{soc}
computation  remains  accurate.  The  high accuracy  of  \gls{soc}  (and  hence,
solid-phase  concentration)   computation  also  validates  the   usage  of  the
\engordnumber{4} order polynomial  approximation in the place of  Fick's law for
modelling solid-phase diffusion.

However,  the  discrepancy  in  accuracies of  terminal  voltage  and  \gls{soc}
computed  by the  basic \gls{spm}  leads to  an important  implication. Even  at
moderate C-rates, the  basic \gls{spm} \emph{cannot} be effectively  used in the
design of \gls{soc}  observers. This is because, the measured  voltage maps to a
vastly different  operating point when using  the \gls{spm} as the  plant model,
leading to strong deviations of the estimated \gls{soc}.


\subsubsection*{Constant current charge}\label{subsubsec:cnstcurrchgsim}

The \gls{cccv} charging  profile is a widely adopted  standard charging strategy
for charging lithium  ion cells. In the constant current  phase, a charging rate
of~1C is  used as an accepted baseline, although  faster charging strategies are
being actively sought  after both in academia and in  particular, the automotive
industry. For establishing the charging performance of the basic \gls{spm}, the
standard rate of~1C is used.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{const_curr_chg.pdf}
    \caption[Voltage and \glsfmtshort{soc} computed by \glsfmtshort{p2d} and
    \glsfmtshort{spm} for 1C~constant current charge]{Time evolution of voltage
        and \glsfmtshort{soc} (top row) of the \glsfmtshort{p2d} and
        \glsfmtshort{spm} models upon charging with a constant current of~1C,
        \ie~\SI{60}{\ampere} starting at \SI{0}{\percent}~\glsfmtshort{soc}.
        The bottom row shows the percentage in terminal voltage and
        \glsfmtshort{soc} respectively of the \glsfmtshort{spm} with respect to
    the \glsfmtshort{p2d} model.}
    \label{fig:cnstchgspmp2d}
\end{figure}

The top row of \cref{fig:cnstchgspmp2d} shows  the evolution of terminal voltage
and \gls{soc}  of the \gls{p2d} and  \gls{spm} models under an  applied charging
current of~1C \ie~\SI{60}{\ampere}.  The constant-voltage charging  phase is
not shown. The bottom row shows  the corresponding errors of the \gls{spm} model
with respect  to the reference  \gls{p2d} benchmark. The corollary  behaviour of
the constant current discharge behaviour  is observed here. The terminal voltage
of the \gls{spm} remains below the  \gls{p2d} model throughout. This is expected
since, to  account for the electrolyte  voltage drop in the  \gls{p2d}, a higher
terminal voltage needs  to be applied. The voltage error  is thus unidirectional
and remains positive (opposite to  that observed for the corresponding discharge
case).  Similarly,  the \gls{soc}  plots  overlap  very closely  validating  the
underlying polynomial approximation of solid  phase diffusion. It is striking to
note  that the  error in  \gls{soc} remains  exactly around  the same  magnitude
(\approx\SI{0.1}{\percent}) in both the charging and discharging cases.

\subsubsection*{Dynamic input profile}\label{subsubsec:dynamicspmp2dsim}

For automotive applications, it is  important to characterise the performance of
the  cell  model  under  dynamic load  conditions.  Several  standard  vehicular
driveycles  have been  defined and  adopted  by regulatory  agencies across  the
world.  These drivecycles  describe  the profile  of the  vehicle's  speed as  a
function of time.  For all drivecycles, the  speed versus time data  is given in
intervals  of  \SI{1}{\second}, and  is  therefore  consistent with  the  sample
interval used for the simulation (see \cref{tbl:lcoSimParamsSPMp2d}).

The \gls{udds} is  one such well-known drivecycle, originally  introduced by the
United  States  Environmental Protection  Agency  that  represents city  driving
conditions which can  be applied to a typical mid-sized  passenger vehicle. This
cycle  has  been  widely  adopted  by  regulatory  agencies  across  the  world.
\Cref{fig:uddsspeedvstimecycle}  shows  the  \gls{udds} drivecycle  wherein  the
vehicle's speed has been converted to  SI units for use in further computations.
One complete drivecycle runs for 1369~seconds.

\begin{figure}[!htbp]
    \centering
    \includegraphics{udds_cycle.pdf}
    \caption{The \glsfmtshort{udds} drivecycle profile}
    \label{fig:uddsspeedvstimecycle}
\end{figure}

In  an  all-electric  drivetrain  wherein  lithium  ion  batteries  provide  the
propulsion power, the speed profile can  be converted to a corresponding current
profile  experienced  by  the  cell. Therefore,  from  the  cell's  perspective,
traversal of  the drivecycle  then corresponds to  the following  events. During
acceleration phases,  the cell experiences  a sharp discharge spike  of current.
Similarly,  assuming that  regenerative braking  is employed,  each deceleration
event corresponds to a charging current. Thus a current versus time dynamic load
profile  can be  obtained.  To  briefly summarise  the  conversion process,  the
computed  power profile  of  the cell  is  divided by  its  nominal voltage  and
suitably scaled  so that the  peak of the the  current profile corresponds  to a
discharge  current of~3C.  Considering that  all of  braking  energy cannot  be
recovered  due  to losses  at  the  wheels,  brake  discs and  other  mechanical
components,  a regenerative  braking factor  of \SI{85}{\percent}  (the fraction
of  recoverable  power)  is  assumed  for the  charging  scenario.  As  seen  in
\cref{fig:uddsspeedvstimecycle},  the  \gls{udds}   profile  is  highly  dynamic
consisting  of  many sets  of  rapid  acceleration  and braking  events.  Hence,
this  drivecycle is  chosen to  provide  representative results  of the  model's
performance to dynamic inputs.

% The details  of this conversion for  a specific \gls{bev} platform  is discussed
% in~?\fxnote{fix this to point to layer opt chapter}.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=10.890625cm]{udds_I_v_soc.pdf} % change the width suitably afterwards
    \caption[Simulation results of \glsfmtshort{p2d} and \glsfmtshort{spm}
    models to \glsfmtshort{udds} current profile]{Simulation results for a
        \glsfmtshort{udds} current profile. The voltage prediction performance
        of the \glsfmtshort{spm} to dynamic loads is poor while its
    \glsfmtshort{soc} computation accuracy is high.}
    \label{fig:uddssimp2dspmresults}
\end{figure}

\Cref{fig:uddssimp2dspmresults}  shows   the  simulation  results   obtained  by
applying  the   \gls{udds}  current  input   profile  (top  row)  to   both  the
\gls{p2d} and \gls{spm}  models. The simulation is  started at \SI{50}{\percent}
cell~\gls{soc}. This  is representative  of the median  point for  the operating
window  of  \gls{soc} swing  for  both  \glspl{bev} and  \glspl{phev}.  Although
regenerative  braking is  employed, due  to  the reduced  occurrence of  braking
events  as well  as  considering efficiencies  of the  drivetrain,  as with  any
driveycle,  the \gls{udds}  run  also  results in  a  net-discharge. The  cell's
\gls{soc} at  the termination of  the \gls{udds} run  is \approx\SI{6}{\percent}
lower than its starting value.

% \FloatBarrier

The voltage output from the models is  plotted in the middle row. The bottom row
shows  the  evolution  of  the  cell's  \gls{soc}  over  time.  Consistent  with
the  error  trends  observed  in  the  constant  current  discharge  and  charge
simulations, the error in terminal voltage  is high whereas that in \gls{soc} is
low.  In  this  work,  the  voltage  error  metrics  are  reported  directly  in
units  of  \si{\milli\volt} for  the  dynamic  simulation run.  Furthermore,  it
is  a  standard  practice  to  report  the  \gls{rms}  error  for  such  dynamic
load  profiles and  is included  in  the summary  of error  metrics reported  in
\cref{tbl:errorsummaryuddsdischgspmp2d}.

\input{chapters/spm_analysis/udds_errs_spm_p2d_table.tex}

% accuracy comparison, figure inset

% textwidth in cm: \printinunitsof{cm}\prntlen{\textwidth} % 15.74776 cm
% textheight in cm: \printinunitsof{cm}\prntlen{\textheight} % 22.27184 cm
% github toolbox
